<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>了解 7z 命令开关（一）</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: Himanshu Arora 7z 无疑是一个功能强大的强大的归档工具（声称提供最高的压缩比）。在 HowtoForge 中，我们已经已经讨论过如何安装和使用 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li class="active"><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2017/08/liao-jie-7z-ming-ling-kai-guan-yi.html" rel="bookmark"
           title="Permalink to 了解 7z 命令开关（一）">了解 7z 命令开关（一）</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2017-08-19T14:32:59+02:00">
                Published: Sat 19 August 2017
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/ji-zhu">技术</a>.</p>

</footer><!-- /.post-info -->      <p>Author: Himanshu Arora</p>
<p><img alt="" src="/data/attachment/album/201708/19/143244kypyp9rln99qyl9v.png"></p>
<p>7z 无疑是一个功能强大的强大的归档工具（声称提供最高的压缩比）。在 HowtoForge 中，我们已经<a href="https://www.howtoforge.com/tutorial/how-to-install-and-use-7zip-file-archiver-on-ubuntu-linux/">已经讨论过</a>如何安装和使用它。但讨论仅限于你可以使用该工具提供的“功能字母”来使用基本功能。</p>
<p>在本教程中，我们将扩展对这个工具的说明，我们会讨论一些 7z 提供的“开关”。 但在继续之前，需要说明的是，本教程中提到的所有说明和命令都已在 Ubuntu 16.04 LTS 上进行了测试。</p>
<p><strong>注意</strong>：我们将使用以下截图中显示的文件来执行使用 7zip 的各种操作。</p>
<p><a href="https://www.howtoforge.com/images/understanding_7z_command_switches_part_i/big/ls.png"><img alt="ls from test directory" src="/data/attachment/album/201708/19/143302xyqgjbbptpfwf3pu.png"></a> </p>
<h3>包含文件</h3>
<p>7z 工具允许你有选择地将文件包含在归档中。可以使用 <code>-i</code> 开关来使用此功能。</p>
<p>语法：</p>
<div class="highlight"><pre><span></span><code><span class="o">-</span><span class="n">i</span><span class="o">[</span><span class="n">r[-|0</span><span class="o">]</span><span class="err">]{</span><span class="nv">@listfile</span><span class="o">|</span><span class="err">!</span><span class="n">wildcard</span><span class="err">}</span>
</code></pre></div>

<p>比如，如果你想在归档中只包含 “.txt” 文件，你可以使用下面的命令：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>7z<span class="w"> </span>a<span class="w"> </span>‘-i!*.txt’<span class="w"> </span>include.7z
</code></pre></div>

<p>这是输出：</p>
<p><a href="https://www.howtoforge.com/images/understanding_7z_command_switches_part_i/big/include.png"><img alt="add files to 7zip" src="/data/attachment/album/201708/19/143304tyy5g74w77ypm5ah.png"></a> </p>
<p>现在，检查新创建的归档是否只包含 “.txt” 文件，你可以使用下面的命令：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>7z<span class="w"> </span>l<span class="w"> </span>include.7z
</code></pre></div>

<p>这是输出：</p>
<p><a href="https://www.howtoforge.com/images/understanding_7z_command_switches_part_i/big/includelist.png"><img alt="Result" src="/data/attachment/album/201708/19/143305c0gbebnwsrbb0l1k.png"></a> </p>
<p>在上面的截图中，你可以看到 “testfile.txt” 已经包含到归档中了。</p>
<h3>排除文件</h3>
<p>如果你想要，你可以排除不想要的文件。可以使用 <code>-x</code> 开关做到。</p>
<p>语法：</p>
<div class="highlight"><pre><span></span><code><span class="o">-</span><span class="n">x</span><span class="o">[</span><span class="n">r[-|0</span><span class="o">]</span><span class="err">]]{</span><span class="nv">@listfile</span><span class="o">|</span><span class="err">!</span><span class="n">wildcard</span><span class="err">}</span>
</code></pre></div>

<p>比如，如果你想在要创建的归档中排除 “abc.7z” ，你可以使用下面的命令：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>7z<span class="w"> </span>a<span class="w"> </span>‘-x!abc.7z’<span class="w"> </span>exclude.7z
</code></pre></div>

<p>这是输出：</p>
<p><a href="https://www.howtoforge.com/images/understanding_7z_command_switches_part_i/big/exclude.png"><img alt="exclude files from 7zip" src="/data/attachment/album/201708/19/143306hxsm44cls1vmc1md.png"></a> </p>
<p>要检查最后的归档是否排除了 “abc.7z”, 你可以使用下面的命令：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>7z<span class="w"> </span>l<span class="w"> </span>exclude.7z
</code></pre></div>

<p>这是输出：</p>
<p><a href="https://www.howtoforge.com/images/understanding_7z_command_switches_part_i/big/excludelist.png"><img alt="result of file exclusion" src="/data/attachment/album/201708/19/143309famooayyvjs0u1o0.png"></a> </p>
<p>上面的截图中，你可以看到 “abc.7z” 已经从新的归档中排除了。</p>
<p><strong>专业提示</strong>：假设任务是排除以 “t” 开头的所有 .7z 文件，并且包含以字母 “a” 开头的所有 .7z 文件。这可以通过以下方式组合 <code>-i</code> 和 <code>-x</code> 开关来实现：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>7z<span class="w"> </span>a<span class="w"> </span><span class="s1">&#39;-x!t*.7z&#39;</span><span class="w"> </span><span class="s1">&#39;-i!a*.7z&#39;</span><span class="w"> </span>combination.7z
</code></pre></div>

<h3>设置归档密码</h3>
<p>7z 同样也支持用密码保护你的归档文件。这个功能可以使用 <code>-p</code> 开关来实现。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>7z<span class="w"> </span>a<span class="w"> </span><span class="o">[</span>archive-filename<span class="o">]</span><span class="w"> </span>-p<span class="o">[</span>your-password<span class="o">]</span><span class="w"> </span>-mhe<span class="o">=[</span>on/off<span class="o">]</span>
</code></pre></div>

<p><strong>注意</strong>：<code>-mhe</code> 选项用来启用或者禁用归档头加密（默认是“off”）。</p>
<p>例子：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>7z<span class="w"> </span>a<span class="w"> </span>password.7z<span class="w"> </span>-pHTF<span class="w"> </span>-mhe<span class="o">=</span>on
</code></pre></div>

<p>无需多说，当你解压密码保护的归档时，工具会向你询问密码。要解压一个密码保护的文件，使用 <code>e</code> 功能字母。下面是例子：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>7z<span class="w"> </span>e<span class="w"> </span>password.7z
</code></pre></div>

<p><a href="https://www.howtoforge.com/images/understanding_7z_command_switches_part_i/big/password.png"><img alt="protect 7zip archive with a password" src="/data/attachment/album/201708/19/143311wspxbbnnpln572pp.png"></a> </p>
<h3>设置输出目录</h3>
<p>工具同样支持解压文件到你选择的目录中。这可以使用 <code>-o</code> 开关。无需多说，这个开关只在含有 <code>e</code> 或者 <code>x</code> 功能字母的时候有用。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>7z<span class="w"> </span><span class="o">[</span>e/x<span class="o">]</span><span class="w"> </span><span class="o">[</span>existing-archive-filename<span class="o">]</span><span class="w"> </span>-o<span class="o">[</span>path-of-directory<span class="o">]</span>
</code></pre></div>

<p>比如，假设下面命令工作在当前的工作目录中：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>7z<span class="w"> </span>e<span class="w"> </span>output.7z<span class="w"> </span>-ohow/to/forge
</code></pre></div>

<p>如 <code>-o</code> 开关的值所指的那样，它的目标是解压文件到 ./how/to/forge 中。</p>
<p>这是输出：</p>
<p><a href="https://www.howtoforge.com/images/understanding_7z_command_switches_part_i/big/output.png"><img alt="7zip output directory" src="/data/attachment/album/201708/19/143315xpy5s5mysko8p484.png"></a> </p>
<p>在上面的截图中，你可以看到归档文件的所有内容都已经解压了。但是在哪里？要检查文件是否被解压到 ./how/to/forge，我们可以使用 <code>ls -R</code> 命令。</p>
<p><a href="https://www.howtoforge.com/images/understanding_7z_command_switches_part_i/big/ls_-R.png"><img alt="result" src="/data/attachment/album/201708/19/143318au8pirl8oz8rte8l.png"></a> </p>
<p>在上面的截图中，我们可以看到 .7z 中的内容都被解压到 ./how/to/forge 中。</p>
<h3>创建多个卷</h3>
<p>借助 7z 工具，你可以为归档创建多个卷（较小的子档案）。当通过网络或 USB 传输大文件时，这是非常有用的。可以使用 <code>-v</code> 开关使用此功能。这个开关需要指定子档案的大小。</p>
<p>我们可以以字节（b）、千字节（k）、兆字节（m）和千兆字节（g）指定子档案大小。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>7z<span class="w"> </span>a<span class="w"> </span><span class="o">[</span>archive-filename<span class="o">]</span><span class="w"> </span><span class="o">[</span>files-to-archive<span class="o">]</span><span class="w"> </span>-v<span class="o">[</span>size-of-sub-archive1<span class="o">]</span><span class="w"> </span>-v<span class="o">[</span>size-of-sub-archive2<span class="o">]</span><span class="w"> </span>....
</code></pre></div>

<p>让我们用一个例子来理解这个。请注意，我们将使用一个新的目录来执行 <code>-v</code> 开关的操作。</p>
<p>这是目录内容的截图：</p>
<p><a href="https://www.howtoforge.com/images/understanding_7z_command_switches_part_i/big/volumels.png"><img alt="7zip volumes" src="/data/attachment/album/201708/19/143319xwdwkof1ks4sk0kd.png"></a> </p>
<p>现在，我们运行下面的命令来为一个归档文件创建多个卷（每个大小 100b）：</p>
<div class="highlight"><pre><span></span><code><span class="mf">7</span><span class="n">z</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">volume</span><span class="mf">.7</span><span class="n">z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">-</span><span class="n">v100b</span>
</code></pre></div>

<p>这是截图：</p>
<p><a href="https://www.howtoforge.com/images/understanding_7z_command_switches_part_i/big/volume.png"><img alt="compressing volumes" src="/data/attachment/album/201708/19/143322z0cdkdg275zpdezu.png"></a> </p>
<p>现在，要查看创建的子归档，使用 <code>ls</code> 命令。</p>
<p><a href="https://www.howtoforge.com/images/understanding_7z_command_switches_part_i/big/volumels2.png"><img alt="list of archives" src="/data/attachment/album/201708/19/143324hz2um0i3wzbr2sbu.png"></a> </p>
<p>如下截图所示，一共创建四个卷 - volume.7z.001、volume.7z.002、volume.7z.003 和 volume.7z.004</p>
<p><strong>注意</strong>：你可以使用 .7z.001 归档文件来解压。但是，要这么做，其他所有的卷都应该在同一个目录内。</p>
<h3>设置归档的压缩级别</h3>
<p>7z 允许你设置归档的压缩级别。这个功能可以使用 <code>-m</code> 开关。7z 中有不同的压缩级别，比如：<code>-mx0</code>、<code>-mx1</code>、<code>-mx3</code>、<code>-mx5</code>、<code>-mx7</code> 和 <code>-mx9</code>。</p>
<p>这是这些压缩级别的简要说明：</p>
<ul>
<li><code>mx0</code> = 完全不压缩 - 只是复制文件到归档中。</li>
<li><code>mx1</code> = 消耗最少时间，但是压缩最小。</li>
<li><code>mx3</code> = 比 <code>-mx1</code> 好。</li>
<li><code>mx5</code> = 这是默认级别 （常规压缩）。</li>
<li><code>mx7</code> = 最大化压缩。</li>
<li><code>mx9</code> = 极端压缩。</li>
</ul>
<p><strong>注意</strong>：关于这些压缩级别的更多信息，阅读<a href="http://askubuntu.com/questions/491223/7z-ultra-settings-for-zip-format">这里</a>。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>7z<span class="w"> </span>a<span class="w"> </span><span class="o">[</span>archive-filename<span class="o">]</span><span class="w"> </span><span class="o">[</span>files-to-archive<span class="o">]</span><span class="w"> </span>-mx<span class="o">=[</span><span class="m">0</span>,1,3,5,7,9<span class="o">]</span>
</code></pre></div>

<p>例如，我们在目录中有一堆文件和文件夹，我们每次尝试使用不同的压缩级别进行压缩。作为一个例子，这是当使用压缩级别 “0” 时创建存档时使用的命令。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>7z<span class="w"> </span>a<span class="w"> </span>compression<span class="o">(</span>-mx0<span class="o">)</span>.7z<span class="w"> </span>*<span class="w"> </span>-mx<span class="o">=</span><span class="m">0</span>
</code></pre></div>

<p>相似地，其他命令也这样执行。</p>
<p>以下是输出档案（使用 “ls” 命令生成）的列表，其名称表示其创建中使用的压缩级别，输出中的第五列显示压缩级别对其大小的影响。</p>
<p><a href="https://www.howtoforge.com/images/understanding_7z_command_switches_part_i/big/compression.png"><img alt="7zip compression level" src="/data/attachment/album/201708/19/143326b7l7pzmm1lxx7w0j.png"></a> </p>
<h3>显示归档的技术信息</h3>
<p>如果需要，7z 还可以在标准输出中显示归档的技术信息 - 类型、物理大小、头大小等。可以使用 <code>-slt</code> 开关使用此功能。 此开关仅适用于带有 <code>l</code> 功能字母的情况下。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>7z<span class="w"> </span>l<span class="w"> </span>-slt<span class="w"> </span><span class="o">[</span>archive-filename<span class="o">]</span>
</code></pre></div>

<p>比如：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>7z<span class="w"> </span>l<span class="w"> </span>-slt<span class="w"> </span>abc.7z
</code></pre></div>

<p>这是输出：</p>
<p><a href="https://www.howtoforge.com/images/understanding_7z_command_switches_part_i/big/slt.png"><img alt="" src="/data/attachment/album/201708/19/143328p2gkd0z2vtnok0s2.png"></a> </p>
<h3>指定创建归档的类型</h3>
<p>如果你想要创建一个非 7z 的归档文件（这是默认的创建类型），你可以使用 <code>-t</code> 开关来指定。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>7z<span class="w"> </span>a<span class="w"> </span>-t<span class="o">[</span>specify-type-of-archive<span class="o">]</span><span class="w"> </span><span class="o">[</span>archive-filename<span class="o">]</span><span class="w"> </span><span class="o">[</span>file-to-archive<span class="o">]</span>
</code></pre></div>

<p>下面的例子展示创建了一个 .zip 文件：</p>
<div class="highlight"><pre><span></span><code><span class="mf">7</span><span class="n">z</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">-</span><span class="n">tzip</span><span class="w"> </span><span class="n">howtoforge</span><span class="w"> </span><span class="o">*</span>
</code></pre></div>

<p>输出的文件是 “howtoforge.zip”。要交叉验证它的类型，使用 <code>file</code> 命令：</p>
<p><a href="https://www.howtoforge.com/images/understanding_7z_command_switches_part_i/big/type.png"><img alt="" src="/data/attachment/album/201708/19/143329hoq7skkmo1k7o8mn.png"></a> </p>
<p>因此，howtoforge.zip 的确是一个 ZIP 文件。相似地，你可以创建其他 7z 支持的归档。</p>
<h3>总结</h3>
<p>你将会认识到， 7z 的 “功能字母” 以及 “开关” 的知识可以让你充分利用这个工具。我们还没有完成开关的部分 - 其余部分将在第 2 部分中讨论。</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>