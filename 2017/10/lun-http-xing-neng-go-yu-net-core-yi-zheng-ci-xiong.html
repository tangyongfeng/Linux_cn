<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>论 HTTP 性能，Go 与 .NET Core 一争雌雄</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: Gerasimos Maropoulos 朋友们，你们好！ 近来，我听到了大量的关于新出的 .NET Core 和其性能的讨论，尤其在 Web 服务方面的讨论更甚。 因为是新出 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li class="active"><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2017/10/lun-http-xing-neng-go-yu-net-core-yi-zheng-ci-xiong.html" rel="bookmark"
           title="Permalink to 论 HTTP 性能，Go 与 .NET Core 一争雌雄">论 HTTP 性能，Go 与 .NET Core 一争雌雄</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2017-10-06T11:13:00+02:00">
                Published: Fri 06 October 2017
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/ruan-jian-kai-fa">软件开发</a>.</p>

</footer><!-- /.post-info -->      <p>Author: Gerasimos Maropoulos</p>
<p><img alt="" src="/data/attachment/album/201710/06/111305ltswozo3cmicl3z6.png"></p>
<p>朋友们，你们好！</p>
<p>近来，我听到了大量的关于新出的 .NET Core 和其性能的讨论，尤其在 Web 服务方面的讨论更甚。</p>
<p>因为是新出的，我不想立马就比较两个不同的东西，所以我耐心等待，想等发布更稳定的版本后再进行。</p>
<p>本周一（8 月 14 日），微软<a href="https://blogs.msdn.microsoft.com/dotnet/2017/08/14/announcing-net-core-2-0/">发布 .NET Core 2.0 版本</a>，因此，我准备开始。您们认为呢？</p>
<p>如前面所提的，我们会比较它们相同的东西，比如应用程序、预期响应及运行时的稳定性，所以我们不会把像对 JSON 或者 XML 的编码、解码这些烦多的事情加入比较游戏中来，仅仅只会使用简单的文本消息。为了公平起见，我们会分别使用 Go 和 .NET Core 的 <a href="https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller">MVC 架构模式</a>。</p>
<h3>参赛选手</h3>
<p><a href="https://golang.org/">Go</a> （或称 Golang）： 是一种<a href="http://www.tiobe.com/tiobe-index/">快速增长</a>的开源编程语言，旨在构建出简单、快捷和稳定可靠的应用软件。</p>
<p>用于支持 Go 语言的 MVC web 框架并不多，还好我们找到了 Iris ，可胜任此工作。</p>
<p><a href="http://iris-go.com/">Iris</a>： 支持 Go 语言的快速、简单和高效的微型 Web 框架。它为您的下一代网站、API 或分布式应用程序奠定了精美的表现方式和易于使用的基础。</p>
<p><a href="https://en.wikipedia.org/wiki/C_Sharp_%28programming_language%29">C#</a>： 是一种通用的、面向对象的编程语言。其开发团队由 <a href="https://twitter.com/ahejlsberg">Anders Hejlsberg</a> 领导。</p>
<p><a href="https://www.microsoft.com/net/">.NET Core</a>： 跨平台，可以在极少时间内开发出高性能的应用程序。</p>
<p>可从 <a href="https://golang.org/dl">https://golang.org/dl</a> 下载 Go ，从 <a href="https://www.microsoft.com/net/core">https://www.microsoft.com/net/core</a> 下载 .NET Core。</p>
<p>在下载和安装好这些软件后，还需要为 Go 安装 Iris。安装很简单，仅仅只需要打开终端，然后执行如下语句：</p>
<div class="highlight"><pre><span></span><code><span class="k">go</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">kataras</span><span class="o">/</span><span class="n">iris</span>
</code></pre></div>

<h3>基准</h3>
<h4>硬件</h4>
<ul>
<li>处理器： Intel(R) Core(TM) i7–4710HQ CPU @ 2.50GHz 2.50GHz</li>
<li>内存： 8.00 GB</li>
</ul>
<h4>软件</h4>
<ul>
<li>操作系统： 微软 Windows [10.0.15063 版本]， 电源计划设置为“高性能”</li>
<li>HTTP 基准工具： <a href="https://github.com/codesenberg/bombardier">https://github.com/codesenberg/bombardier</a>， 使用最新的 1.1 版本。</li>
<li>.NET Core： <a href="https://www.microsoft.com/net/core">https://www.microsoft.com/net/core</a>， 使用最新的 2.0 版本。</li>
<li>Iris： <a href="https://github.com/kataras/iris">https://github.com/kataras/iris</a>， 使用基于 <a href="https://golang.org/">Go 1.8.3</a> 构建的最新 8.3 版本。</li>
</ul>
<p>两个应用程序都通过请求路径 “api/values/{id}” 返回文本“值”。</p>
<h5>.NET Core MVC</h5>
<p><img alt="" src="/data/attachment/album/201710/06/111305kfvhsvvawf2o1sc5.png"></p>
<p>Logo 由 <a href="https://github.com/campusMVP/dotnetCoreLogoPack">Pablo Iglesias</a> 设计。</p>
<p>可以使用 <code>dotnet new webapi</code> 命令创建项目，其 <code>webapi</code> 模板会为您生成代码，代码包含 <code>GET</code> 请求方法的 <code>返回“值”</code>。</p>
<p>源代码：</p>
<div class="highlight"><pre><span></span><code>using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Threading.Tasks;
using Microsoft.AspNetCore;
using Microsoft.AspNetCore.Hosting;
using Microsoft.Extensions.Configuration;
using Microsoft.Extensions.Logging;

namespace netcore_mvc
{
    public class Program
    {
        public static void Main(string[] args)
        {
            BuildWebHost(args).Run();
        }

        public static IWebHost BuildWebHost(string[] args) =&gt;
            WebHost.CreateDefaultBuilder(args)
                .UseStartup&lt;Startup&gt;()
                .Build();
    }
}
</code></pre></div>

<div class="highlight"><pre><span></span><code>using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;
using Microsoft.AspNetCore.Builder;
using Microsoft.AspNetCore.Hosting;
using Microsoft.Extensions.Configuration;
using Microsoft.Extensions.DependencyInjection;
using Microsoft.Extensions.Logging;
using Microsoft.Extensions.Options;

namespace netcore_mvc
{
    public class Startup
    {
        public Startup(IConfiguration configuration)
        {
            Configuration = configuration;
        }

        public IConfiguration Configuration { get; }

        // This method gets called by the runtime. Use this method to add services to the container.
        public void ConfigureServices(IServiceCollection services)
        {
            services.AddMvcCore();
        }

        // This method gets called by the runtime. Use this method to configure the HTTP request pipeline.
        public void Configure(IApplicationBuilder app, IHostingEnvironment env)
        {
            app.UseMvc();
        }
    }
}
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="k">using</span><span class="w"> </span><span class="k">System</span><span class="p">;</span>
<span class="k">using</span><span class="w"> </span><span class="k">System</span><span class="p">.</span><span class="n">Collections</span><span class="p">.</span><span class="n">Generic</span><span class="p">;</span>
<span class="k">using</span><span class="w"> </span><span class="k">System</span><span class="p">.</span><span class="n">Linq</span><span class="p">;</span>
<span class="k">using</span><span class="w"> </span><span class="k">System</span><span class="p">.</span><span class="n">Threading</span><span class="p">.</span><span class="n">Tasks</span><span class="p">;</span>
<span class="k">using</span><span class="w"> </span><span class="n">Microsoft</span><span class="p">.</span><span class="n">AspNetCore</span><span class="p">.</span><span class="n">Mvc</span><span class="p">;</span>

<span class="n">namespace</span><span class="w"> </span><span class="n">netcore_mvc</span><span class="p">.</span><span class="n">Controllers</span>
<span class="err">{</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="n">ValuesController</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">equivalent</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="err">`</span><span class="n">ValuesController</span><span class="err">`</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Iris</span><span class="w"> </span><span class="mf">8.3</span><span class="w"> </span><span class="n">mvc</span><span class="w"> </span><span class="n">application</span><span class="p">.</span>
<span class="w">    </span><span class="o">[</span><span class="n">Route(&quot;api/[controller</span><span class="o">]</span><span class="ss">&quot;)]</span>
<span class="ss">    public class ValuesController : Controller</span>
<span class="ss">    {</span>
<span class="ss">        // Get handles &quot;</span><span class="k">GET</span><span class="ss">&quot; requests to &quot;</span><span class="n">api</span><span class="o">/</span><span class="k">values</span><span class="o">/</span><span class="err">{</span><span class="n">id</span><span class="err">}</span><span class="ss">&quot;.</span>
<span class="ss">        [HttpGet(&quot;</span><span class="err">{</span><span class="n">id</span><span class="err">}</span><span class="ss">&quot;)]</span>
<span class="ss">        public string Get(int id)</span>
<span class="ss">        {</span>
<span class="ss">            return &quot;</span><span class="k">value</span><span class="ss">&quot;;</span>
<span class="ss">        }</span>

<span class="ss">        // Put handles &quot;</span><span class="n">PUT</span><span class="ss">&quot; requests to &quot;</span><span class="n">api</span><span class="o">/</span><span class="k">values</span><span class="o">/</span><span class="err">{</span><span class="n">id</span><span class="err">}</span><span class="ss">&quot;.</span>
<span class="ss">        [HttpPut(&quot;</span><span class="err">{</span><span class="n">id</span><span class="err">}</span><span class="ss">&quot;)]</span>
<span class="ss">        public void Put(int id, [FromBody]string value)</span>
<span class="ss">        {</span>
<span class="ss">        }</span>

<span class="ss">        // Delete handles &quot;</span><span class="k">DELETE</span><span class="ss">&quot; requests to &quot;</span><span class="n">api</span><span class="o">/</span><span class="k">values</span><span class="o">/</span><span class="err">{</span><span class="n">id</span><span class="err">}</span><span class="ss">&quot;.</span>
<span class="ss">        [HttpDelete(&quot;</span><span class="err">{</span><span class="n">id</span><span class="err">}&quot;</span><span class="p">)</span><span class="err">]</span>
<span class="w">        </span><span class="k">public</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="k">Delete</span><span class="p">(</span><span class="nc">int</span><span class="w"> </span><span class="n">id</span><span class="p">)</span>
<span class="w">        </span><span class="err">{</span>
<span class="w">        </span><span class="err">}</span>
<span class="w">    </span><span class="err">}</span>
<span class="err">}</span>
</code></pre></div>

<p>运行 .NET Core web 服务项目：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>netcore-mvc
$<span class="w"> </span>dotnet<span class="w"> </span>run<span class="w"> </span>-c<span class="w"> </span>Release
Hosting<span class="w"> </span>environment:<span class="w"> </span>Production
Content<span class="w"> </span>root<span class="w"> </span>path:<span class="w"> </span>C:<span class="se">\m</span>ygopath<span class="se">\s</span>rc<span class="se">\g</span>ithub.com<span class="se">\k</span>ataras<span class="se">\i</span>ris<span class="se">\_</span>benchmarks<span class="se">\n</span>etcore-mvc
Now<span class="w"> </span>listening<span class="w"> </span>on:<span class="w"> </span>http://localhost:5000
Application<span class="w"> </span>started.<span class="w"> </span>Press<span class="w"> </span>Ctrl+C<span class="w"> </span>to<span class="w"> </span>shut<span class="w"> </span>down.
</code></pre></div>

<p>运行和定位 HTTP 基准工具：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>bombardier<span class="w"> </span>-c<span class="w"> </span><span class="m">125</span><span class="w"> </span>-n<span class="w"> </span><span class="m">5000000</span><span class="w"> </span>http://localhost:5000/api/values/5
Bombarding<span class="w"> </span>http://localhost:5000/api/values/5<span class="w"> </span>with<span class="w"> </span><span class="m">5000000</span><span class="w"> </span>requests<span class="w"> </span>using<span class="w"> </span><span class="m">125</span><span class="w"> </span>connections
<span class="w"> </span><span class="m">5000000</span><span class="w"> </span>/<span class="w"> </span><span class="m">5000000</span><span class="w"> </span><span class="o">[=====================================================]</span><span class="w"> </span><span class="m">100</span>.00%<span class="w"> </span>2m3s
Done!
Statistics<span class="w">        </span>Avg<span class="w">      </span>Stdev<span class="w">        </span>Max
<span class="w">  </span>Reqs/sec<span class="w">     </span><span class="m">40226</span>.03<span class="w">    </span><span class="m">8724</span>.30<span class="w">     </span><span class="m">161919</span>
<span class="w">  </span>Latency<span class="w">        </span><span class="m">3</span>.09ms<span class="w">     </span><span class="m">1</span>.40ms<span class="w">   </span><span class="m">169</span>.12ms
<span class="w">  </span>HTTP<span class="w"> </span>codes:
<span class="w">    </span>1xx<span class="w"> </span>-<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>2xx<span class="w"> </span>-<span class="w"> </span><span class="m">5000000</span>,<span class="w"> </span>3xx<span class="w"> </span>-<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>4xx<span class="w"> </span>-<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>5xx<span class="w"> </span>-<span class="w"> </span><span class="m">0</span>
<span class="w">    </span>others<span class="w"> </span>-<span class="w"> </span><span class="m">0</span>
<span class="w">  </span>Throughput:<span class="w">     </span><span class="m">8</span>.91MB/s
</code></pre></div>

<h5>Iris MVC</h5>
<p><img alt="" src="/data/attachment/album/201710/06/111305gx85k8pcgchtz8gc.png"></p>
<p>Logo 由 <a href="https://github.com/santoshanand">Santosh Anand</a> 设计。</p>
<p>源代码：</p>
<div class="highlight"><pre><span></span><code><span class="n">package</span> <span class="n">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s2">&quot;github.com/kataras/iris&quot;</span>
    <span class="s2">&quot;github.com/kataras/iris/_benchmarks/iris-mvc/controllers&quot;</span>
<span class="p">)</span>

<span class="n">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">app</span> <span class="o">:=</span> <span class="n">iris</span><span class="o">.</span><span class="n">New</span><span class="p">()</span>
    <span class="n">app</span><span class="o">.</span><span class="n">Controller</span><span class="p">(</span><span class="s2">&quot;/api/values/</span><span class="si">{id}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">new</span><span class="p">(</span><span class="n">controllers</span><span class="o">.</span><span class="n">ValuesController</span><span class="p">))</span>
    <span class="n">app</span><span class="o">.</span><span class="n">Run</span><span class="p">(</span><span class="n">iris</span><span class="o">.</span><span class="n">Addr</span><span class="p">(</span><span class="s2">&quot;:5000&quot;</span><span class="p">),</span> <span class="n">iris</span><span class="o">.</span><span class="n">WithoutVersionChecker</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">package</span> <span class="n">controllers</span>

<span class="kn">import</span> <span class="s2">&quot;github.com/kataras/iris/mvc&quot;</span>

<span class="o">//</span> <span class="n">ValuesController</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">equivalent</span>
<span class="o">//</span> <span class="err">`</span><span class="n">ValuesController</span><span class="err">`</span> <span class="n">of</span> <span class="n">the</span> <span class="o">.</span><span class="n">net</span> <span class="n">core</span> <span class="mf">2.0</span> <span class="n">mvc</span> <span class="n">application</span><span class="o">.</span>
<span class="nb">type</span> <span class="n">ValuesController</span> <span class="n">struct</span> <span class="p">{</span>
    <span class="n">mvc</span><span class="o">.</span><span class="n">Controller</span>
<span class="p">}</span>

<span class="o">//</span> <span class="n">Get</span> <span class="n">handles</span> <span class="s2">&quot;GET&quot;</span> <span class="n">requests</span> <span class="n">to</span> <span class="s2">&quot;api/values/</span><span class="si">{id}</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="n">func</span> <span class="p">(</span><span class="n">vc</span> <span class="o">*</span><span class="n">ValuesController</span><span class="p">)</span> <span class="n">Get</span><span class="p">()</span> <span class="p">{</span>
    <span class="o">//</span> <span class="nb">id</span><span class="p">,</span><span class="n">_</span> <span class="o">:=</span> <span class="n">vc</span><span class="o">.</span><span class="n">Params</span><span class="o">.</span><span class="n">GetInt</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>
    <span class="n">vc</span><span class="o">.</span><span class="n">Ctx</span><span class="o">.</span><span class="n">WriteString</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="o">//</span> <span class="n">Put</span> <span class="n">handles</span> <span class="s2">&quot;PUT&quot;</span> <span class="n">requests</span> <span class="n">to</span> <span class="s2">&quot;api/values/</span><span class="si">{id}</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="n">func</span> <span class="p">(</span><span class="n">vc</span> <span class="o">*</span><span class="n">ValuesController</span><span class="p">)</span> <span class="n">Put</span><span class="p">()</span> <span class="p">{}</span>

<span class="o">//</span> <span class="n">Delete</span> <span class="n">handles</span> <span class="s2">&quot;DELETE&quot;</span> <span class="n">requests</span> <span class="n">to</span> <span class="s2">&quot;api/values/</span><span class="si">{id}</span><span class="s2">&quot;</span><span class="o">.</span>
<span class="n">func</span> <span class="p">(</span><span class="n">vc</span> <span class="o">*</span><span class="n">ValuesController</span><span class="p">)</span> <span class="n">Delete</span><span class="p">()</span> <span class="p">{}</span>
</code></pre></div>

<p>运行 Go web 服务项目：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>iris-mvc
$<span class="w"> </span>go<span class="w"> </span>run<span class="w"> </span>main.go
Now<span class="w"> </span>listening<span class="w"> </span>on:<span class="w"> </span>http://localhost:5000
Application<span class="w"> </span>started.<span class="w"> </span>Press<span class="w"> </span>CTRL+C<span class="w"> </span>to<span class="w"> </span>shut<span class="w"> </span>down.
</code></pre></div>

<p>运行和定位 HTTP 基准工具：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>bombardier<span class="w"> </span>-c<span class="w"> </span><span class="m">125</span><span class="w"> </span>-n<span class="w"> </span><span class="m">5000000</span><span class="w"> </span>http://localhost:5000/api/values/5
Bombarding<span class="w"> </span>http://localhost:5000/api/values/5<span class="w"> </span>with<span class="w"> </span><span class="m">5000000</span><span class="w"> </span>requests<span class="w"> </span>using<span class="w"> </span><span class="m">125</span><span class="w"> </span>connections
<span class="w"> </span><span class="m">5000000</span><span class="w"> </span>/<span class="w"> </span><span class="m">5000000</span><span class="w"> </span><span class="o">[======================================================]</span><span class="w"> </span><span class="m">100</span>.00%<span class="w"> </span>47s
Done!
Statistics<span class="w">        </span>Avg<span class="w">      </span>Stdev<span class="w">        </span>Max
<span class="w">  </span>Reqs/sec<span class="w">    </span><span class="m">105643</span>.81<span class="w">    </span><span class="m">7687</span>.79<span class="w">     </span><span class="m">122564</span>
<span class="w">  </span>Latency<span class="w">        </span><span class="m">1</span>.18ms<span class="w">   </span><span class="m">366</span>.55us<span class="w">    </span><span class="m">22</span>.01ms
<span class="w">  </span>HTTP<span class="w"> </span>codes:
<span class="w">    </span>1xx<span class="w"> </span>-<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>2xx<span class="w"> </span>-<span class="w"> </span><span class="m">5000000</span>,<span class="w"> </span>3xx<span class="w"> </span>-<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>4xx<span class="w"> </span>-<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>5xx<span class="w"> </span>-<span class="w"> </span><span class="m">0</span>
<span class="w">    </span>others<span class="w"> </span>-<span class="w"> </span><span class="m">0</span>
<span class="w">  </span>Throughput:<span class="w">    </span><span class="m">19</span>.65MB/s
</code></pre></div>

<p>想通过图片来理解的人，我也把我的屏幕截屏出来了！</p>
<p>请点击<a href="https://github.com/kataras/iris/tree/master/_benchmarks/screens">这儿</a>可以看到这些屏幕快照。</p>
<h4>总结</h4>
<ul>
<li>完成 <code>5000000 个请求</code>的时间 - 越短越好。</li>
<li>请求次数/每秒 - 越大越好。</li>
<li>等待时间 — 越短越好。</li>
<li>吞吐量 — 越大越好。</li>
<li>内存使用 — 越小越好。</li>
<li>LOC (代码行数) — 越少越好。</li>
</ul>
<p>.NET Core MVC 应用程序，使用 86 行代码，运行 2 分钟 8 秒，每秒接纳 39311.56 个请求，平均 3.19ms 等待，最大时到 229.73ms，内存使用大约为 126MB（不包括 dotnet 框架）。</p>
<p>Iris MVC 应用程序，使用 27 行代码，运行 47 秒，每秒接纳 105643.71 个请求，平均 1.18ms 等待，最大时到 22.01ms，内存使用大约为 12MB。</p>
<blockquote>
<p>还有另外一个模板的基准，滚动到底部。</p>
</blockquote>
<p><strong>2017 年 8 月 20 号更新</strong></p>
<p><a href="https://twitter.com/clarkis117">Josh Clark</a> 和 <a href="https://twitter.com/shanselman">Scott Hanselman</a>在此 <a href="https://twitter.com/shanselman/status/899005786826788865">tweet 评论</a>上指出，.NET Core <code>Startup.cs</code> 文件中 <code>services.AddMvc();</code> 这行可以替换为 <code>services.AddMvcCore();</code>。我听从他们的意见，修改代码，重新运行基准，该文章的 .NET Core 应用程序的基准输出已经修改。</p>
<p>@topdawgevh @shanselman 他们也在使用 <code>AddMvc()</code> 而不是 <code>AddMvcCore()</code> ...，难道都不包含中间件？</p>
<p>—  @clarkis117</p>
<p>@clarkis117 @topdawgevh Cool @MakisMaropoulos @ben<em>a</em>adams @davidfowl 我们来看看。认真学习下怎么使用更简单的性能默认值。</p>
<p>—  @shanselman</p>
<p>@shanselman @clarkis117 @topdawgevh @ben<em>a</em>adams @davidfowl @shanselman @ben<em>a</em>adams @davidfowl 谢谢您们的反馈意见。我已经修改，更新了结果，没什么不同。对其它的建议，我非常欢迎。</p>
<p>—  @MakisMaropoulos</p>
<blockquote>
<p>它有点稍微的不同但相差不大（从 8.61MB/s 到 8.91MB/s）</p>
</blockquote>
<p>想要了解跟 <code>services.AddMvc()</code> 标准比较结果的，可以点击<a href="https://github.com/kataras/iris/blob/master/_benchmarks/screens/5m_requests_netcore-mvc.png">这儿</a>。</p>
<h3>想再多了解点儿吗?</h3>
<p>我们再制定一个基准，产生 <code>1000000 次请求</code>，这次会通过视图引擎由模板生成 <code>HTML</code> 页面。</p>
<h4>.NET Core MVC 使用的模板</h4>
<div class="highlight"><pre><span></span><code>using System;

namespace netcore_mvc_templates.Models
{
    public class ErrorViewModel
    {
        public string Title { get; set; }
        public int Code { get; set; }
    }
}
</code></pre></div>

<div class="highlight"><pre><span></span><code> using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
using System.Threading.Tasks;
using Microsoft.AspNetCore.Mvc;
using netcore_mvc_templates.Models;

namespace netcore_mvc_templates.Controllers
{
    public class HomeController : Controller
    {
        public IActionResult Index()
        {
            return View();
        }

        public IActionResult About()
        {
            ViewData[&quot;Message&quot;] = &quot;Your application description page.&quot;;

            return View();
        }

        public IActionResult Contact()
        {
            ViewData[&quot;Message&quot;] = &quot;Your contact page.&quot;;

            return View();
        }

        public IActionResult Error()
        {
            return View(new ErrorViewModel { Title = &quot;Error&quot;, Code = 500});
        }
    }
}
</code></pre></div>

<div class="highlight"><pre><span></span><code>using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Threading.Tasks;
using Microsoft.AspNetCore;
using Microsoft.AspNetCore.Hosting;
using Microsoft.Extensions.Configuration;
using Microsoft.Extensions.Logging;

namespace netcore_mvc_templates
{
    public class Program
    {
        public static void Main(string[] args)
        {
            BuildWebHost(args).Run();
        }

        public static IWebHost BuildWebHost(string[] args) =&gt;
            WebHost.CreateDefaultBuilder(args)
                .UseStartup&lt;Startup&gt;()
                .Build();
    }
}
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="nx">using</span><span class="w"> </span><span class="nx">System</span><span class="p">;</span>
<span class="nx">using</span><span class="w"> </span><span class="nx">System</span><span class="p">.</span><span class="nx">Collections</span><span class="p">.</span><span class="nx">Generic</span><span class="p">;</span>
<span class="nx">using</span><span class="w"> </span><span class="nx">System</span><span class="p">.</span><span class="nx">Linq</span><span class="p">;</span>
<span class="nx">using</span><span class="w"> </span><span class="nx">System</span><span class="p">.</span><span class="nx">Threading</span><span class="p">.</span><span class="nx">Tasks</span><span class="p">;</span>
<span class="nx">using</span><span class="w"> </span><span class="nx">Microsoft</span><span class="p">.</span><span class="nx">AspNetCore</span><span class="p">.</span><span class="nx">Builder</span><span class="p">;</span>
<span class="nx">using</span><span class="w"> </span><span class="nx">Microsoft</span><span class="p">.</span><span class="nx">AspNetCore</span><span class="p">.</span><span class="nx">Hosting</span><span class="p">;</span>
<span class="nx">using</span><span class="w"> </span><span class="nx">Microsoft</span><span class="p">.</span><span class="nx">Extensions</span><span class="p">.</span><span class="nx">Configuration</span><span class="p">;</span>
<span class="nx">using</span><span class="w"> </span><span class="nx">Microsoft</span><span class="p">.</span><span class="nx">Extensions</span><span class="p">.</span><span class="nx">DependencyInjection</span><span class="p">;</span>

<span class="kn">namespace</span><span class="w"> </span><span class="nx">netcore_mvc_templates</span>
<span class="p">{</span>
<span class="w">    </span><span class="nx">public</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nx">Startup</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nx">public</span><span class="w"> </span><span class="nx">Startup</span><span class="p">(</span><span class="nx">IConfiguration</span><span class="w"> </span><span class="nx">configuration</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nx">Configuration</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">configuration</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nx">public</span><span class="w"> </span><span class="nx">IConfiguration</span><span class="w"> </span><span class="nx">Configuration</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">get</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>

<span class="w">        </span><span class="c1">// This method gets called by the runtime. Use this method to add services to the container.</span>
<span class="w">        </span><span class="nx">public</span><span class="w"> </span><span class="nx">void</span><span class="w"> </span><span class="nx">ConfigureServices</span><span class="p">(</span><span class="nx">IServiceCollection</span><span class="w"> </span><span class="nx">services</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="cm">/*  An unhandled exception was thrown by the application.</span>
<span class="cm">                System.InvalidOperationException: No service for type</span>
<span class="cm">                &#39;Microsoft.AspNetCore.Mvc.ViewFeatures.ITempDataDictionaryFactory&#39; has been registered.</span>
<span class="cm">                Solution: Use AddMvc() instead of AddMvcCore() in Startup.cs and it will work.</span>
<span class="cm">            */</span>
<span class="w">            </span><span class="c1">// services.AddMvcCore();</span>
<span class="w">            </span><span class="nx">services</span><span class="p">.</span><span class="nx">AddMvc</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="c1">// This method gets called by the runtime. Use this method to configure the HTTP request pipeline.</span>
<span class="w">        </span><span class="nx">public</span><span class="w"> </span><span class="nx">void</span><span class="w"> </span><span class="nx">Configure</span><span class="p">(</span><span class="nx">IApplicationBuilder</span><span class="w"> </span><span class="nx">app</span><span class="p">,</span><span class="w"> </span><span class="nx">IHostingEnvironment</span><span class="w"> </span><span class="nx">env</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nx">app</span><span class="p">.</span><span class="nx">UseStaticFiles</span><span class="p">();</span>

<span class="w">            </span><span class="nx">app</span><span class="p">.</span><span class="nx">UseMvc</span><span class="p">(</span><span class="nx">routes</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">                </span><span class="nx">routes</span><span class="p">.</span><span class="nx">MapRoute</span><span class="p">(</span>
<span class="w">                    </span><span class="nx">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;default&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">template</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{controller=Home}/{action=Index}/{id?}&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="p">});</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">/*</span>
<span class="n">wwwroot</span><span class="o">/</span><span class="n">css</span>
<span class="n">wwwroot</span><span class="o">/</span><span class="n">images</span>
<span class="n">wwwroot</span><span class="o">/</span><span class="n">js</span>
<span class="n">wwwroot</span><span class="o">/</span><span class="nb">lib</span>
<span class="n">wwwroot</span><span class="o">/</span><span class="n">favicon</span><span class="p">.</span><span class="n">ico</span>


<span class="n">Views</span><span class="o">/</span><span class="n">Shared</span><span class="o">/</span><span class="n">_Layout</span><span class="p">.</span><span class="n">cshtml</span>
<span class="n">Views</span><span class="o">/</span><span class="n">Shared</span><span class="o">/</span><span class="n">Error</span><span class="p">.</span><span class="n">cshtml</span>

<span class="n">Views</span><span class="o">/</span><span class="n">Home</span><span class="o">/</span><span class="n">About</span><span class="p">.</span><span class="n">cshtml</span>
<span class="n">Views</span><span class="o">/</span><span class="n">Home</span><span class="o">/</span><span class="n">Contact</span><span class="p">.</span><span class="n">cshtml</span>
<span class="n">Views</span><span class="o">/</span><span class="n">Home</span><span class="o">/</span><span class="n">Index</span><span class="p">.</span><span class="n">cshtml</span>

<span class="n">These</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">quite</span><span class="w"> </span><span class="n">long</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">shown</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">article</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">view</span><span class="w"> </span><span class="n">them</span><span class="w"> </span><span class="n">at</span><span class="p">:</span><span class="w"> </span>
<span class="n">https</span><span class="p">:</span><span class="c1">//github.com/kataras/iris/tree/master/_benchmarks/netcore-mvc-templates</span>
</code></pre></div>

<p>运行 .NET Core 服务项目：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>netcore-mvc-templates
$<span class="w"> </span>dotnet<span class="w"> </span>run<span class="w"> </span>-c<span class="w"> </span>Release
Hosting<span class="w"> </span>environment:<span class="w"> </span>Production
Content<span class="w"> </span>root<span class="w"> </span>path:<span class="w"> </span>C:<span class="se">\m</span>ygopath<span class="se">\s</span>rc<span class="se">\g</span>ithub.com<span class="se">\k</span>ataras<span class="se">\i</span>ris<span class="se">\_</span>benchmarks<span class="se">\n</span>etcore-mvc-templates
Now<span class="w"> </span>listening<span class="w"> </span>on:<span class="w"> </span>http://localhost:5000
Application<span class="w"> </span>started.<span class="w"> </span>Press<span class="w"> </span>Ctrl+C<span class="w"> </span>to<span class="w"> </span>shut<span class="w"> </span>down.
</code></pre></div>

<p>运行 HTTP 基准工具：</p>
<div class="highlight"><pre><span></span><code>Bombarding http://localhost:5000 with 1000000 requests using 125 connections
 1000000 / 1000000 [====================================================] 100.00% 1m20s
Done!
Statistics Avg Stdev Max
 Reqs/sec 11738.60 7741.36 125887
 Latency 10.10ms 22.10ms 1.97s
 HTTP codes:
 1xx — 0, 2xx — 1000000, 3xx — 0, 4xx — 0, 5xx — 0
 others — 0
 Throughput: 89.03MB/s
</code></pre></div>

<h4>Iris MVC 使用的模板</h4>
<div class="highlight"><pre><span></span><code><span class="n">package</span> <span class="n">controllers</span>

<span class="kn">import</span> <span class="s2">&quot;github.com/kataras/iris/mvc&quot;</span>

<span class="nb">type</span> <span class="n">AboutController</span> <span class="n">struct</span><span class="p">{</span> <span class="n">mvc</span><span class="o">.</span><span class="n">Controller</span> <span class="p">}</span>

<span class="n">func</span> <span class="p">(</span><span class="n">c</span> <span class="o">*</span><span class="n">AboutController</span><span class="p">)</span> <span class="n">Get</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">c</span><span class="o">.</span><span class="n">Data</span><span class="p">[</span><span class="s2">&quot;Title&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;About&quot;</span>
    <span class="n">c</span><span class="o">.</span><span class="n">Data</span><span class="p">[</span><span class="s2">&quot;Message&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Your application description page.&quot;</span>
    <span class="n">c</span><span class="o">.</span><span class="n">Tmpl</span> <span class="o">=</span> <span class="s2">&quot;about.html&quot;</span>
<span class="p">}</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">package</span> <span class="n">controllers</span>

<span class="kn">import</span> <span class="s2">&quot;github.com/kataras/iris/mvc&quot;</span>

<span class="nb">type</span> <span class="n">ContactController</span> <span class="n">struct</span><span class="p">{</span> <span class="n">mvc</span><span class="o">.</span><span class="n">Controller</span> <span class="p">}</span>

<span class="n">func</span> <span class="p">(</span><span class="n">c</span> <span class="o">*</span><span class="n">ContactController</span><span class="p">)</span> <span class="n">Get</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">c</span><span class="o">.</span><span class="n">Data</span><span class="p">[</span><span class="s2">&quot;Title&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Contact&quot;</span>
    <span class="n">c</span><span class="o">.</span><span class="n">Data</span><span class="p">[</span><span class="s2">&quot;Message&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Your contact page.&quot;</span>
    <span class="n">c</span><span class="o">.</span><span class="n">Tmpl</span> <span class="o">=</span> <span class="s2">&quot;contact.html&quot;</span>
<span class="p">}</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nx">models</span>

<span class="c1">// HTTPError a silly structure to keep our error page data.</span>
<span class="k">type</span><span class="w"> </span><span class="nx">HTTPError</span><span class="w"> </span><span class="nx">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">Title</span><span class="w"> </span><span class="kt">string</span>
<span class="w">    </span><span class="nx">Code</span><span class="w">  </span><span class="nx">int</span>
<span class="p">}</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">package</span> <span class="n">controllers</span>

<span class="kn">import</span> <span class="s2">&quot;github.com/kataras/iris/mvc&quot;</span>

<span class="nb">type</span> <span class="n">IndexController</span> <span class="n">struct</span><span class="p">{</span> <span class="n">mvc</span><span class="o">.</span><span class="n">Controller</span> <span class="p">}</span>

<span class="n">func</span> <span class="p">(</span><span class="n">c</span> <span class="o">*</span><span class="n">IndexController</span><span class="p">)</span> <span class="n">Get</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">c</span><span class="o">.</span><span class="n">Data</span><span class="p">[</span><span class="s2">&quot;Title&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Home Page&quot;</span>
    <span class="n">c</span><span class="o">.</span><span class="n">Tmpl</span> <span class="o">=</span> <span class="s2">&quot;index.html&quot;</span>
<span class="p">}</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">package</span> <span class="n">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s2">&quot;github.com/kataras/iris/_benchmarks/iris-mvc-templates/controllers&quot;</span>

    <span class="s2">&quot;github.com/kataras/iris&quot;</span>
    <span class="s2">&quot;github.com/kataras/iris/context&quot;</span>
<span class="p">)</span>

<span class="n">const</span> <span class="p">(</span>
    <span class="o">//</span> <span class="n">templatesDir</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">exactly</span> <span class="n">the</span> <span class="n">same</span> <span class="n">path</span> <span class="n">that</span> <span class="o">.</span><span class="n">NET</span> <span class="n">Core</span> <span class="ow">is</span> <span class="n">using</span> <span class="k">for</span> <span class="n">its</span> <span class="n">templates</span><span class="p">,</span>
    <span class="o">//</span> <span class="ow">in</span> <span class="n">order</span> <span class="n">to</span> <span class="n">reduce</span> <span class="n">the</span> <span class="n">size</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">repository</span><span class="o">.</span>
    <span class="o">//</span> <span class="n">Change</span> <span class="n">the</span> <span class="s2">&quot;C</span><span class="se">\\</span><span class="s2">mygopath&quot;</span> <span class="n">to</span> <span class="n">your</span> <span class="n">own</span> <span class="n">GOPATH</span><span class="o">.</span>
    <span class="n">templatesDir</span> <span class="o">=</span> <span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">mygopath</span><span class="se">\\</span><span class="s2">src</span><span class="se">\\</span><span class="s2">github.com</span><span class="se">\\</span><span class="s2">kataras</span><span class="se">\\</span><span class="s2">iris</span><span class="se">\\</span><span class="s2">_benchmarks</span><span class="se">\\</span><span class="s2">netcore-mvc-templates</span><span class="se">\\</span><span class="s2">wwwroot&quot;</span>
<span class="p">)</span>

<span class="n">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">app</span> <span class="o">:=</span> <span class="n">iris</span><span class="o">.</span><span class="n">New</span><span class="p">()</span>
    <span class="n">app</span><span class="o">.</span><span class="n">Configure</span><span class="p">(</span><span class="n">configure</span><span class="p">)</span>

    <span class="n">app</span><span class="o">.</span><span class="n">Controller</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="n">new</span><span class="p">(</span><span class="n">controllers</span><span class="o">.</span><span class="n">IndexController</span><span class="p">))</span>
    <span class="n">app</span><span class="o">.</span><span class="n">Controller</span><span class="p">(</span><span class="s2">&quot;/about&quot;</span><span class="p">,</span> <span class="n">new</span><span class="p">(</span><span class="n">controllers</span><span class="o">.</span><span class="n">AboutController</span><span class="p">))</span>
    <span class="n">app</span><span class="o">.</span><span class="n">Controller</span><span class="p">(</span><span class="s2">&quot;/contact&quot;</span><span class="p">,</span> <span class="n">new</span><span class="p">(</span><span class="n">controllers</span><span class="o">.</span><span class="n">ContactController</span><span class="p">))</span>

    <span class="n">app</span><span class="o">.</span><span class="n">Run</span><span class="p">(</span><span class="n">iris</span><span class="o">.</span><span class="n">Addr</span><span class="p">(</span><span class="s2">&quot;:5000&quot;</span><span class="p">),</span> <span class="n">iris</span><span class="o">.</span><span class="n">WithoutVersionChecker</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">func</span> <span class="n">configure</span><span class="p">(</span><span class="n">app</span> <span class="o">*</span><span class="n">iris</span><span class="o">.</span><span class="n">Application</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">app</span><span class="o">.</span><span class="n">RegisterView</span><span class="p">(</span><span class="n">iris</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="s2">&quot;./views&quot;</span><span class="p">,</span> <span class="s2">&quot;.html&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="s2">&quot;shared/layout.html&quot;</span><span class="p">))</span>
    <span class="n">app</span><span class="o">.</span><span class="n">StaticWeb</span><span class="p">(</span><span class="s2">&quot;/public&quot;</span><span class="p">,</span> <span class="n">templatesDir</span><span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">OnAnyErrorCode</span><span class="p">(</span><span class="n">onError</span><span class="p">)</span>
<span class="p">}</span>

<span class="nb">type</span> <span class="n">err</span> <span class="n">struct</span> <span class="p">{</span>
    <span class="n">Title</span> <span class="n">string</span>
    <span class="n">Code</span>  <span class="nb">int</span>
<span class="p">}</span>

<span class="n">func</span> <span class="n">onError</span><span class="p">(</span><span class="n">ctx</span> <span class="n">context</span><span class="o">.</span><span class="n">Context</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">ctx</span><span class="o">.</span><span class="n">ViewData</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">err</span><span class="p">{</span><span class="s2">&quot;Error&quot;</span><span class="p">,</span> <span class="n">ctx</span><span class="o">.</span><span class="n">GetStatusCode</span><span class="p">()})</span>
    <span class="n">ctx</span><span class="o">.</span><span class="n">View</span><span class="p">(</span><span class="s2">&quot;shared/error.html&quot;</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">/*</span>
<span class="p">..</span><span class="o">/</span><span class="n">netcore</span><span class="o">-</span><span class="n">mvc</span><span class="o">-</span><span class="n">templates</span><span class="o">/</span><span class="n">wwwroot</span><span class="o">/</span><span class="n">css</span>
<span class="p">..</span><span class="o">/</span><span class="n">netcore</span><span class="o">-</span><span class="n">mvc</span><span class="o">-</span><span class="n">templates</span><span class="o">/</span><span class="n">wwwroot</span><span class="o">/</span><span class="n">images</span>
<span class="p">..</span><span class="o">/</span><span class="n">netcore</span><span class="o">-</span><span class="n">mvc</span><span class="o">-</span><span class="n">templates</span><span class="o">/</span><span class="n">wwwroot</span><span class="o">/</span><span class="n">js</span>
<span class="p">..</span><span class="o">/</span><span class="n">netcore</span><span class="o">-</span><span class="n">mvc</span><span class="o">-</span><span class="n">templates</span><span class="o">/</span><span class="n">wwwroot</span><span class="o">/</span><span class="nb">lib</span>
<span class="p">..</span><span class="o">/</span><span class="n">netcore</span><span class="o">-</span><span class="n">mvc</span><span class="o">-</span><span class="n">templates</span><span class="o">/</span><span class="n">wwwroot</span><span class="o">/</span><span class="n">favicon</span><span class="p">.</span><span class="n">ico</span>
<span class="n">views</span><span class="o">/</span><span class="n">shared</span><span class="o">/</span><span class="n">layout</span><span class="p">.</span><span class="n">html</span>
<span class="n">views</span><span class="o">/</span><span class="n">shared</span><span class="o">/</span><span class="nb">error</span><span class="p">.</span><span class="n">html</span>
<span class="n">views</span><span class="o">/</span><span class="nb">about</span><span class="p">.</span><span class="n">html</span>
<span class="n">views</span><span class="o">/</span><span class="n">contact</span><span class="p">.</span><span class="n">html</span>
<span class="n">views</span><span class="o">/</span><span class="n">index</span><span class="p">.</span><span class="n">html</span>
<span class="n">These</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">quite</span><span class="w"> </span><span class="n">long</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">shown</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">article</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">view</span><span class="w"> </span><span class="n">them</span><span class="w"> </span><span class="n">at</span><span class="p">:</span><span class="w"> </span>
<span class="n">https</span><span class="p">:</span><span class="c1">//github.com/kataras/iris/tree/master/_benchmarks/iris-mvc-templates</span>
<span class="o">*/</span>
</code></pre></div>

<p>运行 Go 服务项目：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>iris-mvc-templates
$<span class="w"> </span>go<span class="w"> </span>run<span class="w"> </span>main.go
Now<span class="w"> </span>listening<span class="w"> </span>on:<span class="w"> </span>http://localhost:5000
Application<span class="w"> </span>started.<span class="w"> </span>Press<span class="w"> </span>CTRL+C<span class="w"> </span>to<span class="w"> </span>shut<span class="w"> </span>down.
</code></pre></div>

<p>运行 HTTP 基准工具：</p>
<div class="highlight"><pre><span></span><code>Bombarding http://localhost:5000 with 1000000 requests using 125 connections
 1000000 / 1000000 [======================================================] 100.00% 37s
Done!
Statistics Avg Stdev Max
 Reqs/sec 26656.76 1944.73 31188
 Latency 4.69ms 1.20ms 22.52ms
 HTTP codes:
 1xx — 0, 2xx — 1000000, 3xx — 0, 4xx — 0, 5xx — 0
 others — 0
 Throughput: 192.51MB/s
</code></pre></div>

<h4>总结</h4>
<ul>
<li>完成 <code>1000000 个请求</code>的时间 - 越短越好。</li>
<li>请求次数/每秒 - 越大越好。</li>
<li>等待时间 — 越短越好。</li>
<li>内存使用 — 越小越好。</li>
<li>吞吐量 — 越大越好。</li>
</ul>
<p>.NET Core MVC 模板应用程序，运行 1 分钟 20 秒，每秒接纳 11738.60 个请求，同时每秒生成 89.03M 页面，平均 10.10ms 等待，最大时到 1.97s，内存使用大约为 193MB（不包括 dotnet 框架）。</p>
<p>Iris MVC 模板应用程序，运行 37 秒，每秒接纳 26656.76 个请求，同时每秒生成 192.51M 页面，平均 1.18ms 等待，最大时到 22.52ms，内存使用大约为 17MB。</p>
<h3>接下来呢？</h3>
<p><a href="https://github.com/kataras/iris/tree/master/_benchmarks">这里</a>有上面所示的源代码，请下载下来，在您本地以同样的基准运行，然后把运行结果在这儿给大家分享。</p>
<p>想添加 Go 或 C# .net core WEB 服务框架到列表的朋友请向<a href="https://github.com/kataras/iris">这个仓库</a>的 <code>_benchmarks</code> 目录推送 PR。</p>
<p>我也需要亲自感谢下 <a href="https://dev.to/kataras/go-vsnet-core-in-terms-of-http-performance">dev.to</a> 团队，感谢把我的这篇文章分享到他们的 Twitter 账户。</p>
<p>感谢大家真心反馈，玩得开心！</p>
<h4>更新 : 2017 年 8 月 21 ，周一</h4>
<p>很多人联系我，希望看到一个基于 .NET Core 的较低级别 Kestrel 的基准测试文章。</p>
<p>因此我完成了，请点击下面的<a href="https://medium.com/@kataras/iris-go-vs-net-core-kestrel-in-terms-of-http-performance-806195dc93d5">链接</a>来了解 Kestrel 和 Iris 之间的性能差异，它还包含一个会话存储管理基准！</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>