<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>从 Node 到 Go：一个粗略的比较</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: John Stamatakos 在 XO 公司，我们最初使用 Node 和 Ruby 构建相互连接的服务系统。我们享受 Node 带来的明显性能优势，以及可以访问已有的 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li class="active"><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2017/10/cong-node-dao-goyi-ge-cu-lue-de-bi-jiao.html" rel="bookmark"
           title="Permalink to 从 Node 到 Go：一个粗略的比较">从 Node 到 Go：一个粗略的比较</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2017-10-01T08:46:00+02:00">
                Published: Sun 01 October 2017
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/ruan-jian-kai-fa">软件开发</a>.</p>

</footer><!-- /.post-info -->      <p>Author: John Stamatakos</p>
<p><img alt="" src="/data/attachment/album/201709/30/210213z2e6jblskrsueuzr.jpg"></p>
<p>在 XO 公司，我们最初使用 Node 和 Ruby 构建相互连接的服务系统。我们享受 Node 带来的明显性能优势，以及可以访问已有的大型软件包仓库。我们也可以轻松地在公司内部发布并复用已有的插件和模块。极大地提高了开发效率，使得我们可以快速编写出可拓展的和可靠的应用。而且，庞大的 Node 社区使我们的工程师向开源软件贡献更加容易（比如 <a href="https://medium.com/xo-tech/bunnybus-building-a-data-transit-system-b9647f6283e5#.l64fdvfys">BunnyBus</a> 和 <a href="https://medium.com/xo-tech/introducing-felicity-7b6d0b734ce#.hmloiiyx8">Felicity</a>）。</p>
<p>虽然我在大学时期和刚刚工作的一些时间在使用更严谨的编译语言，比如 C++ 和 C#，而后来我开始使用 JavaScript。我很喜欢它的自由和灵活，但是我最近开始怀念静态和结构化的语言，因为当时有一个同事让我对 Go 语言产生了兴趣。</p>
<p>我从写 JavaScript 到写 Go，我发现两种语言有很多相似之处。两者学习起来都很快并且易于上手，都具有充满表现力的语法，并且在开发者社区中都有很多工作机会。没有完美的编程语言，所以你应该总是选择一个适合手头项目的语言。在这篇文章中，我将要说明这两种语言深层次上的关键区别，希望能鼓励没有用过 Go 语言的用户~~可以~~有机会使用 Go 。</p>
<h3>大体上的差异</h3>
<p>在深入细节之前，我们应该先了解一下两种语言之间的重要区别。</p>
<p>Go，或称 Golang，是 Google 在 2007 年创建的自由开源编程语言。它以快速和简单为设计目标。Go 被直接编译成机器码，这就是它速度的来源。使用编译语言调试是相当容易的，因为你可以在早期捕获大量错误。Go 也是一种强类型的语言，它有助于数据完整，并可以在编译时查找类型错误。</p>
<p>另一方面，JavaScript 是一种弱类型语言。除了忽略验证数据的类型和真值判断陷阱所带来的额外负担之外，使用弱类型语言也有自己的好处。比起使用<ruby> 接口 <rt>  interfaces </rt></ruby>和<ruby> 范型 <rt>  generics </rt></ruby>，<ruby> 柯里化 <rt>  currying </rt></ruby>和<ruby> 可变的形参个数 <rt>  flexible arity </rt></ruby>让函数变得更加灵活。JavaScript 在运行时进行解释，这可能导致错误处理和调试的问题。Node 是一款基于 Google V8 虚拟机的 JavaScript 运行库，这使它成为一个轻量和快速的 Web 开发平台。</p>
<h3>语法</h3>
<p>作为原来的 JavaScript 开发者，Go 简单和直观的语法很吸引我。由于两种语言的语法可以说都是从 C 语言演变而来的，所以它们的语法有很多相同之处。Go 被普遍认为是一种“容易学习的语言”。那是因为它的对开发者友好的工具、精简的语法和固守惯例（LCTT 译注：惯例优先）。</p>
<p>Go 包含大量有助于简化开发的内置特性。你可以用标准 Go 构建工具把你的程序用 <code>go build</code> 命令编译成二进制可执行文件。使用内置的测试套件进行测试只需要运行 <code>go test</code> 即可。 诸如原生支持的并发等特性甚至在语言层面上提供。</p>
<p><a href="https://golang.org/doc/faq">Google 的 Go 开发者</a>认为，现在的编程太复杂了，太多的“记账一样，重复劳动和文书工作”。这就是为什么 Go 的语法被设计得如此简单和干净，以减少混乱、提高效率和增强可读性。它还鼓励开发人员编写明确的、易于理解的代码。Go 只有 <a href="https://golang.org/ref/spec#Keywords">25 个保留关键字</a>和一种循环（<code>for</code> 循环），而不像 JavaScript 有  <a href="https://www.w3schools.com/js/js_reserved.asp">大约 84 个关键字</a>（包括保留关键字字、对象、属性和方法）。</p>
<p>为了说明语法的一些差异和相似之处，我们来看几个例子：</p>
<ul>
<li>标点符号： Go 去除了所有多余的符号以提高效率和可读性。尽管 JavaScript 中需要符号的地方也不多（参见： <a href="https://en.wikipedia.org/wiki/Lisp_%28programming_language%29">Lisp</a>），而且经常是可选的，但我更加喜欢 Go 的简单。</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="n">JavaScript</span><span class="w"> </span><span class="err">的逗号和分号</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p><em>JavaScript 中的标点</em></p>
<div class="highlight"><pre><span></span><code><span class="c1">// Go 使用最少数量标点</span>
<span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">:=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="w"> </span><span class="p">{</span>
<span class="n">fmt</span><span class="p">.</span><span class="n">Println</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>

<p><em>Go 中的标点</em>
* 赋值：由于 Go 是强类型语言，所以你在初始化变量时可以使用 <code>:=</code> 操作符来进行类型推断，以避免<a href="https://golang.org/doc/faq#principles">重复声明</a>，而 JavaScript 则在运行时声明类型。</p>
<div class="highlight"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="n">JavaScript</span><span class="w"> </span><span class="err">赋值</span>
<span class="k">var</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;bar&quot;</span><span class="p">;</span>
</code></pre></div>

<p><em>JavaScript 中的赋值</em></p>
<div class="highlight"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="n">Go</span><span class="w"> </span><span class="err">的赋值</span>
<span class="k">var</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="o">//</span><span class="err">不使用类型推导</span>
<span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;bar&quot;</span>
<span class="n">foo</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;bar&quot;</span><span class="w"> </span><span class="o">//</span><span class="err">使用类型推导</span>
</code></pre></div>

<p><em>Go 的赋值</em>
* 导出：在 JavaScript 中，你必须从某个模块中显式地导出。 在 Go 中，任何大写的函数将被默认导出。</p>
<div class="highlight"><pre><span></span><code><span class="k">const</span><span class="w"> </span><span class="n">Bar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{};</span>
<span class="n">module</span><span class="o">.</span><span class="n">exports</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="n">Bar</span>
<span class="p">}</span>
</code></pre></div>

<p><em>JavaScript 中的导出</em></p>
<div class="highlight"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="n">Go</span><span class="w"> </span><span class="err">中的导出</span>
<span class="n">package</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="err">定义包名</span>
<span class="k">func</span><span class="w"> </span><span class="n">Bar</span><span class="w"> </span><span class="p">(</span><span class="n">s</span><span class="w"> </span><span class="n">string</span><span class="p">)</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="p">{</span>
<span class="o">//</span><span class="w"> </span><span class="n">Bar</span><span class="w"> </span><span class="err">将被导出</span>
<span class="p">}</span>
</code></pre></div>

<p><em>Go 中的导出</em>
* 导入：在 JavaScript 中 <code>required</code> 库是导入依赖项和模块所必需的，而 Go 则利用原生的 <code>import</code> 关键字通过包的路径导入模块。另一个区别是，与 Node 的中央 NPM 存储库不同，Go 使用 URL 作为路径来导入非标准库的包，这是为了从包的源码仓库直接克隆依赖。</p>
<div class="highlight"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="n">Javascript</span><span class="w"> </span><span class="err">的导入</span>
<span class="k">var</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">require</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">);</span>
<span class="n">foo</span><span class="o">.</span><span class="n">bar</span><span class="p">();</span>
</code></pre></div>

<p><em>JavaScript 的导入</em></p>
<div class="highlight"><pre><span></span><code><span class="o">//</span> <span class="n">Go</span> <span class="n">的导入</span>
<span class="kn">import</span> <span class="p">(</span>
<span class="s2">&quot;fmt&quot;</span> <span class="o">//</span> <span class="n">Go</span> <span class="n">的标准库部分</span>
<span class="s2">&quot;github.com/foo/foo&quot;</span> <span class="o">//</span> <span class="n">直接从仓库导入</span>
<span class="p">)</span>
<span class="n">foo</span><span class="o">.</span><span class="n">Bar</span><span class="p">()</span>
</code></pre></div>

<p><em>Go 的导入</em>
* 返回值：通过 Go 的多值返回特性可以优雅地传递和处理返回值和错误，并且通过传递引用减少了不正确的值传递。在 JavaScript 中需要通过一个对象或者数组来返回多个值。</p>
<div class="highlight"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="n">Javascript</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="err">返回多值</span>
<span class="n">function</span><span class="w"> </span><span class="n">foo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="n">a</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">};</span>
<span class="p">}</span>
<span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">foo</span><span class="p">();</span>
</code></pre></div>

<p><em>JavaScript 的返回</em></p>
<div class="highlight"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="n">Go</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="err">返回多值</span>
<span class="k">func</span><span class="w"> </span><span class="n">foo</span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="nb nb-Type">int</span><span class="p">,</span><span class="w"> </span><span class="nb nb-Type">int</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span>
<span class="p">}</span>
<span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="n">foo</span><span class="p">()</span>
</code></pre></div>

<p><em>Go 的返回</em>
* 错误处理：Go 推荐在错误出现的地方捕获它们，而不是像 Node 一样在回调中让错误冒泡。</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Node 的错误处理</span>
<span class="n">foo</span><span class="p">(</span><span class="s">&#39;bar&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">err</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="c1">// 处理错误</span>
<span class="p">}</span>
</code></pre></div>

<p><em>JavaScript 的错误处理</em></p>
<div class="highlight"><pre><span></span><code><span class="c1">//Go 的错误处理</span>
<span class="n">foo</span><span class="p">,</span><span class="w"> </span><span class="n">err</span><span class="w"> </span><span class="p">:=</span><span class="w"> </span><span class="n">bar</span><span class="p">()</span>
<span class="k">if</span><span class="w"> </span><span class="n">err</span><span class="w"> </span>!<span class="p">=</span><span class="w"> </span><span class="n">nil</span><span class="w"> </span><span class="p">{</span>
<span class="c1">// 用 defer、 panic、 recover 或 log.fatal 等等处理错误.</span>
<span class="p">}</span>
</code></pre></div>

<p><em>Go 的错误处理</em>
* 可变参数函数：Go 和 JavaScript 的函数都支持传入不定数量的参数。</p>
<div class="highlight"><pre><span></span><code>function foo (...args) {
console.log(args.length);
}
foo(); // 0
foo(1, 2, 3); // 3
</code></pre></div>

<p><em>JavaScript 中的可变参数函数</em></p>
<div class="highlight"><pre><span></span><code><span class="k">func</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="p">(</span><span class="n">args</span><span class="w"> </span><span class="o">...</span><span class="n">int</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="n">args</span><span class="p">))</span>
<span class="p">}</span>
<span class="k">func</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="n">foo</span><span class="p">()</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="mi">0</span>
<span class="n">foo</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="mi">3</span>
<span class="p">}</span>
</code></pre></div>

<p><em>Go 中的可变参数函数</em></p>
<h3>社区</h3>
<p>当比较 Go 和 Node 提供的编程范式哪种更方便时，两边都有不同的拥护者。Node 在软件包数量和社区的大小上完全胜过了 Go。Node 包管理器（NPM），是世界上最大的软件仓库，拥有<a href="http://www.modulecounts.com/">超过 410,000 个软件包，每天以 555 个新软件包的惊人速度增长</a>。这个数字可能看起来令人吃惊（确实是），但是需要注意的是，这些包许多是重复的，且质量不足以用在生产环境。 相比之下，Go 大约有 13 万个包。</p>
<p><img alt="" src="/data/attachment/album/201709/30/210334hgodtlx7qeucdets.png"></p>
<p><em>Node 和 Go 包的数量</em></p>
<p>尽管 Node 和 Go 岁数相仿，但 JavaScript 使用更加广泛，并拥有巨大的开发者和开源社区。因为 Node 是为所有人开发的，并在开始的时候就带有一个强壮的包管理器，而 Go 是特地为 Google 开发的。下面的<a href="http://spectrum.ieee.org/static/interactive-the-top-programming-languages-2016">Spectrum 排行榜</a>显示了当前流行的的顶尖 Web 开发语言。</p>
<p><img alt="" src="/data/attachment/album/201709/30/210337xnfkc0jgzfr22x10.png"></p>
<p><em>Web 开发语言排行榜前 7 名</em></p>
<p>JavaScript 的受欢迎程度近年来似乎保持相对稳定，而 <a href="http://www.tiobe.com/tiobe-index/">Go 一直在保持上升趋势</a>。</p>
<p><img alt="" src="/data/attachment/album/201709/30/210338ewom782b98my9bn6.png"></p>
<p><em>编程语言趋势</em></p>
<h3>性能</h3>
<p>如果你的主要关注点是速度呢？当今似乎人们比以前更重视性能的优化。用户不喜欢等待信息。 事实上，如果网页的加载时间超过 3 秒，<a href="https://hostingfacts.com/internet-facts-stats-2016/">40％ 的用户会放弃访问您的网站</a>。</p>
<p>因为它的非阻塞异步 I/O，Node 经常被认为是高性能的语言。另外，正如我之前提到的，Node 运行在针对动态语言进行了优化的 Google V8 引擎上。而 Go 的设计也考虑到速度。<a href="https://golang.org/doc/faq">Google 的开发者们</a>通过建立了一个“充满表现力而轻量级的类型系统；并发和垃圾回收机制；强制地指定依赖版本等等”，达成了这一目标。</p>
<p>我运行了一些测试来比较 Node 和 Go 之间的性能。这些测试注重于语言提供的初级能力。如果我准备测试例如 HTTP 请求或者 CPU 密集型运算，我会使用 Go 语言级别的并发工具（goroutines/channels）。但是我更注重于各个语言提供的基本特性（参见 <a href="https://medium.com/xo-tech/concurrency-in-three-flavors-51ed709876fb#.khvqrttxa">三种并发方法</a> 了解关于 goroutines 和 channels 的更多知识）。</p>
<p>我在基准测试中也加入了 Python，所以无论如何我们对 Node 和 Go 的结果都很满意。</p>
<h4>循环/算术</h4>
<p>迭代十亿项并把它们相加：</p>
<div class="highlight"><pre><span></span><code><span class="k">var</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1000000000</span><span class="p">;</span><span class="w"> </span><span class="n">c</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">r</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<p><em>Node</em></p>
<div class="highlight"><pre><span></span><code><span class="n">package</span><span class="w"> </span><span class="n">main</span>
<span class="k">func</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="nb nb-Type">int</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1000000000</span><span class="p">;</span><span class="w"> </span><span class="n">c</span><span class="o">++</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">r</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">c</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p><em>Go</em></p>
<div class="highlight"><pre><span></span><code>sum(xrange(1000000000))
</code></pre></div>

<p><em>Python</em></p>
<p><img alt="" src="/data/attachment/album/201709/30/210341c4fwxvoffmk1a2et.png"></p>
<p><em>结果</em></p>
<p>这里的输家无疑是 Python，花了超过 7 秒的 CPU 时间。而 Node 和 Go 都相当高效，分别用了 900 ms 和 408 ms。</p>
<p><em>修正：由于一些评论表明 Python 的性能还可以提高。我更新了结果来反映这些变化。同时，使用 PyPy 大大地提高了性能。当使用 Python 3.6.1 和 PyPy 3.5.7 运行时，性能提升到 1.234 秒，但仍然不及 Go 和 Node 。</em></p>
<h4>I/O</h4>
<p>遍历一百万个数字并将其写入一个文件。</p>
<div class="highlight"><pre><span></span><code><span class="k">var</span><span class="w"> </span><span class="n">fs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">require</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">);</span>
<span class="k">var</span><span class="w"> </span><span class="n">wstream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fs</span><span class="o">.</span><span class="n">createWriteStream</span><span class="p">(</span><span class="s1">&#39;node&#39;</span><span class="p">);</span>

<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">var</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1000000</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">wstream</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">toString</span><span class="p">());</span>
<span class="p">}</span>
<span class="n">wstream</span><span class="o">.</span><span class="n">end</span><span class="p">();</span>
</code></pre></div>

<p><em>Node</em></p>
<div class="highlight"><pre><span></span><code><span class="n">package</span> <span class="n">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s2">&quot;bufio&quot;</span>
    <span class="s2">&quot;os&quot;</span>
    <span class="s2">&quot;strconv&quot;</span>
<span class="p">)</span>

<span class="n">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">file</span><span class="p">,</span> <span class="n">_</span> <span class="o">:=</span> <span class="n">os</span><span class="o">.</span><span class="n">Create</span><span class="p">(</span><span class="s2">&quot;go&quot;</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">:=</span> <span class="n">bufio</span><span class="o">.</span><span class="n">NewWriter</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">c</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="mi">1000000</span><span class="p">;</span> <span class="n">c</span><span class="o">++</span> <span class="p">{</span>
        <span class="n">num</span> <span class="o">:=</span> <span class="n">strconv</span><span class="o">.</span><span class="n">Itoa</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="n">b</span><span class="o">.</span><span class="n">WriteString</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="n">file</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div>

<p><em>Go</em></p>
<div class="highlight"><pre><span></span><code>with open(&quot;python&quot;, &quot;a&quot;) as text_file:
    for i in range(1000000):
        text_file.write(str(i))
</code></pre></div>

<p><em>Python</em></p>
<p><img alt="" src="/data/attachment/album/201709/30/210344vlr73w3s6kyllh3r.png"></p>
<p><em>结果</em></p>
<p>Python 以 7.82 秒再次排名第三。 这次测试中，Node 和 Go 之间的差距很大，Node 花费大约 1.172 秒，Go 花费了 213 毫秒。真正令人印象深刻的是，Go 大部分的处理时间花费在编译上。如果我们将代码编译，以二进制运行，这个 I/O 测试仅花费 78 毫秒——要比 Node 快 15 倍。</p>
<p><em>修正：修改了 Go 代码以实现缓存 I/O。</em></p>
<h4>冒泡排序</h4>
<p>将含有十个元素的数组排序一千万次。</p>
<div class="highlight"><pre><span></span><code><span class="k">function</span><span class="w"> </span><span class="n">bubbleSort</span><span class="p">(</span><span class="k">input</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="nf">var</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">input</span><span class="p">.</span><span class="n">length</span><span class="p">;</span>
<span class="w">    </span><span class="nf">var</span><span class="w"> </span><span class="n">swapped</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="p">;</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">swapped</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="n">swapped</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">false</span><span class="p">;</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nf">var</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">input</span><span class="o">[</span><span class="n">i - 1</span><span class="o">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="k">input</span><span class="w"> </span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">                </span><span class="o">[</span><span class="n">input[i</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="k">input</span><span class="o">[</span><span class="n">i - 1</span><span class="o">]</span><span class="err">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">input[i - 1</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="k">input</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="err">]</span><span class="p">;</span>
<span class="w">                </span><span class="n">swapped</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span><span class="p">;</span>
<span class="w">            </span><span class="err">}</span>
<span class="w">        </span><span class="err">}</span>
<span class="w">    </span><span class="err">}</span>
<span class="err">}</span>

<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nf">var</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1000000</span><span class="p">;</span><span class="w"> </span><span class="n">c</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="n">const</span><span class="w"> </span><span class="n">toBeSorted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">1, 3, 2, 4, 8, 6, 7, 2, 3, 0</span><span class="o">]</span><span class="p">;</span>
<span class="w">    </span><span class="n">bubbleSort</span><span class="p">(</span><span class="n">toBeSorted</span><span class="p">);</span>
<span class="err">}</span>
</code></pre></div>

<p><em>Node</em></p>
<div class="highlight"><pre><span></span><code><span class="n">package</span><span class="w"> </span><span class="n">main</span>

<span class="k">var</span><span class="w"> </span><span class="n">toBeSorted</span><span class="w"> </span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="nb nb-Type">int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="nb nb-Type">int</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">}</span>

<span class="k">func</span><span class="w"> </span><span class="n">bubbleSort</span><span class="p">(</span><span class="n">input</span><span class="w"> </span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="nb nb-Type">int</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">n</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="n">input</span><span class="p">)</span>
<span class="w">    </span><span class="n">swapped</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="bp">true</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">swapped</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">swapped</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">false</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="w">                </span><span class="n">swapped</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">true</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">func</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1000000</span><span class="p">;</span><span class="w"> </span><span class="n">c</span><span class="o">++</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">bubbleSort</span><span class="p">(</span><span class="n">toBeSorted</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p><em>Go</em></p>
<div class="highlight"><pre><span></span><code><span class="n">def</span><span class="w"> </span><span class="n">bubbleSort</span><span class="p">(</span><span class="k">input</span><span class="p">)</span><span class="err">:</span>
<span class="w">    </span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="k">input</span><span class="p">)</span>
<span class="w">    </span><span class="n">swapped</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span>

<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="nl">swapped</span><span class="p">:</span>
<span class="w">        </span><span class="n">swapped</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">False</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">length</span><span class="p">)</span><span class="err">:</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="k">input</span><span class="o">[</span><span class="n">i - 1</span><span class="o">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="k">input</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="err">:</span>
<span class="w">                </span><span class="k">input</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="k">input</span><span class="o">[</span><span class="n">i - 1</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">input</span><span class="o">[</span><span class="n">i - 1</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="k">input</span><span class="o">[</span><span class="n">i</span><span class="o">]</span>
<span class="w">                </span><span class="n">swapped</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span>

<span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">range</span><span class="p">(</span><span class="mi">1000000</span><span class="p">)</span><span class="err">:</span>
<span class="w">    </span><span class="n">toBeSorted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">1, 3, 2, 4, 8, 6, 7, 2, 3, 0</span><span class="o">]</span>
<span class="w">    </span><span class="n">bubbleSort</span><span class="p">(</span><span class="n">toBeSorted</span><span class="p">)</span>
</code></pre></div>

<p><em>Python</em></p>
<p><img alt="" src="/data/attachment/album/201709/30/210348dhcqdd3mhdmywjmk.png"></p>
<p><em>结果</em></p>
<p>像刚才一样，Python 的表现是最差的，大约花费 15 秒完成了任务。 Go 完成任务的速度是 Node 的 16 倍。</p>
<h4>判决</h4>
<p>Go 无疑是这三个测试中的赢家，而 Node 大部分表现都很出色。Python 也表现不错。要清楚，性能不是选择编程语言需要考虑的全部内容。如果您的应用不需要处理大量数据，那么 Node 和 Go 之间的性能差异可能是微不足道的。 有关性能的一些其他比较，请参阅以下内容：</p>
<ul>
<li><a href="https://jaxbot.me/articles/node-vs-go-2014">Node Vs. Go</a></li>
<li><a href="https://hashnode.com/post/comparison-nodejs-php-c-go-python-and-ruby-cio352ydg000ym253frmfnt70">Multiple Language Performance Test</a></li>
<li><a href="https://benchmarksgame.alioth.debian.org/u64q/compare.php?lang=go&amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;lang2=node">Benchmarks Game</a></li>
</ul>
<h3>结论</h3>
<p>这个帖子不是为了证明一种语言比另一种语言更好。由于各种原因，每种编程语言都在软件开发社区中占有一席之地。 我的意图是强调 Go 和 Node 之间的差异，并且促进展示一种新的 Web 开发语言。 在为一个项目选择语言时，有各种因素需要考虑，比如开发人员的熟悉程度、花费和实用性。 我鼓励在决定哪种语言适合您时进行一次彻底的底层分析。</p>
<p>正如我们所看到的，Go 有如下的优点：接近底层语言的性能，简单的语法和相对简单的学习曲线使它成为构建可拓展和安全的 Web 应用的理想选择。随着 Go 的使用率和社区活动的快速增长，它将会成为现代网络开发中的重要角色。话虽如此，我相信如果 Node 被正确地实现，它正在向正确的方向努力，仍然是一种强大而有用的语言。它具有大量的追随者和活跃的社区，使其成为一个简单的平台，可以让 Web 应用在任何时候启动和运行。</p>
<h3>资料</h3>
<p>如果你对学习 Go 语言感兴趣，可以参阅下面的资源：</p>
<ul>
<li><a href="https://golang.org/doc/#learning">Golang 网站</a></li>
<li><a href="https://github.com/golang/go/wiki/Learn">Golang Wiki</a></li>
<li><a href="https://www.reddit.com/r/golang/">Golang Subreddit</a></li>
</ul>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>