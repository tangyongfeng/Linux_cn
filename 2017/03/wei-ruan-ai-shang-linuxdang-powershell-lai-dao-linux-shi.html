<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>微软爱上 Linux：当 PowerShell 来到 Linux 时</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: Aaron Kili 在微软爱上 Linux 之后，PowerShell 这个原本只是 Windows 才能使用的组件，于 2016 年 8 月 18 日开源并且成为跨平台软件，登陆了 Linux 和 macOS …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li class="active"><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2017/03/wei-ruan-ai-shang-linuxdang-powershell-lai-dao-linux-shi.html" rel="bookmark"
           title="Permalink to 微软爱上 Linux：当 PowerShell 来到 Linux 时">微软爱上 Linux：当 PowerShell 来到 Linux 时</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2017-03-13T08:40:23+01:00">
                Published: Mon 13 March 2017
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/ji-zhu">技术</a>.</p>

</footer><!-- /.post-info -->      <p>Author: Aaron Kili</p>
<p>在<a href="/article-7515-1.html">微软爱上 Linux</a> 之后，<strong>PowerShell</strong> 这个原本只是 Windows 才能使用的组件，于 2016 年 8 月 18 日<a href="/article-7699-1.html">开源并且成为跨平台软件</a>，登陆了 Linux 和 macOS。</p>
<p><img alt="" src="/data/attachment/album/201703/13/083959vbbegoma8emdggkb.jpg"></p>
<p><strong>PowerShell</strong> 是一个微软开发的自动化任务和配置管理系统。它基于 .NET 框架，由命令行语言解释器（shell）和脚本语言组成。</p>
<p>PowerShell 提供对 <strong>COM</strong> (<ruby> 组件对象模型 <rt>  Component Object Model </rt></ruby>) 和 <strong>WMI</strong> (<ruby> Windows 管理规范 <rt>  Windows Management Instrumentation </rt></ruby>) 的完全访问，从而允许系统管理员在本地或远程 Windows 系统中 <a href="http://www.tecmint.com/using-shell-script-to-automate-linux-system-maintenance-tasks/">执行管理任务</a>，以及对 WS-Management 和 CIM（<ruby> 公共信息模型 <rt>  Common Information Model </rt></ruby>）的访问，实现对远程 Linux 系统和网络设备的管理。</p>
<p>通过这个框架，管理任务基本上由称为 <strong>cmdlets</strong>（发音 command-lets）的 <strong>.NET</strong> 类执行。就像 Linux 的 shell 脚本一样，用户可以通过按照一定的规则将一组 <strong>cmdlets</strong> 写入文件来制作脚本或可执行文件。这些脚本可以用作独立的<a href="http://www.tecmint.com/tag/commandline-tools/">命令行程序或工具</a>。</p>
<h3>在 Linux 系统中安装 PowerShell Core 6.0</h3>
<p>要在 Linux 中安装 <strong>PowerShell Core 6.0</strong>，我们将会用到微软软件仓库，它允许我们通过最流行的 Linux 包管理器工具，如 <a href="http://www.tecmint.com/useful-basic-commands-of-apt-get-and-apt-cache-for-package-management/">apt-get</a>、<a href="http://www.tecmint.com/20-linux-yum-yellowdog-updater-modified-commands-for-package-mangement/">yum</a> 等来安装。</p>
<h4>在 Ubuntu 16.04 中安装</h4>
<p>首先，导入该公共仓库的 <strong>GPG</strong> 密钥，然后将 <strong>Microsoft Ubuntu</strong> 仓库注册到 <strong>APT</strong> 的源中来安装 <strong>PowerShell</strong>：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>curl<span class="w"> </span>https://packages.microsoft.com/keys/microsoft.asc<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>apt-key<span class="w"> </span>add<span class="w"> </span>-
$<span class="w"> </span>curl<span class="w"> </span>https://packages.microsoft.com/config/ubuntu/16.04/prod.list<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/etc/apt/sources.list.d/microsoft.list
$<span class="w"> </span>sudo<span class="w"> </span>apt-get<span class="w"> </span>update
$<span class="w"> </span>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>powershell
</code></pre></div>

<h4>在 Ubuntu 14.04 中安裝</h4>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>curl<span class="w"> </span>https://packages.microsoft.com/keys/microsoft.asc<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>apt-key<span class="w"> </span>add<span class="w"> </span>-
$<span class="w"> </span>curl<span class="w"> </span>https://packages.microsoft.com/config/ubuntu/14.04/prod.list<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/etc/apt/sources.list.d/microsoft.list
$<span class="w"> </span>sudo<span class="w"> </span>apt-get<span class="w"> </span>update
$<span class="w"> </span>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>powershell
</code></pre></div>

<h4>在 CentOS 7 中安裝</h4>
<p>首先，将 <strong>Microsoft RedHat</strong> 仓库注册到 <strong>YUM</strong> 包管理器仓库列表中，然后安装 <strong>PowerShell</strong>：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>curl<span class="w"> </span>https://packages.microsoft.com/config/rhel/7/prod.repo<span class="w"> </span>&gt;<span class="w"> </span>/etc/yum.repos.d/microsoft.repo
$<span class="w"> </span>sudo<span class="w"> </span>yum<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>powershell
</code></pre></div>

<h3>如何在 Linux 中使用 PowerShell Core 6.0</h3>
<p>在这一节中，我们将会简单介绍下 <strong>PowerShell</strong>；我们将会看到如何启动 PowerShell，运行一些基础命令，操作文件、目录和进程。然后学习怎样列出所有可用的命令、显示命令帮助和别名。</p>
<p>输入以下命令来启动 PowerShell：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>powershell
</code></pre></div>

<p><img alt="Start Powershell in Linux" src="/data/attachment/album/201703/13/084024du81euye77bsusii.png"></p>
<p><em>在 Linux 中启动 PowerShell</em></p>
<p>你可以通过以下命令来查看 PowerShell 版本：</p>
<div class="highlight"><pre><span></span><code>$PSVersionTable
</code></pre></div>

<p><img alt="Check Powershell Version" src="/data/attachment/album/201703/13/084025ckdzp5tfm6tcc5cp.png"></p>
<p><em>查看 PowerShell 版本</em></p>
<p>在 Linux 中运行基本的 PowerShell 命令。</p>
<div class="highlight"><pre><span></span><code><span class="nv">get</span><span class="o">-</span><span class="nv">date</span><span class="w">          </span>[#<span class="w"> </span>显示当前日期]
<span class="nv">get</span><span class="o">-</span><span class="k">uptime</span><span class="w">        </span>[#<span class="w"> </span>显示开机时间]
<span class="nv">get</span><span class="o">-</span><span class="nv">location</span><span class="w">      </span>[#<span class="w"> </span>显示当前工作目录]
</code></pre></div>

<h4>在 PowerShell 中操作文件和目录</h4>
<p>1、 可以通过两种方法创建空文件：</p>
<div class="highlight"><pre><span></span><code>new-item  tecmint.tex
或者
&quot;&quot;&gt;tecmint.tex
</code></pre></div>

<p>然后往里面添加内容并查看文件内容。</p>
<div class="highlight"><pre><span></span><code>set-content tecmint.tex -value &quot;TecMint Linux How Tos Guides&quot;
get-content tecmint.tex
</code></pre></div>

<p><img alt="Create New File in Powershell" src="/data/attachment/album/201703/13/084025lvi4q45pzfv98v88.png"></p>
<p><em>在 PowerShell 中创建新文件</em></p>
<p>2、 在 PowerShell 中删除一个文件</p>
<div class="highlight"><pre><span></span><code>remove-item tecmint.tex
get-content tecmint.tex
</code></pre></div>

<p><img alt="Delete File in Powershell" src="/data/attachment/album/201703/13/084026pshkk774r8k6kvee.png"></p>
<p><em>在 PowerShell 中删除一个文件</em></p>
<p>3、 创建目录</p>
<div class="highlight"><pre><span></span><code>mkdir  tecmint-files
cd  tecmint-files
“”&gt;domains.list
ls
</code></pre></div>

<p><img alt="Create Directory in Powershell" src="/data/attachment/album/201703/13/084026d94zz0gpg1gkgg1p.png"></p>
<p><em>在 PowerShell 中创建目录</em></p>
<p>4、 执行长格式的列表操作，列出文件／目录详细情况，包括模式（文件类型）、最后修改时间等，使用以下命令：</p>
<div class="highlight"><pre><span></span><code>dir
</code></pre></div>

<p><img alt="Directory Long Listing in Powershell" src="/data/attachment/album/201703/13/084026ambbskbqhh9mhqbn.png"></p>
<p><em>Powershell 中列出目录长列表</em></p>
<p>5、 显示系统中所有的进程：</p>
<div class="highlight"><pre><span></span><code>get-process
</code></pre></div>

<p><img alt="View Running Processes in Powershell" src="/data/attachment/album/201703/13/084027rba9tystlwkk9aot.png"></p>
<p><em>在 PowerShell 中显示运行中的进程</em></p>
<p>6、 通过给定的名称查看正在运行的进程/进程组细节，将进程名作为参数传给上面的命令，如下：</p>
<div class="highlight"><pre><span></span><code>get-process apache2
</code></pre></div>

<p><img alt="View Specific Process in Powershell" src="/data/attachment/album/201703/13/084027tfb66w2yzf22z6bb.png"></p>
<p><em>在 PowerShell 中查看指定的进程</em></p>
<p>输出中各部分的含义：</p>
<ul>
<li>NPM(K) – 进程使用的非分页内存，单位：Kb。</li>
<li>PM(K) – 进程使用的可分页内存，单位：Kb。</li>
<li>WS(K) – 进程的工作集大小，单位：Kb，工作集由进程所引用到的内存页组成。</li>
<li>CPU(s) – 进程在所有处理器上所占用的处理器时间，单位：秒。</li>
<li>ID – 进程 ID (PID).</li>
<li>ProcessName – 进程名称。</li>
</ul>
<p>7、 想要了解更多，获取 PowerShell 命令列表：</p>
<div class="highlight"><pre><span></span><code>get-command
</code></pre></div>

<p><img alt="List Powershell Commands" src="/data/attachment/album/201703/13/084028o4jtwhzzywjj6f6p.png"></p>
<p><em>列出 PowerShell 的命令</em></p>
<p>8、 想知道如何使用一个命令，查看它的帮助（类似于 Unix/Linux 中的 man）；举个例子，你可以这样获取命令 <strong>Describe</strong> 的帮助：</p>
<div class="highlight"><pre><span></span><code>get-help Describe
</code></pre></div>

<p><img alt="Powershell Help Manual" src="/data/attachment/album/201703/13/084028o6z08ttgt8t06wo0.png"></p>
<p><em>PowerShell 帮助手册</em></p>
<p>9、 显示所有命令的别名，輸入：</p>
<div class="highlight"><pre><span></span><code>get-alias
</code></pre></div>

<p><img alt="List Powershell Command Aliases" src="/data/attachment/album/201703/13/084029g4kmmzokrb4wn4oo.png"></p>
<p><em>列出 PowerShell 命令别名</em></p>
<p>10、 最后，不过也很重要，显示命令历史记录（曾运行过的命令的列表）：</p>
<div class="highlight"><pre><span></span><code>history
</code></pre></div>

<p><img alt="List Powershell Commands History" src="/data/attachment/album/201703/13/084029rixqy93zi60v3ozi.png"></p>
<p><em>显示 PowerShell 命令历史记录</em></p>
<p>就是这些了！在这篇文章里，我们展示了如何在 Linux 中安装<strong>微软的 PowerShell Core 6.0</strong>。在我看来，与传统 Unix／Linux 的 shell 相比，PowerShell 还有很长的路要走。目前看来，PowerShell 还需要在命令行操作机器，更重要的是，编程（写脚本）等方面，提供更好、更多令人激动和富有成效的特性。</p>
<p>查看 PowerShell 的 GitHub 仓库：<a href="https://github.com/PowerShell/PowerShell">https://github.com/PowerShell/PowerShell</a>。</p>
<p>请在评论中分享你的观点。</p>
<p>via: <a href="http://www.tecmint.com/install-powershell-in-linux/">http://www.tecmint.com/install-powershell-in-linux/</a></p>
<p>作者：<a href="http://www.tecmint.com/author/aaronkili/">Aaron Kili</a> 译者：<a href="https://github.com/zijung">zijung</a> 校对：<a href="https://github.com/jasminepeng">jasminepeng</a></p>
<p>本文由 <a href="https://github.com/LCTT/TranslateProject">LCTT</a> 原创编译，<a href="https://linux.cn/">Linux中国</a> 荣誉推出</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>