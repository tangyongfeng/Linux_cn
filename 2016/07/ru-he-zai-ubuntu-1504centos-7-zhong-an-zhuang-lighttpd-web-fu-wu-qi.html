<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>如何在 Ubuntu 15.04/CentOS 7 中安装 Lighttpd Web 服务器</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: Arun Pyasi Lighttpd 是一款开源 Web 服务器软件。Lighttpd 安全快速，符合行业标准，适配性强并且针对高配置环境进行了优化。相对于其它的 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li class="active"><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2016/07/ru-he-zai-ubuntu-1504centos-7-zhong-an-zhuang-lighttpd-web-fu-wu-qi.html" rel="bookmark"
           title="Permalink to 如何在 Ubuntu 15.04/CentOS 7 中安装 Lighttpd Web 服务器">如何在 Ubuntu 15.04/CentOS 7 中安装 Lighttpd Web 服务器</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2016-07-07T09:50:40+02:00">
                Published: Thu 07 July 2016
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/xi-tong-yun-wei">系统运维</a>.</p>

</footer><!-- /.post-info -->      <p>Author: Arun Pyasi</p>
<p>Lighttpd 是一款开源 Web 服务器软件。Lighttpd 安全快速，符合行业标准，适配性强并且针对高配置环境进行了优化。相对于其它的 Web 服务器而言，Lighttpd 占用内存更少；因其对 CPU 占用小和对处理速度的优化而在效率和速度方面从众多 Web 服务器中脱颖而出。而 Lighttpd 诸如 FastCGI、CGI、认证、输出压缩、URL 重写等高级功能更是那些面临性能压力的服务器的福音。</p>
<p><img alt="" src="/data/attachment/album/201607/07/095035jmprwmywkkw1w122.jpg"></p>
<p>以下便是我们在运行 Ubuntu 15.04 或 CentOS 7 Linux 发行版的机器上安装 Lighttpd Web 服务器的简要流程。</p>
<h3>安装Lighttpd</h3>
<h4>使用包管理器安装</h4>
<p>这里我们通过使用包管理器这种最简单的方法来安装 Lighttpd。只需以 sudo 模式在终端或控制台中输入下面的指令即可。</p>
<p><strong>CentOS 7</strong></p>
<p>由于 CentOS 7.0 官方仓库中并没有提供 Lighttpd，所以我们需要在系统中安装额外的软件源 epel 仓库。使用下面的 yum 指令来安装 epel。</p>
<div class="highlight"><pre><span></span><code># yum install epel-release
</code></pre></div>

<p>然后，我们需要更新系统及为 Lighttpd 的安装做前置准备。</p>
<div class="highlight"><pre><span></span><code># yum update
# yum install lighttpd
</code></pre></div>

<p><img alt="Install Lighttpd Centos" src="/data/attachment/album/201607/07/095043p57wz7d62z7w2qwb.png"></p>
<p><strong>Ubuntu 15.04</strong></p>
<p>Ubuntu 15.04 官方仓库中包含了 Lighttpd，所以只需更新本地仓库索引并使用 apt-get 指令即可安装 Lighttpd。</p>
<div class="highlight"><pre><span></span><code># apt-get update
# apt-get install lighttpd
</code></pre></div>

<p><img alt="Install lighttpd ubuntu" src="/data/attachment/album/201607/07/095044lxhuineeubb6tx7n.png"></p>
<h4>从源代码安装 Lighttpd</h4>
<p>如果想从 Lighttpd 源码安装最新版本（例如 1.4.39），我们需要在本地编译源码并进行安装。首先我们要安装编译源码所需的依赖包。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># cd /tmp/</span>
<span class="c1"># wget http://download.lighttpd.net/lighttpd/releases-1.4.x/lighttpd-1.4.39.tar.gz</span>
</code></pre></div>

<p>下载完成后，执行下面的指令解压缩。</p>
<div class="highlight"><pre><span></span><code># tar -zxvf lighttpd-1.4.39.tar.gz
</code></pre></div>

<p>然后使用下面的指令进行编译。</p>
<div class="highlight"><pre><span></span><code># cd lighttpd-1.4.39
# ./configure
# make
</code></pre></div>

<p><strong>注：</strong>在这份教程中，我们安装的是默认配置的 Lighttpd。其他拓展功能，如对 SSL 的支持，mod<em>rewrite，mod</em>redirect 等，需自行配置。</p>
<p>当编译完成后，我们就可以把它安装到系统中了。</p>
<div class="highlight"><pre><span></span><code># make install
</code></pre></div>

<h3>设置 Lighttpd</h3>
<p>如果有更高的需求，我们可以通过修改默认设置文件，如<code>/etc/lighttpd/lighttpd.conf</code>，来对 Lighttpd 进行进一步设置。 而在这份教程中我们将使用默认设置，不对设置文件进行修改。如果你曾做过修改并想检查设置文件是否出错，可以执行下面的指令。</p>
<div class="highlight"><pre><span></span><code># lighttpd -t -f /etc/lighttpd/lighttpd.conf
</code></pre></div>

<h4>使用 CentOS 7</h4>
<p>在 CentOS 7 中，我们需创建一个在 Lighttpd 默认配置文件中设置的 webroot 文件夹，例如<code>/src/www/htdocs</code>。</p>
<div class="highlight"><pre><span></span><code># mkdir -p /srv/www/htdocs/
</code></pre></div>

<p>而后将默认欢迎页面从<code>/var/www/lighttpd</code>复制至刚刚新建的目录中：</p>
<div class="highlight"><pre><span></span><code><span class="c1"># cp -r /var/www/lighttpd/* /srv/www/htdocs/</span>
</code></pre></div>

<h3>开启服务</h3>
<p>现在，通过执行 systemctl 指令来重启 Web 服务。</p>
<div class="highlight"><pre><span></span><code># systemctl start lighttpd
</code></pre></div>

<p>然后我们将它设置为伴随系统启动自动运行。</p>
<div class="highlight"><pre><span></span><code># systemctl enable lighttpd
</code></pre></div>

<h3>设置防火墙</h3>
<p>如要让我们运行在 Lighttpd 上的网页或网站能在 Internet 或同一个网络内被访问，我们需要在防火墙程序中设置打开 80 端口。由于 CentOS 7 和 Ubuntu15.04 都附带 Systemd 作为默认初始化系统，所以我们默认用的都是 firewalld。如果要打开 80 端口或 http 服务，我们只需执行下面的命令：</p>
<div class="highlight"><pre><span></span><code><span class="c1"># firewall-cmd --permanent --add-service=http</span>
<span class="n">success</span>
<span class="c1"># firewall-cmd --reload</span>
<span class="n">success</span>
</code></pre></div>

<h3>连接至 Web 服务器</h3>
<p>在将 80 端口设置为默认端口后，我们就可以直接访问 Lighttpd 的默认欢迎页了。我们需要根据运行 Lighttpd 的设备来设置浏览器的 IP 地址和域名。在本教程中，我们令浏览器访问 <a href="http://lighttpd.linoxide.com/">http://lighttpd.linoxide.com/</a> ，同时将该子域名指向上述 IP 地址。如此一来，我们就可以在浏览器中看到如下的欢迎页面了。</p>
<p><img alt="Lighttpd Welcome Page" src="/data/attachment/album/201607/07/095044uxvy6hk7yqhkkvqv.png"></p>
<p>此外，我们可以将网站的文件添加到 webroot 目录下，并删除 Lighttpd 的默认索引文件，使我们的静态网站可以在互联网上访问。</p>
<p>如果想在 Lighttpd Web 服务器中运行 PHP 应用，请参考下面的步骤：</p>
<h3>安装 PHP5 模块</h3>
<p>在 Lighttpd 成功安装后，我们需要安装 PHP 及相关模块，以在 Lighttpd 中运行 PHP5 脚本。</p>
<h4>使用 Ubuntu 15.04</h4>
<div class="highlight"><pre><span></span><code># apt-get install php5 php5-cgi php5-fpm php5-mysql php5-curl php5-gd php5-intl php5-imagick php5-mcrypt php5-memcache php-pear
</code></pre></div>

<h4>使用 CentOS 7</h4>
<div class="highlight"><pre><span></span><code># yum install php php-cgi php-fpm php-mysql php-curl php-gd php-intl php-pecl-imagick php-mcrypt php-memcache php-pear lighttpd-fastcgi
</code></pre></div>

<h3>设置 Lighttpd 的 PHP 服务</h3>
<p>如要让 PHP 与 Lighttpd 协同工作，我们只要根据所使用的发行版执行如下对应的指令即可。</p>
<h4>使用 CentOS 7</h4>
<p>首先要做的便是使用文件编辑器编辑 php 设置文件（例如<code>/etc/php.ini</code>）并取消掉对<code>cgi.fix_pathinfo=1</code>这一行的注释。</p>
<div class="highlight"><pre><span></span><code># nano /etc/php.ini
</code></pre></div>

<p>完成上面的步骤之后，我们需要把 PHP-FPM 进程的所有权从 Apache 转移至 Lighttpd。要完成这些，首先用文件编辑器打开<code>/etc/php-fpm.d/www.conf</code>文件。</p>
<div class="highlight"><pre><span></span><code># nano /etc/php-fpm.d/www.conf
</code></pre></div>

<p>然后在文件中增加下面的语句：</p>
<div class="highlight"><pre><span></span><code>user = lighttpd
group = lighttpd
</code></pre></div>

<p>做完这些，我们保存并退出文本编辑器。然后从<code>/etc/lighttpd/modules.conf</code>设置文件中添加 FastCGI 模块。</p>
<div class="highlight"><pre><span></span><code># nano /etc/lighttpd/modules.conf
</code></pre></div>

<p>然后，去掉下面语句前面的<code>#</code>来取消对它的注释。</p>
<div class="highlight"><pre><span></span><code><span class="k">include</span><span class="w"> </span><span class="s2">&quot;conf.d/fastcgi.conf&quot;</span>
</code></pre></div>

<p>最后我们还需在文本编辑器设置 FastCGI 的设置文件。</p>
<div class="highlight"><pre><span></span><code># nano /etc/lighttpd/conf.d/fastcgi.conf
</code></pre></div>

<p>在文件尾部添加以下代码：</p>
<div class="highlight"><pre><span></span><code>fastcgi.server += ( &quot;.php&quot; =&gt;
((
&quot;host&quot; =&gt; &quot;127.0.0.1&quot;,
&quot;port&quot; =&gt; &quot;9000&quot;,
&quot;broken-scriptfilename&quot; =&gt; &quot;enable&quot;
))
)
</code></pre></div>

<p>在编辑完成后保存并退出文本编辑器即可。</p>
<h4>使用 Ubuntu 15.04</h4>
<p>如需启用 Lighttpd 的 FastCGI，只需执行下列代码：</p>
<div class="highlight"><pre><span></span><code><span class="c1"># lighttpd-enable-mod fastcgi</span>

<span class="n">Enabling</span><span class="w"> </span><span class="n">fastcgi</span><span class="p">:</span><span class="w"> </span><span class="n">ok</span>
<span class="n">Run</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">lighttpd</span><span class="w"> </span><span class="n">force</span><span class="o">-</span><span class="n">reload</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">enable</span><span class="w"> </span><span class="n">changes</span>

<span class="c1"># lighttpd-enable-mod fastcgi-php</span>

<span class="n">Enabling</span><span class="w"> </span><span class="n">fastcgi</span><span class="o">-</span><span class="n">php</span><span class="p">:</span><span class="w"> </span><span class="n">ok</span>
<span class="n">Run</span><span class="w"> </span><span class="err">`</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">lighttpd</span><span class="err">`</span><span class="w"> </span><span class="n">force</span><span class="o">-</span><span class="n">reload</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">enable</span><span class="w"> </span><span class="n">changes</span>
</code></pre></div>

<p>然后，执行下列命令来重启 Lighttpd。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># systemctl force-reload lighttpd</span>
</code></pre></div>

<h3>检测 PHP 工作状态</h3>
<p>如需检测 PHP 是否按预期工作，我们需在 Lighttpd 的 webroot 目录下新建一个 php 文件。本教程中，在 Ubuntu 下 /var/www/html 目录，CentOS 下 /src/www/htdocs 目录下使用文本编辑器创建并打开 info.php。</p>
<p><strong>使用 CentOS 7</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># nano  /var/www/info.php</span>
</code></pre></div>

<p><strong>使用 Ubuntu 15.04</strong></p>
<div class="highlight"><pre><span></span><code># nano /srv/www/htdocs/info.php
</code></pre></div>

<p>然后只需将下面的语句添加到文件里即可。</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?php</span> <span class="nb">phpinfo</span><span class="p">();</span> <span class="cp">?&gt;</span>
</code></pre></div>

<p>在编辑完成后保存并推出文本编辑器即可。</p>
<p>现在，我们需根据路径 <a href="http://lighttpd.linoxide.com/info.php">http://lighttpd.linoxide.com/info.php</a> 下的 info.php 文件的 IP 地址或域名，来让我们的网页浏览器指向系统上运行的 Lighttpd。如果一切都按照以上说明进行，我们将看到如下图所示的 PHP 页面信息。</p>
<p><img alt="phpinfo lighttpd" src="/data/attachment/album/201607/07/095045uv6pcixzvjsxwvid.png"></p>
<h3>总结</h3>
<p>至此，我们已经在 CentOS 7 和 Ubuntu 15.04 Linux 发行版上成功安装了轻巧快捷并且安全的 Lighttpd Web 服务器。现在，我们已经可以上传网站文件到网站根目录、配置虚拟主机、启用 SSL、连接数据库，在我们的 Lighttpd Web 服务器上运行 Web 应用等功能了。 如果你有任何疑问，建议或反馈请在下面的评论区中写下来以让我们更好的改良 Lighttpd。谢谢！</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>