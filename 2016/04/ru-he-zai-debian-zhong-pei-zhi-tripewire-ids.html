<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>如何在 Debian 中配置 Tripewire IDS</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: nido 本文是一篇关于 Debian 中安装和配置 tripewire 的文章。它是 Linux 环境下基于主机的入侵检测系统（IDS）。tripwire 的高级功能可以检测并报 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li class="active"><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2016/04/ru-he-zai-debian-zhong-pei-zhi-tripewire-ids.html" rel="bookmark"
           title="Permalink to 如何在 Debian 中配置 Tripewire IDS">如何在 Debian 中配置 Tripewire IDS</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2016-04-03T10:41:29+02:00">
                Published: Sun 03 April 2016
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/fen-xiang">分享</a>.</p>

</footer><!-- /.post-info -->      <p>Author: nido</p>
<p>本文是一篇关于 Debian 中安装和配置 tripewire 的文章。它是 Linux 环境下基于主机的入侵检测系统（IDS）。tripwire 的高级功能可以检测并报告任何 Linux 中未授权的（文件和目录）的更改。tripewire 安装之后，会先创建一个基本的数据库，tripewire 监控并检测新文件的创建修改和谁修改了它等等。如果修改是合法的，你可以接受修改并更新 tripwire 的数据库。</p>
<p><img alt="" src="/data/attachment/album/201604/03/104130pcgghcphbab1h8dt.jpg"></p>
<h3>安装和配置</h3>
<p>tripwire 在 Debian VM 中的安装如下。</p>
<div class="highlight"><pre><span></span><code><span class="p">#</span><span class="w"> </span><span class="n">apt</span><span class="o">-</span><span class="n">get</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="n">tripwire</span>
</code></pre></div>

<p><img alt="installation" src="/data/attachment/album/201604/03/104134dleanyyn1d412d2n.png"></p>
<p>安装中，tripwire 会有下面的配置提示。</p>
<h4>站点密钥创建</h4>
<p>tripwire 需要一个站点口令（site passphrase）来加密 tripwire 的配置文件 tw.cfg 和策略文件 tw.pol。tripewire 使用指定的密码加密两个文件。一个 tripewire 实例必须指定站点口令。</p>
<p><img alt="site key1" src="/data/attachment/album/201604/03/104134johmrbx1xgh11gkg.png"></p>
<h4>本地密钥口令</h4>
<p>本地口令用来保护 tripwire 数据库和报告文件。本地密钥用于阻止非授权的 tripewire 数据库修改。</p>
<p><img alt="local key1" src="/data/attachment/album/201604/03/104135cf0gt0vaxptabfgx.png"></p>
<h4>tripwire 配置路径</h4>
<p>tripewire 配置存储在 /etc/tripwire/twcfg.txt。它用于生成加密的配置文件 tw.cfg。</p>
<p><img alt="configuration file" src="/data/attachment/album/201604/03/104136f499o66z80t9ylcr.png"></p>
<p><strong>tripwire 策略路径</strong></p>
<p>tripwire 在 /etc/tripwire/twpol.txt 中保存策略文件。它用于生成加密的策略文件 tw.pol。</p>
<p><img alt="tripwire policy" src="/data/attachment/album/201604/03/104137krtemgexmvexo4ra.png"></p>
<p>安装完成后如下图所示。</p>
<p><img alt="installed tripewire1" src="/data/attachment/album/201604/03/104137ny981ax2c1s181dy.png"></p>
<h4>tripwire 配置文件 (twcfg.txt)</h4>
<p>tripewire 配置文件（twcfg.txt）细节如下图所示。加密策略文件（tw.pol）、站点密钥（site.key）和本地密钥（hostname-local.key）在后面展示。</p>
<div class="highlight"><pre><span></span><code><span class="n">ROOT</span><span class="w">         </span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span>

<span class="n">POLFILE</span><span class="w">       </span><span class="o">=/</span><span class="n">etc</span><span class="o">/</span><span class="n">tripwire</span><span class="o">/</span><span class="n">tw</span><span class="o">.</span><span class="n">pol</span>

<span class="n">DBFILE</span><span class="w">       </span><span class="o">=/</span><span class="k">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">tripwire</span><span class="o">/$</span><span class="p">(</span><span class="n">HOSTNAME</span><span class="p">)</span><span class="o">.</span><span class="n">twd</span>

<span class="n">REPORTFILE</span><span class="w">   </span><span class="o">=/</span><span class="k">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">tripwire</span><span class="o">/</span><span class="n">report</span><span class="o">/$</span><span class="p">(</span><span class="n">HOSTNAME</span><span class="p">)</span><span class="o">-$</span><span class="p">(</span><span class="n">DATE</span><span class="p">)</span><span class="o">.</span><span class="n">twr</span>

<span class="n">SITEKEYFILE</span><span class="w">   </span><span class="o">=/</span><span class="n">etc</span><span class="o">/</span><span class="n">tripwire</span><span class="o">/</span><span class="n">site</span><span class="o">.</span><span class="n">key</span>

<span class="n">LOCALKEYFILE</span><span class="w"> </span><span class="o">=/</span><span class="n">etc</span><span class="o">/</span><span class="n">tripwire</span><span class="o">/$</span><span class="p">(</span><span class="n">HOSTNAME</span><span class="p">)</span><span class="o">-</span><span class="n">local</span><span class="o">.</span><span class="n">key</span>

<span class="n">EDITOR</span><span class="w">       </span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">editor</span>

<span class="n">LATEPROMPTING</span><span class="w"> </span><span class="o">=</span><span class="bp">false</span>

<span class="n">LOOSEDIRECTORYCHECKING</span><span class="w"> </span><span class="o">=</span><span class="bp">false</span>

<span class="n">MAILNOVIOLATIONS</span><span class="w"> </span><span class="o">=</span><span class="bp">true</span>

<span class="n">EMAILREPORTLEVEL</span><span class="w"> </span><span class="o">=</span><span class="mi">3</span>

<span class="n">REPORTLEVEL</span><span class="w">   </span><span class="o">=</span><span class="mi">3</span>

<span class="n">SYSLOGREPORTING</span><span class="w"> </span><span class="o">=</span><span class="bp">true</span>

<span class="n">MAILMETHOD</span><span class="w">   </span><span class="o">=</span><span class="n">SMTP</span>

<span class="n">SMTPHOST</span><span class="w">     </span><span class="o">=</span><span class="n">localhost</span>

<span class="n">SMTPPORT</span><span class="w">     </span><span class="o">=</span><span class="mi">25</span>

<span class="n">TEMPDIRECTORY</span><span class="w"> </span><span class="o">=/</span><span class="n">tmp</span>
</code></pre></div>

<h4>tripwire 策略配置</h4>
<p>在生成基础数据库之前先配置 tripwire 配置。有必要经用一些策略如 /dev、 /proc 、/root/mail 等。详细的 twpol.txt 策略文件如下所示。</p>
<div class="highlight"><pre><span></span><code><span class="err">@@</span><span class="n">section</span><span class="w"> </span><span class="n">GLOBAL</span>
<span class="n">TWBIN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="p">;</span>
<span class="n">TWETC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">tripwire</span><span class="p">;</span>
<span class="n">TWVAR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">tripwire</span><span class="p">;</span>

<span class="c1">#</span>
<span class="c1"># File System Definitions</span>
<span class="c1">#</span>
<span class="err">@@</span><span class="n">section</span><span class="w"> </span><span class="n">FS</span>

<span class="c1">#</span>
<span class="c1"># First, some variables to make configuration easier</span>
<span class="c1">#</span>
<span class="n">SEC_CRIT</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">IgnoreNone</span><span class="p">)</span><span class="o">-</span><span class="n">SHa</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="c1"># Critical files that cannot change</span>

<span class="n">SEC_BIN</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">ReadOnly</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w">        </span><span class="c1"># Binaries that should not change</span>

<span class="n">SEC_CONFIG</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">Dynamic</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w">         </span><span class="c1"># Config files that are changed</span>
<span class="c1"># infrequently but accessed</span>
<span class="c1"># often</span>

<span class="n">SEC_LOG</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">Growing</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w">         </span><span class="c1"># Files that grow, but that</span>
<span class="c1"># should never change ownership</span>

<span class="n">SEC_INVARIANT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">+</span><span class="n">tpug</span><span class="w"> </span><span class="p">;</span><span class="w">              </span><span class="c1"># Directories that should never</span>
<span class="c1"># change permission or ownership</span>

<span class="n">SIG_LOW</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mi">33</span><span class="w"> </span><span class="p">;</span><span class="w">                 </span><span class="c1"># Non-critical files that are of</span>
<span class="c1"># minimal security impact</span>

<span class="n">SIG_MED</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mi">66</span><span class="w"> </span><span class="p">;</span><span class="w">                 </span><span class="c1"># Non-critical files that are of</span>
<span class="c1"># significant security impact</span>

<span class="n">SIG_HI</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="p">;</span><span class="w">                </span><span class="c1"># Critical files that are</span>
<span class="c1"># significant points of</span>
<span class="c1"># vulnerability</span>

<span class="c1">#</span>
<span class="c1"># tripwire Binaries</span>
<span class="c1">#</span>
<span class="p">(</span>
<span class="n">rulename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;tripwire Binaries&quot;</span><span class="p">,</span>
<span class="n">severity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">SIG_HI</span><span class="p">)</span>
<span class="p">)</span>
<span class="p">{</span>
<span class="o">$</span><span class="p">(</span><span class="n">TWBIN</span><span class="p">)</span><span class="o">/</span><span class="n">siggen</span><span class="w">            </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">SEC_BIN</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
<span class="o">$</span><span class="p">(</span><span class="n">TWBIN</span><span class="p">)</span><span class="o">/</span><span class="n">tripwire</span><span class="w">        </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">SEC_BIN</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
<span class="o">$</span><span class="p">(</span><span class="n">TWBIN</span><span class="p">)</span><span class="o">/</span><span class="n">twadmin</span><span class="w">        </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">SEC_BIN</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
<span class="o">$</span><span class="p">(</span><span class="n">TWBIN</span><span class="p">)</span><span class="o">/</span><span class="n">twprint</span><span class="w">        </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">SEC_BIN</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
<span class="p">}</span>
<span class="p">{</span>
<span class="o">/</span><span class="n">boot</span><span class="w">            </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">SEC_CRIT</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
<span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">modules</span><span class="w">        </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">SEC_CRIT</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
<span class="p">}</span>

<span class="p">(</span>
<span class="n">rulename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Boot Scripts&quot;</span><span class="p">,</span>
<span class="n">severity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">SIG_HI</span><span class="p">)</span>
<span class="p">)</span>
<span class="p">{</span>
<span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">d</span><span class="w">        </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">SEC_BIN</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
<span class="c1">#/etc/rc.boot        -&gt; $(SEC_BIN) ;</span>
<span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">rcS</span><span class="o">.</span><span class="n">d</span><span class="w">        </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">SEC_BIN</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
<span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">rc0</span><span class="o">.</span><span class="n">d</span><span class="w">        </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">SEC_BIN</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
<span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">rc1</span><span class="o">.</span><span class="n">d</span><span class="w">        </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">SEC_BIN</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
<span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">rc2</span><span class="o">.</span><span class="n">d</span><span class="w">        </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">SEC_BIN</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
<span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">rc3</span><span class="o">.</span><span class="n">d</span><span class="w">        </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">SEC_BIN</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
<span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">rc4</span><span class="o">.</span><span class="n">d</span><span class="w">        </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">SEC_BIN</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
<span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">rc5</span><span class="o">.</span><span class="n">d</span><span class="w">        </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">SEC_BIN</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
<span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">rc6</span><span class="o">.</span><span class="n">d</span><span class="w">        </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">SEC_BIN</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
<span class="p">}</span>

<span class="p">(</span>
<span class="n">rulename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Root file-system executables&quot;</span><span class="p">,</span>
<span class="n">severity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">SIG_HI</span><span class="p">)</span>
<span class="p">)</span>
<span class="p">{</span>
<span class="o">/</span><span class="n">bin</span><span class="w">            </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">SEC_BIN</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
<span class="o">/</span><span class="n">sbin</span><span class="w">            </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">SEC_BIN</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">#</span>
<span class="c1"># Critical Libraries</span>
<span class="c1">#</span>
<span class="p">(</span>
<span class="n">rulename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Root file-system libraries&quot;</span><span class="p">,</span>
<span class="n">severity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">SIG_HI</span><span class="p">)</span>
<span class="p">)</span>
<span class="p">{</span>
<span class="o">/</span><span class="n">lib</span><span class="w">            </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">SEC_BIN</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">#</span>
<span class="c1"># Login and Privilege Raising Programs</span>
<span class="c1">#</span>
<span class="p">(</span>
<span class="n">rulename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Security Control&quot;</span><span class="p">,</span>
<span class="n">severity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">SIG_MED</span><span class="p">)</span>
<span class="p">)</span>
<span class="p">{</span>
<span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">passwd</span><span class="w">        </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">SEC_CONFIG</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
<span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">shadow</span><span class="w">        </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">SEC_CONFIG</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
<span class="p">}</span>
<span class="p">{</span>
<span class="c1">#/var/lock        -&gt; $(SEC_CONFIG) ;</span>
<span class="c1">#/var/run        -&gt; $(SEC_CONFIG) ; # daemon PIDs</span>
<span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span><span class="w">        </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">SEC_CONFIG</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
<span class="p">}</span>

<span class="c1"># These files change the behavior of the root account</span>
<span class="p">(</span>
<span class="n">rulename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Root config files&quot;</span><span class="p">,</span>
<span class="n">severity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span>
<span class="p">)</span>
<span class="p">{</span>
<span class="o">/</span><span class="n">root</span><span class="w">                </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">SEC_CRIT</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="c1"># Catch all additions to /root</span>
<span class="c1">#/root/mail            -&gt; $(SEC_CONFIG) ;</span>
<span class="c1">#/root/Mail            -&gt; $(SEC_CONFIG) ;</span>
<span class="o">/</span><span class="n">root</span><span class="o">/.</span><span class="n">xsession</span><span class="o">-</span><span class="n">errors</span><span class="w">        </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">SEC_CONFIG</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
<span class="c1">#/root/.xauth            -&gt; $(SEC_CONFIG) ;</span>
<span class="c1">#/root/.tcshrc            -&gt; $(SEC_CONFIG) ;</span>
<span class="c1">#/root/.sawfish            -&gt; $(SEC_CONFIG) ;</span>
<span class="c1">#/root/.pinerc            -&gt; $(SEC_CONFIG) ;</span>
<span class="c1">#/root/.mc            -&gt; $(SEC_CONFIG) ;</span>
<span class="c1">#/root/.gnome_private        -&gt; $(SEC_CONFIG) ;</span>
<span class="c1">#/root/.gnome-desktop        -&gt; $(SEC_CONFIG) ;</span>
<span class="c1">#/root/.gnome            -&gt; $(SEC_CONFIG) ;</span>
<span class="c1">#/root/.esd_auth            -&gt; $(SEC_CONFIG) ;</span>
<span class="c1">#    /root/.elm            -&gt; $(SEC_CONFIG) ;</span>
<span class="c1">#/root/.cshrc                -&gt; $(SEC_CONFIG) ;</span>
<span class="c1">#/root/.bashrc            -&gt; $(SEC_CONFIG) ;</span>
<span class="c1">#/root/.bash_profile        -&gt; $(SEC_CONFIG) ;</span>
<span class="c1">#    /root/.bash_logout        -&gt; $(SEC_CONFIG) ;</span>
<span class="c1">#/root/.bash_history        -&gt; $(SEC_CONFIG) ;</span>
<span class="c1">#/root/.amandahosts        -&gt; $(SEC_CONFIG) ;</span>
<span class="c1">#/root/.addressbook.lu        -&gt; $(SEC_CONFIG) ;</span>
<span class="c1">#/root/.addressbook        -&gt; $(SEC_CONFIG) ;</span>
<span class="c1">#/root/.Xresources        -&gt; $(SEC_CONFIG) ;</span>
<span class="c1">#/root/.Xauthority        -&gt; $(SEC_CONFIG) -i ; # Changes Inode number on login</span>
<span class="o">/</span><span class="n">root</span><span class="o">/.</span><span class="n">ICEauthority</span><span class="w">            </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">SEC_CONFIG</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">#</span>
<span class="c1"># Critical devices</span>
<span class="c1">#</span>
<span class="p">(</span>
<span class="n">rulename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Devices &amp; Kernel information&quot;</span><span class="p">,</span>
<span class="n">severity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">$</span><span class="p">(</span><span class="n">SIG_HI</span><span class="p">),</span>
<span class="p">)</span>
<span class="p">{</span>
<span class="c1">#/dev        -&gt; $(Device) ;</span>
<span class="c1">#/proc        -&gt; $(Device) ;</span>
<span class="p">}</span>
</code></pre></div>

<h4>tripwire 报告</h4>
<p><strong>tripwire-check</strong> 命令检查 twpol.txt 文件并基于此文件生成 tripwire 报告如下。如果 twpol.txt 中有任何错误，tripwire 不会生成报告。</p>
<p><img alt="tripwire report" src="/data/attachment/album/201604/03/104138flllxa2az2vls2zv.png"></p>
<p><strong>文本形式报告</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">root</span><span class="err">@</span><span class="n">VMdebian</span><span class="p">:</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">labadmin</span><span class="c1"># tripwire --check</span>

<span class="n">Parsing</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="n">file</span><span class="p">:</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">tripwire</span><span class="o">/</span><span class="n">tw</span><span class="o">.</span><span class="n">pol</span>

<span class="o">***</span><span class="w"> </span><span class="n">Processing</span><span class="w"> </span><span class="n">Unix</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="n">System</span><span class="w"> </span><span class="o">***</span>

<span class="n">Performing</span><span class="w"> </span><span class="n">integrity</span><span class="w"> </span><span class="n">check</span><span class="o">...</span>

<span class="n">Wrote</span><span class="w"> </span><span class="n">report</span><span class="w"> </span><span class="n">file</span><span class="p">:</span><span class="w"> </span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">tripwire</span><span class="o">/</span><span class="n">report</span><span class="o">/</span><span class="n">VMdebian</span><span class="o">-</span><span class="mi">20151024</span><span class="o">-</span><span class="mf">122322.</span><span class="n">twr</span>

<span class="n">Open</span><span class="w"> </span><span class="n">Source</span><span class="w"> </span><span class="n">tripwire</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="w"> </span><span class="mf">2.4</span><span class="o">.</span><span class="mf">2.2</span><span class="w"> </span><span class="n">Integrity</span><span class="w"> </span><span class="n">Check</span><span class="w"> </span><span class="n">Report</span>

<span class="n">Report</span><span class="w"> </span><span class="n">generated</span><span class="w"> </span><span class="n">by</span><span class="p">:</span><span class="w">         </span><span class="n">root</span>

<span class="n">Report</span><span class="w"> </span><span class="n">created</span><span class="w"> </span><span class="n">on</span><span class="p">:</span><span class="w">           </span><span class="n">Sat</span><span class="w"> </span><span class="n">Oct</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="mi">12</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">22</span><span class="w"> </span><span class="mi">2015</span>

<span class="n">Database</span><span class="w"> </span><span class="n">last</span><span class="w"> </span><span class="n">updated</span><span class="w"> </span><span class="n">on</span><span class="p">:</span><span class="w">     </span><span class="n">Never</span>

<span class="n">Report</span><span class="w"> </span><span class="n">Summary</span><span class="p">:</span>

<span class="o">=========================================================</span>

<span class="n">Host</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w">                   </span><span class="n">VMdebian</span>

<span class="n">Host</span><span class="w"> </span><span class="n">IP</span><span class="w"> </span><span class="n">address</span><span class="p">:</span><span class="w">             </span><span class="mf">127.0</span><span class="o">.</span><span class="mf">1.1</span>

<span class="n">Host</span><span class="w"> </span><span class="n">ID</span><span class="p">:</span><span class="w">                     </span><span class="n">None</span>

<span class="n">Policy</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">used</span><span class="p">:</span><span class="w">             </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">tripwire</span><span class="o">/</span><span class="n">tw</span><span class="o">.</span><span class="n">pol</span>

<span class="n">Configuration</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">used</span><span class="p">:</span><span class="w">     </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">tripwire</span><span class="o">/</span><span class="n">tw</span><span class="o">.</span><span class="n">cfg</span>

<span class="n">Database</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">used</span><span class="p">:</span><span class="w">           </span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">tripwire</span><span class="o">/</span><span class="n">VMdebian</span><span class="o">.</span><span class="n">twd</span>

<span class="n">Command</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">used</span><span class="p">:</span><span class="w">           </span><span class="n">tripwire</span><span class="w"> </span><span class="o">--</span><span class="n">check</span>

<span class="o">=========================================================</span>

<span class="n">Rule</span><span class="w"> </span><span class="n">Summary</span><span class="p">:</span>

<span class="o">=========================================================</span>

<span class="o">-------------------------------------------------------------------------------</span>

<span class="n">Section</span><span class="p">:</span><span class="w"> </span><span class="n">Unix</span><span class="w"> </span><span class="n">File</span><span class="w"> </span><span class="n">System</span>

<span class="o">-------------------------------------------------------------------------------</span>

<span class="n">Rule</span><span class="w"> </span><span class="n">Name</span><span class="w">                       </span><span class="n">Severity</span><span class="w"> </span><span class="n">Level</span><span class="w">   </span><span class="n">Added</span><span class="w">   </span><span class="n">Removed</span><span class="w"> </span><span class="n">Modified</span>

<span class="o">---------</span><span class="w">                       </span><span class="o">--------------</span><span class="w">   </span><span class="o">-----</span><span class="w">   </span><span class="o">-------</span><span class="w"> </span><span class="o">--------</span>

<span class="n">Other</span><span class="w"> </span><span class="n">binaries</span><span class="w">                 </span><span class="mi">66</span><span class="w">               </span><span class="mi">0</span><span class="w">       </span><span class="mi">0</span><span class="w">       </span><span class="mi">0</span><span class="w">      </span>

<span class="n">tripwire</span><span class="w"> </span><span class="n">Binaries</span><span class="w">               </span><span class="mi">100</span><span class="w">               </span><span class="mi">0</span><span class="w">       </span><span class="mi">0</span><span class="w">       </span><span class="mi">0</span><span class="w">      </span>

<span class="n">Other</span><span class="w"> </span><span class="n">libraries</span><span class="w">                 </span><span class="mi">66</span><span class="w">               </span><span class="mi">0</span><span class="w">       </span><span class="mi">0</span><span class="w">       </span><span class="mi">0</span><span class="w">      </span>

<span class="n">Root</span><span class="w"> </span><span class="n">file</span><span class="o">-</span><span class="n">system</span><span class="w"> </span><span class="n">executables</span><span class="w">   </span><span class="mi">100</span><span class="w">               </span><span class="mi">0</span><span class="w">       </span><span class="mi">0</span><span class="w">       </span><span class="mi">0</span><span class="w">      </span>

<span class="n">tripwire</span><span class="w"> </span><span class="n">Data</span><span class="w"> </span><span class="n">Files</span><span class="w">             </span><span class="mi">100</span><span class="w">               </span><span class="mi">0</span><span class="w">       </span><span class="mi">0</span><span class="w">       </span><span class="mi">0</span><span class="w">      </span>

<span class="n">System</span><span class="w"> </span><span class="n">boot</span><span class="w"> </span><span class="n">changes</span><span class="w">             </span><span class="mi">100</span><span class="w">               </span><span class="mi">0</span><span class="w">       </span><span class="mi">0</span><span class="w">       </span><span class="mi">0</span><span class="w">      </span>

<span class="p">(</span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span><span class="p">)</span>

<span class="n">Root</span><span class="w"> </span><span class="n">file</span><span class="o">-</span><span class="n">system</span><span class="w"> </span><span class="n">libraries</span><span class="w">     </span><span class="mi">100</span><span class="w">               </span><span class="mi">0</span><span class="w">       </span><span class="mi">0</span><span class="w">       </span><span class="mi">0</span><span class="w">      </span>

<span class="p">(</span><span class="o">/</span><span class="n">lib</span><span class="p">)</span>

<span class="n">Critical</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">boot</span><span class="w"> </span><span class="n">files</span><span class="w">     </span><span class="mi">100</span><span class="w">               </span><span class="mi">0</span><span class="w">       </span><span class="mi">0</span><span class="w">       </span><span class="mi">0</span><span class="w">      </span>

<span class="n">Other</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">files</span><span class="w">       </span><span class="mi">66</span><span class="w">               </span><span class="mi">0</span><span class="w">       </span><span class="mi">0</span><span class="w">       </span><span class="mi">0</span><span class="w">      </span>

<span class="p">(</span><span class="o">/</span><span class="n">etc</span><span class="p">)</span>

<span class="n">Boot</span><span class="w"> </span><span class="n">Scripts</span><span class="w">                   </span><span class="mi">100</span><span class="w">               </span><span class="mi">0</span><span class="w">       </span><span class="mi">0</span><span class="w">       </span><span class="mi">0</span><span class="w">      </span>

<span class="n">Security</span><span class="w"> </span><span class="n">Control</span><span class="w">               </span><span class="mi">66</span><span class="w">               </span><span class="mi">0</span><span class="w">       </span><span class="mi">0</span><span class="w">       </span><span class="mi">0</span><span class="w">      </span>

<span class="n">Root</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="n">files</span><span class="w">               </span><span class="mi">100</span><span class="w">               </span><span class="mi">0</span><span class="w">       </span><span class="mi">0</span><span class="w">       </span><span class="mi">0</span><span class="w">      </span>

<span class="n">Invariant</span><span class="w"> </span><span class="n">Directories</span><span class="w">           </span><span class="mi">66</span><span class="w">               </span><span class="mi">0</span><span class="w">       </span><span class="mi">0</span><span class="w">       </span><span class="mi">0</span><span class="w">      </span>

<span class="n">Total</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="n">scanned</span><span class="p">:</span><span class="w"> </span><span class="mi">25943</span>

<span class="n">Total</span><span class="w"> </span><span class="n">violations</span><span class="w"> </span><span class="n">found</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span>

<span class="o">=========================</span><span class="nb nb-Type">Object</span><span class="w"> </span><span class="n">Summary</span><span class="p">:</span><span class="o">================================</span>

<span class="o">-------------------------------------------------------------------------------</span>

<span class="c1"># Section: Unix File System</span>

<span class="o">-------------------------------------------------------------------------------</span>

<span class="n">No</span><span class="w"> </span><span class="n">violations</span><span class="o">.</span>

<span class="o">===========================</span><span class="n">Error</span><span class="w"> </span><span class="n">Report</span><span class="p">:</span><span class="o">=====================================</span>

<span class="n">No</span><span class="w"> </span><span class="n">Errors</span>

<span class="o">-------------------------------------------------------------------------------</span>

<span class="o">***</span><span class="w"> </span><span class="n">End</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">report</span><span class="w"> </span><span class="o">***</span>

<span class="n">Open</span><span class="w"> </span><span class="n">Source</span><span class="w"> </span><span class="n">tripwire</span><span class="w"> </span><span class="mf">2.4</span><span class="w"> </span><span class="n">Portions</span><span class="w"> </span><span class="n">copyright</span><span class="w"> </span><span class="mi">2000</span><span class="w"> </span><span class="n">tripwire</span><span class="p">,</span><span class="w"> </span><span class="n">Inc</span><span class="o">.</span><span class="w"> </span><span class="n">tripwire</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">registered</span>

<span class="n">trademark</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">tripwire</span><span class="p">,</span><span class="w"> </span><span class="n">Inc</span><span class="o">.</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="n">software</span><span class="w"> </span><span class="n">comes</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">ABSOLUTELY</span><span class="w"> </span><span class="n">NO</span><span class="w"> </span><span class="n">WARRANTY</span><span class="p">;</span>

<span class="k">for</span><span class="w"> </span><span class="n">details</span><span class="w"> </span><span class="n">use</span><span class="w"> </span><span class="o">--</span><span class="n">version</span><span class="o">.</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">free</span><span class="w"> </span><span class="n">software</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">redistributed</span>

<span class="ow">or</span><span class="w"> </span><span class="n">modified</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">under</span><span class="w"> </span><span class="n">certain</span><span class="w"> </span><span class="n">conditions</span><span class="p">;</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">COPYING</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">details</span><span class="o">.</span>

<span class="n">All</span><span class="w"> </span><span class="n">rights</span><span class="w"> </span><span class="n">reserved</span><span class="o">.</span>

<span class="n">Integrity</span><span class="w"> </span><span class="n">check</span><span class="w"> </span><span class="n">complete</span><span class="o">.</span>
</code></pre></div>

<h3>总结</h3>
<p>本篇中，我们学习安装配置开源入侵检测软件 tripwire。首先生成基础数据库并通过比较检测出任何改动（文件/文件夹）。然而，tripwire 并不是实时监测的 IDS。</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>