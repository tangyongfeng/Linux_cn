<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>'Bash 基础知识系列 #8：For、While 和 Until 循环'</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: Abhishek Prakash 在 Bash 基础知识系列的倒数第二章节，学习 for、while 和 until 循环。 循环是任何编程语言中的一个强大功能。如果你还不知道 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li class="active"><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2023/08/bash-ji-chu-zhi-shi-xi-lie-8for-while-he-until-xun-huan.html" rel="bookmark"
           title="Permalink to 'Bash 基础知识系列 #8：For、While 和 Until 循环'">'Bash 基础知识系列 #8：For、While 和 Until 循环'</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2023-08-21T10:08:12+02:00">
                Published: Mon 21 August 2023
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/ji-zhu">技术</a>.</p>

</footer><!-- /.post-info -->      <p>Author: Abhishek Prakash</p>
<p><img alt="" src="/data/attachment/album/202308/21/100731qmt2cmxnyub9xm62.jpg"></p>
<blockquote>
<p>在 Bash 基础知识系列的倒数第二章节，学习 <code>for</code>、<code>while</code> 和 <code>until</code> 循环。</p>
</blockquote>
<p>循环是任何编程语言中的一个强大功能。如果你还不知道，循环其实是一种根据某些条件重复代码的方式。</p>
<p>例如，想象一下你需要打印从 1 到 10 的数字。你可以使用 <code>echo</code> 命令写十次，但那太原始了。你使用一个循环，在 3 到 4 行代码内，就能完成。</p>
<p>这是我能想到的最简单的例子。我将在讨论 Bash 循环时，分享一些实际有用的例子。</p>
<p>在 Bash 中有三种类型的循环：</p>
<ul>
<li><code>for</code></li>
<li><code>while</code></li>
<li><code>until</code></li>
</ul>
<p>我将在教程中展示所有三种类型的循环。让我们从最常见的一种开始。</p>
<h3>Bash 中的 For 循环</h3>
<p>以下是 Bash 中的 <code>for</code> 循环语法：</p>
<div class="highlight"><pre><span></span><code><span class="k">for</span><span class="w"> </span><span class="nv">arg</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">LIST</span><span class="c1">; do</span>
<span class="w">    </span><span class="nv">commands</span>
<span class="nv">done</span>
</code></pre></div>

<p>这里的 <code>LIST</code> 可能是一个数组或者一个项目列表。<a href="https://linuxhandbook.com/brace-expansion/?ref=itsfoss.com">括号扩展</a> 也是进行循环的常用手段。</p>
<p>考虑一下我在开始提到的最简单的场景。让我们使用 <code>for</code> 循环打印从 1 到 10 的数字：</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="k">for</span><span class="w"> </span>num<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="o">{</span><span class="m">1</span>..10<span class="o">}</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$num</span>
<span class="k">done</span>
</code></pre></div>

<p>如果你运行它，你应该会看到像这样的输出：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>./for-loop.sh
<span class="m">1</span>
<span class="m">2</span>
<span class="m">3</span>
<span class="m">4</span>
<span class="m">5</span>
<span class="m">6</span>
<span class="m">7</span>
<span class="m">8</span>
<span class="m">9</span>
<span class="m">10</span>
</code></pre></div>

<p>你也可以使用 <code>for num in 1 2 3 4 5 6 7 8 9 10; do</code> ，但是使用括号扩展使得代码看起来更短且更智能。</p>
<p><code>{..}</code> 是用于扩展模式的。你使用 <code>{d..h}</code> ，它等同于 <code>d e f g h</code> 。关于括号扩展的更多信息，可以在这篇文章中找到。</p>
<blockquote>
<p><strong><a href="https://linuxhandbook.com/brace-expansion/?ref=itsfoss.com">在 Bash 中使用括号扩展</a></strong></p>
<p>? 如果你熟悉 C 语言编程，你可能会喜欢在 bash 中使用 C 风格的 for 循环：</p>
<p>```
for ((i = 0 ; i &lt; 10 ; i++)); do
  echo $i
done</p>
<p>```</p>
</blockquote>
<p>让我们看另一个例子，显示 <a href="https://itsfoss.com/bash-arrays/">Bash 数组</a> 的所有内容：</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="nv">distros</span><span class="o">=(</span>Ubuntu<span class="w"> </span>Fedora<span class="w"> </span>Debian<span class="w"> </span>Alpine<span class="o">)</span>

<span class="k">for</span><span class="w"> </span>i<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">distros</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$i</span>
<span class="k">done</span>
</code></pre></div>

<p>如果你运行脚本，它将显示数组中定义的所有发行版：</p>
<div class="highlight"><pre><span></span><code>Ubuntu
Fedora
Debian
Alpine
</code></pre></div>

<h3>Bash 中的 While 循环</h3>
<p><code>while</code> 循环测试一个条件，然后只要条件为真，就继续循环。</p>
<div class="highlight"><pre><span></span><code><span class="k">while</span><span class="w"> </span>[<span class="w"> </span><span class="nv">condition</span><span class="w"> </span>]<span class="c1">; do</span>
<span class="w">    </span><span class="nv">commands</span>
<span class="nv">done</span>
</code></pre></div>

<p>如果你考虑前一个例子，它可以使用 <code>while</code> 循环进行重写：</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="nv">num</span><span class="o">=</span><span class="m">1</span>
<span class="k">while</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$num</span><span class="w"> </span>-le<span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$num</span>
<span class="w">    </span><span class="nv">num</span><span class="o">=</span><span class="k">$((</span><span class="nv">$num</span><span class="o">+</span><span class="m">1</span><span class="k">))</span>
<span class="k">done</span>
</code></pre></div>

<p>如你所见，你首先需要将变量 <code>num</code> 定义为 1，然后在循环体内，你增加 <code>num</code> 的值。只要 <code>num</code> 小于或等于 10，while 循环就会检查条件并运行脚本。</p>
<p>因此，现在运行脚本将会显示出和之前 <code>for</code> 循环中看到的完全相同的结果。</p>
<div class="highlight"><pre><span></span><code><span class="mf">1</span>
<span class="mf">2</span>
<span class="mf">3</span>
<span class="mf">4</span>
<span class="mf">5</span>
<span class="mf">6</span>
<span class="mf">7</span>
<span class="mf">8</span>
<span class="mf">9</span>
<span class="mf">10</span>
</code></pre></div>

<p>让我们看另一个例子。这是一个 <a href="https://itsfoss.com/bash-pass-arguments/">Bash 脚本，它接受一个数字作为参数</a> 并显示该表。</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Table for </span><span class="nv">$1</span><span class="s2"> is:&quot;</span>
<span class="nv">index</span><span class="o">=</span><span class="m">1</span>
<span class="k">while</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$index</span><span class="w"> </span>-le<span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="k">$((</span><span class="nv">$1</span><span class="o">*</span><span class="nv">$index</span><span class="k">))</span>
<span class="w">    </span><span class="nv">index</span><span class="o">=</span><span class="k">$((</span><span class="nv">$index</span><span class="o">+</span><span class="m">1</span><span class="k">))</span>
<span class="k">done</span>
</code></pre></div>

<p>如果你对 <code>$1</code> 的使用感到困惑，它代表传递给脚本的第一个参数。更多的细节可以参考这个系列的 <a href="https://itsfoss.com/bash-pass-arguments/">第三章</a>。</p>
<p>如果你运行这个脚本，它应该会显示以下的输出：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>./table.sh<span class="w"> </span><span class="m">2</span>
Table<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m">2</span><span class="w"> </span>is:
<span class="m">2</span>
<span class="m">4</span>
<span class="m">6</span>
<span class="m">8</span>
<span class="m">10</span>
<span class="m">12</span>
<span class="m">14</span>
<span class="m">16</span>
<span class="m">18</span>
<span class="m">20</span>
</code></pre></div>

<h3>Bash 中的 Until 循环</h3>
<p>这是一个使用较少的循环格式。它的行为和 <code>while</code> 循环类似。这里的区别是，循环运行直到它检查的条件为真为止。意味着为了在循环中执行代码，<code>[ ]</code> 中的条件必须为假。</p>
<p>我马上会解释一下。让我们先看一下它的语法。</p>
<div class="highlight"><pre><span></span><code><span class="k">until</span><span class="w"> </span>[<span class="w"> </span><span class="nv">condition</span><span class="w"> </span>]<span class="c1">; do</span>
<span class="w">    </span><span class="nv">commands</span>
<span class="nv">done</span>
</code></pre></div>

<p>现在，如果我要使用相同的示例，即使用 <code>until</code> 循环打印从 1 到 10 的数字，它看起来会是这样：</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="nv">num</span><span class="o">=</span><span class="m">1</span>
<span class="k">until</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$num</span><span class="w"> </span>-gt<span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$num</span>
<span class="w">    </span><span class="nv">num</span><span class="o">=</span><span class="k">$((</span><span class="nv">$num</span><span class="o">+</span><span class="m">1</span><span class="k">))</span>
<span class="k">done</span>
</code></pre></div>

<p>区别在于条件；其余部分保持不变。</p>
<ul>
<li>当变量 <code>num</code> 小于或等于 10 时，while 循环就会运行。<code>[ ]</code> 中的条件必须为真，循环才会执行。</li>
<li>知道变量 <code>num</code> 变得大于 10 时，until 循环才会运行。<code>[ ]</code> 中的条件必须为假，循环才会执行。</li>
</ul>
<p>这都是做同样事情的两种不同方式。<code>while</code> 更受欢迎，因为你会在大多数编程语言中找到类似 <code>while</code> 的循环语法。</p>
<h3>?️ 练习时间</h3>
<p>那是有趣的。现在是做一些练习的时候了。</p>
<p><strong>练习 1</strong>：编写一个脚本，该脚本接受一个数字作为参数并打印其表格。如果脚本在没有参数的情况下运行，你的脚本还应显示一个消息。</p>
<p><strong>预期输出</strong>：</p>
<div class="highlight"><pre><span></span><code>$: ./table.sh
You forgot to enter a number

$: ./table.sh 3
3
6
9
12
15
18
21
24
27
30
</code></pre></div>

<p><strong>练习 2</strong> : 编写一个脚本，列出目录 <code>/var</code> 中的所有文件。</p>
<p><strong>提示</strong> : 对于循环，使用 <code>/var/*</code> 作为 “列表”。</p>
<p>Bash 基础知识系列即将结束。作为该系列的最后一章，你将在下周学习在 Bash 脚本中使用函数。敬请期待。</p>
<p><em>（题图：MJ/945241d6-6a73-432c-9bcd-e0948b3fadc0）</em></p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>