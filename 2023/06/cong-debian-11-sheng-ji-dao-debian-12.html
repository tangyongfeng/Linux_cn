<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>从 Debian 11 升级到 Debian 12</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: Arindam 以下是如何从 Debian 11 升级到 Debian 12 “Bookworm” 的步骤。 Debian 12 Bookworm 已经发布。如果你正在运行 Debian 11 “Bullseye”，你可以计划现在升级你的台式机 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li class="active"><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2023/06/cong-debian-11-sheng-ji-dao-debian-12.html" rel="bookmark"
           title="Permalink to 从 Debian 11 升级到 Debian 12">从 Debian 11 升级到 Debian 12</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2023-06-13T09:55:00+02:00">
                Published: Tue 13 June 2023
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/ji-zhu">技术</a>.</p>

</footer><!-- /.post-info -->      <p>Author: Arindam</p>
<p><img alt="" src="/data/attachment/album/202306/13/095427caykwtqw8fay944z.jpg"></p>
<blockquote>
<p>以下是如何从 Debian 11 升级到 Debian 12 “Bookworm” 的步骤。</p>
</blockquote>
<p>Debian 12 Bookworm 已经发布。如果你正在运行 Debian 11 “Bullseye”，你可以计划现在升级你的台式机或服务器。但是，建议你等待 Debian “Bookworm” 的第一个小版本，即 12.1 版本，再进行关键服务器升级。</p>
<p>话虽如此，如果你想了解 Debian 12 的新特性，可以查看 <a href="/article-15776-1.html">这篇文章</a>。以下是详细的升级步骤：</p>
<h3>从 Debian 11 升级到 Debian 12</h3>
<p>无论你运行的是 Debian 服务器还是任何桌面版本，请确保备份关键数据。例如，你可能需要为桌面文档进行备份。如果是服务器，请记录正在运行的服务。你可以使用 <code>rsync</code> 或其他实用工具来完成此操作。</p>
<p>Debian 12 引入了一个名为 <code>non-free-firmware</code> 的新仓库，用于专有驱动程序和软件包。如果你使用任何“闭源”的网络、显示、图形或其他驱动程序，你可能需要在升级后进行配置。</p>
<p>对于网络驱动程序，请确保在某个地方安全地记录 <code>/etc/network/interfaces</code> 和 <code>/etc/resolv.conf</code> 文件的内容。如果在升级完成后失去了网络连接，可以 <a href="https://wiki.debian.org/NetworkConfiguration">按照这个指南</a> 轻松设置它。</p>
<p>从命令提示符运行以下命令，以确保 Debian 11 更新了安全和其他软件包：</p>
<div class="highlight"><pre><span></span><code>sudo apt update
sudo apt upgrade
sudo apt full-upgrade
sudo apt autoremove
</code></pre></div>

<p>完成上述命令后，重新启动 Debian 11 系统：</p>
<div class="highlight"><pre><span></span><code>sudo systemctl reboot
</code></pre></div>

<p>记下关于 Debian 11 的几个信息。这对于服务器很重要。它们包括内核版本和 Debian 版本。这是因为升级后，你可以验证下面的相同命令以确保升级成功。</p>
<p>例如，我尝试升级的系统是 Debian 11.7，内核版本为 5.10。</p>
<div class="highlight"><pre><span></span><code>uname -mr
</code></pre></div>

<p>示例输出：</p>
<div class="highlight"><pre><span></span><code><span class="mf">5.10.0</span><span class="o">-</span><span class="mf">23</span><span class="o">-</span><span class="n">amd64</span><span class="w">   </span><span class="n">x86_64</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>cat /etc/debian_version
</code></pre></div>

<p>示例输出：</p>
<div class="highlight"><pre><span></span><code><span class="mf">11.7</span>
</code></pre></div>

<p>将 APT 源文件备份到你选择的任何目录：</p>
<div class="highlight"><pre><span></span><code>sudo cp -v /etc/apt/sources.list /home/arindam/
sudo cp -vr /etc/apt/sources.list.d/ /home/arindam/
</code></pre></div>

<p>打开 <code>/etc/apt/sources.list</code> 文件，并将 Debian 12 的代号 <code>bookworm</code> 添加到该文件中，替换 <code>bullseye</code>。</p>
<div class="highlight"><pre><span></span><code>sudo nano /etc/apt/sources.list
</code></pre></div>

<p>以下是我测试系统中的 <code>/etc/apt/sources.list</code> 文件<strong>更改之前</strong>的内容作为参考：</p>
<div class="highlight"><pre><span></span><code><span class="k">deb</span><span class="w"> </span><span class="s">http://deb.debian.org/debian/</span><span class="w"> </span><span class="kp">bullseye</span><span class="w"> </span><span class="kp">main</span>
<span class="k">deb-src</span><span class="w"> </span><span class="s">http://deb.debian.org/debian/</span><span class="w"> </span><span class="kp">bullseye</span><span class="w"> </span><span class="kp">main</span>

<span class="k">deb</span><span class="w"> </span><span class="s">http://security.debian.org/debian-security</span><span class="w"> </span><span class="kp">bullseye-security</span><span class="w"> </span><span class="kp">main</span>
<span class="k">deb-src</span><span class="w"> </span><span class="s">http://security.debian.org/debian-security</span><span class="w"> </span><span class="kp">bullseye-security</span><span class="w"> </span><span class="kp">main</span>

<span class="k">deb</span><span class="w"> </span><span class="s">http://deb.debian.org/debian/</span><span class="w"> </span><span class="kp">bullseye-updates</span><span class="w"> </span><span class="kp">main</span>
<span class="k">deb-src</span><span class="w"> </span><span class="s">http://deb.debian.org/debian/</span><span class="w"> </span><span class="kp">bullseye-updates</span><span class="w"> </span><span class="kp">main</span>
</code></pre></div>

<p>以下是<strong>更改后</strong>的 <code>/etc/apt/sources.list</code> 文件。以下镜像网址是默认设置。如果你使用不同的 Debian 镜像，请不要更改它们：</p>
<div class="highlight"><pre><span></span><code><span class="k">deb</span><span class="w"> </span><span class="s">http://deb.debian.org/debian/</span><span class="w"> </span><span class="kp">bookworm</span><span class="w"> </span><span class="kp">main</span>
<span class="k">deb-src</span><span class="w"> </span><span class="s">http://deb.debian.org/debian/</span><span class="w"> </span><span class="kp">bookworm</span><span class="w"> </span><span class="kp">main</span>

<span class="k">deb</span><span class="w"> </span><span class="s">http://security.debian.org/debian-security</span><span class="w"> </span><span class="kp">bookworm-security</span><span class="w"> </span><span class="kp">main</span>
<span class="k">deb-src</span><span class="w"> </span><span class="s">http://security.debian.org/debian-security</span><span class="w"> </span><span class="kp">bookworm-security</span><span class="w"> </span><span class="kp">main</span>

<span class="k">deb</span><span class="w"> </span><span class="s">http://deb.debian.org/debian/</span><span class="w"> </span><span class="kp">bookworm-updates</span><span class="w"> </span><span class="kp">main</span>
<span class="k">deb-src</span><span class="w"> </span><span class="s">http://deb.debian.org/debian/</span><span class="w"> </span><span class="kp">bookworm-updates</span><span class="w"> </span><span class="kp">main</span>

<span class="k">deb</span><span class="w"> </span><span class="s">http://deb.debian.org/debian</span><span class="w"> </span><span class="kp">bookworm</span><span class="w"> </span><span class="kp">non-free</span><span class="w"> </span><span class="kp">non-free-firmware</span>
<span class="k">deb-src</span><span class="w"> </span><span class="s">http://deb.debian.org/debian</span><span class="w"> </span><span class="kp">bookworm</span><span class="w"> </span><span class="kp">non-free</span><span class="w"> </span><span class="kp">non-free-firmware</span>

<span class="k">deb</span><span class="w"> </span><span class="s">http://deb.debian.org/debian-security</span><span class="w"> </span><span class="kp">bookworm-security</span><span class="w"> </span><span class="kp">non-free</span><span class="w"> </span><span class="kp">non-free-firmware</span>
<span class="k">deb-src</span><span class="w"> </span><span class="s">http://deb.debian.org/debian-security</span><span class="w"> </span><span class="kp">bookworm-security</span><span class="w"> </span><span class="kp">non-free</span><span class="w"> </span><span class="kp">non-free-firmware</span>

<span class="k">deb</span><span class="w"> </span><span class="s">http://deb.debian.org/debian</span><span class="w"> </span><span class="kp">bookworm-updates</span><span class="w"> </span><span class="kp">non-free</span><span class="w"> </span><span class="kp">non-free-firmware</span>
<span class="k">deb-src</span><span class="w"> </span><span class="s">http://deb.debian.org/debian</span><span class="w"> </span><span class="kp">bookworm-updates</span><span class="w"> </span><span class="kp">non-free</span><span class="w"> </span><span class="kp">non-free-firmware</span>
</code></pre></div>

<p><img alt="更新源文件" src="/data/attachment/album/202306/13/095634s3ein79rmiqytn6o.jpg"></p>
<p><strong>注意</strong>：从 Debian 12 “Bookworm” 开始，Debian 团队创建了一个新的仓库 <code>non-free-firmware</code> 来打包非自由的软件包。因此，在上面的示例中最后三个部分中也包含了它们。</p>
<p>保存文件并退出。</p>
<p>打开终端并运行以下命令以开始升级过程：</p>
<div class="highlight"><pre><span></span><code>sudo apt update
sudo apt full-upgrade
</code></pre></div>

<p><img alt="升级过程" src="/data/attachment/album/202306/13/095643hj2qnr3pzms9842n.jpg"></p>
<p><img alt="Debian 12 升级过程进行中" src="/data/attachment/album/202306/13/095652w765w5gbba0e6ew4.jpg"></p>
<p>在升级过程中，安装程序可能会要求你重新启动几个服务。仔细阅读消息后点击 “Yes”。另外，如果你看到带有 <code>:</code> 的提示，请按 <code>q</code> 键退出该消息。</p>
<p><img alt="确认服务验证" src="/data/attachment/album/202306/13/095701j6yu5zxyzftp154r.jpg"></p>
<p>等待软件包下载和安装完成。</p>
<p>升级完成后，请重新启动你的 Debian 桌面或服务器：</p>
<div class="highlight"><pre><span></span><code>sudo systemctl reboot
</code></pre></div>

<h3>检查升级状态</h3>
<p>重启后，请验证你是否正在运行 Debian 12。可以使用以下文件检查 Debian 版本：</p>
<div class="highlight"><pre><span></span><code>cat /etc/debian_version
</code></pre></div>

<p>示例输出：</p>
<p><img alt="Debian 12 Bookworm Desktop (Xfce)" src="/data/attachment/album/202306/13/095711bjee5jjelw8erjr9.jpg"></p>
<p>此外，如果你刚刚升级到 Debian 12 服务器，请确保验证正在运行的服务，例如 HTTP、SSH 等。你可以使用以下 <a href="https://www.debugpoint.com/systemd-systemctl-service/">systemd 命令</a> 了解正在运行的服务：</p>
<div class="highlight"><pre><span></span><code><span class="nx">systemctl</span><span class="w"> </span><span class="nx">list</span><span class="o">-</span><span class="nx">units</span><span class="w"> </span><span class="o">--</span><span class="k">type</span><span class="p">=</span><span class="nx">service</span>
</code></pre></div>

<h3>总结和清理</h3>
<p>在确认所有步骤都已完成后，你可能希望运行 <code>apt autoremove</code> 命令来清理不需要的软件包。但是，请在执行此操作时格外小心。</p>
<div class="highlight"><pre><span></span><code>sudo apt --purge autoremove
</code></pre></div>

<p>这就是升级到 Debian 12 的简要步骤。希望你的升级顺利进行。如果你正在关键服务器上运行 Debian 11，请勿立即升级，请等到 Debian 12.1 发布。</p>
<p>有关 Debian 升级的更多信息，请访问 <a href="https://www.debian.org/releases/bookworm/amd64/release-notes/ch-upgrading.en.html">官方文档</a>。</p>
<p>最后，请别忘了告诉我们你的升级情况。</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>