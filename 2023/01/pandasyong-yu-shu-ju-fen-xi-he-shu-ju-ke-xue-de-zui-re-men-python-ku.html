<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>Pandas：用于数据分析和数据科学的最热门 Python 库</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: Phani Kiran Pandas 是一个十分流行的 Python 第三方库。本文介绍了 Pandas 库中的一些特性和函数，并且我们鼓励读者亲手使用 Pandas 库，来解决 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li class="active"><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2023/01/pandasyong-yu-shu-ju-fen-xi-he-shu-ju-ke-xue-de-zui-re-men-python-ku.html" rel="bookmark"
           title="Permalink to Pandas：用于数据分析和数据科学的最热门 Python 库">Pandas：用于数据分析和数据科学的最热门 Python 库</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2023-01-27T16:34:31+01:00">
                Published: Fri 27 January 2023
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/ruan-jian-kai-fa">软件开发</a>.</p>

</footer><!-- /.post-info -->      <p>Author: Phani Kiran</p>
<p><img alt="" src="/data/attachment/album/202301/27/163400o6afgegh0nf4nfec.jpg"></p>
<blockquote>
<p>Pandas 是一个十分流行的 Python 第三方库。本文介绍了 Pandas 库中的一些特性和函数，并且我们鼓励读者亲手使用 Pandas 库，来解决实际的业务问题。</p>
</blockquote>
<p>Pandas 为 Python 中数据分析提供了基础和高级的构建组件。Pandas 库是用于数据分析与数据操作的最强大和最灵活的开源<strong>分析工具</strong>之一，并且它还提供了用于建模和操作表格数据（以行和列组织的数据）的<strong>数据结构</strong>。</p>
<p>Pandas 库有两个主要的数据结构：第一个是 “<ruby> 系列 <rt>  Series </rt></ruby>”，该数据结构能够很方便地从 Python 数组或字典中<strong>按位置或指定的索引名称</strong>来检索数据；第二个是“<ruby> 数据帧 <rt>  DataFrames </rt></ruby>”，该数据结构将数据存储在行和列中。列可以通过列名访问，行通过索引访问。列可以有不同类型的数据，包括列表、字典、序列、数据帧、NumPy 数组等。</p>
<h3>Pandas 库可以处理各种文件格式</h3>
<p>有各种各样的文件格式。用于数据分析的工具必须能够提供处理各种文件格式的方法。</p>
<p>Pandas 可以读取各种文件格式，例如 CSV 文件、JSON 文件、XML 文件、Parquet 文件、SQL 文件，详见下表。</p>
<table>
<thead>
<tr>
<th></th>
<th>写入</th>
<th>读取</th>
</tr>
</thead>
<tbody>
<tr>
<td>CSV 文件</td>
<td><code>to_csv</code> 函数</td>
<td><code>read_csv</code> 函数</td>
</tr>
<tr>
<td>JSON 文件</td>
<td><code>to_json</code> 函数</td>
<td><code>read_json</code> 函数</td>
</tr>
<tr>
<td>Parquet 文件</td>
<td><code>to_parquet</code> 函数</td>
<td><code>read_parquet</code> 函数</td>
</tr>
<tr>
<td>SQL 文件</td>
<td><code>to_sql</code> 函数</td>
<td><code>read_sql</code> 函数，<code>read_sql_query</code> 函数，<code>read_sql_table</code> 函数</td>
</tr>
<tr>
<td>XML 文件</td>
<td><code>to_xml</code> 函数</td>
<td><code>read_xml</code> 函数</td>
</tr>
</tbody>
</table>
<h3>使用 Pandas 进行数据清理</h3>
<p>在现实场景中，很多数据集存在数据缺失、数据格式错误、错误数据或重复数据的情况，如果要对使数据分析更加准确，就需要对这些没有用的数据进行处理。此外，数据还会有需要 <ruby> 屏蔽 <rt>  mask </rt></ruby> 的敏感和机密信息。接下来，Pandas 提供了清理、丢弃、替换、屏蔽等方法，来处理这些坏数据。</p>
<h4>Pandas 清洗空值：</h4>
<p>a. 空行可以使用 <code>df.dropna(inplace=True)</code> 方法来删除。</p>
<p>b. 空值可以使用 <code>df.fillna(&lt;value&gt;, inplace=True)</code> 方法来替换。还可以指定某一个列来替换该列的空数据。</p>
<h4>Pandas 屏蔽数据：</h4>
<p>c. 要屏蔽所有不满足条件 <code>my_list.where(my_list &lt; 5)</code> 的敏感数据的值，可以使用 <code>my_list.mask(my_list &lt; 5)</code>。</p>
<h4>Pandas 清洗重复数据：</h4>
<p>d. 要删除重复数据，可以使用 <code>drop_duplicates()</code> 方法：</p>
<div class="highlight"><pre><span></span><code>df.drop_duplicates(‘&lt;column&gt;’, keep = False)
df.drop_duplicates(‘&lt;column&gt;’, keep = ‘first’)
df.drop_duplicates(‘&lt;column&gt;’, keep = ‘last’)
</code></pre></div>

<h3>使用 Pandas 进行数据分析</h3>
<p>下面的表格列出了 Pandas 中进行数据分析的各种函数，以及其语法。（请注意：<code>df</code> 代表一个 <ruby> 数据帧 <rt>  DataFrame </rt></ruby> 数据结构的实例。）</p>
<table>
<thead>
<tr>
<th>语法</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>df.head(x)</code></td>
<td><code>head()</code> 函数用于读取前面的 x 行，如果不填参数 x，默认返回 5 行</td>
</tr>
<tr>
<td><code>df.tail(x)</code></td>
<td><code>tail()</code> 函数用于读取尾部的 x 行，如果不填参数 x ，默认返回最后 5 行，空行各个字段的值返回 NaN</td>
</tr>
<tr>
<td><code>loc(x:y)</code></td>
<td>Loc 函数返回指定行的数据，也可以对数据进行切片</td>
</tr>
<tr>
<td><code>groupby('&lt;column&gt;')</code></td>
<td>对指定列的数据进行分组</td>
</tr>
<tr>
<td><code>df['column'].sum()</code></td>
<td>计算指定列数据的总和</td>
</tr>
<tr>
<td><code>df['column']. mean()</code></td>
<td>计算指定列数据的算术平均值</td>
</tr>
<tr>
<td><code>df['column'].min()</code></td>
<td>计算指定列数据的最小值</td>
</tr>
<tr>
<td><code>df['column'].max()</code></td>
<td>计算指定列数据的最大值</td>
</tr>
<tr>
<td><code>df.sort_values(['column'])</code></td>
<td>在指定列上根据数值进行排序，默认升序</td>
</tr>
<tr>
<td><code>df.size</code></td>
<td>返回元素的个数，即为行数 * 列数</td>
</tr>
<tr>
<td><code>df.describe</code></td>
<td>返回对各列的统计汇总</td>
</tr>
<tr>
<td><code>pd.crosstab(df['column1'], df['column2'], margins = True)</code></td>
<td>创建 <code>column1</code> 和 <code>column2</code> 的交叉表</td>
</tr>
<tr>
<td><code>df.duplicated([column1, 'column2'])</code></td>
<td>根据 <code>column1</code> 和 <code>column2</code> 中的重复值，返回 <code>True</code> 或 <code>False</code></td>
</tr>
</tbody>
</table>
<h3>Pandas 的优点</h3>
<ul>
<li>支持多索引（层次索引），方便分析多维数据。</li>
<li>支持数据透视表的创建，堆栈和取消堆栈操作。</li>
<li>可以使用 Pandas 处理有限值的分类数据。</li>
<li>支持分组和聚合运算。</li>
<li>可以禁用排序。</li>
<li>支持行级过滤（获取满足过滤条件的行）和列级过滤（只选择需要的列）。</li>
<li>有助于重塑数据集（数组的维度变换）。还可以转置数组的值，并转换为列表。当你使用 Python 处理数据时，可以将 Pandas 数据帧转换为多维 NumPy 数组。</li>
<li>支持面向标签的数据切片。</li>
</ul>
<h3>Pandas 的不足</h3>
<p>Pandas 的代码和语法与 Python 不同，所以人们需要额外再学习 Pandas。此外，相较于 Pandas，像三维数据这样的高维数据会在 NumPy 等其他库有更好的处理。</p>
<h3>总结</h3>
<p>Pandas 能够大幅提升数据分析的效率。它与其他库的兼容性使它在其他 Python 库中都能有效地使用。</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>