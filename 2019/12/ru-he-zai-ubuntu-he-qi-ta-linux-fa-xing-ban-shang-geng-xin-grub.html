<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>如何在 Ubuntu 和其它 Linux 发行版上更新 grub</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: Abhishek Prakash 在这篇文章中，你将学习在 Ubuntu 或任何其它 Linux 发行版上更新 grub 。你也将学习一个或两个关于更新这个 grub 过程如何工 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li class="active"><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2019/12/ru-he-zai-ubuntu-he-qi-ta-linux-fa-xing-ban-shang-geng-xin-grub.html" rel="bookmark"
           title="Permalink to 如何在 Ubuntu 和其它 Linux 发行版上更新 grub">如何在 Ubuntu 和其它 Linux 发行版上更新 grub</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2019-12-29T11:02:11+01:00">
                Published: Sun 29 December 2019
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/ji-zhu">技术</a>.</p>

</footer><!-- /.post-info -->      <p>Author: Abhishek Prakash</p>
<p><img alt="" src="/data/attachment/album/201912/29/110155d51bhogs5ezp5p71.png"></p>
<p>在这篇文章中，你将学习在 Ubuntu 或任何其它 Linux 发行版上更新 grub 。你也将学习一个或两个关于更新这个 grub 过程如何工作的事情。</p>
<h3>如何更新 grub</h3>
<p>Ubuntu 和很多其它的 Linux 发行版提供一个易使用的称为 <code>update-grub</code> 命令行实用程序。</p>
<p>为更新 grub ，你所要的全部工作就是使用 <code>sudo</code> 在终端中运行这个命令。</p>
<div class="highlight"><pre><span></span><code>sudo update-grub
</code></pre></div>

<p>你应该看到一个像这样的输出：</p>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">email</span><span class="w"> </span><span class="n">protected</span><span class="p">]</span><span class="o">:~</span><span class="n">$</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">update</span><span class="o">-</span><span class="n">grub</span>
<span class="p">[</span><span class="n">sudo</span><span class="p">]</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">abhishek</span><span class="o">:</span>
<span class="n">Sourcing</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="err">`</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="k">default</span><span class="o">/</span><span class="n">grub</span><span class="err">&#39;</span>
<span class="n">Generating</span><span class="w"> </span><span class="n">grub</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="p">...</span>
<span class="n">Found</span><span class="w"> </span><span class="n">linux</span><span class="w"> </span><span class="n">image</span><span class="o">:</span><span class="w"> </span><span class="o">/</span><span class="n">boot</span><span class="o">/</span><span class="n">vmlinuz</span><span class="mf">-5.0.0</span><span class="mi">-37</span><span class="o">-</span><span class="n">generic</span>
<span class="n">Found</span><span class="w"> </span><span class="n">initrd</span><span class="w"> </span><span class="n">image</span><span class="o">:</span><span class="w"> </span><span class="o">/</span><span class="n">boot</span><span class="o">/</span><span class="n">initrd</span><span class="p">.</span><span class="n">img</span><span class="mf">-5.0.0</span><span class="mi">-37</span><span class="o">-</span><span class="n">generic</span>
<span class="n">Found</span><span class="w"> </span><span class="n">linux</span><span class="w"> </span><span class="n">image</span><span class="o">:</span><span class="w"> </span><span class="o">/</span><span class="n">boot</span><span class="o">/</span><span class="n">vmlinuz</span><span class="mf">-5.0.0</span><span class="mi">-36</span><span class="o">-</span><span class="n">generic</span>
<span class="n">Found</span><span class="w"> </span><span class="n">initrd</span><span class="w"> </span><span class="n">image</span><span class="o">:</span><span class="w"> </span><span class="o">/</span><span class="n">boot</span><span class="o">/</span><span class="n">initrd</span><span class="p">.</span><span class="n">img</span><span class="mf">-5.0.0</span><span class="mi">-36</span><span class="o">-</span><span class="n">generic</span>
<span class="n">Found</span><span class="w"> </span><span class="n">linux</span><span class="w"> </span><span class="n">image</span><span class="o">:</span><span class="w"> </span><span class="o">/</span><span class="n">boot</span><span class="o">/</span><span class="n">vmlinuz</span><span class="mf">-5.0.0</span><span class="mi">-31</span><span class="o">-</span><span class="n">generic</span>
<span class="n">Found</span><span class="w"> </span><span class="n">initrd</span><span class="w"> </span><span class="n">image</span><span class="o">:</span><span class="w"> </span><span class="o">/</span><span class="n">boot</span><span class="o">/</span><span class="n">initrd</span><span class="p">.</span><span class="n">img</span><span class="mf">-5.0.0</span><span class="mi">-31</span><span class="o">-</span><span class="n">generic</span>
<span class="n">Found</span><span class="w"> </span><span class="n">Ubuntu</span><span class="w"> </span><span class="mf">19.10</span><span class="w"> </span><span class="p">(</span><span class="mf">19.10</span><span class="p">)</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda4</span>
<span class="n">Found</span><span class="w"> </span><span class="n">MX</span><span class="w"> </span><span class="mi">19</span><span class="w"> </span><span class="n">patito</span><span class="w"> </span><span class="n">feo</span><span class="w"> </span><span class="p">(</span><span class="mi">19</span><span class="p">)</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sdb1</span>
<span class="n">Adding</span><span class="w"> </span><span class="n">boot</span><span class="w"> </span><span class="n">menu</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">EFI</span><span class="w"> </span><span class="n">firmware</span><span class="w"> </span><span class="n">configuration</span>
<span class="n">done</span>
</code></pre></div>

<p>你可能看到一个类似的称为 <code>update-grub2</code> 的命令。不需要在 <code>update-grub</code> 和 <code>update-grub2</code> 之间感到害怕或不知所措。这两个命令执行相同的动作。</p>
<p>大约在 10 年前，当 grub2 刚刚被引进时，<code>update-grub2</code> 命令也被引进。现在，<code>update-grub2</code> 只是一个链接到 <code>update-grub</code> 的符号，它们都更新 grub2 配置（因为 grub2 是默认的）。</p>
<h4>不能找到 update-grub 命令？这里是在这种情况下该做什么</h4>
<p>它可能是，你的 Linux 发行版可能没有可用的 <code>update-grub</code> 命令。</p>
<p>在这种情况下你该做什么？你如何在这样一个 Linux 发行版上更新 grub ？</p>
<p>在这里不需要惊慌。<code>update-grub</code> 命令只是一个入口，用于运行 <code>grub-mkconfig -o /boot/grub/grub.cfg</code> 来生成 grub2 配置文件。</p>
<p>这意味着你可以在任意 Linux 发行版上使用下面的命令更新 grub ：</p>
<div class="highlight"><pre><span></span><code>sudo grub-mkconfig -o /boot/grub/grub.cfg
</code></pre></div>

<p>当然，记住 <code>update-grub</code> 命令比上面的命令容易很多，这是为什么它在一开始被创建的原因。</p>
<h3>update-grub 是如何工作的？</h3>
<p>当你安装一个 Linux 发行版时，它（通常）要求你安装 <a href="https://en.wikipedia.org/wiki/GNU_GRUB">grub 启动引导程序</a>。</p>
<p>grub 的一部分安装在 MBR/ESP 分区上。grub 的剩余部分保留在 Linux 发行版的 <code>/boot/grub</code> 目录中。</p>
<p>依据它的 <a href="https://manpages.debian.org/testing/grub-legacy/update-grub.8.en.html">man 页面</a>，<code>update-grub</code> 通过查找 <code>/boot</code> 目录来工作。所有以 <a href="https://www.ibm.com/developerworks/community/blogs/mhhaque/entry/anatomy_of_the_initrd_and_vmlinuz?lang=en">vmlinuz-</a> 开头的文件将被作为内核来对待，并且它们将得到一个 grub 菜单项。它也将为与所找到内核版本相同的 <a href="https://en.wikipedia.org/wiki/Initial_ramdisk">ramdisk</a> 镜像添加 initrd 行。</p>
<p>它也使用 <a href="https://packages.debian.org/sid/utils/os-prober">os-prober</a> 为其它操作系统查找所有磁盘分区。如果找到其它操作系统，它添加它们到 grub 菜单。</p>
<p><img alt="Representational image of Grub Menu" src="/data/attachment/album/201912/29/110215yzk01gtzmt6rn1nz.png"></p>
<h3>为什么你需要更新 grub ？</h3>
<p>在有很多场景下你需要更新 grub。</p>
<p>假设你修改 grub 配置文件（<code>/etc/default/grub</code>）以 <a href="https://itsfoss.com/grub-customizer-ubuntu/">更改默认启动顺序</a> 或减少默认启动时间。除非你更新 grub ，否则你的修改将不会生效。</p>
<p>另一种情况是，你在同一个电脑系统上安装多个 Linux 发行版。</p>
<p>例如，在我的 Intel NUC 上，我有两个磁盘。第一个磁盘有 Ubuntu 19.10 ，并且我在其上面安装了 Ubuntu 18.04 。第二个操作系统（Ubuntu 18.04）安装了其自己的 grub ，现在 grub 启动屏幕由 Ubuntu 18.04 grub 控制。</p>
<p>在第二个磁盘上，我安装了 MX Linux ，但是这次我没有安装 grub。我希望现有的 grub（由 Ubuntu 18.04 控制）来处理所有的操作系统项目。</p>
<p>现在，在这种情况中，在 Ubuntu 18.04 上的 grub 需要更新，以便它能够看到 <a href="https://mxlinux.org/">MX Linux</a> 。</p>
<p><img alt="" src="/data/attachment/album/201912/29/110215pp3pajbpn9ea3999.png"></p>
<p>如上图所示，当我更新 grub 时，它在 18.04 上找到很多安装的 Linux 内核, 以及在不同的分区上 Ubntu 19.10 和 MX Linux 。</p>
<p>如果你想让 MX Linux 控制 grub ，我可以使用 <a href="https://www.gnu.org/software/grub/manual/grub/html_node/Installing-GRUB-using-grub_002dinstall.html">grub-install</a> 命令来在 MX Linux 上安装 grub，然后在 MX Linux 上的 grub 将开始控制 grub 启动屏幕。你已经明白这点，对吧？</p>
<p>使用一个像 <a href="https://itsfoss.com/customize-grub-linux/">Grub Customizer</a> 的 GUI 工具是在 grub 中进行更改的一种简单的方法。</p>
<h3>最后…</h3>
<p>最初，我打算保持它为一篇短文作为一种快速提示。但是后来我想解释一些与之相关的东西，以便（相对）新的 Linux 用户能够学到更多，而不仅仅是一个简单命令。</p>
<p>你喜欢它吗？你有一些问题或建议吗？请随意发表评论。</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>