<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>处理 Linux 文件的 3 个技巧</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: Sandra Henry-stocker Linux 提供了许多用于查找、计数和重命名文件的命令。这有一些有用的选择。 Linux 提供了多种用于处理文件的命令，这些 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li class="active"><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2019/10/chu-li-linux-wen-jian-de-3-ge-ji-qiao.html" rel="bookmark"
           title="Permalink to 处理 Linux 文件的 3 个技巧">处理 Linux 文件的 3 个技巧</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2019-10-11T10:11:51+02:00">
                Published: Fri 11 October 2019
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/ji-zhu">技术</a>.</p>

</footer><!-- /.post-info -->      <p>Author: Sandra Henry-stocker</p>
<blockquote>
<p>Linux 提供了许多用于查找、计数和重命名文件的命令。这有一些有用的选择。</p>
</blockquote>
<p><img alt="" src="/data/attachment/album/201910/11/101136ei4sslezne7esyis.jpg"></p>
<p>Linux 提供了多种用于处理文件的命令，这些命令可以节省你的时间，并使你的工作不那么繁琐。</p>
<h3>查找文件</h3>
<p>当你查找文件时，<code>find</code> 可能会是第一个想到的命令，但是有时精心设计的 <code>ls</code> 命令会更好。想知道你昨天离开办公室回家前调用的脚本么？简单！使用 <code>ls</code> 命令并加上 <code>-ltr</code> 选项。最后一个列出的将是最近创建或更新的文件。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ls<span class="w"> </span>-ltr<span class="w"> </span>~/bin<span class="w"> </span><span class="p">|</span><span class="w"> </span>tail<span class="w"> </span>-3
-rwx------<span class="w"> </span><span class="m">1</span><span class="w"> </span>shs<span class="w"> </span>shs<span class="w">   </span><span class="m">229</span><span class="w"> </span>Sep<span class="w"> </span><span class="m">22</span><span class="w"> </span><span class="m">19</span>:37<span class="w"> </span>checkCPU
-rwx------<span class="w"> </span><span class="m">1</span><span class="w"> </span>shs<span class="w"> </span>shs<span class="w">   </span><span class="m">285</span><span class="w"> </span>Sep<span class="w"> </span><span class="m">22</span><span class="w"> </span><span class="m">19</span>:37<span class="w"> </span>ff
-rwxrw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>shs<span class="w"> </span>shs<span class="w">  </span><span class="m">1629</span><span class="w"> </span>Sep<span class="w"> </span><span class="m">22</span><span class="w"> </span><span class="m">19</span>:37<span class="w"> </span>test2
</code></pre></div>

<p>像这样的命令将仅列出今天更新的文件：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ls<span class="w"> </span>-al<span class="w"> </span>--time-style<span class="o">=</span>+%D<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="sb">`</span>date<span class="w"> </span>+%D<span class="sb">`</span>
drwxr-xr-x<span class="w">  </span><span class="m">60</span><span class="w"> </span>shs<span class="w">  </span>shs<span class="w">       </span><span class="m">69632</span><span class="w"> </span><span class="m">09</span>/23/19<span class="w"> </span>.
drwxrwxr-x<span class="w">   </span><span class="m">2</span><span class="w"> </span>shs<span class="w">  </span>shs<span class="w">     </span><span class="m">8052736</span><span class="w"> </span><span class="m">09</span>/23/19<span class="w"> </span>bin
-rw-rw-r--<span class="w">   </span><span class="m">1</span><span class="w"> </span>shs<span class="w">  </span>shs<span class="w">         </span><span class="m">506</span><span class="w"> </span><span class="m">09</span>/23/19<span class="w"> </span>stats
</code></pre></div>

<p>如果你要查找的文件可能不在当前目录中，那么 <code>find</code> 将比 <code>ls</code> 提供更好的选项，但它可能会输出比你想要的更多结果。在下面的命令中，我们<em>不</em>搜索以点开头的目录（它们很多一直在更新），指定我们要查找的是文件（即不是目录），并要求仅显示最近一天 （<code>-mtime -1</code>）更新过的文件。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>find<span class="w"> </span>.<span class="w"> </span>-not<span class="w"> </span>-path<span class="w"> </span><span class="s1">&#39;*/\.*&#39;</span><span class="w"> </span>-type<span class="w"> </span>f<span class="w"> </span>-mtime<span class="w"> </span>-1<span class="w"> </span>-ls
<span class="w">   </span><span class="m">917517</span><span class="w">      </span><span class="m">0</span><span class="w"> </span>-rwxrw-r--<span class="w">   </span><span class="m">1</span><span class="w"> </span>shs<span class="w">      </span>shs<span class="w">          </span><span class="m">683</span><span class="w"> </span>Sep<span class="w"> </span><span class="m">23</span><span class="w"> </span><span class="m">11</span>:00<span class="w"> </span>./newscript
</code></pre></div>

<p>注意 <code>-not</code> 选项反转了 <code>-path</code> 的行为，因此我们不会搜索以点开头的子目录。</p>
<p>如果只想查找最大的文件和目录，那么可以使用类似 <code>du</code> 这样的命令，它会按大小列出当前目录的内容。将输出通过管道传输到 <code>tail</code>，仅查看最大的几个。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>du<span class="w"> </span>-kx<span class="w"> </span><span class="p">|</span><span class="w"> </span>egrep<span class="w"> </span>-v<span class="w"> </span><span class="s2">&quot;\./.+/&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span>-n<span class="w"> </span><span class="p">|</span><span class="w"> </span>tail<span class="w"> </span>-5
<span class="m">918984</span><span class="w">      </span>./reports
<span class="m">1053980</span><span class="w">     </span>./notes
<span class="m">1217932</span><span class="w">     </span>./.cache
<span class="m">31470204</span><span class="w">    </span>./photos
<span class="m">39771212</span><span class="w">    </span>.
</code></pre></div>

<p><code>-k</code> 选项让 <code>du</code> 以块列出文件大小，而 <code>x</code> 可防止其遍历其他文件系统上的目录（例如，通过符号链接引用）。事实上，<code>du</code> 会先列出文件大小，这样可以按照大小排序（<code>sort -n</code>）。</p>
<h3>文件计数</h3>
<p>使用 <code>find</code> 命令可以很容易地计数任何特定目录中的文件。你只需要记住，<code>find</code> 会递归到子目录中，并将这些子目录中的文件与当前目录中的文件一起计数。在此命令中，我们计数一个特定用户（<code>username</code>）的家目录中的文件。根据家目录的权限，这可能需要使用 <code>sudo</code>。请记住，第一个参数是搜索的起点。这里指定的是用户的家目录。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>find<span class="w"> </span>~username<span class="w"> </span>-type<span class="w"> </span>f<span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="w"> </span><span class="p">|</span><span class="w"> </span>wc<span class="w"> </span>-l
<span class="m">35624</span>
</code></pre></div>

<p>请注意，我们正在将上面 <code>find</code> 命令的错误输出发送到 <code>/dev/null</code>，以避免搜索类似 <code>~username/.cache</code> 这类无法搜索并且对它的内容也不感兴趣的文件夹。</p>
<p>必要时，你可以使用 <code>maxdepth 1</code> 选项将 <code>find</code> 限制在单个目录中：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>find<span class="w"> </span>/home/shs<span class="w"> </span>-maxdepth<span class="w"> </span><span class="m">1</span><span class="w"> </span>-type<span class="w"> </span>f<span class="w"> </span><span class="p">|</span><span class="w"> </span>wc<span class="w"> </span>-l
<span class="m">387</span>
</code></pre></div>

<h3>重命名文件</h3>
<p>使用 <code>mv</code> 命令可以很容易地重命名文件，但是有时你会想重命名大量文件，并且不想花费大量时间。例如，要将你在当前目录的文件名中找到的所有空格更改为下划线，你可以使用如下命令：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>rename<span class="w"> </span><span class="s1">&#39;s/ /_/g&#39;</span><span class="w"> </span>*
</code></pre></div>

<p>如你怀疑的那样，此命令中的 <code>g</code> 表示“全局”。这意味着该命令会将文件名中的<em>所有</em>空格更改为下划线，而不仅仅是第一个。</p>
<p>要从文本文件中删除 .txt 扩展名，可以使用如下命令：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>rename<span class="w"> </span><span class="s1">&#39;s/.txt//g&#39;</span><span class="w"> </span>*
</code></pre></div>

<h3>总结</h3>
<p>Linux 命令行提供了许多用于处理文件的有用选择。请提出你认为特别有用的其他命令。</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>