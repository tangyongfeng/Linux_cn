<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>如何在 Ubuntu 上安装 MongoDB</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: Sergiu 本教程介绍了在 Ubuntu 和基于 Ubuntu 的 Linux 发行版上安装 MongoDB 的两种方法。 MongoDB 是一个越来越流行的自由开源的 NoSQL 数据库，它将数 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li class="active"><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2019/08/ru-he-zai-ubuntu-shang-an-zhuang-mongodb.html" rel="bookmark"
           title="Permalink to 如何在 Ubuntu 上安装 MongoDB">如何在 Ubuntu 上安装 MongoDB</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2019-08-02T10:46:11+02:00">
                Published: Fri 02 August 2019
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/ji-zhu">技术</a>.</p>

</footer><!-- /.post-info -->      <p>Author: Sergiu</p>
<blockquote>
<p>本教程介绍了在 Ubuntu 和基于 Ubuntu 的 Linux 发行版上安装 MongoDB 的两种方法。</p>
</blockquote>
<p><a href="https://www.mongodb.com/">MongoDB</a> 是一个越来越流行的自由开源的 NoSQL 数据库，它将数据存储在类似 JSON 的灵活文档集中，这与 SQL 数据库中常见的表格形式形成对比。</p>
<p>你很可能发现在现代 Web 应用中使用 MongoDB。它的文档模型使得使用各种编程语言能非常直观地访问和处理它。</p>
<p><img alt="mongodb Ubuntu" src="/data/attachment/album/201908/02/104616prrh800vakprgaqq.jpg"></p>
<p>在本文中，我将介绍两种在 Ubuntu 上安装 MongoDB 的方法。</p>
<h3>在基于 Ubuntu 的发行版上安装 MongoDB</h3>
<ol>
<li>使用 Ubuntu 仓库安装 MongoDB。简单但不是最新版本的 MongoDB</li>
<li>使用其官方仓库安装 MongoDB。稍微复杂，但你能得到最新版本的 MongoDB。</li>
</ol>
<p>第一种安装方法更容易，但如果你计划使用官方支持的最新版本，那么我建议使用第二种方法。</p>
<p>有些人可能更喜欢使用 snap 包。Ubuntu 软件中心提供了 snap，但我不建议使用它们，因为他们现在已经过期了，因此我这里不会提到。</p>
<h3>方法 1：从 Ubuntu 仓库安装 MongoDB</h3>
<p>这是在系统中安装 MongoDB 的简便方法，你只需输入一个命令即可。</p>
<h4>安装 MongoDB</h4>
<p>首先，确保你的包是最新的。打开终端并输入：</p>
<div class="highlight"><pre><span></span><code>sudo apt update &amp;&amp; sudo apt upgrade -y
</code></pre></div>

<p>继续安装 MongoDB：</p>
<div class="highlight"><pre><span></span><code>sudo apt install mongodb
</code></pre></div>

<p>这就完成了！MongoDB 现在安装到你的计算机上了。</p>
<p>MongoDB 服务应该在安装时自动启动，但要检查服务状态：</p>
<div class="highlight"><pre><span></span><code>sudo systemctl status mongodb
</code></pre></div>

<p><img alt="Check if the MongoDB service is running." src="/data/attachment/album/201908/02/104618ep30u03e0200od38.jpg"></p>
<p>你可以看到该服务是<strong>活动</strong>的。</p>
<h4>运行 MongoDB</h4>
<p>MongoDB 目前是一个 systemd 服务，因此我们使用 <code>systemctl</code> 来检查和修改它的状态，使用以下命令：</p>
<div class="highlight"><pre><span></span><code>sudo systemctl status mongodb
sudo systemctl stop mongodb
sudo systemctl start mongodb
sudo systemctl restart mongodb
</code></pre></div>

<p>你也可以修改 MongoDB 是否自动随系统启动（默认：启用）：</p>
<div class="highlight"><pre><span></span><code>sudo systemctl disable mongodb
sudo systemctl enable mongodb
</code></pre></div>

<p>要开始使用（创建和编辑）数据库，请输入：</p>
<div class="highlight"><pre><span></span><code>mongo
</code></pre></div>

<p>这将启动 <strong>mongo shell</strong>。有关查询和选项的详细信息，请查看<a href="https://docs.mongodb.com/manual/tutorial/getting-started/">手册</a>。</p>
<p><strong>注意：</strong>根据你计划使用 MongoDB 的方式，你可能需要调整防火墙。不过这超出了本篇的内容，并且取决于你的配置。</p>
<h4>卸载 MongoDB</h4>
<p>如果你从 Ubuntu 仓库安装 MongoDB 并想要卸载它（可能要使用官方支持的方式安装），请输入：</p>
<div class="highlight"><pre><span></span><code>sudo systemctl stop mongodb
sudo apt purge mongodb
sudo apt autoremove
</code></pre></div>

<p>这应该会完全卸载 MongoDB。确保<strong>备份</strong>你可能想要保留的任何集合或文档，因为它们将被删除！</p>
<h3>方法 2：在 Ubuntu 上安装 MongoDB 社区版</h3>
<p>这是推荐的安装 MongoDB 的方法，它使用包管理器。你需要多打几条命令，对于 Linux 新手而言，这可能会感到害怕。</p>
<p>但没有什么可怕的！我们将一步步说明安装过程。</p>
<h4>安装 MongoDB</h4>
<p>由 MongoDB Inc. 维护的包称为 <code>mongodb-org</code>，而不是 <code>mongodb</code>（这是 Ubuntu 仓库中包的名称）。在开始之前，请确保系统上未安装 <code>mongodb</code>。因为包之间会发生冲突。让我们开始吧！</p>
<p>首先，我们必须导入公钥：</p>
<div class="highlight"><pre><span></span><code>sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv 9DA31620334BD75D9DCB49F368818C72E52529D4
</code></pre></div>

<p>现在，你需要在源列表中添加一个新的仓库，以便你可以安装 MongoDB 社区版并获得自动更新：</p>
<div class="highlight"><pre><span></span><code>echo &quot;deb [ arch=amd64 ] https://repo.mongodb.org/apt/ubuntu $(lsb_release -cs)/mongodb-org/4.0 multiverse&quot; | sudo tee /etc/apt/sources.list.d/mongodb-org-4.0.list
</code></pre></div>

<p>要安装 <code>mongodb-org</code>，我们需要更新我们的包数据库，以便系统知道可用的新包：</p>
<div class="highlight"><pre><span></span><code>sudo apt update
</code></pre></div>

<p>现在你可以安装<strong>最新稳定版</strong>的 MongoDB：</p>
<div class="highlight"><pre><span></span><code>sudo apt install -y mongodb-org
</code></pre></div>

<p>或者某个<strong>特定版本</strong>（在 <code>=</code> 后面修改版本号）</p>
<div class="highlight"><pre><span></span><code><span class="n">sudo</span><span class="w"> </span><span class="n">apt</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="o">-</span><span class="n">y</span><span class="w"> </span><span class="n">mongodb</span><span class="o">-</span><span class="n">org</span><span class="o">=</span><span class="mf">4.0</span><span class="o">.</span><span class="mi">6</span><span class="w"> </span><span class="n">mongodb</span><span class="o">-</span><span class="n">org</span><span class="o">-</span><span class="n">server</span><span class="o">=</span><span class="mf">4.0</span><span class="o">.</span><span class="mi">6</span><span class="w"> </span><span class="n">mongodb</span><span class="o">-</span><span class="n">org</span><span class="o">-</span><span class="n">shell</span><span class="o">=</span><span class="mf">4.0</span><span class="o">.</span><span class="mi">6</span><span class="w"> </span><span class="n">mongodb</span><span class="o">-</span><span class="n">org</span><span class="o">-</span><span class="n">mongos</span><span class="o">=</span><span class="mf">4.0</span><span class="o">.</span><span class="mi">6</span><span class="w"> </span><span class="n">mongodb</span><span class="o">-</span><span class="n">org</span><span class="o">-</span><span class="n">tools</span><span class="o">=</span><span class="mf">4.0</span><span class="o">.</span><span class="mi">6</span>
</code></pre></div>

<p>如果你选择安装特定版本，请确保在所有位置都修改了版本号。如果你修改了 <code>mongodb-org=4.0.6</code>，你将安装最新版本。</p>
<p>默认情况下，使用包管理器（<code>apt-get</code>）更新时，MongoDB 将更新为最新的版本。要阻止这种情况发生（并冻结为已安装的版本），请使用：</p>
<div class="highlight"><pre><span></span><code><span class="n">echo</span><span class="w"> </span><span class="s2">&quot;mongodb-org hold&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">dpkg</span><span class="w"> </span><span class="o">--</span><span class="n">set</span><span class="o">-</span><span class="n">selections</span>
<span class="n">echo</span><span class="w"> </span><span class="s2">&quot;mongodb-org-server hold&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">dpkg</span><span class="w"> </span><span class="o">--</span><span class="n">set</span><span class="o">-</span><span class="n">selections</span>
<span class="n">echo</span><span class="w"> </span><span class="s2">&quot;mongodb-org-shell hold&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">dpkg</span><span class="w"> </span><span class="o">--</span><span class="n">set</span><span class="o">-</span><span class="n">selections</span>
<span class="n">echo</span><span class="w"> </span><span class="s2">&quot;mongodb-org-mongos hold&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">dpkg</span><span class="w"> </span><span class="o">--</span><span class="n">set</span><span class="o">-</span><span class="n">selections</span>
<span class="n">echo</span><span class="w"> </span><span class="s2">&quot;mongodb-org-tools hold&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">dpkg</span><span class="w"> </span><span class="o">--</span><span class="n">set</span><span class="o">-</span><span class="n">selections</span>
</code></pre></div>

<p>你现在已经成功安装了 MongoDB！</p>
<h4>配置 MongoDB</h4>
<p>默认情况下，包管理器将创建 <code>/var/lib/mongodb</code> 和 <code>/var/log/mongodb</code>，MongoDB 将使用 <code>mongodb</code> 用户帐户运行。</p>
<p>我不会去更改这些默认设置，因为这超出了本指南的范围。有关详细信息，请查看<a href="https://docs.mongodb.com/manual/">手册</a>。</p>
<p><code>/etc/mongod.conf</code> 中的设置在启动/重新启动 <strong>mongodb</strong> 服务实例时生效。</p>
<h5>运行 MongoDB</h5>
<p>要启动 mongodb 的守护进程 <code>mongod</code>，请输入：</p>
<div class="highlight"><pre><span></span><code>sudo service mongod start
</code></pre></div>

<p>现在你应该验证 <code>mongod</code> 进程是否已成功启动。此信息（默认情况下）保存在 <code>/var/log/mongodb/mongod.log</code> 中。我们来看看文件的内容：</p>
<div class="highlight"><pre><span></span><code><span class="n">sudo</span><span class="w"> </span><span class="n">cat</span><span class="w"> </span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span><span class="o">/</span><span class="n">mongodb</span><span class="o">/</span><span class="n">mongod</span><span class="o">.</span><span class="n">log</span>
</code></pre></div>

<p><img alt="Check MongoDB logs to see if the process is running properly." src="/data/attachment/album/201908/02/104621u2352nfhhqqqjhf5.jpg"></p>
<p>只要你在某处看到：<code>[initandlisten] waiting for connections on port 27017</code>，就说明进程正常运行。</p>
<p><strong>注意</strong>：27017 是 <code>mongod</code> 的默认端口。</p>
<p>要停止/重启 <code>mongod</code>，请输入：</p>
<div class="highlight"><pre><span></span><code>sudo service mongod stop
sudo service mongod restart
</code></pre></div>

<p>现在，你可以通过打开 <strong>mongo shell</strong> 来使用 MongoDB：</p>
<div class="highlight"><pre><span></span><code>mongo
</code></pre></div>

<h4>卸载 MongoDB</h4>
<p>运行以下命令：</p>
<div class="highlight"><pre><span></span><code>sudo service mongod stop
sudo apt purge mongodb-org*
</code></pre></div>

<p>要删除<strong>数据库</strong>和<strong>日志文件</strong>（确保<strong>备份</strong>你要保留的内容！）：</p>
<div class="highlight"><pre><span></span><code><span class="n">sudo</span><span class="w"> </span><span class="n">rm</span><span class="w"> </span><span class="o">-</span><span class="n">r</span><span class="w"> </span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span><span class="o">/</span><span class="n">mongodb</span>
<span class="n">sudo</span><span class="w"> </span><span class="n">rm</span><span class="w"> </span><span class="o">-</span><span class="n">r</span><span class="w"> </span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">mongodb</span>
</code></pre></div>

<h3>总结</h3>
<p>MongoDB 是一个很棒的 NoSQL 数据库，它易于集成到现代项目中。我希望本教程能帮助你在 Ubuntu 上安装它！在下面的评论中告诉我们你计划如何使用 MongoDB。</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>