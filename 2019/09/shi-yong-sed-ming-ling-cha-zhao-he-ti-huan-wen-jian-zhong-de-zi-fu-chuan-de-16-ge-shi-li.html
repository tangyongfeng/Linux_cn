<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>使用 sed 命令查找和替换文件中的字符串的 16 个示例</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: Magesh Maruthamuthu 当你在使用文本文件时，很可能需要查找和替换文件中的字符串。sed 命令主要用于替换一个文件中的文本。在 Linux 中 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li class="active"><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2019/09/shi-yong-sed-ming-ling-cha-zhao-he-ti-huan-wen-jian-zhong-de-zi-fu-chuan-de-16-ge-shi-li.html" rel="bookmark"
           title="Permalink to 使用 sed 命令查找和替换文件中的字符串的 16 个示例">使用 sed 命令查找和替换文件中的字符串的 16 个示例</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2019-09-20T21:07:35+02:00">
                Published: Fri 20 September 2019
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/ji-zhu">技术</a>.</p>

</footer><!-- /.post-info -->      <p>Author: Magesh Maruthamuthu</p>
<p><img alt="" src="/data/attachment/album/201909/20/210723xf884pafyzf9zf4a.jpg"></p>
<p>当你在使用文本文件时，很可能需要查找和替换文件中的字符串。<code>sed</code> 命令主要用于替换一个文件中的文本。在 Linux 中这可以通过使用 <code>sed</code> 命令和 <code>awk</code> 命令来完成。</p>
<p>在本教程中，我们将告诉你使用 <code>sed</code> 命令如何做到这一点，然后讨论讨论 <code>awk</code> 命令相关的。</p>
<h3>sed 命令是什么</h3>
<p><code>sed</code> 命令表示 Stream Editor（流编辑器），用来在 Linux 上执行基本的文本操作。它可以执行各种功能，如搜索、查找、修改、插入或删除文件。</p>
<p>此外，它也可以执行复杂的正则表达式匹配。</p>
<p>它可用于以下目的：</p>
<ul>
<li>查找和替换匹配给定的格式的内容。</li>
<li>在指定行查找和替换匹配给定的格式的内容。</li>
<li>在所有行查找和替换匹配给定的格式的内容。</li>
<li>搜索并同时替换两种不同的模式。</li>
</ul>
<p>本文列出的十五个例子可以帮助你掌握 <code>sed</code> 命令。</p>
<p>如果要使用 <code>sed</code> 命令删除文件中的行，去下面的文章。</p>
<p>注意：由于这是一篇演示文章，我们使用不带 <code>-i</code> 选项的 <code>sed</code> 命令，该选项会在 Linux 终端中删除行并打印文件内容。</p>
<p>但是，在实际环境中如果你想删除源文件中的行，使用带 <code>-i</code> 选项的 <code>sed</code> 命令。</p>
<p>常见的 <code>sed</code> 替换字符串的语法。</p>
<div class="highlight"><pre><span></span><code>sed -i &#39;s/Search_String/Replacement_String/g&#39; Input_File
</code></pre></div>

<p>首先我们需要了解 <code>sed</code> 语法来做到这一点。请参阅有关的细节。</p>
<ul>
<li><code>sed</code>：这是一个 Linux 命令。</li>
<li><code>-i</code>：这是 <code>sed</code> 命令的一个选项，它有什么作用？默认情况下，<code>sed</code> 打印结果到标准输出。当你使用 <code>sed</code> 添加这个选项时，那么它会在适当的位置修改文件。当你添加一个后缀（比如，<code>-i.bak</code>）时，就会创建原始文件的备份。</li>
<li><code>s</code>：字母 <code>s</code> 是一个替换命令。</li>
<li><code>Search_String</code>：搜索一个给定的字符串或正则表达式。</li>
<li><code>Replacement_String</code>：替换的字符串。</li>
<li><code>g</code>：全局替换标志。默认情况下，<code>sed</code> 命令替换每一行第一次出现的模式，它不会替换行中的其他的匹配结果。但是，提供了该替换标志时，所有匹配都将被替换。</li>
<li><code>/</code>：分界符。</li>
<li><code>Input_File</code>：要执行操作的文件名。</li>
</ul>
<p>让我们来看看文件中用sed命令来搜索和转换文本的一些常用例子。</p>
<p>我们已经创建了用于演示的以下文件。</p>
<div class="highlight"><pre><span></span><code># cat sed-test.txt

1 Unix unix unix 23
2 linux Linux 34
3 linuxunix UnixLinux
linux /bin/bash CentOS Linux OS
Linux is free and opensource operating system
</code></pre></div>

<h3>1) 如何查找和替换一行中“第一次”模式匹配</h3>
<p>下面的 <code>sed</code> 命令用 <code>linux</code> 替换文件中的 <code>unix</code>。这仅仅改变了每一行模式的第一个实例。</p>
<div class="highlight"><pre><span></span><code># sed &#39;s/unix/linux/&#39; sed-test.txt

1 Unix linux unix 23
2 linux Linux 34
3 linuxlinux UnixLinux
linux /bin/bash CentOS Linux OS
Linux is free and opensource operating system
</code></pre></div>

<h3>2) 如何查找和替换每一行中“第 N 次”出现的模式</h3>
<p>在行中使用<code>/1</code>、<code>/2</code>……<code>/n</code> 等标志来代替相应的匹配。</p>
<p>下面的 <code>sed</code> 命令在一行中用 <code>linux</code> 来替换 <code>unix</code> 模式的第二个实例。</p>
<div class="highlight"><pre><span></span><code># sed &#39;s/unix/linux/2&#39; sed-test.txt

1 Unix unix linux 23
2 linux Linux 34
3 linuxunix UnixLinux
linux /bin/bash CentOS Linux OS
Linux is free and opensource operating system
</code></pre></div>

<h3>3) 如何搜索和替换一行中所有的模式实例</h3>
<p>下面的 <code>sed</code> 命令用 <code>linux</code> 替换 <code>unix</code> 格式的所有实例，因为 <code>g</code> 是一个全局替换标志。</p>
<div class="highlight"><pre><span></span><code># sed &#39;s/unix/linux/g&#39; sed-test.txt

1 Unix linux linux 23
2 linux Linux 34
3 linuxlinux UnixLinux
linux /bin/bash CentOS Linux OS
Linux is free and opensource operating system
</code></pre></div>

<h3>4) 如何查找和替换一行中从“第 N 个”开始的所有匹配的模式实例</h3>
<p>下面的 <code>sed</code> 命令在一行中替换从模式的“第 N 个”开始的匹配实例。</p>
<div class="highlight"><pre><span></span><code># sed &#39;s/unix/linux/2g&#39; sed-test.txt

1 Unix unix linux 23
2 linux Linux 34
3 linuxunix UnixLinux
linux /bin/bash CentOS Linux OS
Linux is free and opensource operating system
</code></pre></div>

<h3>5) 在特定的行号搜索和替换模式</h3>
<p>你可以替换特定行号中的字符串。下面的 <code>sed</code> 命令用 <code>linux</code> 仅替换第三行的 <code>unix</code> 模式。</p>
<div class="highlight"><pre><span></span><code># sed &#39;3 s/unix/linux/&#39; sed-test.txt

1 Unix unix unix 23
2 linux Linux 34
3 linuxlinux UnixLinux
linux /bin/bash CentOS Linux OS
Linux is free and opensource operating system
</code></pre></div>

<h3>6) 在特定范围行号间搜索和替换模式</h3>
<p>你可以指定行号的范围，以替换字符串。</p>
<p>下面的 <code>sed</code> 命令在 1 到 3 行间用 <code>linux</code> 替换 <code>Unix</code> 模式。</p>
<div class="highlight"><pre><span></span><code># sed &#39;1,3 s/unix/linux/&#39; sed-test.txt

1 Unix linux unix 23
2 linux Linux 34
3 linuxlinux UnixLinux
linux /bin/bash CentOS Linux OS
Linux is free and opensource operating system
</code></pre></div>

<h3>7) 如何查找和修改最后一行的模式</h3>
<p>下面的 sed 命令允许你只在最后一行替换匹配的字符串。</p>
<p>下面的 <code>sed</code> 命令只在最后一行用 <code>Unix</code> 替换 <code>Linux</code> 模式。</p>
<div class="highlight"><pre><span></span><code># sed &#39;$ s/Linux/Unix/&#39; sed-test.txt

1 Unix unix unix 23
2 linux Linux 34
3 linuxunix UnixLinux
linux /bin/bash CentOS Linux OS
Unix is free and opensource operating system
</code></pre></div>

<h3>8) 在一行中如何只查找和替换正确的模式匹配</h3>
<p>你可能已经注意到，子串 <code>linuxunix</code> 被替换为在第 6 个示例中的 <code>linuxlinux</code>。如果你只想更改正确的匹配词，在搜索串的两端用这个边界符 <code>\b</code>。</p>
<div class="highlight"><pre><span></span><code># sed &#39;1,3 s/\bunix\b/linux/&#39; sed-test.txt

1 Unix linux unix 23
2 linux Linux 34
3 linuxunix UnixLinux
linux /bin/bash CentOS Linux OS
Linux is free and opensource operating system
</code></pre></div>

<h3>9) 如何以不区分大小写来搜索与替换模式</h3>
<p>大家都知道，Linux 是区分大小写的。为了与不区分大小写的模式匹配，使用 <code>I</code> 标志。</p>
<div class="highlight"><pre><span></span><code># sed &#39;s/unix/linux/gI&#39; sed-test.txt

1 linux linux linux 23
2 linux Linux 34
3 linuxlinux linuxLinux
linux /bin/bash CentOS Linux OS
Linux is free and opensource operating system
</code></pre></div>

<h3>10) 如何查找和替换包含分隔符的字符串</h3>
<p>当你搜索和替换含分隔符的字符串时，我们需要用反斜杠 <code>\</code> 来取消转义。</p>
<p>在这个例子中，我们将用 <code>/usr/bin/fish</code> 来替换 <code>/bin/bash</code>。</p>
<div class="highlight"><pre><span></span><code># sed &#39;s/\/bin\/bash/\/usr\/bin\/fish/g&#39; sed-test.txt

1 Unix unix unix 23
2 linux Linux 34
3 linuxunix UnixLinux
linux /usr/bin/fish CentOS Linux OS
Linux is free and opensource operating system
</code></pre></div>

<p>上述 <code>sed</code> 命令按预期工作，但它看起来来很糟糕。 为了简化，大部分的人会用竖线 <code>|</code> 作为正则表达式的定位符。 所以，我建议你用它。</p>
<div class="highlight"><pre><span></span><code># sed &#39;s|/bin/bash|/usr/bin/fish/|g&#39; sed-test.txt

1 Unix unix unix 23
2 linux Linux 34
3 linuxunix UnixLinux
linux /usr/bin/fish/ CentOS Linux OS
Linux is free and opensource operating system
</code></pre></div>

<h3>11) 如何以给定的模式来查找和替换数字</h3>
<p>类似地，数字可以用模式来代替。下面的 <code>sed</code> 命令以 <code>[0-9]</code> 替换所有数字为 <code>number</code>。</p>
<div class="highlight"><pre><span></span><code># sed &#39;s/[0-9]/number/g&#39; sed-test.txt

number Unix unix unix numbernumber
number linux Linux numbernumber
number linuxunix UnixLinux
linux /bin/bash CentOS Linux OS
Linux is free and opensource operating system
</code></pre></div>

<h3>12) 如何用模式仅查找和替换两个数字</h3>
<p>如果你想用模式来代替两位数字，使用下面的 <code>sed</code> 命令。</p>
<div class="highlight"><pre><span></span><code># sed &#39;s/\b[0-9]\{2\}\b/number/g&#39; sed-test.txt

1 Unix unix unix number
2 linux Linux number
3 linuxunix UnixLinux
linux /bin/bash CentOS Linux OS
Linux is free and opensource operating system
</code></pre></div>

<h3>13) 如何用 sed 命令仅打印被替换的行</h3>
<p>如果你想显示仅更改的行，使用下面的 <code>sed</code> 命令。</p>
<ul>
<li><code>p</code> - 它在终端上输出替换的行两次。</li>
<li><code>-n</code> - 它抑制由 <code>p</code> 标志所产生的重复行。</li>
</ul>
<div class="highlight"><pre><span></span><code># sed -n &#39;s/Unix/Linux/p&#39; sed-test.txt

1 Linux unix unix 23
3 linuxunix LinuxLinux
</code></pre></div>

<h3>14) 如何同时运行多个 sed 命令</h3>
<p>以下 <code>sed</code> 命令同时检测和置换两个不同的模式。</p>
<p>下面的 <code>sed</code> 命令搜索 <code>linuxunix</code> 和 <code>CentOS</code> 模式，用 <code>LINUXUNIX</code> 和 <code>RHEL8</code> 一次性更换它们。</p>
<div class="highlight"><pre><span></span><code># sed -e &#39;s/linuxunix/LINUXUNIX/g&#39; -e &#39;s/CentOS/RHEL8/g&#39; sed-test.txt

1 Unix unix unix 23
2 linux Linux 34
3 LINUXUNIX UnixLinux
linux /bin/bash RHEL8 Linux OS
Linux is free and opensource operating system
</code></pre></div>

<p>下面的 <code>sed</code> 命令搜索替换两个不同的模式，并一次性替换为一个字符串。</p>
<p>以下 <code>sed</code> 的命令搜索 <code>linuxunix</code> 和 <code>CentOS</code> 模式，用 <code>Fedora30</code> 替换它们。</p>
<div class="highlight"><pre><span></span><code># sed -e &#39;s/\(linuxunix\|CentOS\)/Fedora30/g&#39; sed-test.txt

1 Unix unix unix 23
2 linux Linux 34
3 Fedora30 UnixLinux
linux /bin/bash Fedora30 Linux OS
Linux is free and opensource operating system
</code></pre></div>

<h3>15) 如果给定的模式匹配，如何查找和替换整个行</h3>
<p>如果模式匹配，可以使用 <code>sed</code> 命令用新行来代替整行。这可以通过使用 <code>c</code> 标志来完成。</p>
<div class="highlight"><pre><span></span><code># sed &#39;/OS/ c\
New Line
&#39; sed-test.txt

1 Unix unix unix 23
2 linux Linux 34
3 linuxunix UnixLinux
New Line
Linux is free and opensource operating system
</code></pre></div>

<h3>16) 如何搜索和替换相匹配的模式行</h3>
<p>在 <code>sed</code> 命令中你可以为行指定适合的模式。在匹配该模式的情况下，<code>sed</code> 命令搜索要被替换的字符串。</p>
<p>下面的 <code>sed</code> 命令首先查找具有 <code>OS</code> 模式的行，然后用 <code>ArchLinux</code> 替换单词 <code>Linux</code>。</p>
<div class="highlight"><pre><span></span><code># sed &#39;/OS/ s/Linux/ArchLinux/&#39; sed-test.txt

1 Unix unix unix 23
2 linux Linux 34
3 linuxunix UnixLinux
linux /bin/bash CentOS ArchLinux OS
Linux is free and opensource operating system
</code></pre></div>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>