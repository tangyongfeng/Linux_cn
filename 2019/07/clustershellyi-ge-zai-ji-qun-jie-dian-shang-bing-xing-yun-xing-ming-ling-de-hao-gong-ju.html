<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>ClusterShell：一个在集群节点上并行运行命令的好工具</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: Magesh Maruthamuthu 我们过去曾写过两篇如何并行地在多个远程服务器上运行命令的文章：并行 SSH（PSSH） 和分布式 Shell（DSH）。今天，我们将讨论 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li class="active"><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2019/07/clustershellyi-ge-zai-ji-qun-jie-dian-shang-bing-xing-yun-xing-ming-ling-de-hao-gong-ju.html" rel="bookmark"
           title="Permalink to ClusterShell：一个在集群节点上并行运行命令的好工具">ClusterShell：一个在集群节点上并行运行命令的好工具</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2019-07-26T05:32:32+02:00">
                Published: Fri 26 July 2019
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/fen-xiang">分享</a>.</p>

</footer><!-- /.post-info -->      <p>Author: Magesh Maruthamuthu</p>
<p><img alt="" src="/data/attachment/album/201907/26/053202pgcgg1y1rc5l5mgg.jpg"></p>
<p>我们过去曾写过两篇如何并行地在多个远程服务器上运行命令的文章：<a href="https://www.2daygeek.com/pssh-parallel-ssh-run-execute-commands-on-multiple-linux-servers/">并行 SSH（PSSH）</a> 和<a href="https://www.2daygeek.com/dsh-run-execute-shell-commands-on-multiple-linux-servers-at-once/">分布式 Shell（DSH）</a>。今天，我们将讨论相同类型的主题，但它允许我们在集群节点上执行相同的操作。你可能会想，我可以编写一个小的 shell 脚本来实现这个目的，而不是安装这些第三方软件包。</p>
<p>当然，你是对的，如果要在十几个远程系统中运行一些命令，那么你不需要使用它。但是，你的脚本需要一些时间来完成此任务，因为它是按顺序运行的。想想你要是在一千多台服务器上运行一些命令会是什么样子？在这种情况下，你的脚本用处不大。此外，完成任务需要很长时间。所以，要克服这种问题和情况，我们需要可以在远程计算机上并行运行命令。</p>
<p>为此，我们需要在一个并行应用程序中使用它。我希望这个解释可以解决你对并行实用程序的疑虑。</p>
<h3>ClusterShell</h3>
<p><a href="https://cea-hpc.github.io/clustershell/">ClusterShell</a> 是一个事件驱动的开源 Python 库，旨在在服务器场或大型 Linux 集群上并行运行本地或远程命令。（<code>clush</code> 即 <a href="https://cea-hpc.github.io/clustershell/">ClusterShell</a>）。</p>
<p>它将处理在 HPC 集群上遇到的常见问题，例如在节点组上操作，使用优化过的执行算法运行分布式命令，以及收集结果和合并相同的输出，或检索返回代码。</p>
<p>ClusterShell 可以利用已安装在系统上的现有远程 shell 设施，如 SSH。</p>
<p>ClusterShell 的主要目标是通过为开发人员提供轻量级、但可扩展的 Python API 来改进高性能集群的管理。它还提供了 <code>clush</code>、<code>clubak</code> 和 <code>cluset</code>/<code>nodeset</code> 等方便的命令行工具，可以让传统的 shell 脚本利用这个库的一些功能。</p>
<p>ClusterShell 是用 Python 编写的，它需要 Python（v2.6+ 或 v3.4+）才能在你的系统上运行。</p>
<h3>如何在 Linux 上安装 ClusterShell？</h3>
<p>ClusterShell 包在大多数发行版的官方包管理器中都可用。因此，使用发行版包管理器工具进行安装。</p>
<p>对于 Fedora 系统，使用 <a href="https://www.2daygeek.com/dnf-command-examples-manage-packages-fedora-system/">DNF 命令</a>来安装 clustershell。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>clustershell
</code></pre></div>

<p>如果系统默认是 Python 2，这会安装 Python 2 模块和工具，可以运行以下命令安装 Python 3 开发包。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>python3-clustershell
</code></pre></div>

<p>在执行 clustershell 安装之前，请确保你已在系统上启用 <a href="https://www.2daygeek.com/install-enable-epel-repository-on-rhel-centos-scientific-linux-oracle-linux/">EPEL 存储库</a>。</p>
<p>对于 RHEL/CentOS 系统，使用 <a href="https://www.2daygeek.com/yum-command-examples-manage-packages-rhel-centos-systems/">YUM 命令</a> 来安装 clustershell。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>yum<span class="w"> </span>install<span class="w"> </span>clustershell
</code></pre></div>

<p>如果系统默认是 Python 2，这会安装 Python 2 模块和工具，可以运行以下命令安装 Python 3 开发包。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>yum<span class="w"> </span>install<span class="w"> </span>python34-clustershell
</code></pre></div>

<p>对于 openSUSE Leap 系统，使用 <a href="https://www.2daygeek.com/zypper-command-examples-manage-packages-opensuse-system/">Zypper 命令</a> 来安装 clustershell。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>zypper<span class="w"> </span>install<span class="w"> </span>clustershell
</code></pre></div>

<p>如果系统默认是 Python 2，这会安装 Python 2 模块和工具，可以运行以下命令安装 Python 3 开发包。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>zypper<span class="w"> </span>install<span class="w"> </span>python3-clustershell
</code></pre></div>

<p>对于 Debian/Ubuntu 系统，使用 <a href="https://www.2daygeek.com/apt-get-apt-cache-command-examples-manage-packages-debian-ubuntu-systems/">APT-GET 命令</a> 或 <a href="https://www.2daygeek.com/apt-command-examples-manage-packages-debian-ubuntu-systems/">APT 命令</a> 来安装 clustershell。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>clustershell
</code></pre></div>

<h3>如何在 Linux 使用 PIP 安装 ClusterShell？</h3>
<p>可以使用 PIP 安装 ClusterShell，因为它是用 Python 编写的。</p>
<p>在执行 clustershell 安装之前，请确保你已在系统上启用了 <a href="https://www.2daygeek.com/3-methods-to-install-latest-python3-package-on-centos-6-system/">Python</a> 和 <a href="https://www.2daygeek.com/install-pip-manage-python-packages-linux/">PIP</a>。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>ClusterShell
</code></pre></div>

<h3>如何在 Linux 上使用 ClusterShell？</h3>
<p>与其他实用程序（如 <code>pssh</code> 和 <code>dsh</code>）相比，它是直接了当的优秀工具。它有很多选项可以在远程并行执行。</p>
<p>在开始使用 clustershell 之前，请确保你已启用系统上的<a href="https://www.2daygeek.com/linux-passwordless-ssh-login-using-ssh-keygen/">无密码登录</a>。</p>
<p>以下配置文件定义了系统范围的默认值。你不需要修改这里的任何东西。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>cat<span class="w"> </span>/etc/clustershell/clush.conf
</code></pre></div>

<p>如果你想要创建一个服务器组，那也可以。默认情况下有一些示例，请根据你的要求执行相同操作。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>cat<span class="w"> </span>/etc/clustershell/groups.d/local.cfg
</code></pre></div>

<p>只需按以下列格式运行 clustershell 命令即可从给定节点获取信息：</p>
<div class="highlight"><pre><span></span><code><span class="n">$</span><span class="w"> </span><span class="n">clush</span><span class="w"> </span><span class="o">-</span><span class="n">w</span><span class="w"> </span><span class="mf">192.168.1.4</span><span class="p">,</span><span class="mf">192.168.1.9</span><span class="w"> </span><span class="n">cat</span><span class="w"> </span><span class="o">/</span><span class="n">proc</span><span class="o">/</span><span class="n">version</span>
<span class="mf">192.168.1.9</span><span class="o">:</span><span class="w"> </span><span class="n">Linux</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">4.15.0</span><span class="mi">-45</span><span class="o">-</span><span class="n">generic</span><span class="w"> </span><span class="p">([</span><span class="n">email</span><span class="w"> </span><span class="n">protected</span><span class="p">])</span><span class="w"> </span><span class="p">(</span><span class="n">gcc</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">7.3.0</span><span class="w"> </span><span class="p">(</span><span class="n">Ubuntu</span><span class="w"> </span><span class="mf">7.3.0</span><span class="mi">-16u</span><span class="n">buntu3</span><span class="p">))</span><span class="w"> </span><span class="err">#</span><span class="mi">48</span><span class="o">-</span><span class="n">Ubuntu</span><span class="w"> </span><span class="n">SMP</span><span class="w"> </span><span class="n">Tue</span><span class="w"> </span><span class="n">Jan</span><span class="w"> </span><span class="mi">29</span><span class="w"> </span><span class="mi">16</span><span class="o">:</span><span class="mi">28</span><span class="o">:</span><span class="mi">13</span><span class="w"> </span><span class="n">UTC</span><span class="w"> </span><span class="mi">2019</span>
<span class="mf">192.168.1.4</span><span class="o">:</span><span class="w"> </span><span class="n">Linux</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">3.10.0-957.</span><span class="n">el7</span><span class="p">.</span><span class="n">x86_64</span><span class="w"> </span><span class="p">([</span><span class="n">email</span><span class="w"> </span><span class="n">protected</span><span class="p">])</span><span class="w"> </span><span class="p">(</span><span class="n">gcc</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">4.8.5</span><span class="w"> </span><span class="mi">20150623</span><span class="w"> </span><span class="p">(</span><span class="n">Red</span><span class="w"> </span><span class="n">Hat</span><span class="w"> </span><span class="mf">4.8.5</span><span class="mi">-36</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">GCC</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="err">#</span><span class="mi">1</span><span class="w"> </span><span class="n">SMP</span><span class="w"> </span><span class="n">Thu</span><span class="w"> </span><span class="n">Nov</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="mi">23</span><span class="o">:</span><span class="mi">39</span><span class="o">:</span><span class="mi">32</span><span class="w"> </span><span class="n">UTC</span><span class="w"> </span><span class="mi">2018</span>
</code></pre></div>

<p>选项：</p>
<ul>
<li><code>-w:</code> 你要运行该命令的节点。</li>
</ul>
<p>你可以使用正则表达式而不是使用完整主机名和 IP：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>clush<span class="w"> </span>-w<span class="w"> </span><span class="m">192</span>.168.1.<span class="o">[</span><span class="m">4</span>,9<span class="o">]</span><span class="w"> </span>uname<span class="w"> </span>-r
<span class="m">192</span>.168.1.9:<span class="w"> </span><span class="m">4</span>.15.0-45-generic
<span class="m">192</span>.168.1.4:<span class="w"> </span><span class="m">3</span>.10.0-957.el7.x86_64
</code></pre></div>

<p>或者，如果服务器位于同一 IP 系列中，则可以使用以下格式：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>clush<span class="w"> </span>-w<span class="w"> </span><span class="m">192</span>.168.1.<span class="o">[</span><span class="m">4</span>-9<span class="o">]</span><span class="w"> </span>date
<span class="m">192</span>.168.1.6:<span class="w"> </span>Mon<span class="w"> </span>Mar<span class="w">  </span><span class="m">4</span><span class="w"> </span><span class="m">21</span>:08:29<span class="w"> </span>IST<span class="w"> </span><span class="m">2019</span>
<span class="m">192</span>.168.1.7:<span class="w"> </span>Mon<span class="w"> </span>Mar<span class="w">  </span><span class="m">4</span><span class="w"> </span><span class="m">21</span>:08:29<span class="w"> </span>IST<span class="w"> </span><span class="m">2019</span>
<span class="m">192</span>.168.1.8:<span class="w"> </span>Mon<span class="w"> </span>Mar<span class="w">  </span><span class="m">4</span><span class="w"> </span><span class="m">21</span>:08:29<span class="w"> </span>IST<span class="w"> </span><span class="m">2019</span>
<span class="m">192</span>.168.1.5:<span class="w"> </span>Mon<span class="w"> </span>Mar<span class="w">  </span><span class="m">4</span><span class="w"> </span><span class="m">09</span>:16:30<span class="w"> </span>CST<span class="w"> </span><span class="m">2019</span>
<span class="m">192</span>.168.1.9:<span class="w"> </span>Mon<span class="w"> </span>Mar<span class="w">  </span><span class="m">4</span><span class="w"> </span><span class="m">21</span>:08:29<span class="w"> </span>IST<span class="w"> </span><span class="m">2019</span>
<span class="m">192</span>.168.1.4:<span class="w"> </span>Mon<span class="w"> </span>Mar<span class="w">  </span><span class="m">4</span><span class="w"> </span><span class="m">09</span>:16:30<span class="w"> </span>CST<span class="w"> </span><span class="m">2019</span>
</code></pre></div>

<p>clustershell 允许我们以批处理模式运行命令。使用以下格式来实现此目的：</p>
<div class="highlight"><pre><span></span><code><span class="o">$</span><span class="w"> </span><span class="n">clush</span><span class="w"> </span><span class="o">-</span><span class="n">w</span><span class="w"> </span><span class="mf">192.168</span><span class="o">.</span><span class="mf">1.4</span><span class="p">,</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">1.9</span><span class="w"> </span><span class="o">-</span><span class="n">b</span>
<span class="n">Enter</span><span class="w"> </span><span class="s1">&#39;quit&#39;</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">leave</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">interactive</span><span class="w"> </span><span class="n">mode</span>
<span class="n">Working</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">nodes</span><span class="p">:</span><span class="w"> </span><span class="mf">192.168</span><span class="o">.</span><span class="mf">1.</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">9</span><span class="p">]</span>
<span class="n">clush</span><span class="o">&gt;</span><span class="w"> </span><span class="n">hostnamectl</span>
<span class="o">---------------</span>
<span class="mf">192.168</span><span class="o">.</span><span class="mf">1.4</span>
<span class="o">---------------</span>
<span class="w">   </span><span class="n">Static</span><span class="w"> </span><span class="n">hostname</span><span class="p">:</span><span class="w"> </span><span class="n">CentOS7</span><span class="o">.</span><span class="mi">2</span><span class="n">daygeek</span><span class="o">.</span><span class="n">com</span>
<span class="w">         </span><span class="n">Icon</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="n">computer</span><span class="o">-</span><span class="n">vm</span>
<span class="w">           </span><span class="n">Chassis</span><span class="p">:</span><span class="w"> </span><span class="n">vm</span>
<span class="w">        </span><span class="n">Machine</span><span class="w"> </span><span class="n">ID</span><span class="p">:</span><span class="w"> </span><span class="mi">002</span><span class="n">f47b82af248f5be1d67b67e03514c</span>
<span class="w">           </span><span class="n">Boot</span><span class="w"> </span><span class="n">ID</span><span class="p">:</span><span class="w"> </span><span class="n">f9b37a073c534dec8b236885e754cb56</span>
<span class="w">    </span><span class="n">Virtualization</span><span class="p">:</span><span class="w"> </span><span class="n">kvm</span>
<span class="w">  </span><span class="n">Operating</span><span class="w"> </span><span class="n">System</span><span class="p">:</span><span class="w"> </span><span class="n">CentOS</span><span class="w"> </span><span class="n">Linux</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="p">(</span><span class="n">Core</span><span class="p">)</span>
<span class="w">       </span><span class="n">CPE</span><span class="w"> </span><span class="n">OS</span><span class="w"> </span><span class="n">Name</span><span class="p">:</span><span class="w"> </span><span class="n">cpe</span><span class="p">:</span><span class="o">/</span><span class="n">o</span><span class="p">:</span><span class="n">centos</span><span class="p">:</span><span class="n">centos</span><span class="p">:</span><span class="mi">7</span>
<span class="w">            </span><span class="n">Kernel</span><span class="p">:</span><span class="w"> </span><span class="n">Linux</span><span class="w"> </span><span class="mf">3.10</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">957.</span><span class="n">el7</span><span class="o">.</span><span class="n">x86_64</span>
<span class="w">      </span><span class="n">Architecture</span><span class="p">:</span><span class="w"> </span><span class="n">x86</span><span class="o">-</span><span class="mi">64</span>
<span class="o">---------------</span>
<span class="mf">192.168</span><span class="o">.</span><span class="mf">1.9</span>
<span class="o">---------------</span>
<span class="w">   </span><span class="n">Static</span><span class="w"> </span><span class="n">hostname</span><span class="p">:</span><span class="w"> </span><span class="n">Ubuntu18</span>
<span class="w">         </span><span class="n">Icon</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="n">computer</span><span class="o">-</span><span class="n">vm</span>
<span class="w">           </span><span class="n">Chassis</span><span class="p">:</span><span class="w"> </span><span class="n">vm</span>
<span class="w">        </span><span class="n">Machine</span><span class="w"> </span><span class="n">ID</span><span class="p">:</span><span class="w"> </span><span class="mi">27</span><span class="n">f6c2febda84dc881f28fd145077187</span>
<span class="w">           </span><span class="n">Boot</span><span class="w"> </span><span class="n">ID</span><span class="p">:</span><span class="w"> </span><span class="n">f176f2eb45524d4f906d12e2b5716649</span>
<span class="w">    </span><span class="n">Virtualization</span><span class="p">:</span><span class="w"> </span><span class="n">oracle</span>
<span class="w">  </span><span class="n">Operating</span><span class="w"> </span><span class="n">System</span><span class="p">:</span><span class="w"> </span><span class="n">Ubuntu</span><span class="w"> </span><span class="mf">18.04</span><span class="o">.</span><span class="mi">2</span><span class="w"> </span><span class="n">LTS</span>
<span class="w">            </span><span class="n">Kernel</span><span class="p">:</span><span class="w"> </span><span class="n">Linux</span><span class="w"> </span><span class="mf">4.15</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mi">45</span><span class="o">-</span><span class="n">generic</span>
<span class="w">      </span><span class="n">Architecture</span><span class="p">:</span><span class="w"> </span><span class="n">x86</span><span class="o">-</span><span class="mi">64</span>
<span class="n">clush</span><span class="o">&gt;</span><span class="w"> </span><span class="n">free</span><span class="w"> </span><span class="o">-</span><span class="n">m</span>
<span class="o">---------------</span>
<span class="mf">192.168</span><span class="o">.</span><span class="mf">1.4</span>
<span class="o">---------------</span>
<span class="w">              </span><span class="n">total</span><span class="w">        </span><span class="n">used</span><span class="w">        </span><span class="n">free</span><span class="w">      </span><span class="n">shared</span><span class="w">  </span><span class="n">buff</span><span class="o">/</span><span class="n">cache</span><span class="w">   </span><span class="n">available</span>
<span class="n">Mem</span><span class="p">:</span><span class="w">           </span><span class="mi">1838</span><span class="w">         </span><span class="mi">641</span><span class="w">         </span><span class="mi">217</span><span class="w">          </span><span class="mi">19</span><span class="w">         </span><span class="mi">978</span><span class="w">         </span><span class="mi">969</span>
<span class="n">Swap</span><span class="p">:</span><span class="w">          </span><span class="mi">2047</span><span class="w">           </span><span class="mi">0</span><span class="w">        </span><span class="mi">2047</span>
<span class="o">---------------</span>
<span class="mf">192.168</span><span class="o">.</span><span class="mf">1.9</span>
<span class="o">---------------</span>
<span class="w">              </span><span class="n">total</span><span class="w">        </span><span class="n">used</span><span class="w">        </span><span class="n">free</span><span class="w">      </span><span class="n">shared</span><span class="w">  </span><span class="n">buff</span><span class="o">/</span><span class="n">cache</span><span class="w">   </span><span class="n">available</span>
<span class="n">Mem</span><span class="p">:</span><span class="w">           </span><span class="mi">1993</span><span class="w">         </span><span class="mi">352</span><span class="w">        </span><span class="mi">1067</span><span class="w">           </span><span class="mi">1</span><span class="w">         </span><span class="mi">573</span><span class="w">        </span><span class="mi">1473</span>
<span class="n">Swap</span><span class="p">:</span><span class="w">          </span><span class="mi">1425</span><span class="w">           </span><span class="mi">0</span><span class="w">        </span><span class="mi">1425</span>
<span class="n">clush</span><span class="o">&gt;</span><span class="w"> </span><span class="n">w</span>
<span class="o">---------------</span>
<span class="mf">192.168</span><span class="o">.</span><span class="mf">1.4</span>
<span class="o">---------------</span>
<span class="w"> </span><span class="mi">09</span><span class="p">:</span><span class="mi">21</span><span class="p">:</span><span class="mi">14</span><span class="w"> </span><span class="n">up</span><span class="w">  </span><span class="mi">3</span><span class="p">:</span><span class="mi">21</span><span class="p">,</span><span class="w">  </span><span class="mi">3</span><span class="w"> </span><span class="n">users</span><span class="p">,</span><span class="w">  </span><span class="nb">load</span><span class="w"> </span><span class="n">average</span><span class="p">:</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span><span class="mf">0.05</span>
<span class="n">USER</span><span class="w">     </span><span class="n">TTY</span><span class="w">      </span><span class="n">FROM</span><span class="w">             </span><span class="n">LOGIN</span><span class="err">@</span><span class="w">   </span><span class="n">IDLE</span><span class="w">   </span><span class="n">JCPU</span><span class="w">   </span><span class="n">PCPU</span><span class="w"> </span><span class="n">WHAT</span>
<span class="n">daygeek</span><span class="w">  </span><span class="p">:</span><span class="mi">0</span><span class="w">       </span><span class="p">:</span><span class="mi">0</span><span class="w">               </span><span class="mi">06</span><span class="p">:</span><span class="mi">02</span><span class="w">   </span><span class="err">?</span><span class="n">xdm</span><span class="err">?</span><span class="w">   </span><span class="mi">1</span><span class="p">:</span><span class="mi">28</span><span class="w">   </span><span class="mf">0.30</span><span class="n">s</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">libexec</span><span class="o">/</span><span class="n">gnome</span><span class="o">-</span><span class="n">session</span><span class="o">-</span><span class="n">binary</span><span class="w"> </span><span class="o">--</span><span class="n">session</span><span class="w"> </span><span class="n">gnome</span><span class="o">-</span><span class="n">classic</span>
<span class="n">daygeek</span><span class="w">  </span><span class="n">pts</span><span class="o">/</span><span class="mi">0</span><span class="w">    </span><span class="p">:</span><span class="mi">0</span><span class="w">               </span><span class="mi">06</span><span class="p">:</span><span class="mi">03</span><span class="w">    </span><span class="mi">3</span><span class="p">:</span><span class="mi">17</span><span class="n">m</span><span class="w">  </span><span class="mf">0.06</span><span class="n">s</span><span class="w">  </span><span class="mf">0.06</span><span class="n">s</span><span class="w"> </span><span class="n">bash</span>
<span class="n">daygeek</span><span class="w">  </span><span class="n">pts</span><span class="o">/</span><span class="mi">1</span><span class="w">    </span><span class="mf">192.168</span><span class="o">.</span><span class="mf">1.6</span><span class="w">      </span><span class="mi">06</span><span class="p">:</span><span class="mi">03</span><span class="w">   </span><span class="mi">52</span><span class="p">:</span><span class="mi">26</span><span class="w">   </span><span class="mf">0.10</span><span class="n">s</span><span class="w">  </span><span class="mf">0.10</span><span class="n">s</span><span class="w"> </span><span class="o">-</span><span class="n">bash</span>
<span class="o">---------------</span>
<span class="mf">192.168</span><span class="o">.</span><span class="mf">1.9</span>
<span class="o">---------------</span>
<span class="w"> </span><span class="mi">21</span><span class="p">:</span><span class="mi">13</span><span class="p">:</span><span class="mi">12</span><span class="w"> </span><span class="n">up</span><span class="w">  </span><span class="mi">3</span><span class="p">:</span><span class="mi">12</span><span class="p">,</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="n">user</span><span class="p">,</span><span class="w">  </span><span class="nb">load</span><span class="w"> </span><span class="n">average</span><span class="p">:</span><span class="w"> </span><span class="mf">0.08</span><span class="p">,</span><span class="w"> </span><span class="mf">0.03</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span>
<span class="n">USER</span><span class="w">     </span><span class="n">TTY</span><span class="w">      </span><span class="n">FROM</span><span class="w">             </span><span class="n">LOGIN</span><span class="err">@</span><span class="w">   </span><span class="n">IDLE</span><span class="w">   </span><span class="n">JCPU</span><span class="w">   </span><span class="n">PCPU</span><span class="w"> </span><span class="n">WHAT</span>
<span class="n">daygeek</span><span class="w">  </span><span class="n">pts</span><span class="o">/</span><span class="mi">0</span><span class="w">    </span><span class="mf">192.168</span><span class="o">.</span><span class="mf">1.6</span><span class="w">      </span><span class="mi">20</span><span class="p">:</span><span class="mi">42</span><span class="w">   </span><span class="mi">29</span><span class="p">:</span><span class="mi">41</span><span class="w">   </span><span class="mf">0.05</span><span class="n">s</span><span class="w">  </span><span class="mf">0.05</span><span class="n">s</span><span class="w"> </span><span class="o">-</span><span class="n">bash</span>
<span class="n">clush</span><span class="o">&gt;</span><span class="w"> </span><span class="n">quit</span>
</code></pre></div>

<p>如果要在一组节点上运行该命令，请使用以下格式：</p>
<div class="highlight"><pre><span></span><code><span class="o">$</span><span class="w"> </span><span class="n">clush</span><span class="w"> </span><span class="o">-</span><span class="n">w</span><span class="w"> </span><span class="err">@</span><span class="n">dev</span><span class="w"> </span><span class="n">uptime</span>
<span class="ow">or</span>
<span class="o">$</span><span class="w"> </span><span class="n">clush</span><span class="w"> </span><span class="o">-</span><span class="n">g</span><span class="w"> </span><span class="n">dev</span><span class="w"> </span><span class="n">uptime</span>
<span class="ow">or</span>
<span class="o">$</span><span class="w"> </span><span class="n">clush</span><span class="w"> </span><span class="o">--</span><span class="n">group</span><span class="o">=</span><span class="n">dev</span><span class="w"> </span><span class="n">uptime</span>

<span class="mf">192.168</span><span class="o">.</span><span class="mf">1.9</span><span class="p">:</span><span class="w">  </span><span class="mi">21</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">10</span><span class="w"> </span><span class="n">up</span><span class="w">  </span><span class="mi">3</span><span class="p">:</span><span class="mi">09</span><span class="p">,</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="n">user</span><span class="p">,</span><span class="w">  </span><span class="nb">load</span><span class="w"> </span><span class="n">average</span><span class="p">:</span><span class="w"> </span><span class="mf">0.09</span><span class="p">,</span><span class="w"> </span><span class="mf">0.03</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01</span>
<span class="mf">192.168</span><span class="o">.</span><span class="mf">1.4</span><span class="p">:</span><span class="w">  </span><span class="mi">09</span><span class="p">:</span><span class="mi">18</span><span class="p">:</span><span class="mi">12</span><span class="w"> </span><span class="n">up</span><span class="w">  </span><span class="mi">3</span><span class="p">:</span><span class="mi">18</span><span class="p">,</span><span class="w">  </span><span class="mi">3</span><span class="w"> </span><span class="n">users</span><span class="p">,</span><span class="w">  </span><span class="nb">load</span><span class="w"> </span><span class="n">average</span><span class="p">:</span><span class="w"> </span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span><span class="mf">0.02</span><span class="p">,</span><span class="w"> </span><span class="mf">0.05</span>
</code></pre></div>

<p>如果要在多个节点组上运行该命令，请使用以下格式：</p>
<div class="highlight"><pre><span></span><code><span class="o">$</span><span class="w"> </span><span class="n">clush</span><span class="w"> </span><span class="o">-</span><span class="n">w</span><span class="w"> </span><span class="err">@</span><span class="n">dev</span><span class="p">,</span><span class="err">@</span><span class="n">uat</span><span class="w"> </span><span class="n">uptime</span>
<span class="ow">or</span>
<span class="o">$</span><span class="w"> </span><span class="n">clush</span><span class="w"> </span><span class="o">-</span><span class="n">g</span><span class="w"> </span><span class="n">dev</span><span class="p">,</span><span class="n">uat</span><span class="w"> </span><span class="n">uptime</span>
<span class="ow">or</span>
<span class="o">$</span><span class="w"> </span><span class="n">clush</span><span class="w"> </span><span class="o">--</span><span class="n">group</span><span class="o">=</span><span class="n">dev</span><span class="p">,</span><span class="n">uat</span><span class="w"> </span><span class="n">uptime</span>

<span class="mf">192.168</span><span class="o">.</span><span class="mf">1.7</span><span class="p">:</span><span class="w"> </span><span class="mi">07</span><span class="p">:</span><span class="mi">57</span><span class="p">:</span><span class="mi">19</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="mi">59</span><span class="w"> </span><span class="nb">min</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">user</span><span class="p">,</span><span class="w"> </span><span class="nb">load</span><span class="w"> </span><span class="n">average</span><span class="p">:</span><span class="w"> </span><span class="mf">0.08</span><span class="p">,</span><span class="w"> </span><span class="mf">0.03</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span>
<span class="mf">192.168</span><span class="o">.</span><span class="mf">1.9</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">20</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="mi">00</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">user</span><span class="p">,</span><span class="w"> </span><span class="nb">load</span><span class="w"> </span><span class="n">average</span><span class="p">:</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.00</span>
<span class="mf">192.168</span><span class="o">.</span><span class="mf">1.5</span><span class="p">:</span><span class="w"> </span><span class="mi">08</span><span class="p">:</span><span class="mi">57</span><span class="p">:</span><span class="mi">21</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="mi">59</span><span class="w"> </span><span class="nb">min</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">user</span><span class="p">,</span><span class="w"> </span><span class="nb">load</span><span class="w"> </span><span class="n">average</span><span class="p">:</span><span class="w"> </span><span class="mf">0.00</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span><span class="mf">0.05</span>
</code></pre></div>

<p>clustershell 允许我们将文件复制到远程计算机。将本地文件或目录复制到同一个远程节点：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>clush<span class="w"> </span>-w<span class="w"> </span><span class="m">192</span>.168.1.<span class="o">[</span><span class="m">4</span>,9<span class="o">]</span><span class="w"> </span>--copy<span class="w"> </span>/home/daygeek/passwd-up.sh
</code></pre></div>

<p>我们可以通过运行以下命令来验证它：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>clush<span class="w"> </span>-w<span class="w"> </span><span class="m">192</span>.168.1.<span class="o">[</span><span class="m">4</span>,9<span class="o">]</span><span class="w"> </span>ls<span class="w"> </span>-lh<span class="w"> </span>/home/daygeek/passwd-up.sh
<span class="m">192</span>.168.1.4:<span class="w"> </span>-rwxr-xr-x.<span class="w"> </span><span class="m">1</span><span class="w"> </span>daygeek<span class="w"> </span>daygeek<span class="w"> </span><span class="m">159</span><span class="w"> </span>Mar<span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">09</span>:00<span class="w"> </span>/home/daygeek/passwd-up.sh
<span class="m">192</span>.168.1.9:<span class="w"> </span>-rwxr-xr-x<span class="w"> </span><span class="m">1</span><span class="w"> </span>daygeek<span class="w"> </span>daygeek<span class="w"> </span><span class="m">159</span><span class="w"> </span>Mar<span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">20</span>:52<span class="w"> </span>/home/daygeek/passwd-up.sh
</code></pre></div>

<p>将本地文件或目录复制到不同位置的远程节点：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>clush<span class="w"> </span>-g<span class="w"> </span>uat<span class="w"> </span>--copy<span class="w"> </span>/home/daygeek/passwd-up.sh<span class="w"> </span>--dest<span class="w"> </span>/tmp
</code></pre></div>

<p>我们可以通过运行以下命令来验证它：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>clush<span class="w"> </span>--group<span class="o">=</span>uat<span class="w"> </span>ls<span class="w"> </span>-lh<span class="w"> </span>/tmp/passwd-up.sh
<span class="m">192</span>.168.1.7:<span class="w"> </span>-rwxr-xr-x.<span class="w"> </span><span class="m">1</span><span class="w"> </span>daygeek<span class="w"> </span>daygeek<span class="w"> </span><span class="m">159</span><span class="w"> </span>Mar<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">07</span>:44<span class="w"> </span>/tmp/passwd-up.sh
</code></pre></div>

<p>将文件或目录从远程节点复制到本地系统：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>clush<span class="w"> </span>-w<span class="w"> </span><span class="m">192</span>.168.1.7<span class="w"> </span>--rcopy<span class="w"> </span>/home/daygeek/Documents/magi.txt<span class="w"> </span>--dest<span class="w"> </span>/tmp
</code></pre></div>

<p>我们可以通过运行以下命令来验证它：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ls<span class="w"> </span>-lh<span class="w"> </span>/tmp/magi.txt.192.168.1.7
-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>daygeek<span class="w"> </span>daygeek<span class="w"> </span><span class="m">35</span><span class="w"> </span>Mar<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">20</span>:24<span class="w"> </span>/tmp/magi.txt.192.168.1.7
</code></pre></div>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>