<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>tmux：适用于重度命令行 Linux 用户的终端复用器</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: Magesh Maruthamuthu tmux 是 终端复用器 terminal multiplexer 的缩写，它允许用户在单个窗口中创建或启用多个终端（垂直或水平），当你处理不同的问题时 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li class="active"><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2019/01/tmuxgua-yong-yu-zhong-du-ming-ling-xing-linux-yong-hu-de-zhong-duan-fu-yong-qi.html" rel="bookmark"
           title="Permalink to tmux：适用于重度命令行 Linux 用户的终端复用器">tmux：适用于重度命令行 Linux 用户的终端复用器</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2019-01-27T11:57:36+01:00">
                Published: Sun 27 January 2019
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/ji-zhu">技术</a>.</p>

</footer><!-- /.post-info -->      <p>Author: Magesh Maruthamuthu</p>
<p><img alt="" src="/data/attachment/album/201901/27/115721l0rp0cn3ptq1u91c.jpg"></p>
<p>tmux 是<ruby> 终端复用器 <rt>  terminal multiplexer </rt></ruby>的缩写，它允许用户在单个窗口中创建或启用多个终端（垂直或水平），当你处理不同的问题时，可以在单个窗口中轻松访问和控制它们。</p>
<p>它使用客户端-服务器模型，允许在用户之间共享会话，也可以将终端连接到 tmux 会话。我们可以根据需要轻松移动或重新排列虚拟控制台。终端会话可以从一个虚拟控制台自由切换到另一个。</p>
<p>tmux 依赖于 <code>libevent</code> 和 <code>ncurses</code> 库。tmux 在屏幕底部提供了一个状态行，它显示当前 tmux 会话的有关信息，例如当前窗口编号、窗口名称、用户名、主机名、当前时间和日期。</p>
<p>启动 tmux 时，它会在一个单独窗口上创建一个新的会话，并将其显示在屏幕上。它允许用户在同一个会话中创建任意数量的窗口。</p>
<p>许多人说它类似于 <code>screen</code>，但我不这么认为，因为它提供了许多配置选项。</p>
<p><strong>注意：</strong> <code>Ctrl+b</code> 是 tmux 中的默认命令前缀，因此，要在 tmux 中执行任何操作，你必须先输入该前缀然后输入所需的选项。</p>
<h3>tmux 特性</h3>
<ul>
<li>创建任意数量的窗口</li>
<li>在一个窗口中创建任意数量的窗格</li>
<li>它允许垂直和水平分割</li>
<li>分离并重新连接窗口</li>
<li>客户端-服务器架构，这允许用户之间共享会话</li>
<li>tmux 提供许多配置技巧</li>
</ul>
<p><strong>建议阅读：</strong></p>
<ul>
<li><a href="https://www.2daygeek.com/tmate-instantly-share-your-terminal-session-to-anyone-in-seconds/">tmate - 马上与其他人分享你的终端会话</a></li>
<li><a href="https://www.2daygeek.com/teleconsole-share-terminal-session-instantly-to-anyone-in-seconds/">Teleconsole - 一个与其他人分享终端会话的工具</a></li>
</ul>
<h3>如何安装 tmux 命令</h3>
<p>大多数 Linux 系统默认预安装 tmux 命令。如果没有，按照以下步骤安装。</p>
<p>对于 Debian/Ubuntu，使用 <a href="https://www.2daygeek.com/apt-get-apt-cache-command-examples-manage-packages-debian-ubuntu-systems/">APT-GET 命令</a>或 <a href="https://www.2daygeek.com/apt-command-examples-manage-packages-debian-ubuntu-systems/">APT 命令</a>来安装：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>tmux
</code></pre></div>

<p>对于 RHEL/CentOS，使用 <a href="https://www.2daygeek.com/yum-command-examples-manage-packages-rhel-centos-systems/">YUM 命令</a>来安装：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>yum<span class="w"> </span>install<span class="w"> </span>tmux
</code></pre></div>

<p>对于 Fedora，使用 <a href="https://www.2daygeek.com/dnf-command-examples-manage-packages-fedora-system/">DNF 命令</a>来安装：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>tmux
</code></pre></div>

<p>对于 Arch Linux，使用 <a href="https://www.2daygeek.com/pacman-command-examples-manage-packages-arch-linux-system/">Pacman 命令</a>来安装：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>pacman<span class="w"> </span>-S<span class="w"> </span>tmux
</code></pre></div>

<p>对于 openSUSE，使用 <a href="https://www.2daygeek.com/zypper-command-examples-manage-packages-opensuse-system/">Zypper 命令</a>来安装：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>zypper<span class="w"> </span><span class="k">in</span><span class="w"> </span>tmux
</code></pre></div>

<h3>如何使用 tmux</h3>
<p>在终端上运行以下命令来启动 tmux 会话。启动 tmux 后，它会在一个新窗口中创建新会话，并将使用你的用户账户自动登录到你的默认 shell。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>tmux
</code></pre></div>

<p><img alt="" src="/data/attachment/album/201901/27/115737zzi48znxb8n0wzru.png"></p>
<p>你会得到类似于我们上面的截图。tmux 附带状态栏，显示有关当前会话详细信息、日期、时间等。</p>
<p>状态栏信息如下：</p>
<ul>
<li><code>[0]</code>：它表示由 tmux 服务器创建的会话号。默认情况下，它从 0 开始。</li>
<li><code>0:bash</code>：表示会话号、命令行提示符（这里的 <code>bash</code> 表示 shell 名称）。</li>
<li><code>*</code>：这表示该窗口现在处于活动状态。</li>
<li>主机名：显示服务器的完全主机名。</li>
<li>日期与时间：显示当前日期和时间。</li>
</ul>
<p>（LCTT 译注：tmux 的状态可以根据需要定制，也会因环境、版本的不同而不同。）</p>
<h3>如何拆分窗口</h3>
<p>tmux 允许用户垂直或水平分割窗口，称为窗格。每个窗格都包含自己独立运行的终端实例。我们来看看如何做到这一点。</p>
<p>按下 <code>Ctrl+b, %</code> 来垂直分割窗格。</p>
<p><img alt="" src="/data/attachment/album/201901/27/115738fe7cgtwabwx1n7tg.png"></p>
<p>按下 <code>Ctrl+b, "</code> 来水平分割窗格。</p>
<p><img alt="" src="/data/attachment/album/201901/27/115738c6hh2p0bp8tth2dh.png"></p>
<h3>如何在窗格之间移动</h3>
<p>假设，我们创建了一些窗格，希望在它们之间移动，这该怎么做？如果你不知道怎么做，那么使用 tmux 就没有意义了。使用以下控制键执行操作。在窗格之间移动有许多方法。</p>
<ul>
<li>按 <code>Ctrl+b, ←</code> - 选择左边的窗格</li>
<li>按 <code>Ctrl+b, →</code> - 选择右边的窗格</li>
<li>按 <code>Ctrl+b, ↑</code> - 选择上边的窗格</li>
<li>按 <code>Ctrl+b, ↓</code> - 选择下边的窗格</li>
<li>按 <code>Ctrl+b, {</code> - 来向左交换窗格</li>
<li>按 <code>Ctrl+b, }</code> - 来向右交换窗格</li>
<li>按 <code>Ctrl+b, o</code> - 切换到下一个窗格（从左到右，从上到下）</li>
<li>按 <code>Ctrl+b, ;</code> - 移动到先前活动的窗格</li>
</ul>
<p>出于测试目的，我们将在窗格之间移动。现在我们在 <code>pane2</code> 中，它展示了 <code>lsb_release -a</code> 命令的输出。</p>
<p><img alt="" src="/data/attachment/album/201901/27/115738m9i13v19n9v1sbs1.png"></p>
<p>我们将移动到 <code>pane0</code>，它显示 <code>uname -a</code> 命令的输出。</p>
<p><img alt="" src="/data/attachment/album/201901/27/115739za3230hb33ozdb4a.png"></p>
<h3>如何打开/创建新窗口</h3>
<p>你可以在一个终端内打开任意数量的窗口。</p>
<ul>
<li>按 <code>Ctrl+b, c</code> 来创建一个新窗口。</li>
<li>按 <code>Ctrl+b, n</code> 移动到下一个窗口。</li>
<li>按 <code>Ctrl+b, p</code> 移动到上一个窗口。</li>
<li>按 <code>Ctrl+b, 0</code> ~ <code>Ctrl+b, 9</code> 立即移动到特定窗口。</li>
<li>按 <code>Ctrl+b, l</code> 移动到先前选择的窗口。</li>
</ul>
<p>我有两个窗口，第一个窗口有三个窗格，其中包含操作系统版本信息，<code>top</code> 命令输出和内核信息。</p>
<p><img alt="" src="/data/attachment/album/201901/27/115739yzbexhmyysxd4yiz.png"></p>
<p>第二个窗口有两个窗格，其中包含 Linux 发行版 logo 信息。使用以下命令执行操作：</p>
<p><img alt="" src="/data/attachment/album/201901/27/115740jtg1sj77gsjdsgyw.png"></p>
<p>按 <code>Ctrl+b, w</code> 以交互方式选择当前窗口。</p>
<p><img alt="" src="/data/attachment/album/201901/27/115740aq0rjcjdcuqrj7cc.png"></p>
<h3>如何缩放窗格</h3>
<p>你正在一些非常小的窗格中工作，并且你希望将其缩小以进行进一步的工作。要做到这一点，使用以下键绑定。</p>
<p>目前我们有三个窗格，我在 <code>pane1</code> 工作，它使用 <code>top</code> 命令显示系统活动信息，我将缩放它。</p>
<p><img alt="" src="/data/attachment/album/201901/27/115739yzbexhmyysxd4yiz.png"></p>
<p>缩放窗格时，它将隐藏所有其它窗格，并只显示窗口中的缩放窗格。</p>
<p><img alt="" src="/data/attachment/album/201901/27/115741thhi80ggchlbl6gl.png"></p>
<p>按 <code>Ctrl+b, z</code> 缩放窗格，并再次按下它使缩放窗格恢复原状。</p>
<h3>显示窗格信息</h3>
<p>要了解窗格编号及其大小，运行以下命令。</p>
<p>按 <code>Ctrl+b, q</code> 可简单显示窗格索引。</p>
<p><img alt="" src="/data/attachment/album/201901/27/115741etkopvoywkp7lkyt.png"></p>
<h3>显示窗口信息</h3>
<p>要知道窗口编号、布局大小，与窗口关联的窗格数量及其大小等，运行以下命令。</p>
<p>只需运行 <code>tmux list-windows</code> 即可查看窗口信息。</p>
<p><img alt="" src="/data/attachment/album/201901/27/115741y3q8btqhxhk88k8l.png"></p>
<h3>如何调整窗格大小</h3>
<p>你可能需要调整窗格大小来满足你的要求。你必须按下 <code>Ctrl+b, :</code>，然后在页面底部的黄色颜色条上输入以下详细信息。</p>
<p><img alt="" src="/data/attachment/album/201901/27/115742gaffvy3kr3kyz3mi.png"></p>
<p>在上一部分中，我们打印了窗格索引，它同时也显示了窗格大小。为了测试，我们要向增加 <code>10</code> 个单元。参考以下输出，该窗格将 pane1 和 pane2 的大小从 <code>55x21</code> 增加到 <code>55x31</code>。</p>
<p><img alt="" src="/data/attachment/album/201901/27/115742k5zi8pid8wwk15kw.png"></p>
<p><strong>语法：</strong> <code>Ctrl+b, :</code> 然后输入 <code>resize-pane [options] [cells size]</code></p>
<ul>
<li><code>Ctrl+b, :</code> 然后输入 <code>resize-pane -D 10</code> 将当前窗格大小向下调整 10 个单元。</li>
<li><code>Ctrl+b, :</code> 然后输入 <code>resize-pane -U 10</code> 将当前窗格大小向上调整 10 个单元。</li>
<li><code>Ctrl+b, :</code> 然后输入 <code>resize-pane -L 10</code> 将当前窗格大小向左调整 10 个单元。</li>
<li><code>Ctrl+b, :</code> 然后输入 <code>resize-pane -R 10</code> 将当前窗格大小向右调整 10 个单元。</li>
</ul>
<h3>分离并重新连接 tmux 会话</h3>
<p>tmux 最强大的功能之一是能够在需要时分离和重新连接会话。</p>
<p>运行一个长时间运行的进程，然后按下 <code>Ctrl+b</code>，接着按 <code>d</code>，通过离开正在运行的进程安全地分离你的 tmux 会话。</p>
<p><strong>建议阅读：</strong> <a href="https://www.2daygeek.com/how-to-keep-a-process-command-running-after-disconnecting-ssh-session/">如何在断开 SSH 会话后保持进程/命令继续运行</a></p>
<p>现在，运行一个长时间运行的进程。出于演示目的，我们将把此服务器备份移动到另一个远程服务器以进行灾难恢复（DR）。</p>
<div class="highlight"><pre><span></span><code><span class="n">$</span><span class="w"> </span><span class="n">rsync</span><span class="w"> </span><span class="o">-</span><span class="n">avzhe</span><span class="w"> </span><span class="n">ssh</span><span class="w"> </span><span class="o">/</span><span class="n">backup</span><span class="w"> </span><span class="n">root</span><span class="mf">@192.168.0.161</span><span class="o">:/</span><span class="n">backups</span><span class="o">/</span><span class="n">week</span><span class="mi">-1</span><span class="o">/</span>
</code></pre></div>

<p>在分离 tmux 会话之后，你将获得类似下面的输出。</p>
<div class="highlight"><pre><span></span><code>[detached (from session 0)]
</code></pre></div>

<p>运行以下命令以列出可用的 tmux 会话。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>tmux<span class="w"> </span>ls
<span class="m">0</span>:<span class="w"> </span><span class="m">3</span><span class="w"> </span>windows<span class="w"> </span><span class="o">(</span>created<span class="w"> </span>Tue<span class="w"> </span>Jan<span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="m">06</span>:17:47<span class="w"> </span><span class="m">2018</span><span class="o">)</span><span class="w"> </span><span class="o">[</span>109x45<span class="o">]</span>
</code></pre></div>

<p>现在，使用适当的会话 ID 重新连接 tmux 会话，如下所示：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>tmux<span class="w"> </span>attach<span class="w"> </span>-t<span class="w"> </span><span class="m">0</span>
</code></pre></div>

<h3>如何关闭窗格和窗口</h3>
<p>只需在相应的窗格中输入 <code>exit</code> 或按下 <code>Ctrl-d</code> 即可关闭它，和终端关闭类似。要关闭窗口，按下 <code>Ctrl+b, &amp;</code>。</p>
<p>好了，就到这里了，希望你喜欢上它。</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>