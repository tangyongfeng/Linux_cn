<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>史上最复杂的验证邮件地址的正则表达式</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: wxy 用正则表达式验证邮件地址似乎是一件简单的事情，但是如果要完美的验证一个合规的邮件地址，其实也许很复杂 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li class="active"><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2015/08/shi-shang-zui-fu-za-de-yan-zheng-you-jian-di-zhi-de-zheng-ze-biao-da-shi.html" rel="bookmark"
           title="Permalink to 史上最复杂的验证邮件地址的正则表达式">史上最复杂的验证邮件地址的正则表达式</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2015-08-05T15:56:00+02:00">
                Published: Wed 05 August 2015
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/ruan-jian-kai-fa">软件开发</a>.</p>

</footer><!-- /.post-info -->      <p>Author: wxy</p>
<p>用正则表达式验证邮件地址似乎是一件简单的事情，但是如果要完美的验证一个合规的邮件地址，其实也许很复杂。</p>
<p><img alt="" src="/data/attachment/album/201508/05/155648gil3ndk3885gn331.jpg"></p>
<p>邮件地址的规范来自于 <a href="http://www.ietf.org/rfc/rfc5322.txt">RFC 5322</a> 。有一个网站 <a href="http://emailregex.com">emailregex.com</a> 专门列出各种编程语言下的验证邮件地址的正则表达式，其中很多正则表达式都是我听说过而从未见过的复杂——我想说，做这个网站的程序员是被邮件验证这件事伤害了多深啊！</p>
<p>其实，在产品环境中，一般来说并不需要这么复杂的正则表达式来做到99.99%正确。一般来说，从执行效率和测试覆盖率来说，只需要一个简单的版本即可：</p>
<div class="highlight"><pre><span></span><code>/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i
</code></pre></div>

<p>那么下面我们来看看这些更严谨、更复杂的正则表达式吧：</p>
<h3>验证邮件地址的通用正则表达式（符合 RFC 5322 标准）</h3>
<div class="highlight"><pre><span></span><code>(?:[a-z0-9!#$%&amp;&#39;*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&amp;&#39;*+/=?^_`{|}~-]+)*|&quot;(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*&quot;)@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])
</code></pre></div>

<p>由于各种语言对正则表达式的支持不同、语法差异和覆盖率不同，所以，不同语言里面的正则表达式也不同：</p>
<h3>Python</h3>
<p>这个是个简单的版本：</p>
<div class="highlight"><pre><span></span><code>r&quot;(^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$)&quot;
</code></pre></div>

<h3>Javascript</h3>
<p>这个有点复杂了：</p>
<div class="highlight"><pre><span></span><code>/^[-a-z0-9~!$%^&amp;*_=+}{\&#39;?]+(\.[-a-z0-9~!$%^&amp;*_=+}{\&#39;?]+)*@([a-z0-9_][-a-z0-9_]*(\.[-a-z0-9_]+)*\.(aero|arpa|biz|com|coop|edu|gov|info|int|mil|museum|name|net|org|pro|travel|mobi|[a-z][a-z])|([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}))(:[0-9]{1,5})?$/i
</code></pre></div>

<h3>Swift</h3>
<div class="highlight"><pre><span></span><code>[A-Z0-9a-z._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,6}
</code></pre></div>

<h3>PHP</h3>
<p>PHP 的这个版本就更复杂了，覆盖率就更大一些：</p>
<div class="highlight"><pre><span></span><code><span class="s s-Atom">/^</span><span class="p">(</span><span class="nb">?</span><span class="p">!(</span><span class="nb">?</span><span class="o">:</span><span class="p">(</span><span class="nb">?</span><span class="o">:</span><span class="s s-Atom">\x22</span><span class="nb">?</span><span class="s s-Atom">\x5C</span><span class="p">[</span><span class="s s-Atom">\x00-\x7E</span><span class="p">]</span><span class="s s-Atom">\x22</span><span class="nb">?</span><span class="p">)|(</span><span class="nb">?</span><span class="o">:</span><span class="s s-Atom">\x22</span><span class="nb">?</span><span class="p">[</span><span class="s s-Atom">^\x5C\x22</span><span class="p">]</span><span class="s s-Atom">\x22</span><span class="nb">?</span><span class="p">)){</span><span class="mi">255</span><span class="p">,})(</span><span class="nb">?</span><span class="p">!(</span><span class="nb">?</span><span class="o">:</span><span class="p">(</span><span class="nb">?</span><span class="o">:</span><span class="s s-Atom">\x22</span><span class="nb">?</span><span class="s s-Atom">\x5C</span><span class="p">[</span><span class="s s-Atom">\x00-\x7E</span><span class="p">]</span><span class="s s-Atom">\x22</span><span class="nb">?</span><span class="p">)|(</span><span class="nb">?</span><span class="o">:</span><span class="s s-Atom">\x22</span><span class="nb">?</span><span class="p">[</span><span class="s s-Atom">^\x5C\x22</span><span class="p">]</span><span class="s s-Atom">\x22</span><span class="nb">?</span><span class="p">)){</span><span class="mi">65</span><span class="p">,}</span><span class="s s-Atom">@</span><span class="p">)(</span><span class="nb">?</span><span class="o">:</span><span class="p">(</span><span class="nb">?</span><span class="o">:</span><span class="p">[</span><span class="s s-Atom">\x21\x23-\x27\x2A\x2B\x2D\x2F-\x39\x3D\x3F\x5E-\x7E</span><span class="p">]</span><span class="s s-Atom">+</span><span class="p">)|(</span><span class="nb">?</span><span class="o">:</span><span class="s s-Atom">\</span><span class="nf">x22</span><span class="p">(</span><span class="nb">?</span><span class="o">:</span><span class="p">[</span><span class="s s-Atom">\x01-\x08\x0B\x0C\x0E-\x1F\x21\x23-\x5B\x5D-\x7F</span><span class="p">]|(</span><span class="nb">?</span><span class="o">:</span><span class="s s-Atom">\x5C</span><span class="p">[</span><span class="s s-Atom">\x00-\x7F</span><span class="p">]))</span><span class="s s-Atom">*\x22</span><span class="p">))(</span><span class="nb">?</span><span class="o">:</span><span class="s s-Atom">\.</span><span class="p">(</span><span class="nb">?</span><span class="o">:</span><span class="p">(</span><span class="nb">?</span><span class="o">:</span><span class="p">[</span><span class="s s-Atom">\x21\x23-\x27\x2A\x2B\x2D\x2F-\x39\x3D\x3F\x5E-\x7E</span><span class="p">]</span><span class="s s-Atom">+</span><span class="p">)|(</span><span class="nb">?</span><span class="o">:</span><span class="s s-Atom">\</span><span class="nf">x22</span><span class="p">(</span><span class="nb">?</span><span class="o">:</span><span class="p">[</span><span class="s s-Atom">\x01-\x08\x0B\x0C\x0E-\x1F\x21\x23-\x5B\x5D-\x7F</span><span class="p">]|(</span><span class="nb">?</span><span class="o">:</span><span class="s s-Atom">\x5C</span><span class="p">[</span><span class="s s-Atom">\x00-\x7F</span><span class="p">]))</span><span class="s s-Atom">*\x22</span><span class="p">)))</span><span class="s s-Atom">*@</span><span class="p">(</span><span class="nb">?</span><span class="o">:</span><span class="p">(</span><span class="nb">?</span><span class="o">:</span><span class="p">(</span><span class="nb">?</span><span class="p">!.</span><span class="o">*</span><span class="p">[</span><span class="s s-Atom">^.</span><span class="p">]{</span><span class="mi">64</span><span class="p">,})(</span><span class="nb">?</span><span class="o">:</span><span class="p">(</span><span class="nb">?</span><span class="o">:</span><span class="p">(</span><span class="nb">?</span><span class="o">:</span><span class="s s-Atom">xn--</span><span class="p">)</span><span class="nb">?</span><span class="p">[</span><span class="s s-Atom">a</span><span class="o">-</span><span class="s s-Atom">z0</span><span class="o">-</span><span class="mi">9</span><span class="p">]</span><span class="s s-Atom">+</span><span class="p">(</span><span class="nb">?</span><span class="o">:-</span><span class="p">[</span><span class="s s-Atom">a</span><span class="o">-</span><span class="s s-Atom">z0</span><span class="o">-</span><span class="mi">9</span><span class="p">]</span><span class="s s-Atom">+</span><span class="p">)</span><span class="s s-Atom">*\.</span><span class="p">){</span><span class="mi">1</span><span class="p">,</span><span class="mi">126</span><span class="p">}){</span><span class="mi">1</span><span class="p">,}(</span><span class="nb">?</span><span class="o">:</span><span class="p">(</span><span class="nb">?</span><span class="o">:</span><span class="p">[</span><span class="s s-Atom">a</span><span class="o">-</span><span class="s s-Atom">z</span><span class="p">][</span><span class="s s-Atom">a</span><span class="o">-</span><span class="s s-Atom">z0</span><span class="o">-</span><span class="mi">9</span><span class="p">]</span><span class="s s-Atom">*</span><span class="p">)|(</span><span class="nb">?</span><span class="o">:</span><span class="p">(</span><span class="nb">?</span><span class="o">:</span><span class="s s-Atom">xn--</span><span class="p">)[</span><span class="s s-Atom">a</span><span class="o">-</span><span class="s s-Atom">z0</span><span class="o">-</span><span class="mi">9</span><span class="p">]</span><span class="s s-Atom">+</span><span class="p">))(</span><span class="nb">?</span><span class="o">:-</span><span class="p">[</span><span class="s s-Atom">a</span><span class="o">-</span><span class="s s-Atom">z0</span><span class="o">-</span><span class="mi">9</span><span class="p">]</span><span class="s s-Atom">+</span><span class="p">)</span><span class="s s-Atom">*</span><span class="p">)|(</span><span class="nb">?</span><span class="o">:</span><span class="s s-Atom">\</span><span class="p">[(</span><span class="nb">?</span><span class="o">:</span><span class="p">(</span><span class="nb">?</span><span class="o">:</span><span class="nv">IPv6</span><span class="o">:</span><span class="p">(</span><span class="nb">?</span><span class="o">:</span><span class="p">(</span><span class="nb">?</span><span class="o">:</span><span class="p">[</span><span class="s s-Atom">a</span><span class="o">-</span><span class="s s-Atom">f0</span><span class="o">-</span><span class="mi">9</span><span class="p">]{</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">}(</span><span class="nb">?</span><span class="o">::</span><span class="p">[</span><span class="s s-Atom">a</span><span class="o">-</span><span class="s s-Atom">f0</span><span class="o">-</span><span class="mi">9</span><span class="p">]{</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">}){</span><span class="mi">7</span><span class="p">})|(</span><span class="nb">?</span><span class="o">:</span><span class="p">(</span><span class="nb">?</span><span class="p">!(</span><span class="nb">?</span><span class="o">:</span><span class="p">.</span><span class="o">*</span><span class="p">[</span><span class="s s-Atom">a</span><span class="o">-</span><span class="s s-Atom">f0</span><span class="o">-</span><span class="mi">9</span><span class="p">][</span><span class="o">:</span><span class="s s-Atom">\</span><span class="p">]]){</span><span class="mi">7</span><span class="p">,})(</span><span class="nb">?</span><span class="o">:</span><span class="p">[</span><span class="s s-Atom">a</span><span class="o">-</span><span class="s s-Atom">f0</span><span class="o">-</span><span class="mi">9</span><span class="p">]{</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">}(</span><span class="nb">?</span><span class="o">::</span><span class="p">[</span><span class="s s-Atom">a</span><span class="o">-</span><span class="s s-Atom">f0</span><span class="o">-</span><span class="mi">9</span><span class="p">]{</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">}){</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">})</span><span class="nb">?</span><span class="o">::</span><span class="p">(</span><span class="nb">?</span><span class="o">:</span><span class="p">[</span><span class="s s-Atom">a</span><span class="o">-</span><span class="s s-Atom">f0</span><span class="o">-</span><span class="mi">9</span><span class="p">]{</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">}(</span><span class="nb">?</span><span class="o">::</span><span class="p">[</span><span class="s s-Atom">a</span><span class="o">-</span><span class="s s-Atom">f0</span><span class="o">-</span><span class="mi">9</span><span class="p">]{</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">}){</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">})</span><span class="nb">?</span><span class="p">)))|(</span><span class="nb">?</span><span class="o">:</span><span class="p">(</span><span class="nb">?</span><span class="o">:</span><span class="nv">IPv6</span><span class="o">:</span><span class="p">(</span><span class="nb">?</span><span class="o">:</span><span class="p">(</span><span class="nb">?</span><span class="o">:</span><span class="p">[</span><span class="s s-Atom">a</span><span class="o">-</span><span class="s s-Atom">f0</span><span class="o">-</span><span class="mi">9</span><span class="p">]{</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">}(</span><span class="nb">?</span><span class="o">::</span><span class="p">[</span><span class="s s-Atom">a</span><span class="o">-</span><span class="s s-Atom">f0</span><span class="o">-</span><span class="mi">9</span><span class="p">]{</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">}){</span><span class="mi">5</span><span class="p">}</span><span class="o">:</span><span class="p">)|(</span><span class="nb">?</span><span class="o">:</span><span class="p">(</span><span class="nb">?</span><span class="p">!(</span><span class="nb">?</span><span class="o">:</span><span class="p">.</span><span class="o">*</span><span class="p">[</span><span class="s s-Atom">a</span><span class="o">-</span><span class="s s-Atom">f0</span><span class="o">-</span><span class="mi">9</span><span class="p">]</span><span class="o">:</span><span class="p">){</span><span class="mi">5</span><span class="p">,})(</span><span class="nb">?</span><span class="o">:</span><span class="p">[</span><span class="s s-Atom">a</span><span class="o">-</span><span class="s s-Atom">f0</span><span class="o">-</span><span class="mi">9</span><span class="p">]{</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">}(</span><span class="nb">?</span><span class="o">::</span><span class="p">[</span><span class="s s-Atom">a</span><span class="o">-</span><span class="s s-Atom">f0</span><span class="o">-</span><span class="mi">9</span><span class="p">]{</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">}){</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">})</span><span class="nb">?</span><span class="o">::</span><span class="p">(</span><span class="nb">?</span><span class="o">:</span><span class="p">[</span><span class="s s-Atom">a</span><span class="o">-</span><span class="s s-Atom">f0</span><span class="o">-</span><span class="mi">9</span><span class="p">]{</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">}(</span><span class="nb">?</span><span class="o">::</span><span class="p">[</span><span class="s s-Atom">a</span><span class="o">-</span><span class="s s-Atom">f0</span><span class="o">-</span><span class="mi">9</span><span class="p">]{</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">}){</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">}</span><span class="o">:</span><span class="p">)</span><span class="nb">?</span><span class="p">)))</span><span class="nb">?</span><span class="p">(</span><span class="nb">?</span><span class="o">:</span><span class="p">(</span><span class="nb">?</span><span class="o">:</span><span class="mi">25</span><span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="mi">5</span><span class="p">])|(</span><span class="nb">?</span><span class="o">:</span><span class="mi">2</span><span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="o">-</span><span class="mi">9</span><span class="p">])|(</span><span class="nb">?</span><span class="o">:</span><span class="mi">1</span><span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="mi">9</span><span class="p">]{</span><span class="mi">2</span><span class="p">})|(</span><span class="nb">?</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="o">-</span><span class="mi">9</span><span class="p">]</span><span class="nb">?</span><span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="mi">9</span><span class="p">]))(</span><span class="nb">?</span><span class="o">:</span><span class="s s-Atom">\.</span><span class="p">(</span><span class="nb">?</span><span class="o">:</span><span class="p">(</span><span class="nb">?</span><span class="o">:</span><span class="mi">25</span><span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="mi">5</span><span class="p">])|(</span><span class="nb">?</span><span class="o">:</span><span class="mi">2</span><span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="o">-</span><span class="mi">9</span><span class="p">])|(</span><span class="nb">?</span><span class="o">:</span><span class="mi">1</span><span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="mi">9</span><span class="p">]{</span><span class="mi">2</span><span class="p">})|(</span><span class="nb">?</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="o">-</span><span class="mi">9</span><span class="p">]</span><span class="nb">?</span><span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="mi">9</span><span class="p">]))){</span><span class="mi">3</span><span class="p">}))</span><span class="s s-Atom">\</span><span class="p">]))</span><span class="err">$</span><span class="o">/</span><span class="s s-Atom">iD</span>
</code></pre></div>

<h3>Perl / Ruby</h3>
<p>对与 PHP 的版本，Perl 和 Ruby 表示不服，可以更严谨：</p>
<div class="highlight"><pre><span></span><code>(?:(?:\r\n)?[ \t])*(?:(?:(?:[^()&lt;&gt;@,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;@,;:\\&quot;.\[\]]))|&quot;(?:[^\&quot;\r\\]|\\.|(?:(?:\r\n)?[ \t]))*&quot;(?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;@,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;@,;:\\&quot;.\[\]]))|&quot;(?:[^\&quot;\r\\]|\\.|(?:(?:\r\n)?[\t]))*&quot;(?:(?:\r\n)?[ \t])*))*@(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;@,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;@,;:\\&quot;.\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;@,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;@,;:\\&quot;.\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*))*|(?:[^()&lt;&gt;@,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;@,;:\\&quot;.\[\]]))|&quot;(?:[^\&quot;\r\\]|\\.|(?:(?:\r\n)?[ \t]))*&quot;(?:(?:\r\n)?[ \t])*)*\&lt;(?:(?:\r\n)?[ \t])*(?:@(?:[^()&lt;&gt;@,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;@,;:\\&quot;.\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[\t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;@,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;@,;:\\&quot;.\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*))*(?:,@(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;@,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[\t])+|\Z|(?=[\[&quot;()&lt;&gt;@,;:\\&quot;.\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;@,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;@,;:\\&quot;.\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*))*)*:(?:(?:\r\n)?[ \t])*)?(?:[^()&lt;&gt;@,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;@,;:\\&quot;.\[\]]))|&quot;(?:[^\&quot;\r\\]|\\.|(?:(?:\r\n)?[ \t]))*&quot;(?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;@,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;@,;:\\&quot;.\[\]]))|&quot;(?:[^\&quot;\r\\]|\\.|(?:(?:\r\n)?[ \t]))*&quot;(?:(?:\r\n)?[ \t])*))*@(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;@,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;@,;:\\&quot;.\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;@,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;@,;:\\&quot;.\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*))*\&gt;(?:(?:\r\n)?[ \t])*)|(?:[^()&lt;&gt;@,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;@,;:\\&quot;.\[\]]))|&quot;(?:[^\&quot;\r\\]|\\.|(?:(?:\r\n)?[ \t]))*&quot;(?:(?:\r\n)?[ \t])*)*:(?:(?:\r\n)?[ \t])*(?:(?:(?:[^()&lt;&gt;@,;:\\&quot;.\[\]\000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;@,;:\\&quot;.\[\]]))|&quot;(?:[^\&quot;\r\\]|\\.|(?:(?:\r\n)?[ \t]))*&quot;(?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;@,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;@,;:\\&quot;.\[\]]))|&quot;(?:[^\&quot;\r\\]|\\.|(?:(?:\r\n)?[ \t]))*&quot;(?:(?:\r\n)?[ \t])*))*@(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;@,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;@,;:\\&quot;.\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;@,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;@,;:\\&quot;.\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*))*|(?:[^()&lt;&gt;@,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;@,;:\\&quot;.\[\]]))|&quot;(?:[^\&quot;\r\\]|\\.|(?:(?:\r\n)?[ \t]))*&quot;(?:(?:\r\n)?[ \t])*)*\&lt;(?:(?:\r\n)?[ \t])*(?:@(?:[^()&lt;&gt;@,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;@,;:\\&quot;.\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;@,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;@,;:\\&quot;.\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*))*(?:,@(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;@,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;@,;:\\&quot;.\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;@,;:\\&quot;.\[\]\000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;@,;:\\&quot;.\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*))*)*:(?:(?:\r\n)?[ \t])*)?(?:[^()&lt;&gt;@,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;@,;:\\&quot;.\[\]]))|&quot;(?:[^\&quot;\r\\]|\\.|(?:(?:\r\n)?[ \t]))*&quot;(?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;@,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;@,;:\\&quot;.\[\]]))|&quot;(?:[^\&quot;\r\\]|\\.|(?:(?:\r\n)?[ \t]))*&quot;(?:(?:\r\n)?[ \t])*))*@(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;@,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;@,;:\\&quot;.\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;@,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;@,;:\\&quot;.\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*))*\&gt;(?:(?:\r\n)?[ \t])*)(?:,\s*(?:(?:[^()&lt;&gt;@,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;@,;:\\&quot;.\[\]]))|&quot;(?:[^\&quot;\r\\]|\\.|(?:(?:\r\n)?[ \t]))*&quot;(?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;@,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;@,;:\\&quot;.\[\]]))|&quot;(?:[^\&quot;\r\\]|\\.|(?:(?:\r\n)?[ \t]))*&quot;(?:(?:\r\n)?[ \t])*))*@(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;@,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;@,;:\\&quot;.\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;@,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;@,;:\\&quot;.\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*))*|(?:[^()&lt;&gt;@,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;@,;:\\&quot;.\[\]]))|&quot;(?:[^\&quot;\r\\]|\\.|(?:(?:\r\n)?[ \t]))*&quot;(?:(?:\r\n)?[ \t])*)*\&lt;(?:(?:\r\n)?[ \t])*(?:@(?:[^()&lt;&gt;@,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;@,;:\\&quot;.\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;@,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;@,;:\\&quot;.\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*))*(?:,@(?:(?:\r\n)?[\t])*(?:[^()&lt;&gt;@,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;@,;:\\&quot;.\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;@,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;@,;:\\&quot;.\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*))*)*:(?:(?:\r\n)?[ \t])*)?(?:[^()&lt;&gt;@,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;@,;:\\&quot;.\[\]]))|&quot;(?:[^\&quot;\r\\]|\\.|(?:(?:\r\n)?[ \t]))*&quot;(?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;@,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;@,;:\\&quot;.\[\]]))|&quot;(?:[^\&quot;\r\\]|\\.|(?:(?:\r\n)?[ \t]))*&quot;(?:(?:\r\n)?[ \t])*))*@(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;@,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;@,;:\\&quot;.\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*)(?:\.(?:(?:\r\n)?[ \t])*(?:[^()&lt;&gt;@,;:\\&quot;.\[\] \000-\031]+(?:(?:(?:\r\n)?[ \t])+|\Z|(?=[\[&quot;()&lt;&gt;@,;:\\&quot;.\[\]]))|\[([^\[\]\r\\]|\\.)*\](?:(?:\r\n)?[ \t])*))*\&gt;(?:(?:\r\n)?[ \t])*))*)?;\s
</code></pre></div>

<h3>Perl 5.10 及以后版本</h3>
<p>上面的版本，嗯，我可以说是天书吗？反正我是没有解读的想法了。当然，新版本的 Perl 语言还有一个更易读的版本（你是说真的么？） </p>
<div class="highlight"><pre><span></span><code><span class="o">/</span><span class="p">(?(</span><span class="nx">DEFINE</span><span class="p">)</span>
<span class="p">(?&lt;</span><span class="nx">address</span><span class="p">&gt;</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">mailbox</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">group</span><span class="p">))</span>
<span class="p">(?&lt;</span><span class="nx">mailbox</span><span class="p">&gt;</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">name_addr</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">addr_spec</span><span class="p">))</span>
<span class="p">(?&lt;</span><span class="nx">name_addr</span><span class="p">&gt;</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">display_name</span><span class="p">)?</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">angle_addr</span><span class="p">))</span>
<span class="p">(?&lt;</span><span class="nx">angle_addr</span><span class="p">&gt;</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">CFWS</span><span class="p">)?</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">addr_spec</span><span class="p">)</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">CFWS</span><span class="p">)?)</span>
<span class="p">(?&lt;</span><span class="nx">group</span><span class="p">&gt;</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">display_name</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">(?:(?</span><span class="o">&amp;</span><span class="nx">mailbox_list</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">CFWS</span><span class="p">))?</span><span class="w"> </span><span class="p">;</span>
<span class="p">(?</span><span class="o">&amp;</span><span class="nx">CFWS</span><span class="p">)?)</span>
<span class="p">(?&lt;</span><span class="nx">display_name</span><span class="p">&gt;</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">phrase</span><span class="p">))</span>
<span class="p">(?&lt;</span><span class="nx">mailbox_list</span><span class="p">&gt;</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">mailbox</span><span class="p">)</span><span class="w"> </span><span class="p">(?:</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">mailbox</span><span class="p">))</span><span class="o">*</span><span class="p">)</span>

<span class="p">(?&lt;</span><span class="nx">addr_spec</span><span class="p">&gt;</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">local_part</span><span class="p">)</span><span class="w"> </span><span class="err">\@</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">domain</span><span class="p">))</span>
<span class="p">(?&lt;</span><span class="nx">local_part</span><span class="p">&gt;</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">dot_atom</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">quoted_string</span><span class="p">))</span>
<span class="p">(?&lt;</span><span class="nx">domain</span><span class="p">&gt;</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">dot_atom</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">domain_literal</span><span class="p">))</span>
<span class="p">(?&lt;</span><span class="nx">domain_literal</span><span class="p">&gt;</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">CFWS</span><span class="p">)?</span><span class="w"> </span><span class="err">\</span><span class="p">[</span><span class="w"> </span><span class="p">(?:</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">FWS</span><span class="p">)?</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">dcontent</span><span class="p">))</span><span class="o">*</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">FWS</span><span class="p">)?</span>
<span class="err">\</span><span class="p">]</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">CFWS</span><span class="p">)?)</span>
<span class="p">(?&lt;</span><span class="nx">dcontent</span><span class="p">&gt;</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">dtext</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">quoted_pair</span><span class="p">))</span>
<span class="p">(?&lt;</span><span class="nx">dtext</span><span class="p">&gt;</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">NO_WS_CTL</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">[</span><span class="err">\</span><span class="nx">x21</span><span class="o">-</span><span class="err">\</span><span class="nx">x5a</span><span class="err">\</span><span class="nx">x5e</span><span class="o">-</span><span class="err">\</span><span class="nx">x7e</span><span class="p">])</span>

<span class="p">(?&lt;</span><span class="nx">atext</span><span class="p">&gt;</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">ALPHA</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">DIGIT</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">[!</span><span class="err">#\$</span><span class="o">%&amp;</span><span class="err">&#39;</span><span class="o">*+-/=</span><span class="p">?</span><span class="o">^</span><span class="nx">_</span><span class="err">`</span><span class="p">{</span><span class="o">|</span><span class="p">}</span><span class="o">~</span><span class="p">])</span>
<span class="p">(?&lt;</span><span class="nx">atom</span><span class="p">&gt;</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">CFWS</span><span class="p">)?</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">atext</span><span class="p">)</span><span class="o">+</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">CFWS</span><span class="p">)?)</span>
<span class="p">(?&lt;</span><span class="nx">dot_atom</span><span class="p">&gt;</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">CFWS</span><span class="p">)?</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">dot_atom_text</span><span class="p">)</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">CFWS</span><span class="p">)?)</span>
<span class="p">(?&lt;</span><span class="nx">dot_atom_text</span><span class="p">&gt;</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">atext</span><span class="p">)</span><span class="o">+</span><span class="w"> </span><span class="p">(?:</span><span class="w"> </span><span class="err">\</span><span class="p">.</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">atext</span><span class="p">)</span><span class="o">+</span><span class="p">)</span><span class="o">*</span><span class="p">)</span>

<span class="p">(?&lt;</span><span class="nx">text</span><span class="p">&gt;</span><span class="w"> </span><span class="p">[</span><span class="err">\</span><span class="nx">x01</span><span class="o">-</span><span class="err">\</span><span class="nx">x09</span><span class="err">\</span><span class="nx">x0b</span><span class="err">\</span><span class="nx">x0c</span><span class="err">\</span><span class="nx">x0e</span><span class="o">-</span><span class="err">\</span><span class="nx">x7f</span><span class="p">])</span>
<span class="p">(?&lt;</span><span class="nx">quoted_pair</span><span class="p">&gt;</span><span class="w"> </span><span class="err">\\</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">text</span><span class="p">))</span>

<span class="p">(?&lt;</span><span class="nx">qtext</span><span class="p">&gt;</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">NO_WS_CTL</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">[</span><span class="err">\</span><span class="nx">x21</span><span class="err">\</span><span class="nx">x23</span><span class="o">-</span><span class="err">\</span><span class="nx">x5b</span><span class="err">\</span><span class="nx">x5d</span><span class="o">-</span><span class="err">\</span><span class="nx">x7e</span><span class="p">])</span>
<span class="p">(?&lt;</span><span class="nx">qcontent</span><span class="p">&gt;</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">qtext</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">quoted_pair</span><span class="p">))</span>
<span class="p">(?&lt;</span><span class="nx">quoted_string</span><span class="p">&gt;</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">CFWS</span><span class="p">)?</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">DQUOTE</span><span class="p">)</span><span class="w"> </span><span class="p">(?:(?</span><span class="o">&amp;</span><span class="nx">FWS</span><span class="p">)?</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">qcontent</span><span class="p">))</span><span class="o">*</span>
<span class="p">(?</span><span class="o">&amp;</span><span class="nx">FWS</span><span class="p">)?</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">DQUOTE</span><span class="p">)</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">CFWS</span><span class="p">)?)</span>

<span class="p">(?&lt;</span><span class="nx">word</span><span class="p">&gt;</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">atom</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">quoted_string</span><span class="p">))</span>
<span class="p">(?&lt;</span><span class="nx">phrase</span><span class="p">&gt;</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">word</span><span class="p">)</span><span class="o">+</span><span class="p">)</span>

<span class="err">#</span><span class="w"> </span><span class="nx">Folding</span><span class="w"> </span><span class="nx">white</span><span class="w"> </span><span class="nx">space</span>
<span class="p">(?&lt;</span><span class="nx">FWS</span><span class="p">&gt;</span><span class="w"> </span><span class="p">(?:</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">WSP</span><span class="p">)</span><span class="o">*</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">CRLF</span><span class="p">))?</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">WSP</span><span class="p">)</span><span class="o">+</span><span class="p">)</span>
<span class="p">(?&lt;</span><span class="nx">ctext</span><span class="p">&gt;</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">NO_WS_CTL</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">[</span><span class="err">\</span><span class="nx">x21</span><span class="o">-</span><span class="err">\</span><span class="nx">x27</span><span class="err">\</span><span class="nx">x2a</span><span class="o">-</span><span class="err">\</span><span class="nx">x5b</span><span class="err">\</span><span class="nx">x5d</span><span class="o">-</span><span class="err">\</span><span class="nx">x7e</span><span class="p">])</span>
<span class="p">(?&lt;</span><span class="nx">ccontent</span><span class="p">&gt;</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">ctext</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">quoted_pair</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">comment</span><span class="p">))</span>
<span class="p">(?&lt;</span><span class="nx">comment</span><span class="p">&gt;</span><span class="w"> </span><span class="err">\</span><span class="p">(</span><span class="w"> </span><span class="p">(?:</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">FWS</span><span class="p">)?</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">ccontent</span><span class="p">))</span><span class="o">*</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">FWS</span><span class="p">)?</span><span class="w"> </span><span class="err">\</span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="p">(?&lt;</span><span class="nx">CFWS</span><span class="p">&gt;</span><span class="w"> </span><span class="p">(?:</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">FWS</span><span class="p">)?</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">comment</span><span class="p">))</span><span class="o">*</span>
<span class="p">(?:</span><span class="w"> </span><span class="p">(?:(?</span><span class="o">&amp;</span><span class="nx">FWS</span><span class="p">)?</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">comment</span><span class="p">))</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">(?</span><span class="o">&amp;</span><span class="nx">FWS</span><span class="p">)))</span>

<span class="err">#</span><span class="w"> </span><span class="nx">No</span><span class="w"> </span><span class="nx">whitespace</span><span class="w"> </span><span class="nx">control</span>
<span class="p">(?&lt;</span><span class="nx">NO_WS_CTL</span><span class="p">&gt;</span><span class="w"> </span><span class="p">[</span><span class="err">\</span><span class="nx">x01</span><span class="o">-</span><span class="err">\</span><span class="nx">x08</span><span class="err">\</span><span class="nx">x0b</span><span class="err">\</span><span class="nx">x0c</span><span class="err">\</span><span class="nx">x0e</span><span class="o">-</span><span class="err">\</span><span class="nx">x1f</span><span class="err">\</span><span class="nx">x7f</span><span class="p">])</span>

<span class="p">(?&lt;</span><span class="nx">ALPHA</span><span class="p">&gt;</span><span class="w"> </span><span class="p">[</span><span class="nx">A</span><span class="o">-</span><span class="nx">Za</span><span class="o">-</span><span class="nx">z</span><span class="p">])</span>
<span class="p">(?&lt;</span><span class="nx">DIGIT</span><span class="p">&gt;</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="mi">9</span><span class="p">])</span>
<span class="p">(?&lt;</span><span class="nx">CRLF</span><span class="p">&gt;</span><span class="w"> </span><span class="err">\</span><span class="nx">x0d</span><span class="w"> </span><span class="err">\</span><span class="nx">x0a</span><span class="p">)</span>
<span class="p">(?&lt;</span><span class="nx">DQUOTE</span><span class="p">&gt;</span><span class="w"> </span><span class="err">&quot;</span><span class="p">)</span>
<span class="p">(?&lt;</span><span class="nx">WSP</span><span class="p">&gt;</span><span class="w"> </span><span class="p">[</span><span class="err">\</span><span class="nx">x20</span><span class="err">\</span><span class="nx">x09</span><span class="p">])</span>
<span class="p">)</span>

<span class="p">(?</span><span class="o">&amp;</span><span class="nx">address</span><span class="p">)</span><span class="o">/</span><span class="nx">x</span>
</code></pre></div>

<h3>Ruby (简单版)</h3>
<p>Ruby 表示，其实人家还有个简单版本：</p>
<div class="highlight"><pre><span></span><code>/\A([\w+\-].?)+@[a-z\d\-]+(\.[a-z]+)*\.[a-z]+\z/i
</code></pre></div>

<h3>.NET</h3>
<p>这样的版本谁没有啊——.NET 说：</p>
<div class="highlight"><pre><span></span><code><span class="o">^</span>\<span class="nv">w</span><span class="o">+</span><span class="p">([</span><span class="o">-+.&#39;</span><span class="p">]</span>\<span class="nv">w</span><span class="o">+</span><span class="p">)</span><span class="o">*@</span>\<span class="nv">w</span><span class="o">+</span><span class="p">([</span><span class="o">-.</span><span class="p">]</span>\<span class="nv">w</span><span class="o">+</span><span class="p">)</span><span class="o">*</span>\<span class="o">.</span>\<span class="nv">w</span><span class="o">+</span><span class="p">([</span><span class="o">-.</span><span class="p">]</span>\<span class="nv">w</span><span class="o">+</span><span class="p">)</span><span class="o">*</span><span class="p">$</span>
</code></pre></div>

<h3>grep 命令</h3>
<p>用 grep 命令在文件中查找邮件地址，我想你不会写个若干行的正则表达式吧，意思一下就行了：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>grep<span class="w"> </span>-E<span class="w"> </span>-o<span class="w"> </span><span class="s2">&quot;\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,6}\b&quot;</span><span class="w"> </span>filename.txt
</code></pre></div>

<h3>SQL Server</h3>
<p>在 SQL Server 中也是可以用正则表达式的，不过这个代码片段应该是来自某个产品环境中的，所以，还体贴的照顾了那些把邮件地址写错的人：</p>
<div class="highlight"><pre><span></span><code> select email 
 from table_name where 
 patindex (&#39;%[ &amp;&#39;&#39;,&quot;:;!+=\/()&lt;&gt;]%&#39;, email) &gt; 0 -- Invalid characters
 or patindex (&#39;[@.-_]%&#39;, email) &gt; 0 -- Valid but cannot be starting character
 or patindex (&#39;%[@.-_]&#39;, email) &gt; 0 -- Valid but cannot be ending character
 or email not like &#39;%@%.%&#39; -- Must contain at least one @ and one .
 or email like &#39;%..%&#39; -- Cannot have two periods in a row
 or email like &#39;%@%@%&#39; -- Cannot have two @ anywhere
 or email like &#39;%.@%&#39; or email like &#39;%@.%&#39; -- Cannot have @ and . next to each other
 or email like &#39;%.cm&#39; or email like &#39;%.co&#39; -- Camaroon or Colombia? Typos. 
 or email like &#39;%.or&#39; or email like &#39;%.ne&#39; -- Missing last letter
</code></pre></div>

<h3>Oracle PL/SQL</h3>
<p>这个是不是有点偷懒？尤其是在那些“复杂”的正则表达式之后：</p>
<div class="highlight"><pre><span></span><code>SELECT email 
FROM table_name
WHERE REGEXP_LIKE (email, &#39;[A-Z0-9._%-]+@[A-Z0-9._%-]+\.[A-Z]{2,4}&#39;);
</code></pre></div>

<h3>MySQL</h3>
<p>好吧，看来最后也一样懒：</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n n-Quoted">`users`</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n n-Quoted">`email`</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">REGEXP</span><span class="w"> </span><span class="s1">&#39;^[A-Z0-9._%-]+@[A-Z0-9.-]+</span><span class="err">\</span><span class="s1">.[A-Z]{2,4}$&#39;</span><span class="p">;</span>
</code></pre></div>

<p>那么，你有没有关于验证邮件地址的正则表达式分享给大家？</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>