<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>Shell入门：掌握Linux，OS X，Unix的Shell环境</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: nixCraft 在Linux或类Unix系统中，每个用户和进程都运行在一个特定环境中。这个环境包含了变量、设置、别名、函数以及更多的东西。下面是对Shell环境下一些常用命令的简单介绍，包 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li class="active"><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2015/03/shellru-men-zhang-wo-linuxos-xunixde-shellhuan-jing.html" rel="bookmark"
           title="Permalink to Shell入门：掌握Linux，OS X，Unix的Shell环境">Shell入门：掌握Linux，OS X，Unix的Shell环境</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2015-03-31T08:05:00+02:00">
                Published: Tue 31 March 2015
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/ji-zhu">技术</a>.</p>

</footer><!-- /.post-info -->      <p>Author: nixCraft</p>
<p>在Linux或类Unix系统中，每个用户和进程都运行在一个特定环境中。这个环境包含了变量、设置、别名、函数以及更多的东西。下面是对Shell环境下一些常用命令的简单介绍，包括每个命令如何使用的例子，以及在命令行下设定你自己的环境来提高效率。</p>
<p><img alt="" src="/data/attachment/album/201503/29/221909al9hdmdo0sltclh8.jpg"></p>
<h3>找出你当前的shell</h3>
<p>在终端应用中输入下面命令中的任意一个：</p>
<div class="highlight"><pre><span></span><code><span class="nv">ps</span><span class="w"> </span><span class="p">$$</span>
<span class="nv">ps</span><span class="w"> </span><span class="o">-</span><span class="nv">p</span><span class="w"> </span><span class="p">$$</span>
</code></pre></div>

<p>或者</p>
<div class="highlight"><pre><span></span><code>echo &quot;$0&quot;
</code></pre></div>

<p>输出范例：</p>
<p><a href="http://www.cyberciti.biz/howto/shell-primer-configuring-your-linux-unix-osx-environment/attachment/finding-your-shell-like-a-pro/"><img alt="图1: Finding out your shell name" src="/data/attachment/album/201503/29/221934vlrrgxgwggieczrc.jpg"></a></p>
<p><em>图1：找出当前的shell</em></p>
<h3>找出所有已安装的shell</h3>
<p>找到已安装shell的完整路径：</p>
<div class="highlight"><pre><span></span><code><span class="k">type</span><span class="w"> </span><span class="o">-</span><span class="nx">a</span><span class="w"> </span><span class="nx">zsh</span>
<span class="k">type</span><span class="w"> </span><span class="o">-</span><span class="nx">a</span><span class="w"> </span><span class="nx">ksh</span>
<span class="k">type</span><span class="w"> </span><span class="o">-</span><span class="nx">a</span><span class="w"> </span><span class="nx">sh</span>
<span class="k">type</span><span class="w"> </span><span class="o">-</span><span class="nx">a</span><span class="w"> </span><span class="nx">bash</span>
</code></pre></div>

<p>输出范例：</p>
<p><a href="http://www.cyberciti.biz/howto/shell-primer-configuring-your-linux-unix-osx-environment/attachment/finding-and-verifying-shell-path/"><img alt="Fig.02: Finding out your shell path" src="/data/attachment/album/201503/29/221937o727t3p73ct6zw0p.jpg"></a></p>
<p><em>图2：找出shell的路径</em></p>
<p>文件/etc/shells里包含了系统所支持的shell列表。每一行代表一个shell，是相对根目录的完整路径。用这个<a href="http://www.cyberciti.biz/faq/linux-unix-appleosx-bsd-cat-command-examples/">cat命令</a>来查看这些数据：</p>
<div class="highlight"><pre><span></span><code>cat /etc/shells
</code></pre></div>

<p>输出范例：</p>
<div class="highlight"><pre><span></span><code>#<span class="w"> </span><span class="nv">List</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">acceptable</span><span class="w"> </span><span class="nv">shells</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">chpass</span><span class="ss">(</span><span class="mi">1</span><span class="ss">)</span>.
#<span class="w"> </span><span class="nv">Ftpd</span><span class="w"> </span><span class="nv">will</span><span class="w"> </span><span class="nv">not</span><span class="w"> </span><span class="nv">allow</span><span class="w"> </span><span class="nv">users</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="k">connect</span><span class="w"> </span><span class="nv">who</span><span class="w"> </span><span class="nv">are</span><span class="w"> </span><span class="nv">not</span><span class="w"> </span><span class="nv">using</span>
#<span class="w"> </span><span class="nv">one</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">these</span><span class="w"> </span><span class="nv">shells</span>.

<span class="o">/</span><span class="nv">bin</span><span class="o">/</span><span class="nv">bash</span>
<span class="o">/</span><span class="nv">bin</span><span class="o">/</span><span class="nv">csh</span>
<span class="o">/</span><span class="nv">bin</span><span class="o">/</span><span class="nv">ksh</span>
<span class="o">/</span><span class="nv">bin</span><span class="o">/</span><span class="nv">sh</span>
<span class="o">/</span><span class="nv">bin</span><span class="o">/</span><span class="nv">tcsh</span>
<span class="o">/</span><span class="nv">bin</span><span class="o">/</span><span class="nv">zsh</span>
<span class="o">/</span><span class="nv">usr</span><span class="o">/</span><span class="nv">local</span><span class="o">/</span><span class="nv">bin</span><span class="o">/</span><span class="nv">fish</span>
</code></pre></div>

<h3>临时改变当前shell</h3>
<p>只需要输入shell的名字。在下面的例子里，我从bash切换到了zsh：</p>
<div class="highlight"><pre><span></span><code>zsh
</code></pre></div>

<p>这只是临时改变了系统shell。也叫做子shell。要从子/临时shell退出，输入下面的命令或者按下CTRL-D：</p>
<div class="highlight"><pre><span></span><code><span class="k">exit</span>
</code></pre></div>

<h3>找出子shell的层级或临时shell的嵌套层级</h3>
<p>每个bash实例启动后，变量$SHLVL的值都会加一。输入下面的命令：</p>
<div class="highlight"><pre><span></span><code>echo &quot;$SHLVL&quot;
</code></pre></div>

<p>示例输出：</p>
<p><a href="http://www.cyberciti.biz/howto/shell-primer-configuring-your-linux-unix-osx-environment/attachment/a-nested-shell-level-command/"><img alt="Fig. 03: Bash shell nesting level (subshell numbers)" src="/data/attachment/album/201503/29/221938z9aczas9ysoyua3e.jpg"></a></p>
<p><em>图3：Bash shell嵌套层级（子shell数目）</em></p>
<h3>通过chsh命令永久变更系统shell</h3>
<p>想要把当前系统shell从bash永久换成zsh？试试这个：</p>
<div class="highlight"><pre><span></span><code>chsh -s /bin/zsh
</code></pre></div>

<p>想把其他用户的shell从bash永久换成ksh？试试这个：</p>
<div class="highlight"><pre><span></span><code>sudo chsh -s /bin/ksh userNameHere
</code></pre></div>

<h3>查看当前的环境变量</h3>
<p>你需要用到：</p>
<div class="highlight"><pre><span></span><code>env
env | more
env | less
env | grep &#39;NAME&#39;
</code></pre></div>

<p>示例输出：</p>
<div class="highlight"><pre><span></span><code><span class="n">TERM_PROGRAM</span><span class="o">=</span><span class="n">Apple_Terminal</span>
<span class="n">SHELL</span><span class="o">=/</span><span class="n">bin</span><span class="o">/</span><span class="n">bash</span>
<span class="n">TERM</span><span class="o">=</span><span class="n">xterm</span><span class="o">-</span><span class="mi">256</span><span class="n">color</span>
<span class="n">TMPDIR</span><span class="o">=/</span><span class="k">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="mi">6</span><span class="n">x</span><span class="o">/</span><span class="mi">45252</span><span class="n">d6j1lqbtyy_xt62h40c0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span>
<span class="n">Apple_PubSub_Socket_Render</span><span class="o">=/</span><span class="n">tmp</span><span class="o">/</span><span class="n">launch</span><span class="o">-</span><span class="n">djaOJg</span><span class="o">/</span><span class="n">Render</span>
<span class="n">TERM_PROGRAM_VERSION</span><span class="o">=</span><span class="mi">326</span>
<span class="n">TERM_SESSION_ID</span><span class="o">=</span><span class="mi">16</span><span class="n">F470E3</span><span class="o">-</span><span class="mi">501</span><span class="n">C</span><span class="o">-</span><span class="mi">498</span><span class="n">E</span><span class="o">-</span><span class="n">B315</span><span class="o">-</span><span class="n">D70E538DA825</span>
<span class="n">USER</span><span class="o">=</span><span class="n">vivek</span>
<span class="n">SSH_AUTH_SOCK</span><span class="o">=/</span><span class="n">tmp</span><span class="o">/</span><span class="n">launch</span><span class="o">-</span><span class="n">uQGJ2h</span><span class="o">/</span><span class="n">Listeners</span>
<span class="n">__CF_USER_TEXT_ENCODING</span><span class="o">=</span><span class="mh">0x1F5</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span>
<span class="n">PATH</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="p">:</span><span class="o">/</span><span class="n">bin</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="p">:</span><span class="o">/</span><span class="n">sbin</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bin</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">X11</span><span class="o">/</span><span class="n">bin</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">go</span><span class="o">/</span><span class="n">bin</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">modemZapp</span><span class="p">:</span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">vivek</span><span class="o">/</span><span class="n">google</span><span class="o">-</span><span class="n">cloud</span><span class="o">-</span><span class="n">sdk</span><span class="o">/</span><span class="n">bin</span>
<span class="n">__CHECKFIX1436934</span><span class="o">=</span><span class="mi">1</span>
<span class="n">PWD</span><span class="o">=/</span><span class="n">Users</span><span class="o">/</span><span class="n">vivek</span>
<span class="n">SHLVL</span><span class="o">=</span><span class="mi">2</span>
<span class="n">HOME</span><span class="o">=/</span><span class="n">Users</span><span class="o">/</span><span class="n">vivek</span>
<span class="n">LOGNAME</span><span class="o">=</span><span class="n">vivek</span>
<span class="n">LC_CTYPE</span><span class="o">=</span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span>
<span class="n">DISPLAY</span><span class="o">=/</span><span class="n">tmp</span><span class="o">/</span><span class="n">launch</span><span class="o">-</span><span class="mi">6</span><span class="n">hNAhh</span><span class="o">/</span><span class="n">org</span><span class="o">.</span><span class="n">macosforge</span><span class="o">.</span><span class="n">xquartz</span><span class="p">:</span><span class="mi">0</span>
<span class="n">_</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">env</span>
<span class="n">OLDPWD</span><span class="o">=/</span><span class="n">Users</span><span class="o">/</span><span class="n">vivek</span>
</code></pre></div>

<p>下面是bash shell里一些常见变量的列表：</p>
<p><img alt="Fig.04: Common bash environment variables" src="/data/attachment/album/201503/29/221946wd52y52y5yxy52d2.jpg"></p>
<p><em>图4：常见bash环境变量</em></p>
<blockquote>
<p><strong>注意</strong>：下面这些环境变量没事不要乱改。很可能会造成不稳定的shell会话：</p>
<p>SHELL</p>
<p>UID</p>
<p>RANDOM</p>
<p>PWD</p>
<p>PPID</p>
<p>SSH<em>AUTH</em>SOCK</p>
<p>USER</p>
<p>HOME</p>
<p>LINENO</p>
</blockquote>
<h3>显示环境变量的值</h3>
<p>使用下面任意一条命令显示环境变量HOME的值：</p>
<div class="highlight"><pre><span></span><code>## 使用printenv ##
printenv HOME

## 或者用echo ##
echo &quot;$HOME&quot;

# 考虑到可移植性，也可以用printf ##
printf &quot;%s\n&quot; &quot;$HOME&quot;
</code></pre></div>

<p>示例输出：</p>
<div class="highlight"><pre><span></span><code>/home/vivek
</code></pre></div>

<h3>增加或设定一个新环境变量</h3>
<p>下面是bash，zsh，sh和ksh的语法：</p>
<div class="highlight"><pre><span></span><code><span class="c1">## 语法 ##</span>
<span class="n">VAR</span><span class="o">=</span><span class="n">value</span>
<span class="n">FOO</span><span class="o">=</span><span class="n">bar</span>

<span class="c1">## 设定vim为默认文本编辑器 ##</span>
<span class="n">EDITOR</span><span class="o">=</span><span class="n">vim</span>
<span class="k">export</span><span class="w"> </span><span class="o">$</span><span class="n">EDITOR</span>

<span class="c1">## 考虑安全性，设定默认shell连接超时时间 ##</span>
<span class="n">TMOUT</span><span class="o">=</span><span class="mi">300</span>
<span class="k">export</span><span class="w"> </span><span class="n">TMOUT</span>

<span class="c1">## 你可以直接使用export命令设定命令的搜素路径 ##</span>
<span class="k">export</span><span class="w"> </span><span class="n">PATH</span><span class="o">=$</span><span class="n">PATH</span><span class="p">:</span><span class="o">$</span><span class="n">HOME</span><span class="o">/</span><span class="n">bin</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bin</span><span class="p">:</span><span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">mycoolapps</span>
</code></pre></div>

<p>然后，使用printenv或者echo或printf命令查看环境变量PATH，EDITOR，和TMOUT的值：</p>
<div class="highlight"><pre><span></span><code>printenv PATH
echo &quot;$EDITOR&quot;
printf &quot;%s\n&quot; $TMOUT
</code></pre></div>

<h3>怎么修改一个现有的环境变量？</h3>
<p>下面是语法：</p>
<div class="highlight"><pre><span></span><code><span class="k">export</span><span class="w"> </span><span class="n">VAR</span><span class="o">=</span><span class="n">value</span>
<span class="c1">## 或者 ##</span>
<span class="n">VAR</span><span class="o">=</span><span class="n">value</span>
<span class="k">export</span><span class="w"> </span><span class="o">$</span><span class="n">VAR</span>

<span class="c1">## 把默认文本编辑器从vim改为emacs ##</span>
<span class="n">echo</span><span class="w"> </span><span class="s2">&quot;$EDITOR&quot;</span><span class="w"> </span><span class="c1">## &lt;--- 屏幕输出vim</span>
<span class="n">EDITOR</span><span class="o">=</span><span class="n">emacs</span><span class="w">   </span><span class="c1">## &lt;--- 修改</span>
<span class="k">export</span><span class="w"> </span><span class="o">$</span><span class="n">EDITOR</span><span class="w"> </span><span class="c1">## &lt;--- 让修改在其他会话生效</span>
<span class="n">echo</span><span class="w"> </span><span class="s2">&quot;$EDITOR&quot;</span><span class="w"> </span><span class="c1">## &lt;--- 屏幕输出emacs </span>
</code></pre></div>

<p><strong>tcsh shell下增加和修改变量</strong>的语法是下面这样的：</p>
<div class="highlight"><pre><span></span><code><span class="c1">## 语法</span>
<span class="n">setenv</span><span class="w"> </span><span class="k">var</span><span class="w"> </span><span class="n">value</span>
<span class="n">printenv</span><span class="w"> </span><span class="k">var</span>

<span class="c1">## 设置变量foo的值为bar ##</span>
<span class="n">setenv</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="n">bar</span>
<span class="n">echo</span><span class="w"> </span><span class="s2">&quot;$foo&quot;</span>
<span class="n">printenv</span><span class="w"> </span><span class="n">foo</span>

<span class="c1">## 设置变量PATH ##</span>
<span class="n">setenv</span><span class="w"> </span><span class="n">PATH</span><span class="w"> </span><span class="o">$</span><span class="n">PATH</span>\<span class="p">:</span><span class="o">$</span><span class="n">HOME</span><span class="o">/</span><span class="n">bin</span>
<span class="n">echo</span><span class="w"> </span><span class="s2">&quot;$PATH&quot;</span>

<span class="c1">## 设置变量PAGER ##</span>
<span class="n">setenv</span><span class="w"> </span><span class="n">PAGER</span><span class="w"> </span><span class="n">most</span>
<span class="n">printf</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">$</span><span class="n">PAGER</span>
</code></pre></div>

<h3>找出bash shell的配置文件</h3>
<p>用下面的命令列出bash shell的文件：</p>
<div class="highlight"><pre><span></span><code>ls -l ~/.bash* ~/.profile /etc/bash* /etc/profile
</code></pre></div>

<p>示例输出：</p>
<p><a href="http://www.cyberciti.biz/howto/shell-primer-configuring-your-linux-unix-osx-environment/attachment/list-bash-enviroment-variables/"><img alt="Fig.05: List all bash environment configuration files" src="/data/attachment/album/201503/29/221947gwam5wdqphm5mp1w.jpg"></a></p>
<p><em>图5：列出bash的所有配置文件</em></p>
<p>要查看所有的bash配置文件，输入：</p>
<div class="highlight"><pre><span></span><code>less ~/.bash* ~/.profile /etc/bash* /etc/profile
</code></pre></div>

<p>可以使用文字编辑器比如vim或emacs来一个一个编辑bash配置文件：</p>
<div class="highlight"><pre><span></span><code>vim ~/.bashrc
</code></pre></div>

<p>编辑/etc/目录下的文件，输入：</p>
<div class="highlight"><pre><span></span><code><span class="gu">##</span> 首先是备份，以防万一
sudo cp -v /etc/bashrc /etc/bashrc.bak.22_jan_15

<span class="gu">##</span>######################################################################
<span class="gu">##</span> 然后，随心所欲随便改吧，好好玩玩shell环境或者提高一下效率:)                 ##
<span class="gu">##</span>######################################################################
sudo vim /etc/bashrc
</code></pre></div>

<h3>被Bash shell初始化过程中应用的文件搞糊涂了吗？</h3>
<p>下面的"bash初始化文件"流程图应该有些帮助：</p>
<p><img alt="" src="/data/attachment/album/201503/29/221949w5kouu69ocee5kvo.jpg"></p>
<p>根据账户设定的默认shell，你的用户配置或系统配置可能是下面其中一种：</p>
<h3>找出zsh shell配置文件</h3>
<p>zsh的<a href="http://zshwiki.org/home/config/files">wiki</a>中建议用下面的命令：</p>
<div class="highlight"><pre><span></span><code>strings =zsh | grep zshrc
</code></pre></div>

<p>示例输出：</p>
<div class="highlight"><pre><span></span><code><span class="err">/</span><span class="nf">etc</span><span class="err">/</span><span class="no">zshrc</span>
<span class="na">.zshrc</span>
</code></pre></div>

<p>输入下面的命令列出你的zsh shell文件：</p>
<div class="highlight"><pre><span></span><code>ls -l /etc/zsh/* /etc/profile ~/.z*
</code></pre></div>

<p>查看所有zsh配置文件：</p>
<div class="highlight"><pre><span></span><code>less /etc/zsh/* /etc/profile ~/.z*
</code></pre></div>

<h3>找出ksh shell配置文件</h3>
<ol>
<li>查看~/.profile或者/etc/profile文件。</li>
</ol>
<h3>找出tcsh shell配置文件</h3>
<ol>
<li>C shell查看~/.login，~/.cshrc文件。</li>
<li>TC shell查看~/.tcshrc和~/.cshrc文件。</li>
</ol>
<h3>我可以写个类似这样每次登录时都自动执行的脚本吗？</h3>
<p>是的，把你的命令或别名或其他设定添加到~/.bashrc（bash shell）或者~/.profile（sh/ksh/bash）或者~/.login（csh/tcsh）文件中。</p>
<h3>我可以写个类似这样每次登出都自动执行的脚本吗？</h3>
<p>是的，把你的命令或别名或其他设定添加到~/.bash_logout（bash）或者~/.logout（csh/tcsh）文件。</p>
<h3>history：获取关于shell会话的更多信息</h3>
<p>输入history命令来查看本次会话的历史：</p>
<div class="highlight"><pre><span></span><code>history
</code></pre></div>

<p>示例输出：</p>
<div class="highlight"><pre><span></span><code>    9  ls
   10  vi advanced-cache.php
   11  cd ..
   12  ls
   13  w
   14  cd ..
   15  ls
   16  pwd
   17  ls
   ....
   ..
   ...
   91  hddtemp /dev/sda
   92  yum install hddtemp
   93  hddtemp /dev/sda
   94  hddtemp /dev/sg0
   95  hddtemp /dev/sg1
   96  smartctl -d ata -A /dev/sda | grep -i temperature
   97  smartctl -d ata -A /dev/sg1 | grep -i temperature
   98  smartctl  -A /dev/sg1 | grep -i temperature
   99  sensors
</code></pre></div>

<p>输入history 20来查看命令历史的后20条：</p>
<div class="highlight"><pre><span></span><code>history 20
</code></pre></div>

<p>示例输出：</p>
<p><a href="http://www.cyberciti.biz/howto/shell-primer-configuring-your-linux-unix-osx-environment/attachment/history-outputs/"><img alt="Fig.06: View session history in the bash shell using history command" src="/data/attachment/album/201503/29/221950x3788tqafrldrclu.jpg"></a></p>
<p><em>图6：在bash shell中使用history命令查看会话历史</em></p>
<p>你可以重复使用之前的命令。简单地按下[上]或[下]方向键就可以查看之前的命令。在shell提示符下按下[CTRL-R]可以向后搜索历史缓存或文件来查找命令。重复最后一次命令，只需要在shell提示符下输入!!就好了：</p>
<div class="highlight"><pre><span></span><code>ls -l /foo/bar
!!
</code></pre></div>

<p>在以上的历史记录中找到命令#93 (hddtemp /dev/sda)，输入：</p>
<div class="highlight"><pre><span></span><code><span class="sx">!93</span>
</code></pre></div>

<h3>使用sudo或su改变用户</h3>
<p>下面是语法：</p>
<div class="highlight"><pre><span></span><code>su userName

## 登录为tom用户 ##
su tom

## 为用户tom打开一个新的shell会话 ##
su tom

## 登录为root用户 ##
su -

## sudo命令语法（必须在系统中配置有这个命令） ##
sudo -s
sudo tom
</code></pre></div>

<p>看看帖子"<a href="http://www.cyberciti.biz/open-source/command-line-hacks/linux-run-command-as-different-user/">Linux下使用其他用户身份运行命令</a>"更多地了解sudo，su和runuser命令。</p>
<h3>shell别名</h3>
<p>别名仅仅是命令的一个快捷方式。</p>
<h3>列出所有的别名</h3>
<p>输入下面的命令：</p>
<div class="highlight"><pre><span></span><code>alias
</code></pre></div>

<p>示例输出：</p>
<div class="highlight"><pre><span></span><code><span class="n">alias</span><span class="w"> </span><span class="o">..=</span><span class="s1">&#39;cd ..&#39;</span>
<span class="n">alias</span><span class="w"> </span><span class="o">...=</span><span class="s1">&#39;cd ../../../&#39;</span>
<span class="n">alias</span><span class="w"> </span><span class="o">....=</span><span class="s1">&#39;cd ../../../../&#39;</span>
<span class="n">alias</span><span class="w"> </span><span class="o">.....=</span><span class="s1">&#39;cd ../../../../&#39;</span>
<span class="n">alias</span><span class="w"> </span><span class="o">.</span><span class="mi">4</span><span class="o">=</span><span class="s1">&#39;cd ../../../../&#39;</span>
<span class="n">alias</span><span class="w"> </span><span class="o">.</span><span class="mi">5</span><span class="o">=</span><span class="s1">&#39;cd ../../../../..&#39;</span>
<span class="n">alias</span><span class="w"> </span><span class="n">bc</span><span class="o">=</span><span class="s1">&#39;bc -l&#39;</span>
<span class="n">alias</span><span class="w"> </span><span class="n">cd</span><span class="o">..=</span><span class="s1">&#39;cd ..&#39;</span>
<span class="n">alias</span><span class="w"> </span><span class="n">chgrp</span><span class="o">=</span><span class="s1">&#39;chgrp --preserve-root&#39;</span>
<span class="n">alias</span><span class="w"> </span><span class="n">chmod</span><span class="o">=</span><span class="s1">&#39;chmod --preserve-root&#39;</span>
<span class="n">alias</span><span class="w"> </span><span class="n">chown</span><span class="o">=</span><span class="s1">&#39;chown --preserve-root&#39;</span>
<span class="n">alias</span><span class="w"> </span><span class="n">cp</span><span class="o">=</span><span class="s1">&#39;cp -i&#39;</span>
<span class="n">alias</span><span class="w"> </span><span class="n">dnstop</span><span class="o">=</span><span class="s1">&#39;dnstop -l 5 eth1&#39;</span>
<span class="n">alias</span><span class="w"> </span><span class="n">egrep</span><span class="o">=</span><span class="s1">&#39;egrep --color=auto&#39;</span>
<span class="n">alias</span><span class="w"> </span><span class="n">ethtool</span><span class="o">=</span><span class="s1">&#39;ethtool eth1&#39;</span>
</code></pre></div>

<h3>设定一个别名</h3>
<p>bash/zsh语法：</p>
<div class="highlight"><pre><span></span><code>alias c=&#39;clear&#39;
alias down=&#39;sudo /sbin/shutdown -h now&#39;
</code></pre></div>

<p>对于命令clear可以输入c别名，这样我们就可以输入c代替clear命令来清空屏幕：</p>
<div class="highlight"><pre><span></span><code>c
</code></pre></div>

<p>或者输入down来关闭基于Linux的服务器：</p>
<div class="highlight"><pre><span></span><code>down
</code></pre></div>

<p>你可以设定任意多的别名。看下"<a href="http://www.cyberciti.biz/tips/bash-aliases-mac-centos-linux-unix.html">Linux/Unix/Mac OS X系统中的30个方便的bash shell别名</a>"了解在类Unix系统中别名的实际应用。</p>
<h3>shell函数</h3>
<p>Bash/ksh/zsh函数允许你更进一步地配置shell环境。在这个例子中，我写了一个简单的名叫memcpu()的bash函数，用来显示前10个最占用CPU和内存的进程：</p>
<div class="highlight"><pre><span></span><code>memcpu() { echo &quot;*** Top 10 cpu eating process ***&quot;; ps auxf | sort -nr -k 3 | head -10;
echo  &quot;*** Top 10 memory eating process ***&quot;; ps auxf | sort -nr -k 4 | head -10;  }
</code></pre></div>

<p>输入memcpu就可以在屏幕上看到下面的信息：</p>
<div class="highlight"><pre><span></span><code><span class="n">memcpu</span>

<span class="o">***</span><span class="w"> </span><span class="n">Top</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="n">cpu</span><span class="w"> </span><span class="n">eating</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="o">***</span>
<span class="n">nginx</span><span class="w">    </span><span class="mi">39559</span><span class="w"> </span><span class="mf">13.0</span><span class="w">  </span><span class="mf">0.2</span><span class="w"> </span><span class="mi">264020</span><span class="w"> </span><span class="mi">35168</span><span class="w"> </span><span class="err">?</span><span class="w">        </span><span class="n">S</span><span class="w">    </span><span class="mi">04</span><span class="p">:</span><span class="mi">26</span><span class="w">   </span><span class="mi">0</span><span class="p">:</span><span class="mi">00</span><span class="w">      </span>\<span class="n">_</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">php</span><span class="o">-</span><span class="n">cgi</span>
<span class="n">nginx</span><span class="w">    </span><span class="mi">39545</span><span class="w">  </span><span class="mf">6.6</span><span class="w">  </span><span class="mf">0.1</span><span class="w"> </span><span class="mi">216484</span><span class="w"> </span><span class="mi">13088</span><span class="w"> </span><span class="err">?</span><span class="w">        </span><span class="n">S</span><span class="w">    </span><span class="mi">04</span><span class="p">:</span><span class="mi">25</span><span class="w">   </span><span class="mi">0</span><span class="p">:</span><span class="mi">04</span><span class="w">      </span>\<span class="n">_</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">php</span><span class="o">-</span><span class="n">cgi</span>
<span class="n">nginx</span><span class="w">    </span><span class="mi">39471</span><span class="w">  </span><span class="mf">6.2</span><span class="w">  </span><span class="mf">0.6</span><span class="w"> </span><span class="mi">273352</span><span class="w"> </span><span class="mi">81704</span><span class="w"> </span><span class="err">?</span><span class="w">        </span><span class="n">S</span><span class="w">    </span><span class="mi">04</span><span class="p">:</span><span class="mi">22</span><span class="w">   </span><span class="mi">0</span><span class="p">:</span><span class="mi">17</span><span class="w">      </span>\<span class="n">_</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">php</span><span class="o">-</span><span class="n">cgi</span>
<span class="n">nginx</span><span class="w">    </span><span class="mi">39544</span><span class="w">  </span><span class="mf">5.7</span><span class="w">  </span><span class="mf">0.1</span><span class="w"> </span><span class="mi">216484</span><span class="w"> </span><span class="mi">13084</span><span class="w"> </span><span class="err">?</span><span class="w">        </span><span class="n">S</span><span class="w">    </span><span class="mi">04</span><span class="p">:</span><span class="mi">25</span><span class="w">   </span><span class="mi">0</span><span class="p">:</span><span class="mi">03</span><span class="w">      </span>\<span class="n">_</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">php</span><span class="o">-</span><span class="n">cgi</span>
<span class="n">nginx</span><span class="w">    </span><span class="mi">39540</span><span class="w">  </span><span class="mf">5.5</span><span class="w">  </span><span class="mf">0.1</span><span class="w"> </span><span class="mi">221260</span><span class="w"> </span><span class="mi">19296</span><span class="w"> </span><span class="err">?</span><span class="w">        </span><span class="n">S</span><span class="w">    </span><span class="mi">04</span><span class="p">:</span><span class="mi">25</span><span class="w">   </span><span class="mi">0</span><span class="p">:</span><span class="mi">04</span><span class="w">      </span>\<span class="n">_</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">php</span><span class="o">-</span><span class="n">cgi</span>
<span class="n">nginx</span><span class="w">    </span><span class="mi">39542</span><span class="w">  </span><span class="mf">5.4</span><span class="w">  </span><span class="mf">0.1</span><span class="w"> </span><span class="mi">216484</span><span class="w"> </span><span class="mi">13152</span><span class="w"> </span><span class="err">?</span><span class="w">        </span><span class="n">S</span><span class="w">    </span><span class="mi">04</span><span class="p">:</span><span class="mi">25</span><span class="w">   </span><span class="mi">0</span><span class="p">:</span><span class="mi">04</span><span class="w">      </span>\<span class="n">_</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">php</span><span class="o">-</span><span class="n">cgi</span>
<span class="n">nixcraft</span><span class="w"> </span><span class="mi">39543</span><span class="w">  </span><span class="mf">5.3</span><span class="w">  </span><span class="mf">0.1</span><span class="w"> </span><span class="mi">216484</span><span class="w"> </span><span class="mi">14096</span><span class="w"> </span><span class="err">?</span><span class="w">        </span><span class="n">S</span><span class="w">    </span><span class="mi">04</span><span class="p">:</span><span class="mi">25</span><span class="w">   </span><span class="mi">0</span><span class="p">:</span><span class="mi">04</span><span class="w">      </span>\<span class="n">_</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">php</span><span class="o">-</span><span class="n">cgi</span>
<span class="n">nixcraft</span><span class="w"> </span><span class="mi">39538</span><span class="w">  </span><span class="mf">5.2</span><span class="w">  </span><span class="mf">0.1</span><span class="w"> </span><span class="mi">221248</span><span class="w"> </span><span class="mi">18608</span><span class="w"> </span><span class="err">?</span><span class="w">        </span><span class="n">S</span><span class="w">    </span><span class="mi">04</span><span class="p">:</span><span class="mi">25</span><span class="w">   </span><span class="mi">0</span><span class="p">:</span><span class="mi">04</span><span class="w">      </span>\<span class="n">_</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">php</span><span class="o">-</span><span class="n">cgi</span>
<span class="n">nixcraft</span><span class="w"> </span><span class="mi">39539</span><span class="w">  </span><span class="mf">5.0</span><span class="w">  </span><span class="mf">0.1</span><span class="w"> </span><span class="mi">216484</span><span class="w"> </span><span class="mi">16272</span><span class="w"> </span><span class="err">?</span><span class="w">        </span><span class="n">S</span><span class="w">    </span><span class="mi">04</span><span class="p">:</span><span class="mi">25</span><span class="w">   </span><span class="mi">0</span><span class="p">:</span><span class="mi">04</span><span class="w">      </span>\<span class="n">_</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">php</span><span class="o">-</span><span class="n">cgi</span>
<span class="n">nixcraft</span><span class="w"> </span><span class="mi">39541</span><span class="w">  </span><span class="mf">4.8</span><span class="w">  </span><span class="mf">0.1</span><span class="w"> </span><span class="mi">216484</span><span class="w"> </span><span class="mi">14860</span><span class="w"> </span><span class="err">?</span><span class="w">        </span><span class="n">S</span><span class="w">    </span><span class="mi">04</span><span class="p">:</span><span class="mi">25</span><span class="w">   </span><span class="mi">0</span><span class="p">:</span><span class="mi">04</span><span class="w">      </span>\<span class="n">_</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">php</span><span class="o">-</span><span class="n">cgi</span>

<span class="o">***</span><span class="w"> </span><span class="n">Top</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="n">eating</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="o">***</span>
<span class="mi">498</span><span class="w">      </span><span class="mi">63859</span><span class="w">  </span><span class="mf">0.5</span><span class="w">  </span><span class="mf">4.0</span><span class="w"> </span><span class="mi">2429652</span><span class="w"> </span><span class="mi">488084</span><span class="w"> </span><span class="err">?</span><span class="w">      </span><span class="n">Ssl</span><span class="w">   </span><span class="mi">2014</span><span class="w"> </span><span class="mi">177</span><span class="p">:</span><span class="mi">41</span><span class="w"> </span><span class="n">memcached</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="mi">11211</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">memcached</span><span class="w"> </span><span class="o">-</span><span class="n">m</span><span class="w"> </span><span class="mi">2048</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="mi">18288</span><span class="w"> </span><span class="o">-</span><span class="n">P</span><span class="w"> </span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">memcached</span><span class="o">/</span><span class="n">memcached</span><span class="o">.</span><span class="n">pid</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="mf">10.10</span><span class="o">.</span><span class="mf">29.68</span><span class="w"> </span><span class="o">-</span><span class="n">L</span>
<span class="n">mysql</span><span class="w">    </span><span class="mi">64221</span><span class="w">  </span><span class="mf">4.2</span><span class="w">  </span><span class="mf">3.4</span><span class="w"> </span><span class="mi">4653600</span><span class="w"> </span><span class="mi">419868</span><span class="w"> </span><span class="err">?</span><span class="w">      </span><span class="n">Sl</span><span class="w">    </span><span class="mi">2014</span><span class="w"> </span><span class="mi">1360</span><span class="p">:</span><span class="mi">40</span><span class="w">  </span>\<span class="n">_</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">libexec</span><span class="o">/</span><span class="n">mysqld</span><span class="w"> </span><span class="o">--</span><span class="n">basedir</span><span class="o">=/</span><span class="n">usr</span><span class="w"> </span><span class="o">--</span><span class="n">datadir</span><span class="o">=/</span><span class="k">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">mysql</span><span class="w"> </span><span class="o">--</span><span class="n">user</span><span class="o">=</span><span class="n">mysql</span><span class="w"> </span><span class="o">--</span><span class="nb">log</span><span class="o">-</span><span class="n">error</span><span class="o">=/</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span><span class="o">/</span><span class="n">mysqld</span><span class="o">.</span><span class="n">log</span><span class="w"> </span><span class="o">--</span><span class="n">open</span><span class="o">-</span><span class="n">files</span><span class="o">-</span><span class="n">limit</span><span class="o">=</span><span class="mi">65535</span><span class="w"> </span><span class="o">--</span><span class="n">pid</span><span class="o">-</span><span class="n">file</span><span class="o">=/</span><span class="k">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">mysqld</span><span class="o">/</span><span class="n">mysqld</span><span class="o">.</span><span class="n">pid</span><span class="w"> </span><span class="o">--</span><span class="n">socket</span><span class="o">=/</span><span class="k">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">mysql</span><span class="o">/</span><span class="n">mysql</span><span class="o">.</span><span class="n">sock</span>
<span class="n">nixcraft</span><span class="w"> </span><span class="mi">39418</span><span class="w">  </span><span class="mf">0.4</span><span class="w">  </span><span class="mf">1.1</span><span class="w"> </span><span class="mi">295312</span><span class="w"> </span><span class="mi">138624</span><span class="w"> </span><span class="err">?</span><span class="w">       </span><span class="n">S</span><span class="w">    </span><span class="mi">04</span><span class="p">:</span><span class="mi">17</span><span class="w">   </span><span class="mi">0</span><span class="p">:</span><span class="mi">02</span><span class="w">  </span><span class="o">|</span><span class="w">   </span>\<span class="n">_</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">php</span><span class="o">-</span><span class="n">cgi</span>
<span class="n">nixcraft</span><span class="w"> </span><span class="mi">39419</span><span class="w">  </span><span class="mf">0.5</span><span class="w">  </span><span class="mf">0.9</span><span class="w"> </span><span class="mi">290284</span><span class="w"> </span><span class="mi">113036</span><span class="w"> </span><span class="err">?</span><span class="w">       </span><span class="n">S</span><span class="w">    </span><span class="mi">04</span><span class="p">:</span><span class="mi">18</span><span class="w">   </span><span class="mi">0</span><span class="p">:</span><span class="mi">02</span><span class="w">  </span><span class="o">|</span><span class="w">   </span>\<span class="n">_</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">php</span><span class="o">-</span><span class="n">cgi</span>
<span class="n">nixcraft</span><span class="w"> </span><span class="mi">39464</span><span class="w">  </span><span class="mf">0.7</span><span class="w">  </span><span class="mf">0.8</span><span class="w"> </span><span class="mi">294356</span><span class="w"> </span><span class="mi">99200</span><span class="w"> </span><span class="err">?</span><span class="w">        </span><span class="n">S</span><span class="w">    </span><span class="mi">04</span><span class="p">:</span><span class="mi">20</span><span class="w">   </span><span class="mi">0</span><span class="p">:</span><span class="mi">02</span><span class="w">  </span><span class="o">|</span><span class="w">   </span>\<span class="n">_</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">php</span><span class="o">-</span><span class="n">cgi</span>
<span class="n">nixcraft</span><span class="w"> </span><span class="mi">39469</span><span class="w">  </span><span class="mf">0.3</span><span class="w">  </span><span class="mf">0.7</span><span class="w"> </span><span class="mi">288400</span><span class="w"> </span><span class="mi">91256</span><span class="w"> </span><span class="err">?</span><span class="w">        </span><span class="n">S</span><span class="w">    </span><span class="mi">04</span><span class="p">:</span><span class="mi">20</span><span class="w">   </span><span class="mi">0</span><span class="p">:</span><span class="mi">01</span><span class="w">  </span><span class="o">|</span><span class="w">   </span>\<span class="n">_</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">php</span><span class="o">-</span><span class="n">cgi</span>
<span class="n">nixcraft</span><span class="w"> </span><span class="mi">39471</span><span class="w">  </span><span class="mf">6.2</span><span class="w">  </span><span class="mf">0.6</span><span class="w"> </span><span class="mi">273352</span><span class="w"> </span><span class="mi">81704</span><span class="w"> </span><span class="err">?</span><span class="w">        </span><span class="n">S</span><span class="w">    </span><span class="mi">04</span><span class="p">:</span><span class="mi">22</span><span class="w">   </span><span class="mi">0</span><span class="p">:</span><span class="mi">17</span><span class="w">      </span>\<span class="n">_</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">php</span><span class="o">-</span><span class="n">cgi</span>
<span class="n">vivek</span><span class="w">    </span><span class="mi">39261</span><span class="w">  </span><span class="mf">2.2</span><span class="w">  </span><span class="mf">0.6</span><span class="w"> </span><span class="mi">253172</span><span class="w"> </span><span class="mi">82812</span><span class="w"> </span><span class="err">?</span><span class="w">        </span><span class="n">S</span><span class="w">    </span><span class="mi">04</span><span class="p">:</span><span class="mi">05</span><span class="w">   </span><span class="mi">0</span><span class="p">:</span><span class="mi">28</span><span class="w">      </span>\<span class="n">_</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">php</span><span class="o">-</span><span class="n">cgi</span>
<span class="n">squid</span><span class="w">     </span><span class="mi">9995</span><span class="w">  </span><span class="mf">0.0</span><span class="w">  </span><span class="mf">0.5</span><span class="w"> </span><span class="mi">175152</span><span class="w"> </span><span class="mi">72396</span><span class="w"> </span><span class="err">?</span><span class="w">        </span><span class="n">S</span><span class="w">     </span><span class="mi">2014</span><span class="w">  </span><span class="mi">27</span><span class="p">:</span><span class="mi">00</span><span class="w">  </span>\<span class="n">_</span><span class="w"> </span><span class="p">(</span><span class="n">squid</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">squid</span><span class="o">/</span><span class="n">squid</span><span class="o">.</span><span class="n">conf</span>
<span class="n">cybercit</span><span class="w">  </span><span class="mi">3922</span><span class="w">  </span><span class="mf">0.0</span><span class="w">  </span><span class="mf">0.4</span><span class="w"> </span><span class="mi">303380</span><span class="w"> </span><span class="mi">56304</span><span class="w"> </span><span class="err">?</span><span class="w">        </span><span class="n">S</span><span class="w">    </span><span class="n">Jan10</span><span class="w">   </span><span class="mi">0</span><span class="p">:</span><span class="mi">13</span><span class="w">  </span><span class="o">|</span><span class="w">   </span>\<span class="n">_</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">php</span><span class="o">-</span><span class="n">cgi</span>
</code></pre></div>

<p>看下"<a href="http://bash.cyberciti.biz/guide/Chapter_9:_Functions">如何编写和应用shell函数</a>"了解更多信息。</p>
<h3>综合一下：定制你自己的Linux或Unix bash shell工作环境</h3>
<p>现在，你将使用bash shell配置自己的环境。我只介绍bash。但是理论上zsh，ksh和其他常用shell都差不多。让我们看看如何调整shell来适合我作为系统管理员的需求。编辑你的~/.bashrc文件来附加设定。下面是一些常用的配置选项。</p>
<h4>#1: 设定bash路径和环境变量</h4>
<div class="highlight"><pre><span></span><code><span class="c1"># 设定路径 ##</span>
<span class="k">export</span><span class="w"> </span><span class="n">PATH</span><span class="o">=$</span><span class="n">PATH</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bin</span><span class="p">:</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">vivek</span><span class="o">/</span><span class="n">bin</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">firefox</span><span class="o">/</span><span class="n">bin</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">oraapp</span><span class="o">/</span><span class="n">bin</span>

<span class="c1"># 为cd命令设定路径</span>
<span class="k">export</span><span class="w"> </span><span class="n">CDPATH</span><span class="o">=.</span><span class="p">:</span><span class="o">$</span><span class="n">HOME</span><span class="p">:</span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">www</span>
</code></pre></div>

<p>使用less或more命令作为翻页器：</p>
<div class="highlight"><pre><span></span><code><span class="k">export</span><span class="w"> </span><span class="n">PAGER</span><span class="o">=</span><span class="n">less</span>
</code></pre></div>

<p>设定vim作为默认文本编辑器：</p>
<div class="highlight"><pre><span></span><code><span class="k">export</span><span class="w"> </span><span class="n">EDITOR</span><span class="o">=</span><span class="n">vim</span>
<span class="k">export</span><span class="w"> </span><span class="n">VISUAL</span><span class="o">=</span><span class="n">vim</span>
<span class="k">export</span><span class="w"> </span><span class="n">SVN_EDITOR</span><span class="o">=</span><span class="s2">&quot;$VISUAL&quot;</span>
</code></pre></div>

<p>设定Oracle数据库特别要求的参数：</p>
<div class="highlight"><pre><span></span><code><span class="k">export</span><span class="w"> </span><span class="n">ORACLE_HOME</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">oracle</span><span class="o">/</span><span class="n">xe</span><span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="n">oracle</span><span class="o">/</span><span class="n">product</span><span class="o">/</span><span class="mf">10.2</span><span class="o">.</span><span class="mi">0</span><span class="o">/</span><span class="n">server</span>
<span class="k">export</span><span class="w"> </span><span class="n">ORACLE_SID</span><span class="o">=</span><span class="n">XE</span>
<span class="k">export</span><span class="w"> </span><span class="n">NLS_LANG</span><span class="o">=$</span><span class="p">(</span><span class="o">$</span><span class="n">ORACLE_HOME</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">nls_lang</span><span class="o">.</span><span class="n">sh</span><span class="p">)</span>
</code></pre></div>

<p>设定JAVA_HOME和其他java路径，比如java版本：</p>
<div class="highlight"><pre><span></span><code><span class="k">export</span><span class="w"> </span><span class="n">JAVA_HOME</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">jvm</span><span class="o">/</span><span class="n">java</span><span class="o">-</span><span class="mi">6</span><span class="o">-</span><span class="n">sun</span><span class="o">/</span><span class="n">jre</span>

<span class="c1"># 把ORACLE和JAVA加入到PATH里</span>
<span class="k">export</span><span class="w"> </span><span class="n">PATH</span><span class="o">=$</span><span class="n">PATH</span><span class="p">:</span><span class="o">$</span><span class="n">ORACLE_HOME</span><span class="o">/</span><span class="n">bin</span><span class="p">:</span><span class="o">$</span><span class="n">JAVA_HOME</span><span class="o">/</span><span class="n">bin</span>
</code></pre></div>

<p><a href="http://www.cyberciti.biz/faq/ssh-passwordless-login-with-keychain-for-scripts/">使用密钥实现免密码登录</a>让ssh远程登录更安全：</p>
<div class="highlight"><pre><span></span><code><span class="gh">#</span> 再也不用输密码了
/usr/bin/keychain $HOME/.ssh/id_rsa
source $HOME/.keychain/$HOSTNAME-sh
</code></pre></div>

<p>最后，<a href="http://www.cyberciti.biz/faq/fedora-redhat-scientific-linuxenable-bash-completion/">打开bash命令补齐</a></p>
<div class="highlight"><pre><span></span><code>source /etc/bash_completion
</code></pre></div>

<h4>#2: 设定bash命令提示符</h4>
<p>设定<a href="http://www.cyberciti.biz/tips/howto-linux-unix-bash-shell-setup-prompt.html">定制的bash提示符(PS1)</a>:</p>
<div class="highlight"><pre><span></span><code>PS1=&#39;{\u@\h:\w }\$ &#39;
</code></pre></div>

<h4>#3: 设定默认文件权限</h4>
<div class="highlight"><pre><span></span><code>## 设定默认权限为644 ##
umask 022
</code></pre></div>

<h4>#4: 调整shell命令历史设定</h4>
<div class="highlight"><pre><span></span><code><span class="c1"># 不往命令历史里写入相同的行</span>
<span class="n">HISTCONTROL</span><span class="o">=</span><span class="n">ignoreboth</span>

<span class="c1"># 忽略这些命令</span>
<span class="n">HISTIGNORE</span><span class="o">=</span><span class="s2">&quot;reboot:shutdown *:ls:pwd:exit:mount:man *:history&quot;</span>

<span class="c1"># 通过HISTSIZE和HISTFILESIZE设定命令历史的长度</span>
<span class="k">export</span><span class="w"> </span><span class="n">HISTSIZE</span><span class="o">=</span><span class="mi">10000</span>
<span class="k">export</span><span class="w"> </span><span class="n">HISTFILESIZE</span><span class="o">=</span><span class="mi">10000</span>

<span class="c1"># 为命令历史文件增加时间戳</span>
<span class="k">export</span><span class="w"> </span><span class="n">HISTTIMEFORMAT</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%F</span><span class="s2"> %T &quot;</span>

<span class="c1"># 附加到命令历史文件，而不是覆盖</span>
<span class="n">shopt</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="n">histappend</span>
</code></pre></div>

<h4>#5: 设定shell会话的时区</h4>
<div class="highlight"><pre><span></span><code>## 为我自己的shell会话设定IST（印度标准时间） ##
TZ=Asia/Kolkata
</code></pre></div>

<h4>#6: 设定shell行编辑接口</h4>
<div class="highlight"><pre><span></span><code>## 使用vi风格的行编辑接口，替代bash默认的emacs模式 ##
set -o vi
</code></pre></div>

<h4>#7: 设定自己喜好的别名</h4>
<div class="highlight"><pre><span></span><code><span class="c1">## 增加一些保护 ##</span>
<span class="n">alias</span><span class="w"> </span><span class="n">rm</span><span class="o">=</span><span class="s1">&#39;rm -i&#39;</span>
<span class="n">alias</span><span class="w"> </span><span class="n">cp</span><span class="o">=</span><span class="s1">&#39;cp -i&#39;</span>
<span class="n">alias</span><span class="w"> </span><span class="n">mv</span><span class="o">=</span><span class="s1">&#39;mv -i&#39;</span>

<span class="c1">## Memcached ##</span>
<span class="n">alias</span><span class="w"> </span><span class="n">mcdstats</span><span class="o">=</span><span class="s1">&#39;/usr/bin/memcached-tool 10.10.29.68:11211 stats&#39;</span>
<span class="n">alias</span><span class="w"> </span><span class="n">mcdshow</span><span class="o">=</span><span class="s1">&#39;/usr/bin/memcached-tool 10.10.29.68:11211 display&#39;</span>
<span class="n">alias</span><span class="w"> </span><span class="n">mcdflush</span><span class="o">=</span><span class="s1">&#39;echo &quot;flush_all&quot; | nc 10.10.29.68 11211&#39;</span>

<span class="c1">## 默认命令参数 ##</span>
<span class="n">alias</span><span class="w"> </span><span class="n">vi</span><span class="o">=</span><span class="s1">&#39;vim&#39;</span>
<span class="n">alias</span><span class="w"> </span><span class="n">grep</span><span class="o">=</span><span class="s1">&#39;grep --color=auto&#39;</span>
<span class="n">alias</span><span class="w"> </span><span class="n">egrep</span><span class="o">=</span><span class="s1">&#39;egrep --color=auto&#39;</span>
<span class="n">alias</span><span class="w"> </span><span class="n">fgrep</span><span class="o">=</span><span class="s1">&#39;fgrep --color=auto&#39;</span>
<span class="n">alias</span><span class="w"> </span><span class="n">bc</span><span class="o">=</span><span class="s1">&#39;bc -l&#39;</span>
<span class="n">alias</span><span class="w"> </span><span class="n">wget</span><span class="o">=</span><span class="s1">&#39;wget -c&#39;</span>
<span class="n">alias</span><span class="w"> </span><span class="n">chown</span><span class="o">=</span><span class="s1">&#39;chown --preserve-root&#39;</span>
<span class="n">alias</span><span class="w"> </span><span class="n">chmod</span><span class="o">=</span><span class="s1">&#39;chmod --preserve-root&#39;</span>
<span class="n">alias</span><span class="w"> </span><span class="n">chgrp</span><span class="o">=</span><span class="s1">&#39;chgrp --preserve-root&#39;</span>
<span class="n">alias</span><span class="w"> </span><span class="n">rm</span><span class="o">=</span><span class="s1">&#39;rm -I --preserve-root&#39;</span>
<span class="n">alias</span><span class="w"> </span><span class="n">ln</span><span class="o">=</span><span class="s1">&#39;ln -i&#39;</span>
</code></pre></div>

<p>下面是一些额外的OS X Unix bash shell别名：</p>
<div class="highlight"><pre><span></span><code><span class="err">#</span><span class="w"> </span><span class="nx">从bash打开桌面应用</span>
<span class="kd">alias</span><span class="w"> </span><span class="nx">preview</span><span class="p">=</span><span class="s">&quot;open -a &#39;$PREVIEW&#39;&quot;</span>
<span class="kd">alias</span><span class="w"> </span><span class="nx">safari</span><span class="p">=</span><span class="s">&quot;open -a safari&quot;</span>
<span class="kd">alias</span><span class="w"> </span><span class="nx">firefox</span><span class="p">=</span><span class="s">&quot;open -a firefox&quot;</span>
<span class="kd">alias</span><span class="w"> </span><span class="nx">chrome</span><span class="p">=</span><span class="s">&quot;open -a google\ chrome&quot;</span>
<span class="kd">alias</span><span class="w"> </span><span class="nx">f</span><span class="p">=</span><span class="err">&#39;</span><span class="nx">open</span><span class="w"> </span><span class="o">-</span><span class="nx">a</span><span class="w"> </span><span class="nx">Finder</span><span class="w"> </span><span class="err">&#39;</span>

<span class="err">#</span><span class="w"> </span><span class="nx">清理那些</span><span class="p">.</span><span class="nx">DS_Store文件</span>
<span class="kd">alias</span><span class="w"> </span><span class="nx">dsclean</span><span class="p">=</span><span class="err">&#39;</span><span class="nx">find</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="o">-</span><span class="k">type</span><span class="w"> </span><span class="nx">f</span><span class="w"> </span><span class="o">-</span><span class="nx">name</span><span class="w"> </span><span class="p">.</span><span class="nx">DS_Store</span><span class="w"> </span><span class="o">-</span><span class="nx">delete</span><span class="err">&#39;</span>
</code></pre></div>

<h4>#8: 寡人好色</h4>
<div class="highlight"><pre><span></span><code><span class="c1"># 彩色的grep输出 </span>
<span class="n">alias</span><span class="w"> </span><span class="n">grep</span><span class="o">=</span><span class="s1">&#39;grep --color=auto&#39;</span>
<span class="k">export</span><span class="w"> </span><span class="n">GREP_COLOR</span><span class="o">=</span><span class="s1">&#39;1;33&#39;</span>

<span class="c1"># 彩色的ls</span>
<span class="k">export</span><span class="w"> </span><span class="n">LSCOLORS</span><span class="o">=</span><span class="s1">&#39;Gxfxcxdxdxegedabagacad&#39;</span>
<span class="c1"># Gnu/linux的ls</span>
<span class="n">ls</span><span class="o">=</span><span class="s1">&#39;ls --color=auto&#39;</span>

<span class="c1"># BSD/os x的ls命令</span>
<span class="c1"># alias ls=&#39;ls -G&#39;</span>
</code></pre></div>

<h4>#9: 设定自己喜好的bash函数</h4>
<div class="highlight"><pre><span></span><code><span class="err">#</span><span class="w"> </span><span class="n">在屏幕上显示10个最近的历史命令</span>
<span class="k">function</span><span class="w"> </span><span class="n">ht</span><span class="w"> </span><span class="err">{</span>
<span class="w">  </span><span class="n">history</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">awk</span><span class="w"> </span><span class="s1">&#39;{a[$2]++}END{for(i in a){print a[i] &quot; &quot; i}}&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">sort</span><span class="w"> </span><span class="o">-</span><span class="n">rn</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">head</span>
<span class="err">}</span>

<span class="err">#</span><span class="w"> </span><span class="n">host和ping命令的替代</span>
<span class="err">#</span><span class="w"> </span><span class="nl">接受http</span><span class="p">:</span><span class="o">//</span><span class="w"> </span><span class="n">或</span><span class="w"> </span><span class="nl">https</span><span class="p">:</span><span class="o">//</span><span class="w"> </span><span class="n">或</span><span class="w"> </span><span class="nl">ftps</span><span class="p">:</span><span class="o">//</span><span class="w"> </span><span class="n">名称用作域或主机名</span>
<span class="n">_getdomainnameonly</span><span class="p">()</span><span class="err">{</span>
<span class="w">    </span><span class="k">local</span><span class="w"> </span><span class="n">h</span><span class="o">=</span><span class="ss">&quot;$1&quot;</span>
<span class="w">    </span><span class="k">local</span><span class="w"> </span><span class="n">f</span><span class="o">=</span><span class="ss">&quot;${h,,}&quot;</span>
<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">remove</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">part</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">hostname</span>
<span class="w">        </span><span class="n">f</span><span class="o">=</span><span class="ss">&quot;${f#http://}&quot;</span>
<span class="w">        </span><span class="n">f</span><span class="o">=</span><span class="ss">&quot;${f#https://}&quot;</span>
<span class="w">    </span><span class="n">f</span><span class="o">=</span><span class="ss">&quot;${f#ftp://}&quot;</span>
<span class="w">    </span><span class="n">f</span><span class="o">=</span><span class="ss">&quot;${f#scp://}&quot;</span>
<span class="w">    </span><span class="n">f</span><span class="o">=</span><span class="ss">&quot;${f#scp://}&quot;</span>
<span class="w">    </span><span class="n">f</span><span class="o">=</span><span class="ss">&quot;${f#sftp://}&quot;</span>
<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">remove</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="ow">and</span><span class="o">/</span><span class="ow">or</span><span class="w"> </span><span class="nl">username</span><span class="p">:</span><span class="n">password</span><span class="w"> </span><span class="n">part</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">hostname</span>
<span class="w">    </span><span class="n">f</span><span class="o">=</span><span class="ss">&quot;${f#*:*@}&quot;</span>
<span class="w">    </span><span class="n">f</span><span class="o">=</span><span class="ss">&quot;${f#*@}&quot;</span>
<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">remove</span><span class="w"> </span><span class="ow">all</span><span class="w"> </span><span class="o">/</span><span class="n">foo</span><span class="o">/</span><span class="n">xyz</span><span class="p">.</span><span class="n">html</span><span class="o">*</span><span class="w">  </span>
<span class="w">    </span><span class="n">f</span><span class="o">=</span><span class="err">${</span><span class="n">f</span><span class="o">%%</span><span class="cm">/*}</span>
<span class="cm">    # show domain name only</span>
<span class="cm">    echo &quot;$f&quot;</span>
<span class="cm">}</span>


<span class="cm">ping(){</span>
<span class="cm">    local array=( $@ )          # get all args in an array</span>
<span class="cm">    local len=${#array[@]}          # find the length of an array</span>
<span class="cm">    local host=${array[$len-1]}     # get the last arg</span>
<span class="cm">    local args=${array[@]:0:$len-1} # get all args before the last arg in $@ in an array </span>
<span class="cm">    local _ping=&quot;/bin/ping&quot;</span>
<span class="cm">    local c=$(_getdomainnameonly &quot;$host&quot;)</span>
<span class="cm">    [ &quot;$t&quot; != &quot;$c&quot; ] &amp;&amp; echo &quot;Sending ICMP ECHO_REQUEST to \&quot;$c\&quot;...&quot;</span>
<span class="cm">    # pass args and host</span>
<span class="cm">    $_ping $args $c</span>
<span class="cm">}</span>

<span class="cm">host(){</span>
<span class="cm">    local array=( $@ )</span>
<span class="cm">    local len=${#array[@]}</span>
<span class="cm">    local host=${array[$len-1]}</span>
<span class="cm">    local args=${array[@]:0:$len-1}</span>
<span class="cm">    local _host=&quot;/usr/bin/host&quot;</span>
<span class="cm">    local c=$(_getdomainnameonly &quot;$host&quot;)</span>
<span class="cm">    [ &quot;$t&quot; != &quot;$c&quot; ] &amp;&amp; echo &quot;Performing DNS lookups for \&quot;$c\&quot;...&quot;</span>
<span class="cm">    $_host $args $c</span>
<span class="cm">}</span>
</code></pre></div>

<h4>#10: 通过shell shopt命令设定bash shell行为</h4>
<p>最后，你可以<a href="http://bash.cyberciti.biz/guide/Setting_shell_options">使用set和shopt命令调整bash shell环境</a>：</p>
<div class="highlight"><pre><span></span><code># 目录拼写纠正
shopt -q -s cdspell

# 保证每次终端窗口改变大小后会更新显示
shopt -q -s checkwinsize

# 打开高级模式匹配功能
shopt -q -s extglob

# 退出时附加命令历史而不是覆盖
shopt -s histappend

# 在命令历史使用多行
shopt -q -s cmdhist

# 在后台任务结束时立刻通知
set -o notify

# 禁用[CTRL-D]来结束shell
set -o ignoreeof
</code></pre></div>

<h3>总结</h3>
<p>这个帖子不难理解。它简短地将如何定制用户环境从头介绍了一下。要深入了解bash/ksh/zsh/csh/tcsh/的能力，我建议你用下面的命令阅读man文档：</p>
<div class="highlight"><pre><span></span><code>man bash
man zsh
man tcsh
man ksh
</code></pre></div>

<blockquote>
<p>这篇文章由Aadrika T. J.贡献；由admin编辑并增加了额外内容。你也可以<a href="http://www.cyberciti.biz/write-for-nixcraft/">为nixCraft做出贡献</a>。</p>
</blockquote>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>