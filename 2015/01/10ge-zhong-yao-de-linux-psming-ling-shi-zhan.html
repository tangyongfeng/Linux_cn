<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>10个重要的Linux ps命令实战</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: Pungki Arianto Linux作为Unix的衍生操作系统，Linux内建有查看当前进程的工具ps。这个工具能在命令行中使用。 PS 命令是什么 查看它的man手册可以看到，ps命令能够给出当前系统中进程的快照。它能捕获系统在某一事件的进程状态。如果你想不 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li class="active"><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2015/01/10ge-zhong-yao-de-linux-psming-ling-shi-zhan.html" rel="bookmark"
           title="Permalink to 10个重要的Linux ps命令实战">10个重要的Linux ps命令实战</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2015-01-26T07:34:00+01:00">
                Published: Mon 26 January 2015
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/ji-zhu">技术</a>.</p>

</footer><!-- /.post-info -->      <p>Author: Pungki Arianto</p>
<p>Linux作为Unix的衍生操作系统，Linux内建有查看当前进程的工具ps。这个工具能在命令行中使用。</p>
<p><img alt="" src="/data/attachment/album/201501/25/233930c0ze2crfeqxeexwu.jpg"></p>
<h3>PS 命令是什么</h3>
<p>查看它的man手册可以看到，ps命令能够给出当前系统中进程的快照。它能捕获系统在某一事件的进程状态。如果你想不断更新查看的这个状态，可以使用top命令。</p>
<p>ps命令支持三种使用的语法格式</p>
<ol>
<li>UNIX 风格，选项可以组合在一起，并且选项前必须有“-”连字符</li>
<li>BSD 风格，选项可以组合在一起，但是选项前不能有“-”连字符</li>
<li>GNU 风格的长选项，选项前有两个“-”连字符</li>
</ol>
<p>我们能够混用这几种风格，但是可能会发生冲突。本文使用 UNIX 风格的ps命令。这里有在日常生活中使用较多的ps命令的例子。</p>
<h3>1. 不加参数执行ps命令</h3>
<p>这是一个基本的 <strong>ps</strong> 使用。在控制台中执行这个命令并查看结果。</p>
<p><img alt="不加选项执行ps命令" src="/data/attachment/album/201501/25/233938qmgppp33dwzi7yzf.png"></p>
<p>结果默认会显示4列信息。</p>
<ul>
<li>PID: 运行着的命令(CMD)的进程编号</li>
<li>TTY: 命令所运行的位置（终端）</li>
<li>TIME: 运行着的该命令所占用的CPU处理时间</li>
<li>CMD: 该进程所运行的命令</li>
</ul>
<p>这些信息在显示时未排序。</p>
<h3>2. 显示所有当前进程</h3>
<p>使用 <strong>-a</strong> 参数。<strong>-a 代表 all</strong>。同时加上x参数会显示没有控制终端的进程。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ps<span class="w"> </span>-ax
</code></pre></div>

<p>这个命令的结果或许会很长。为了便于查看，可以结合less命令和管道来使用。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ps<span class="w"> </span>-ax<span class="w"> </span><span class="p">|</span><span class="w"> </span>less
</code></pre></div>

<p><img alt="ps all 信息" src="/data/attachment/album/201501/25/233940xel3ufv3k5v2vm4z.png"></p>
<h3>3. 根据用户过滤进程</h3>
<p>在需要查看特定用户进程的情况下，我们可以使用 <strong>-u</strong> 参数。比如我们要查看用户'pungki'的进程，可以通过下面的命令：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ps<span class="w"> </span>-u<span class="w"> </span>pungki
</code></pre></div>

<p><img alt="通过用户过滤" src="/data/attachment/album/201501/25/233941kadate1eaq0uq11z.png"></p>
<h3>4. 通过cpu和内存使用来过滤进程</h3>
<p>也许你希望把结果按照 CPU 或者内存用量来筛选，这样你就找到哪个进程占用了你的资源。要做到这一点，我们可以使用 <strong>aux 参数</strong>，来显示全面的信息:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ps<span class="w"> </span>-aux<span class="w"> </span><span class="p">|</span><span class="w"> </span>less
</code></pre></div>

<p><img alt="显示全面信息" src="/data/attachment/album/201501/25/233942v744wacwmj00ww6m.png"></p>
<p>当结果很长时，我们可以使用管道和less命令来筛选。</p>
<p>默认的结果集是未排好序的。可以通过 <strong>--sort</strong>命令来排序。</p>
<p>根据 <strong>CPU 使用</strong>来升序排序</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ps<span class="w"> </span>-aux<span class="w"> </span>--sort<span class="w"> </span>-pcpu<span class="w"> </span><span class="p">|</span><span class="w"> </span>less
</code></pre></div>

<p><img alt="根据cpu使用排序" src="/data/attachment/album/201501/25/233944u3221ih11w94i1e1.png"></p>
<p>根据 <strong>内存使用</strong> 来升序排序</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ps<span class="w"> </span>-aux<span class="w"> </span>--sort<span class="w"> </span>-pmem<span class="w"> </span><span class="p">|</span><span class="w"> </span>less
</code></pre></div>

<p><img alt="根据内存使用来排序" src="/data/attachment/album/201501/25/233945v0ghd4ewbhzzt0f0.png"></p>
<p>我们也可以将它们合并到一个命令，并通过管道显示前10个结果：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ps<span class="w"> </span>-aux<span class="w"> </span>--sort<span class="w"> </span>-pcpu,+pmem<span class="w"> </span><span class="p">|</span><span class="w"> </span>head<span class="w"> </span>-n<span class="w"> </span><span class="m">10</span>
</code></pre></div>

<h3>5. 通过进程名和PID过滤</h3>
<p>使用 <strong>-C 参数</strong>，后面跟你要找的进程的名字。比如想显示一个名为getty的进程的信息，就可以使用下面的命令：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ps<span class="w"> </span>-C<span class="w"> </span>getty
</code></pre></div>

<p><img alt="通过进程名和PID过滤" src="/data/attachment/album/201501/25/233946pcw0ckciee14w6wt.png"></p>
<p>如果想要看到更多的细节，我们可以使用-f参数来查看格式化的信息列表：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ps<span class="w"> </span>-f<span class="w"> </span>-C<span class="w"> </span>getty
</code></pre></div>

<p><img alt="通过进程名和PID过滤" src="/data/attachment/album/201501/25/233947r6g66w1p6ds75d3g.png"></p>
<h3>6. 根据线程来过滤进程</h3>
<p>如果我们想知道特定进程的线程，可以使用<strong>-L 参数</strong>，后面加上特定的PID。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ps<span class="w"> </span>-L<span class="w"> </span><span class="m">1213</span>
</code></pre></div>

<p><img alt="根据线程来过滤进程" src="/data/attachment/album/201501/25/233948lidpli3t533atlie.png"></p>
<h3>7. 树形显示进程</h3>
<p>有时候我们希望以树形结构显示进程，可以使用 <strong>-axjf</strong> 参数。</p>
<div class="highlight"><pre><span></span><code>$ps -axjf
</code></pre></div>

<p><img alt="树形显示进程" src="/data/attachment/album/201501/25/233950h5ws44wshv5sz5xd.png"></p>
<p>或者可以使用另一个命令。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>pstree
</code></pre></div>

<p><img alt="树形显示进程" src="/data/attachment/album/201501/25/233952a3sqm33t5qf5195v.png"></p>
<h3>8. 显示安全信息</h3>
<p>如果想要查看现在有谁登入了你的服务器。可以使用ps命令加上相关参数:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ps<span class="w"> </span>-eo<span class="w"> </span>pid,user,args
</code></pre></div>

<p><strong>参数 -e</strong> 显示所有进程信息，<strong>-o 参数</strong>控制输出。<strong>Pid</strong>,<strong>User 和 Args</strong>参数显示<strong>PID，运行应用的用户</strong>和<strong>该应用</strong>。</p>
<p><img alt="显示安全信息" src="/data/attachment/album/201501/25/233953mo9i92auznn2o425.png"></p>
<p>能够与<strong>-e 参数</strong> 一起使用的关键字是<strong>args, cmd, comm, command, fname, ucmd, ucomm, lstart, bsdstart 和 start</strong>。</p>
<h3>9. 格式化输出root用户（真实的或有效的UID）创建的进程</h3>
<p>系统管理员想要查看由root用户运行的进程和这个进程的其他相关信息时，可以通过下面的命令:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ps<span class="w"> </span>-U<span class="w"> </span>root<span class="w"> </span>-u<span class="w"> </span>root<span class="w"> </span>u
</code></pre></div>

<p><strong>-U 参数</strong>按真实用户ID(RUID)筛选进程，它会从用户列表中选择真实用户名或 ID。真实用户即实际创建该进程的用户。</p>
<p><strong>-u</strong> 参数用来筛选有效用户ID（EUID）。</p>
<p>最后的<strong>u</strong>参数用来决定以针对用户的格式输出，由<strong>User, PID, %CPU, %MEM, VSZ, RSS, TTY, STAT, START, TIME 和 COMMAND</strong>这几列组成。</p>
<p>这里有上面的命令的输出结果：</p>
<p><img alt="show real and effective User ID" src="/data/attachment/album/201501/25/233954viyztzzw6i976ppl.png"></p>
<h3>10. 使用PS实时监控进程状态</h3>
<p>ps 命令会显示你系统当前的进程状态，但是这个结果是静态的。</p>
<p>当有一种情况，我们需要像上面第四点中提到的通过CPU和内存的使用率来筛选进程，并且我们希望结果能够每秒刷新一次。为此，我们可以<strong>将ps命令和watch命令结合起来</strong>。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>watch<span class="w"> </span>-n<span class="w"> </span><span class="m">1</span><span class="w"> </span>‘ps<span class="w"> </span>-aux<span class="w"> </span>--sort<span class="w"> </span>-pmem,<span class="w"> </span>-pcpu’
</code></pre></div>

<p><img alt="组合 ps 和 watch" src="/data/attachment/album/201501/25/233956qw67614nnx74q11p.png"></p>
<p>如果输出太长，我们也可以限制它，比如前20条，我们可以使用<strong>head</strong>命令来做到。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>watch<span class="w"> </span>-n<span class="w"> </span><span class="m">1</span><span class="w"> </span>‘ps<span class="w"> </span>-aux<span class="w"> </span>--sort<span class="w"> </span>-pmem,<span class="w"> </span>-pcpu<span class="w"> </span><span class="p">|</span><span class="w"> </span>head<span class="w"> </span><span class="m">20</span>’
</code></pre></div>

<p><img alt="组合 ps 和 watch" src="/data/attachment/album/201501/25/233959luqwzx6q7585nl77.png"></p>
<p>这里的动态查看并不像top或者htop命令一样。<strong>但是使用ps的好处是</strong>你能够定义显示的字段，你能够选择你想查看的字段。</p>
<p>举个例子，<strong>如果你只需要看名为'pungki'用户的信息</strong>，你可以使用下面的命令：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>watch<span class="w"> </span>-n<span class="w"> </span><span class="m">1</span><span class="w"> </span>‘ps<span class="w"> </span>-aux<span class="w"> </span>-U<span class="w"> </span>pungki<span class="w"> </span>u<span class="w"> </span>--sort<span class="w"> </span>-pmem,<span class="w"> </span>-pcpu<span class="w"> </span><span class="p">|</span><span class="w"> </span>head<span class="w"> </span><span class="m">20</span>’
</code></pre></div>

<p><img alt="组合 ps 和 watch" src="/data/attachment/album/201501/25/234001v8ui2zsif2sg2ww2.png"></p>
<h3>结论</h3>
<p>你也许每天都会使用ps命令来监控你的Linux系统。但是事实上，你可以通过ps命令的参数来生成各种你需要的报表。</p>
<p>ps命令的另一个优势是ps是各种 Linux系统都默认安装的，因此你只要用就行了。</p>
<p>不要忘了通过 man ps来查看更多的参数。（LCTT 译注：由于 ps 命令古老而重要，所以它在不同的 UNIX、BSD、Linux 等系统中的参数不尽相同，因此如果你用的不是 Linux 系统，请查阅你的文档了解具体可用的参数。）</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>