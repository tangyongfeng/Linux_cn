<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>用腻了 wget 或 curl，有什么更好的替代品吗？</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: Dan Nanni 如果你经常需要通过终端以非交互模式访问网络服务器（例如，从网络上下载文件，或者是测试 RESTful 网络服务接口），可 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li class="active"><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2015/05/yong-ni-liao-wget-huo-curlyou-shi-yao-geng-hao-de-ti-dai-pin-ma.html" rel="bookmark"
           title="Permalink to 用腻了 wget 或 curl，有什么更好的替代品吗？">用腻了 wget 或 curl，有什么更好的替代品吗？</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2015-05-21T10:30:00+02:00">
                Published: Thu 21 May 2015
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/ji-zhu">技术</a>.</p>

</footer><!-- /.post-info -->      <p>Author: Dan Nanni</p>
<p>如果你经常需要通过终端以非交互模式访问网络服务器（例如，从网络上下载文件，或者是测试 RESTful 网络服务接口），可能你会选择的工具是 wget 或 curl。通过大量的命令行选项，这两种工具都可以处理很多非交互网络访问的情况（比如<a href="http://xmodulo.com/how-to-download-multiple-files-with-wget.html">这里</a>、<a href="http://xmodulo.com/how-to-use-custom-http-headers-with-wget.html">这里</a>，还有<a href="/article-4957-1.html">这里</a>）。然而，即使像这些一样的强大的工具，你也只能发挥你所了解的那些选项的功能。除非你很精通那些繁冗的语法细节，这些工具对于你来说只不过是简单的网络下载器而已。</p>
<p>就像其宣传的那样，“给人用 curl 类工具”，<a href="https://github.com/jakubroztocil/httpie">HTTPie</a> 设计用来增强 wget 和 curl 的可用性。它的主要目标是使通过命令行与网络服务器进行交互的过程变得尽可能的人性化。为此，HTTPie 支持具有表现力、但又很简单很直观的语法。它以彩色模式显示响应，并且还有一些不错的优点，比如对 JSON 的良好支持，和持久性会话用以作业流程化。</p>
<p>我知道很多人对把像 wget 和 curl 这样的无处不在的、可用的、完美的工具换成完全没听说过的软件心存疑虑。这种观点是好的，特别是如果你是一个系统管理员、要处理很多不同的硬件的话。然而，对于开发者和终端用户来说，重要的是效率。如果我发现了一个工具的用户更佳替代品，那么我认为采用易于使用的版本来节省宝贵的时间是毫无疑问的。没有必要对替换掉的工具保持信仰忠诚。毕竟，对于 Linux 来说，最好的事情就是可以选择。</p>
<p>在这篇文章中，让我们来了解并展示一下我所说的 HTTPie，一个用户友好的 wget 和 curl 的替代。</p>
<p><img alt="" src="/data/attachment/album/201505/20/233149by4l4qv8yzlokkkm.jpg"></p>
<h3>在 Linux 上安装 HTTPie</h3>
<p>HTTPie 是用 Python 写的，所以你可以在几乎所有地方（Linux，MacOSX，Windows）安装它。而且，在大多数的 Linux 发行版中都有编译好的安装包。</p>
<h4>Debian，Ubuntu 或者 Linux Mint：</h4>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>httpie
</code></pre></div>

<h4>Fedora：</h4>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>yum<span class="w"> </span>install<span class="w"> </span>httpie
</code></pre></div>

<h4>CentOS/RHEL：</h4>
<p>首先，启用<a href="/article-2324-1.html">EPEL 仓库</a>，然后运行：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>yum<span class="w"> </span>install<span class="w"> </span>httpie
</code></pre></div>

<p>对于任何 Linux 发行版，另一个安装方法时使用<a href="http://ask.xmodulo.com/install-pip-linux.html">pip</a>。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>--upgrade<span class="w"> </span>httpie
</code></pre></div>

<h3>HTTPie 的例子</h3>
<p>当你安装完 HTTPie 后，你可以通过输入 http 命令来调用它。在这篇文章的剩余部分，我会展示几个有用的 http 命令的例子。</p>
<h4>例1：定制头部</h4>
<p>你可以使用 <header:value> 的格式来定制头部。例如，我们发送一个 HTTP GET 请求到 <a href="http://www.test.com">www.test.com</a> ，使用定制用户代理（user-agent）和来源（referer），还有定制头部（比如 MyParam）。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>http<span class="w"> </span>www.test.com<span class="w"> </span>User-Agent:Xmodulo/1.0<span class="w"> </span>Referer:http://xmodulo.com<span class="w"> </span>MyParam:Foo
</code></pre></div>

<p>注意到当使用 HTTP GET 方法时，就无需明确指定 HTTP 方法。</p>
<p>这个 HTTP 请求看起来如下：</p>
<div class="highlight"><pre><span></span><code><span class="nf">GET</span> <span class="nn">/</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">www.test.com</span>
<span class="na">Accept</span><span class="o">:</span> <span class="l">*/*</span>
<span class="na">Referer</span><span class="o">:</span> <span class="l">http://xmodulo.com</span>
<span class="na">Accept-Encoding</span><span class="o">:</span> <span class="l">gzip, deflate, compress</span>
<span class="na">MyParam</span><span class="o">:</span> <span class="l">Foo</span>
<span class="na">User-Agent</span><span class="o">:</span> <span class="l">Xmodulo/1.0</span>
</code></pre></div>

<h4>例2：下载文件</h4>
<p>你可以把 http 作为文件下载器来使用。你需要像下面一样把输出重定向到文件。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>http<span class="w"> </span>www.test.com/my_file.zip<span class="w"> </span>&gt;<span class="w"> </span>my_file.zip
</code></pre></div>

<p>或者：</p>
<div class="highlight"><pre><span></span><code><span class="o">$</span><span class="w"> </span><span class="n">http</span><span class="w"> </span><span class="o">--</span><span class="n">download</span><span class="w"> </span><span class="n">www</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">my_file</span><span class="o">.</span><span class="n">zip</span>
</code></pre></div>

<h4>例3：定制 HTTP 方法</h4>
<p>除了默认的 GET 方法，你还可以使用其他方法（比如 PUT，POST，HEAD）。例如，发送一个 HTTP PUT 请求：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>http<span class="w"> </span>PUT<span class="w"> </span>www.test.com<span class="w"> </span><span class="nv">name</span><span class="o">=</span><span class="s1">&#39;Dan Nanni&#39;</span><span class="w"> </span><span class="nv">email</span><span class="o">=</span>dan@email.com
</code></pre></div>

<h4>例4：提交表单</h4>
<p>使用 http 命令提交表单很容易，如下：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>http<span class="w"> </span>-f<span class="w"> </span>POST<span class="w"> </span>www.test.com<span class="w"> </span><span class="nv">name</span><span class="o">=</span><span class="s1">&#39;Dan Nanni&#39;</span><span class="w"> </span><span class="nv">comment</span><span class="o">=</span><span class="s1">&#39;Hi there&#39;</span>
</code></pre></div>

<p>'-f' 选项使 http 命令序列化数据字段，并将 'Content-Type' 设置为 "application/x-www-form-urlencoded; charset=utf-8"。</p>
<p>这个 HTTP POST 请求看起来如下：</p>
<div class="highlight"><pre><span></span><code><span class="nf">POST</span> <span class="nn">/</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">www.test.com</span>
<span class="na">Content-Length</span><span class="o">:</span> <span class="l">31</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/x-www-form-urlencoded; charset=utf-8</span>
<span class="na">Accept-Encoding</span><span class="o">:</span> <span class="l">gzip, deflate, compress</span>
<span class="na">Accept</span><span class="o">:</span> <span class="l">*/*</span>
<span class="na">User-Agent</span><span class="o">:</span> <span class="l">HTTPie/0.8.0</span>

<span class="nt">name</span><span class="o">=</span><span class="s">Dan+Nanni</span><span class="p">&amp;</span><span class="nt">comment</span><span class="o">=</span><span class="s">Hi+there</span>
</code></pre></div>

<h4>例５：JSON 支持</h4>
<p>HTTPie 内置 JSON（一种日渐普及的数据交换格式）支持。事实上，HTTPie 默认使用的内容类型（content-type）就是 JSON。因此，当你不指定内容类型发送数据字段时，它们会自动序列化为 JSON 对象。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>http<span class="w"> </span>POST<span class="w"> </span>www.test.com<span class="w"> </span><span class="nv">name</span><span class="o">=</span><span class="s1">&#39;Dan Nanni&#39;</span><span class="w"> </span><span class="nv">comment</span><span class="o">=</span><span class="s1">&#39;Hi there&#39;</span>
</code></pre></div>

<p>这个 HTTP POST 请求看起来如下：</p>
<div class="highlight"><pre><span></span><code><span class="nf">POST</span> <span class="nn">/</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">www.test.com</span>
<span class="na">Content-Length</span><span class="o">:</span> <span class="l">44</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/json; charset=utf-8</span>
<span class="na">Accept-Encoding</span><span class="o">:</span> <span class="l">gzip, deflate, compress</span>
<span class="na">Accept</span><span class="o">:</span> <span class="l">application/json</span>
<span class="na">User-Agent</span><span class="o">:</span> <span class="l">HTTPie/0.8.0</span>

<span class="p">{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Dan Nanni&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;comment&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Hi there&quot;</span><span class="p">}</span>
</code></pre></div>

<h4>例6：输出重定向</h4>
<p>HTTPie 的另外一个用户友好特性是输入重定向，你可以使用缓冲数据提供 HTTP 请求内容。例如：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>http<span class="w"> </span>POST<span class="w"> </span>api.test.com/db/lookup<span class="w"> </span>&lt;<span class="w"> </span>my_info.json
</code></pre></div>

<p>或者：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;{&quot;name&quot;: &quot;Dan Nanni&quot;}&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>http<span class="w"> </span>POST<span class="w"> </span>api.test.com/db/lookup
</code></pre></div>

<h3>结束语</h3>
<p>在这篇文章中，我介绍了 HTTPie，一个 wget 和 curl 的可能替代工具。除了这里展示的几个简单的例子，你可以在其<a href="https://github.com/jakubroztocil/httpie">官方网站</a>上找到 HTTPie 的很多有趣的应用。再次重复一遍，一款再强大的工具也取决于你对它的了解程度。从个人而言，我更倾向于 HTTPie，因为我在寻找一种更简洁的测试复杂网络接口的方法。</p>
<p>你怎么看？</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>