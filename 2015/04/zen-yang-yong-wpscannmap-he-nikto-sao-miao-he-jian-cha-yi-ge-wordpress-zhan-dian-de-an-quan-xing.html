<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>怎样用 WPScan，Nmap 和 Nikto 扫描和检查一个 WordPress 站点的安全性</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: anismaj 介绍 数百万个网站用着 WordPress ，这当然是有原因的。WordPress 是众多内容管理系统中对开发者最友好的，本质上说你可以用它做 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li class="active"><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2015/04/zen-yang-yong-wpscannmap-he-nikto-sao-miao-he-jian-cha-yi-ge-wordpress-zhan-dian-de-an-quan-xing.html" rel="bookmark"
           title="Permalink to 怎样用 WPScan，Nmap 和 Nikto 扫描和检查一个 WordPress 站点的安全性">怎样用 WPScan，Nmap 和 Nikto 扫描和检查一个 WordPress 站点的安全性</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2015-04-26T07:52:00+02:00">
                Published: Sun 26 April 2015
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/xi-tong-yun-wei">系统运维</a>.</p>

</footer><!-- /.post-info -->      <p>Author: anismaj</p>
<h3>介绍</h3>
<p>数百万个网站用着 WordPress ，这当然是有原因的。WordPress 是众多内容管理系统中对开发者最友好的，本质上说你可以用它做任何事情。不幸的是，每天都有些吓人的报告说某个主要的网站被黑了，或者某个重要的数据库被泄露了之类的，吓得人一愣一愣的。</p>
<p>如果你还没有安装 WordPress ，可以看下下面的文章。</p>
<p>在基于 Debian 的系统上：</p>
<ul>
<li><a href="http://www.unixmen.com/install-wordpress-ubuntu-14-10/">如何在 Ubuntu 上安装 WordPress</a></li>
</ul>
<p>在基于 RPM 的系统上：</p>
<ul>
<li><a href="http://www.unixmen.com/install-configure-wordpress-4-0-benny-centos-7/">如何在 CentOS 上安装 WordPress</a></li>
</ul>
<p>我之前的文章  <a href="http://www.unixmen.com/secure-wordpress-website/">如何安全加固 WordPress 站点</a> 里面列出的<strong>备忘录</strong>为读者维护 WordPress 的安全提供了一点帮助。</p>
<p>在这篇文章里面，我将介绍 <strong>wpscan</strong> 的安装过程，以及怎样使用 wpscan 来定位那些已知的会让你的站点变得易受攻击的插件和主题。还有怎样安装和使用一款免费的网络探索和攻击的安全扫描软件 <strong>nmap</strong> 。最后展示的是使用 <strong>nikto</strong> 的步骤。</p>
<p><img alt="" src="/data/attachment/album/201504/25/225948j6druzvrwmu6swwc.jpg"></p>
<p>（题图来自：codersmount.com）</p>
<h3>用 WPScan 测试 WordPress 中易受攻击的插件和主题</h3>
<p><strong>WPScan</strong> 是一个 WordPress 黑盒安全扫描软件，用 Ruby 写成，它是专门用来寻找已知的 WordPress 的弱点的。它为安全专家和 WordPress 管理员提供了一条评估他们的 WordPress 站点的途径。它的基于开源代码，在 GPLv3 下发行。</p>
<h4>下载和安装 WPScan</h4>
<p>在我们开始安装之前，很重要的一点是要注意 wpscan 不能在 Windows 下工作，所以你需要使用一台 Linux 或者 OS X 的机器来完成下面的事情。如果你只有 Windows 的系统，拿你可以下载一个 Virtualbox 然后在虚拟机里面安装任何你喜欢的 Linux 发行版本。</p>
<p>WPScan 的源代码放在 Github 上，所以需要先安装 git（LCTT 译注：其实你也可以直接从 Github 上下载打包的源代码，而不必非得装 git ）。</p>
<div class="highlight"><pre><span></span><code>sudo apt-get install git
</code></pre></div>

<p>git 装好了，我们就要安装 wpscan 的依赖包了。</p>
<div class="highlight"><pre><span></span><code>sudo apt-get install libcurl4-gnutls-dev libopenssl-ruby libxml2 libxml2-dev libxslt1-dev ruby-dev ruby1.9.3
</code></pre></div>

<p>把 wpscan 从 github 上 clone 下来。</p>
<div class="highlight"><pre><span></span><code>git clone https://github.com/wpscanteam/wpscan.git
</code></pre></div>

<p>现在我们可以进入这个新建立的 wpscan 目录，通过 bundler 安装必要的 ruby 包。</p>
<div class="highlight"><pre><span></span><code>cd wpscan
sudo gem install bundler &amp;&amp; bundle install --without test development
</code></pre></div>

<p>现在 wpscan 装好了，我们就可以用它来搜索我们 WordPress 站点潜在的易受攻击的文件。wpcan 最重要的方面是它能列出不仅是插件和主题，也能列出用户和缩略图的功能。WPScan 也可以用来暴力破解 WordPress —— 但这不是本文要讨论的内容。</p>
<h4>更新 WPScan</h4>
<div class="highlight"><pre><span></span><code>ruby wpscan.rb --update
</code></pre></div>

<h4>列举插件</h4>
<p>要列出所有插件，只需要加上 “--enumerate p” 参数，就像这样：</p>
<div class="highlight"><pre><span></span><code><span class="n">ruby</span><span class="w"> </span><span class="n">wpscan</span><span class="o">.</span><span class="n">rb</span><span class="w"> </span><span class="o">--</span><span class="n">url</span><span class="w"> </span><span class="n">http</span><span class="p">(</span><span class="n">s</span><span class="p">):</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">yoursiteurl</span><span class="o">.</span><span class="n">com</span><span class="w"> </span><span class="o">--</span><span class="n">enumerate</span><span class="w"> </span><span class="n">p</span>
</code></pre></div>

<p>或者仅仅列出易受攻击的插件：</p>
<div class="highlight"><pre><span></span><code><span class="n">ruby</span><span class="w"> </span><span class="n">wpscan</span><span class="o">.</span><span class="n">rb</span><span class="w"> </span><span class="o">--</span><span class="n">url</span><span class="w"> </span><span class="n">http</span><span class="p">(</span><span class="n">s</span><span class="p">):</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">yoursiteurl</span><span class="o">.</span><span class="n">com</span><span class="w"> </span><span class="o">--</span><span class="n">enumerate</span><span class="w"> </span><span class="n">vp</span>
</code></pre></div>

<p>下面是一些例子：</p>
<div class="highlight"><pre><span></span><code>| Name: ukiscet
| Location: http://********.com/wp-content/plugins/akismet/

| Name: audio-player
| Location: http://********.com/wp-content/plugins/audio-player/
|
| <span class="gs">* Title: Audio Player - player.swf playerID Parameter XSS</span>
<span class="gs">| *</span> Reference: http://seclists.org/bugtraq/2013/Feb/35
| <span class="gs">* Reference: http://secunia.com/advisories/52083</span>
<span class="gs">| *</span> Reference: http://osvdb.org/89963
| <span class="gs">* Fixed in: 2.0.4.6</span>

<span class="gs">| Name: bbpress - v2.3.2</span>
<span class="gs">| Location: http://*</span>*******.com/wp-content/plugins/bbpress/
| Readme: http://********.com/wp-content/plugins/bbpress/readme.txt
|
| <span class="gs">* Title: BBPress - Multiple Script Malformed Input Path Disclosure</span>
<span class="gs">| *</span> Reference: http://xforce.iss.net/xforce/xfdb/78244
| <span class="gs">* Reference: http://packetstormsecurity.com/files/116123/</span>
<span class="gs">| *</span> Reference: http://osvdb.org/86399
| <span class="gs">* Reference: http://www.exploit-db.com/exploits/22396/</span>
<span class="gs">|</span>
<span class="gs">| *</span> Title: BBPress - forum.php page Parameter SQL Injection
| <span class="gs">* Reference: http://xforce.iss.net/xforce/xfdb/78244</span>
<span class="gs">| *</span> Reference: http://packetstormsecurity.com/files/116123/
| <span class="gs">* Reference: http://osvdb.org/86400</span>
<span class="gs">| *</span> Reference: http://www.exploit-db.com/exploits/22396/

| Name: contact
| Location: http://********.com/wp-content/plugins/contact/
</code></pre></div>

<h4>列举主题</h4>
<p>列举主题和列举插件差不多，只要用"--enumerate t"就可以了。</p>
<div class="highlight"><pre><span></span><code><span class="n">ruby</span><span class="w"> </span><span class="n">wpscan</span><span class="o">.</span><span class="n">rb</span><span class="w"> </span><span class="o">--</span><span class="n">url</span><span class="w"> </span><span class="n">http</span><span class="p">(</span><span class="n">s</span><span class="p">):</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">host</span><span class="o">-</span><span class="n">name</span><span class="o">.</span><span class="n">com</span><span class="w"> </span><span class="o">--</span><span class="n">enumerate</span><span class="w"> </span><span class="n">t</span>
</code></pre></div>

<p>或者只列出易受攻击的主题：</p>
<div class="highlight"><pre><span></span><code><span class="n">ruby</span><span class="w"> </span><span class="n">wpscan</span><span class="o">.</span><span class="n">rb</span><span class="w"> </span><span class="o">--</span><span class="n">url</span><span class="w"> </span><span class="n">http</span><span class="p">(</span><span class="n">s</span><span class="p">):</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">host</span><span class="o">-</span><span class="n">name</span><span class="o">.</span><span class="n">com</span><span class="w"> </span><span class="o">--</span><span class="n">enumerate</span><span class="w"> </span><span class="n">vt</span>
</code></pre></div>

<p>例子的输出：</p>
<div class="highlight"><pre><span></span><code>| Name: path
| Location: http://********.com/wp-content/themes/path/
| Style URL: http://********.com/wp-content/themes/path/style.css
| Description: 

| Name: pub
| Location: http://********.com/wp-content/themes/pub/
| Style URL: http://********.com/wp-content/themes/pub/style.css
| Description: 

| Name: rockstar
| Location: http://********.com/wp-content/themes/rockstar/
| Style URL: http://********.com/wp-content/themes/rockstar/style.css
| Description: 
|
| <span class="gs">* Title: WooThemes WooFramework Remote Unauthenticated Shortcode Execution</span>
<span class="gs">| *</span> Reference: https://gist.github.com/2523147

| Name: twentyten
| Location: http://********.com/wp-content/themes/twentyten/
| Style URL: http://********.com/wp-content/themes/twentyten/style.css
| Description: 
</code></pre></div>

<h4>列举用户</h4>
<p>WPscan 也可以用来列举某个 WordPress 站点的用户和有效的登录记录。攻击者常常这么做——为了获得一个用户清单，好进行暴力破解。</p>
<div class="highlight"><pre><span></span><code><span class="n">ruby</span><span class="w"> </span><span class="n">wpscan</span><span class="o">.</span><span class="n">rb</span><span class="w"> </span><span class="o">--</span><span class="n">url</span><span class="w"> </span><span class="n">http</span><span class="p">(</span><span class="n">s</span><span class="p">):</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">host</span><span class="o">-</span><span class="n">name</span><span class="o">.</span><span class="n">com</span><span class="w"> </span><span class="o">--</span><span class="n">enumerate</span><span class="w"> </span><span class="n">u</span>
</code></pre></div>

<h4>列举 Timthumb 文件</h4>
<p>关于 WPscan ，我要说的最后一个功能是列举 timthub （缩略图）相关的文件。近年来，timthumb 已经成为攻击者眼里的一个常见目标，因为无数的漏洞被找出来并发到论坛上、邮件列表等等地方。用下面的命令可以通过 wpscan 找出易受攻击的 timthub 文件：</p>
<div class="highlight"><pre><span></span><code><span class="n">ruby</span><span class="w"> </span><span class="n">wpscan</span><span class="o">.</span><span class="n">rb</span><span class="w"> </span><span class="o">--</span><span class="n">url</span><span class="w"> </span><span class="n">http</span><span class="p">(</span><span class="n">s</span><span class="p">):</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">host</span><span class="o">-</span><span class="n">name</span><span class="o">.</span><span class="n">com</span><span class="w"> </span><span class="o">--</span><span class="n">enumerate</span><span class="w"> </span><span class="n">tt</span>
</code></pre></div>

<h3>用 Nmap 扫描你 VPS 的开放端口</h3>
<p><strong>Nmap</strong> 是一个开源的用于网络探索和安全审查方面的工具。它可以迅速扫描巨大的网络，也可一单机使用。Nmap 用原始 IP 数据包通过不同寻常的方法判断网络里那些主机是正在工作的，那些主机上都提供了什么服务（应用名称和版本），是什么操作系统（以及版本），用的什么类型的防火墙，以及很多其他特征。</p>
<h4>在 Debian 和 Ubuntu 上下载和安装 nmap</h4>
<p>要在基于 Debian 和 Ubuntu 的操作系统上安装 nmap ，运行下面的命令：</p>
<div class="highlight"><pre><span></span><code>sudo apt-get install nmap
</code></pre></div>

<p><strong>输出样例</strong></p>
<div class="highlight"><pre><span></span><code><span class="nx">Reading</span><span class="w"> </span><span class="kn">package</span><span class="w"> </span><span class="nx">lists</span><span class="o">...</span><span class="w"> </span><span class="nx">Done</span>
<span class="nx">Building</span><span class="w"> </span><span class="nx">dependency</span><span class="w"> </span><span class="nx">tree</span>
<span class="nx">Reading</span><span class="w"> </span><span class="nx">state</span><span class="w"> </span><span class="nx">information</span><span class="o">...</span><span class="w"> </span><span class="nx">Done</span>
<span class="nx">The</span><span class="w"> </span><span class="nx">following</span><span class="w"> </span><span class="nx">NEW</span><span class="w"> </span><span class="nx">packages</span><span class="w"> </span><span class="nx">will</span><span class="w"> </span><span class="nx">be</span><span class="w"> </span><span class="nx">installed</span><span class="p">:</span>
<span class="w">  </span><span class="nx">nmap</span>
<span class="mi">0</span><span class="w"> </span><span class="nx">upgraded</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="nx">newly</span><span class="w"> </span><span class="nx">installed</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">remove</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="nx">upgraded</span><span class="p">.</span>
<span class="nx">Need</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">get</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">643</span><span class="w"> </span><span class="nx">kB</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">archives</span><span class="p">.</span>
<span class="nx">After</span><span class="w"> </span><span class="nx">this</span><span class="w"> </span><span class="nx">operation</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="mi">913</span><span class="w"> </span><span class="nx">kB</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">additional</span><span class="w"> </span><span class="nx">disk</span><span class="w"> </span><span class="nx">space</span><span class="w"> </span><span class="nx">will</span><span class="w"> </span><span class="nx">be</span><span class="w"> </span><span class="nx">used</span><span class="p">.</span>
<span class="nx">Get</span><span class="p">:</span><span class="mi">1</span><span class="w"> </span><span class="nx">http</span><span class="p">:</span><span class="c1">//mirrors.service.networklayer.com/ubuntu/ precise/main nmap amd64 5.21-1.1ubuntu1 [1,643 kB]</span>
<span class="nx">Fetched</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">643</span><span class="w"> </span><span class="nx">kB</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">0</span><span class="nx">s</span><span class="w"> </span><span class="p">(</span><span class="m m-Double">16.4</span><span class="w"> </span><span class="nx">MB</span><span class="o">/</span><span class="nx">s</span><span class="p">)</span>
<span class="nx">Selecting</span><span class="w"> </span><span class="nx">previously</span><span class="w"> </span><span class="nx">unselected</span><span class="w"> </span><span class="kn">package</span><span class="w"> </span><span class="nx">nmap</span><span class="p">.</span>
<span class="p">(</span><span class="nx">Reading</span><span class="w"> </span><span class="nx">database</span><span class="w"> </span><span class="o">...</span><span class="w"> </span><span class="mi">56834</span><span class="w"> </span><span class="nx">files</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="nx">directories</span><span class="w"> </span><span class="nx">currently</span><span class="w"> </span><span class="nx">installed</span><span class="p">.)</span>
<span class="nx">Unpacking</span><span class="w"> </span><span class="nx">nmap</span><span class="w"> </span><span class="p">(</span><span class="nx">from</span><span class="w"> </span><span class="o">.../</span><span class="nx">nmap_5</span><span class="m m-Double">.21</span><span class="o">-</span><span class="m m-Double">1.1</span><span class="nx">ubuntu1_amd64</span><span class="p">.</span><span class="nx">deb</span><span class="p">)</span><span class="w"> </span><span class="o">...</span>
<span class="nx">Processing</span><span class="w"> </span><span class="nx">triggers</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">man</span><span class="o">-</span><span class="nx">db</span><span class="w"> </span><span class="o">...</span>
<span class="nx">Setting</span><span class="w"> </span><span class="nx">up</span><span class="w"> </span><span class="nx">nmap</span><span class="w"> </span><span class="p">(</span><span class="m m-Double">5.21</span><span class="o">-</span><span class="m m-Double">1.1</span><span class="nx">ubuntu1</span><span class="p">)</span><span class="w"> </span><span class="o">...</span>
</code></pre></div>

<h4>举个例子</h4>
<p>输出 nmap 的版本：</p>
<div class="highlight"><pre><span></span><code>nmap -V
</code></pre></div>

<p>或者</p>
<div class="highlight"><pre><span></span><code>nmap --version
</code></pre></div>

<p><strong>输出样例</strong></p>
<div class="highlight"><pre><span></span><code>Nmap version 5.21 ( http://nmap.org )
</code></pre></div>

<h4>在 Centos 上下载和安装 nmap</h4>
<p>要在基于 RHEL 的 Linux 上面安装 nmap ，输入下面的命令：</p>
<div class="highlight"><pre><span></span><code>yum install nmap
</code></pre></div>

<p><strong>输出样例</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">Loaded</span><span class="w"> </span><span class="n">plugins</span><span class="p">:</span><span class="w"> </span><span class="n">protectbase</span><span class="p">,</span><span class="w"> </span><span class="n">rhnplugin</span><span class="p">,</span><span class="w"> </span><span class="n">security</span>
<span class="mi">0</span><span class="w"> </span><span class="n">packages</span><span class="w"> </span><span class="n">excluded</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">repository</span><span class="w"> </span><span class="n">protections</span>
<span class="n">Setting</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">Install</span><span class="w"> </span><span class="n">Process</span>
<span class="n">Resolving</span><span class="w"> </span><span class="n">Dependencies</span>
<span class="o">--&gt;</span><span class="w"> </span><span class="n">Running</span><span class="w"> </span><span class="n">transaction</span><span class="w"> </span><span class="n">check</span>
<span class="o">---&gt;</span><span class="w"> </span><span class="n">Package</span><span class="w"> </span><span class="n">nmap</span><span class="o">.</span><span class="n">x86_64</span><span class="w"> </span><span class="mi">2</span><span class="p">:</span><span class="mf">5.51</span><span class="o">-</span><span class="mf">2.</span><span class="n">el6</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">installed</span>
<span class="o">--&gt;</span><span class="w"> </span><span class="n">Finished</span><span class="w"> </span><span class="n">Dependency</span><span class="w"> </span><span class="n">Resolution</span>

<span class="n">Dependencies</span><span class="w"> </span><span class="n">Resolved</span>

<span class="o">================================================================================</span>
<span class="w"> </span><span class="n">Package</span><span class="w">    </span><span class="n">Arch</span><span class="w">         </span><span class="n">Version</span><span class="w">               </span><span class="n">Repository</span><span class="w">                  </span><span class="n">Size</span>
<span class="o">================================================================================</span>
<span class="n">Installing</span><span class="p">:</span>
<span class="w"> </span><span class="n">nmap</span><span class="w">       </span><span class="n">x86_64</span><span class="w">       </span><span class="mi">2</span><span class="p">:</span><span class="mf">5.51</span><span class="o">-</span><span class="mf">2.</span><span class="n">el6</span><span class="w">          </span><span class="n">rhel</span><span class="o">-</span><span class="n">x86_64</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="mi">6</span><span class="w">       </span><span class="mf">2.8</span><span class="w"> </span><span class="n">M</span>

<span class="n">Transaction</span><span class="w"> </span><span class="n">Summary</span>
<span class="o">================================================================================</span>
<span class="n">Install</span><span class="w">       </span><span class="mi">1</span><span class="w"> </span><span class="n">Package</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

<span class="n">Total</span><span class="w"> </span><span class="n">download</span><span class="w"> </span><span class="n">size</span><span class="p">:</span><span class="w"> </span><span class="mf">2.8</span><span class="w"> </span><span class="n">M</span>
<span class="n">Installed</span><span class="w"> </span><span class="n">size</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span>
<span class="n">Is</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">ok</span><span class="w"> </span><span class="p">[</span><span class="n">y</span><span class="o">/</span><span class="n">N</span><span class="p">]:</span><span class="w"> </span><span class="n">y</span>
<span class="n">Downloading</span><span class="w"> </span><span class="n">Packages</span><span class="p">:</span>
<span class="n">nmap</span><span class="o">-</span><span class="mf">5.51</span><span class="o">-</span><span class="mf">2.</span><span class="n">el6</span><span class="o">.</span><span class="n">x86_64</span><span class="o">.</span><span class="n">rpm</span><span class="w">                               </span><span class="o">|</span><span class="w"> </span><span class="mf">2.8</span><span class="w"> </span><span class="n">MB</span><span class="w">     </span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>
<span class="n">Running</span><span class="w"> </span><span class="n">rpm_check_debug</span>
<span class="n">Running</span><span class="w"> </span><span class="n">Transaction</span><span class="w"> </span><span class="n">Test</span>
<span class="n">Transaction</span><span class="w"> </span><span class="n">Test</span><span class="w"> </span><span class="n">Succeeded</span>
<span class="n">Running</span><span class="w"> </span><span class="n">Transaction</span>
<span class="w">  </span><span class="n">Installing</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">:</span><span class="n">nmap</span><span class="o">-</span><span class="mf">5.51</span><span class="o">-</span><span class="mf">2.</span><span class="n">el6</span><span class="o">.</span><span class="n">x86_64</span><span class="w">                                     </span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span>
<span class="w">  </span><span class="n">Verifying</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">:</span><span class="n">nmap</span><span class="o">-</span><span class="mf">5.51</span><span class="o">-</span><span class="mf">2.</span><span class="n">el6</span><span class="o">.</span><span class="n">x86_64</span><span class="w">                                     </span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span>

<span class="n">Installed</span><span class="p">:</span>
<span class="w">  </span><span class="n">nmap</span><span class="o">.</span><span class="n">x86_64</span><span class="w"> </span><span class="mi">2</span><span class="p">:</span><span class="mf">5.51</span><span class="o">-</span><span class="mf">2.</span><span class="n">el6</span>

<span class="n">Complete</span><span class="o">!</span>
</code></pre></div>

<h4>举个例子</h4>
<p>输出 nmap 版本号：</p>
<div class="highlight"><pre><span></span><code>nmap --version
</code></pre></div>

<p><strong>输出样例</strong></p>
<div class="highlight"><pre><span></span><code>Nmap version 5.51 ( http://nmap.org )
</code></pre></div>

<h4>用 Nmap 扫描端口</h4>
<p>你可以用 nmap 来获得很多关于你的服务器的信息，它可以让你站在对你的网站不怀好意的人的角度看你自己的网站。</p>
<p>因此，请仅用它测试你自己的服务器或者在行动之前通知服务器的所有者。</p>
<p>nmap 的作者提供了一个测试服务器：</p>
<div class="highlight"><pre><span></span><code>scanme.nmap.org
</code></pre></div>

<p>有些命令可能会耗时较长：</p>
<p>要扫描一个 IP 地址或者一个主机名（全称域名），运行：</p>
<div class="highlight"><pre><span></span><code>nmap 192.168.1.1
</code></pre></div>

<p>输出样例：</p>
<p><img alt="Fig.01: nmap in action" src="/data/attachment/album/201504/26/105917vkqytsyphljnfssf.png"></p>
<p>扫描以获得主机的操作系统：</p>
<div class="highlight"><pre><span></span><code>sudo nmap -O 192.168.1.1
</code></pre></div>

<p>加上“-”或者“/24”来一次性扫描某个范围里面的多个主机：</p>
<div class="highlight"><pre><span></span><code>sudo nmap -PN xxx.xxx.xxx.xxx-yyy
</code></pre></div>

<p>扫描某个范围内可用的服务：</p>
<div class="highlight"><pre><span></span><code><span class="nx">sudo</span><span class="w"> </span><span class="nx">nmap</span><span class="w"> </span><span class="o">-</span><span class="nx">sP</span><span class="w"> </span><span class="nx">network_address_range</span>
</code></pre></div>

<p>扫描 IP 地址时部进行反向 DNS 解析。多数情况下这会加快你获得结果的速度：</p>
<div class="highlight"><pre><span></span><code>sudo nmap -n remote_host
</code></pre></div>

<p>扫描一个特定端口而不是所有常用端口：</p>
<div class="highlight"><pre><span></span><code>sudo nmap -p port_number remote_host
</code></pre></div>

<p>扫描一个网络，找出哪些服务器在线，分别运行了什么服务。</p>
<p>这就是传说中的主机探索或者 ping 扫描：</p>
<div class="highlight"><pre><span></span><code>nmap -sP 192.168.1.0/24
</code></pre></div>

<p>输出样例：</p>
<div class="highlight"><pre><span></span><code><span class="nx">Host</span><span class="w"> </span><span class="m m-Double">192.168.1.1</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">up</span><span class="w"> </span><span class="p">(</span><span class="m m-Double">0.00035</span><span class="nx">s</span><span class="w"> </span><span class="nx">latency</span><span class="p">).</span>
<span class="nx">MAC</span><span class="w"> </span><span class="nx">Address</span><span class="p">:</span><span class="w"> </span><span class="nx">BC</span><span class="p">:</span><span class="nx">AE</span><span class="p">:</span><span class="nx">C5</span><span class="p">:</span><span class="nx">C3</span><span class="p">:</span><span class="mi">16</span><span class="p">:</span><span class="mi">93</span><span class="w"> </span><span class="p">(</span><span class="nx">Unknown</span><span class="p">)</span>
<span class="nx">Host</span><span class="w"> </span><span class="m m-Double">192.168.1.2</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">up</span><span class="w"> </span><span class="p">(</span><span class="m m-Double">0.0038</span><span class="nx">s</span><span class="w"> </span><span class="nx">latency</span><span class="p">).</span>
<span class="nx">MAC</span><span class="w"> </span><span class="nx">Address</span><span class="p">:</span><span class="w"> </span><span class="mi">74</span><span class="p">:</span><span class="mi">44</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mi">57</span><span class="p">:</span><span class="nx">FB</span><span class="w"> </span><span class="p">(</span><span class="nx">Unknown</span><span class="p">)</span>
<span class="nx">Host</span><span class="w"> </span><span class="m m-Double">192.168.1.5</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">up</span><span class="p">.</span>
<span class="nx">Host</span><span class="w"> </span><span class="nx">nas03</span><span class="w"> </span><span class="p">(</span><span class="m m-Double">192.168.1.12</span><span class="p">)</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">up</span><span class="w"> </span><span class="p">(</span><span class="m m-Double">0.0091</span><span class="nx">s</span><span class="w"> </span><span class="nx">latency</span><span class="p">).</span>
<span class="nx">MAC</span><span class="w"> </span><span class="nx">Address</span><span class="p">:</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="nx">FC</span><span class="w"> </span><span class="p">(</span><span class="nx">Synology</span><span class="w"> </span><span class="nx">Incorporated</span><span class="p">)</span>
<span class="nx">Nmap</span><span class="w"> </span><span class="nx">done</span><span class="p">:</span><span class="w"> </span><span class="mi">256</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="nx">addresses</span><span class="w"> </span><span class="p">(</span><span class="mi">4</span><span class="w"> </span><span class="nx">hosts</span><span class="w"> </span><span class="nx">up</span><span class="p">)</span><span class="w"> </span><span class="nx">scanned</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m m-Double">2.80</span><span class="w"> </span><span class="nx">second</span>
</code></pre></div>

<p>理解端口配置和如何发现你的服务器上的攻击目标只是确保你的信息和你的 VPS 安全的第一步。</p>
<h3>用 Nikto 扫描你网站的缺陷</h3>
<p><a href="http://www.unixmen.com/install-nikto-web-scanner-check-vulnerabilities">Nikto</a> 网络扫描器是一个开源的 web 服务器的扫描软件，它可以用来扫描 web 服务器上的恶意的程序和文件。Nikto 也可以用来检查软件版本是否过期。Nikto 能进行简单而快速地扫描以发现服务器上危险的文件和程序。扫描结束后会给出一个日志文件。`</p>
<h4>在 Linux 服务器上下载和安装 Nikto</h4>
<p>Perl 在 Linux 上是预先安装好的，所以你只需要从<a href="https://cirt.net/nikto/">项目页面</a>下载 nikto ，解压到一个目录里面，然后开始测试。</p>
<div class="highlight"><pre><span></span><code>wget https://cirt.net/nikto/nikto-2.1.4.tar.gz
</code></pre></div>

<p>你可以用某个归档管理工具解包，或者如下同时使用 tar 和 gzip ：</p>
<div class="highlight"><pre><span></span><code>tar zxvf nikto-2.1.4.tar.gz
cd nikto-2.1.4
perl nikto.pl
</code></pre></div>

<p>安装正确的话会得到这样的结果：</p>
<div class="highlight"><pre><span></span><code> <span class="k">-</span> ***** SSL support not available (see docs for SSL install) *****
<span class="k">-</span> Nikto v2.1.4
---------------------------------------------------------------------------
+ ERROR: No host specified

       -config+            Use this config file
       -Cgidirs+           scan these CGI dirs: &#39;none&#39;, &#39;all&#39;, or values like &quot;/cgi/ /cgi-a/&quot;
       -dbcheck            check database and other key files for syntax errors
       -Display+           Turn on/off display outputs
       -evasion+           ids evasion technique
       -Format+            save file (-o) format
       -host+              target host
       -Help               Extended help information
       -id+                Host authentication to use, format is id:pass or id:pass:realm
       -list-plugins       List all available plugins
       -mutate+            Guess additional file names
       -mutate-options+    Provide extra information for mutations
       -output+            Write output to this file
       -nocache            Disables the URI cache
       -nossl              Disables using SSL
       -no404              Disables 404 checks
       -port+              Port to use (default 80)
       -Plugins+           List of plugins to run (default: ALL)
       -root+              Prepend root value to all requests, format is /directory
       -ssl                Force ssl mode on port
       -Single             Single request mode
       -timeout+           Timeout (default 2 seconds)
       -Tuning+            Scan tuning
       -update             Update databases and plugins from CIRT.net
       -vhost+             Virtual host (for Host header)
       -Version            Print plugin and database versions
           + requires a value

    Note: This is the short help output. Use -H for full help.
</code></pre></div>

<p>这个报错只是告诉我们没有给出必要的参数。SSL 支持可以通过安装相关的 perl ssl 模块得到（sudo apt-get install libnet-ssleay-perl）。</p>
<h4>更新 nikto 数据库</h4>
<p>在开始使用之前我们需要先更新 nikto 数据库：</p>
<div class="highlight"><pre><span></span><code>/usr/local/bin/nikto.pl -update
</code></pre></div>

<p>下面的命令可以列出可用的 nikto 插件。</p>
<div class="highlight"><pre><span></span><code>nikto.pl -list-plugins // To list the installed plugins //
</code></pre></div>

<h4>扫描以寻找缺陷</h4>
<p>我们用一个 url 来在做个简单的测试。</p>
<div class="highlight"><pre><span></span><code>perl nikto.pl -h http://www.host-name.com
</code></pre></div>

<p><strong>输出样例</strong></p>
<p>会有十分冗长的输出，可能一开始会让人感到困惑。许多 Nikto 的警报会返回 OSVDB 序号。这是由开源缺陷数据库（<a href="http://osvdb.org/">http://osvdb.org/</a>）所指定。你可以在 OSVDB 上找出相关缺陷的深入说明。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>nikto<span class="w"> </span>-h<span class="w"> </span>http://www.host-name.com
-<span class="w"> </span>Nikto<span class="w"> </span>v2.1.4
---------------------------------------------------------------------------
+<span class="w"> </span>Target<span class="w"> </span>IP:<span class="w">         </span><span class="m">1</span>.2.3.4
+<span class="w"> </span>Target<span class="w"> </span>Hostname:<span class="w">    </span>host-name.com
+<span class="w"> </span>Target<span class="w"> </span>Port:<span class="w">        </span><span class="m">80</span>
+<span class="w"> </span>Start<span class="w"> </span>Time:<span class="w">         </span><span class="m">2012</span>-08-11<span class="w"> </span><span class="m">14</span>:27:31
---------------------------------------------------------------------------
+<span class="w"> </span>Server:<span class="w"> </span>Apache/2.2.22<span class="w"> </span><span class="o">(</span>FreeBSD<span class="o">)</span><span class="w"> </span>mod_ssl/2.2.22<span class="w"> </span>OpenSSL/1.0.1c<span class="w"> </span>DAV/2
+<span class="w"> </span>robots.txt<span class="w"> </span>contains<span class="w"> </span><span class="m">4</span><span class="w"> </span>entries<span class="w"> </span>which<span class="w"> </span>should<span class="w"> </span>be<span class="w"> </span>manually<span class="w"> </span>viewed.
+<span class="w"> </span>mod_ssl/2.2.22<span class="w"> </span>appears<span class="w"> </span>to<span class="w"> </span>be<span class="w"> </span>outdated<span class="w"> </span><span class="o">(</span>current<span class="w"> </span>is<span class="w"> </span>at<span class="w"> </span>least<span class="w"> </span><span class="m">2</span>.8.31<span class="o">)</span><span class="w"> </span><span class="o">(</span>may<span class="w"> </span>depend<span class="w"> </span>on<span class="w"> </span>server<span class="w"> </span>version<span class="o">)</span>
+<span class="w"> </span>ETag<span class="w"> </span>header<span class="w"> </span>found<span class="w"> </span>on<span class="w"> </span>server,<span class="w"> </span>inode:<span class="w"> </span><span class="m">5918348</span>,<span class="w"> </span>size:<span class="w"> </span><span class="m">121</span>,<span class="w"> </span>mtime:<span class="w"> </span>0x48fc943691040
+<span class="w"> </span>mod_ssl/2.2.22<span class="w"> </span>OpenSSL/1.0.1c<span class="w"> </span>DAV/2<span class="w"> </span>-<span class="w"> </span>mod_ssl<span class="w"> </span><span class="m">2</span>.8.7<span class="w"> </span>and<span class="w"> </span>lower<span class="w"> </span>are<span class="w"> </span>vulnerable<span class="w"> </span>to<span class="w"> </span>a<span class="w"> </span>remote<span class="w"> </span>buffer<span class="w"> </span>overflow<span class="w"> </span>which<span class="w"> </span>may<span class="w"> </span>allow<span class="w"> </span>a<span class="w"> </span>remote<span class="w"> </span>shell<span class="w"> </span><span class="o">(</span>difficult<span class="w"> </span>to<span class="w"> </span>exploit<span class="o">)</span>.<span class="w"> </span>CVE-2002-0082,<span class="w"> </span>OSVDB-756.
+<span class="w"> </span>Allowed<span class="w"> </span>HTTP<span class="w"> </span>Methods:<span class="w"> </span>GET,<span class="w"> </span>HEAD,<span class="w"> </span>POST,<span class="w"> </span>OPTIONS,<span class="w"> </span>TRACE<span class="w"> </span>
+<span class="w"> </span>OSVDB-877:<span class="w"> </span>HTTP<span class="w"> </span>TRACE<span class="w"> </span>method<span class="w"> </span>is<span class="w"> </span>active,<span class="w"> </span>suggesting<span class="w"> </span>the<span class="w"> </span>host<span class="w"> </span>is<span class="w"> </span>vulnerable<span class="w"> </span>to<span class="w"> </span>XST
+<span class="w"> </span>/lists/admin/:<span class="w"> </span>PHPList<span class="w"> </span>pre<span class="w"> </span><span class="m">2</span>.6.4<span class="w"> </span>contains<span class="w"> </span>a<span class="w"> </span>number<span class="w"> </span>of<span class="w"> </span>vulnerabilities<span class="w"> </span>including<span class="w"> </span>remote<span class="w"> </span>administrative<span class="w"> </span>access,<span class="w"> </span>harvesting<span class="w"> </span>user<span class="w"> </span>info<span class="w"> </span>and<span class="w"> </span>more.<span class="w"> </span>Default<span class="w"> </span>login<span class="w"> </span>to<span class="w"> </span>admin<span class="w"> </span>interface<span class="w"> </span>is<span class="w"> </span>admin/phplist
+<span class="w"> </span>OSVDB-2322:<span class="w"> </span>/gallery/search.php?searchstring<span class="o">=</span>&lt;script&gt;alert<span class="o">(</span>document.cookie<span class="o">)</span>&lt;/script&gt;:<span class="w"> </span>Gallery<span class="w"> </span><span class="m">1</span>.3.4<span class="w"> </span>and<span class="w"> </span>below<span class="w"> </span>is<span class="w"> </span>vulnerable<span class="w"> </span>to<span class="w"> </span>Cross<span class="w"> </span>Site<span class="w"> </span>Scripting<span class="w"> </span><span class="o">(</span>XSS<span class="o">)</span>.<span class="w"> </span>Upgrade<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>latest<span class="w"> </span>version.<span class="w"> </span>http://www.securityfocus.com/bid/8288.
+<span class="w"> </span>OSVDB-7022:<span class="w"> </span>/calendar.php?year<span class="o">=</span>&lt;script&gt;alert<span class="o">(</span>document.cookie<span class="o">)</span><span class="p">;</span>&lt;/script&gt;<span class="p">&amp;</span><span class="nv">month</span><span class="o">=</span><span class="m">03</span><span class="p">&amp;</span><span class="nv">day</span><span class="o">=</span><span class="m">05</span>:<span class="w"> </span>DCP-Portal<span class="w"> </span>v5.3.1<span class="w"> </span>is<span class="w"> </span>vulnerable<span class="w"> </span>to<span class="w">  </span>Cross<span class="w"> </span>Site<span class="w"> </span>Scripting<span class="w"> </span><span class="o">(</span>XSS<span class="o">)</span>.<span class="w"> </span>http://www.cert.org/advisories/CA-2000-02.html.
+<span class="w"> </span>OSVDB-3233:<span class="w"> </span>/phpinfo.php:<span class="w"> </span>Contains<span class="w"> </span>PHP<span class="w"> </span>configuration<span class="w"> </span>information
+<span class="w"> </span>OSVDB-3092:<span class="w"> </span>/system/:<span class="w"> </span>This<span class="w"> </span>might<span class="w"> </span>be<span class="w"> </span>interesting...
+<span class="w"> </span>OSVDB-3092:<span class="w"> </span>/template/:<span class="w"> </span>This<span class="w"> </span>may<span class="w"> </span>be<span class="w"> </span>interesting<span class="w"> </span>as<span class="w"> </span>the<span class="w"> </span>directory<span class="w"> </span>may<span class="w"> </span>hold<span class="w"> </span>sensitive<span class="w"> </span>files<span class="w"> </span>or<span class="w"> </span>reveal<span class="w"> </span>system<span class="w"> </span>information.
+<span class="w"> </span>OSVDB-3092:<span class="w"> </span>/updates/:<span class="w"> </span>This<span class="w"> </span>might<span class="w"> </span>be<span class="w"> </span>interesting...
+<span class="w"> </span>OSVDB-3092:<span class="w"> </span>/README:<span class="w"> </span>README<span class="w"> </span>file<span class="w"> </span>found.
+<span class="w"> </span><span class="m">6448</span><span class="w"> </span>items<span class="w"> </span>checked:<span class="w"> </span><span class="m">1</span><span class="w"> </span>error<span class="o">(</span>s<span class="o">)</span><span class="w"> </span>and<span class="w"> </span><span class="m">14</span><span class="w"> </span>item<span class="o">(</span>s<span class="o">)</span><span class="w"> </span>reported<span class="w"> </span>on<span class="w"> </span>remote<span class="w"> </span>host
+<span class="w"> </span>End<span class="w"> </span>Time:<span class="w">           </span><span class="m">2012</span>-08-11<span class="w"> </span><span class="m">15</span>:52:57<span class="w"> </span><span class="o">(</span><span class="m">5126</span><span class="w"> </span>seconds<span class="o">)</span>
---------------------------------------------------------------------------
+<span class="w"> </span><span class="m">1</span><span class="w"> </span>host<span class="o">(</span>s<span class="o">)</span><span class="w"> </span>tested
$
</code></pre></div>

<p><strong>Nikto</strong> 是一个非常轻量级的通用工具。因为 Nikto 是用 Perl 写的，所以它可以在几乎任何服务器的操作系统上运行。</p>
<p>希望这篇文章能在你检查 wordpress 站点的缺陷的时候给你一些提示。我之前的文章<a href="http://www.unixmen.com/secure-wordpress-website/">如何安全加固 WordPress 站点</a>记录了一个<strong>清单</strong>，可以让你保护你的 WordPress 站点的工作变得更简单。</p>
<p>有想说的，留下你的评论。</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>