<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>在linux中创建和解压文档的11个 tar 命令例子</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: Silver Moon linux中的tar命令 tar（磁带归档）命令是linux系统中被经常用来将文件存入到一个归档文件中的命令。 其常见的文件扩展包括：.tar.gz 和 .tar.bz2, 分别表示通过了gzip或bzip算法进一步进行了压缩。 在本教程中我们会管中窥豹一下 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li class="active"><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2015/04/zai-linuxzhong-chuang-jian-he-jie-ya-wen-dang-de-11ge-tar-ming-ling-li-zi.html" rel="bookmark"
           title="Permalink to 在linux中创建和解压文档的11个 tar 命令例子">在linux中创建和解压文档的11个 tar 命令例子</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2015-04-01T09:23:00+02:00">
                Published: Wed 01 April 2015
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/ji-zhu">技术</a>.</p>

</footer><!-- /.post-info -->      <p>Author: Silver Moon</p>
<h3>linux中的tar命令</h3>
<p>tar（磁带归档）命令是linux系统中被经常用来将文件存入到一个归档文件中的命令。</p>
<p>其常见的文件扩展包括：.tar.gz 和 .tar.bz2, 分别表示通过了gzip或bzip算法进一步进行了压缩。</p>
<p>在本教程中我们会管中窥豹一下在linux桌面或服务器版本中使用tar命令来处理一些创建和解压归档文件的日常工作的例子。</p>
<p><img alt="" src="/data/attachment/album/201504/01/002720igszsupsvy7pj9vg.png"></p>
<h3>使用tar命令</h3>
<p>tar命令在大部分linux系统默认情况下都是可用的，所以你不用单独安装该软件。</p>
<blockquote>
<p>tar命令具有两个压缩格式，gzip和bzip，该命令的“z”选项用来指定gzip，“j”选项用来指定bzip。同时也可以创建非压缩归档文件。</p>
</blockquote>
<h4>1.解压一个tar.gz归档</h4>
<p>一般常见的用法是用来解压归档文件，下面的命令将会把文件从一个tar.gz归档文件中解压出来。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>tar<span class="w"> </span>-xvzf<span class="w"> </span>tarfile.tar.gz
</code></pre></div>

<p>这里对这些参数做一个简单解释-</p>
<blockquote>
<p>x - 解压文件</p>
<p>v - 冗长模式，在解压每个文件时打印出文件的名称。</p>
<p>z - 该文件是一个使用 gzip 压缩的文件。</p>
<p>f - 使用接下来的tar归档来进行操作。</p>
</blockquote>
<p>这些就是一些需要记住的重要选项。</p>
<p><strong>解压 tar.bz2/bzip 归档文件</strong></p>
<p>具有bz2扩展名的文件是使用bzip算法进行压缩的，但是tar命令也可以对其进行处理，但是需要通过使用“j”选项来替换“z”选项。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>tar<span class="w"> </span>-xvjf<span class="w"> </span>archivefile.tar.bz2
</code></pre></div>

<h4>2.将文件解压到一个指定的目录或路径</h4>
<p>为了将文件解压到一个指定的目录中，使用“-C”选项来指定路径，此处的“C”是大写“C”。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>tar<span class="w"> </span>-xvzf<span class="w"> </span>abc.tar.gz<span class="w"> </span>-C<span class="w"> </span>/opt/folder/
</code></pre></div>

<p>然后，首先需要确认目标目录是否存在，毕竟tar命令并不会为你创建目录，所以如果目标目录不存在的情况下该命令会失败。</p>
<h4>3. 提取出单个文件</h4>
<p>为了从一个归档文件中提取出单个文件，只需要将文件名按照以下方式将其放置在命令后面。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>tar<span class="w"> </span>-xz<span class="w"> </span>-f<span class="w"> </span>abc.tar.gz<span class="w"> </span><span class="s2">&quot;./new/abc.txt&quot;</span>
</code></pre></div>

<p>在上述命令中，可以按照以下方式来指定多个文件。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>tar<span class="w"> </span>-xz<span class="w"> </span>-f<span class="w"> </span>abc.tar.gz<span class="w"> </span><span class="s2">&quot;./new/cde.txt&quot;</span><span class="w"> </span><span class="s2">&quot;./new/abc.txt&quot;</span>
</code></pre></div>

<h4>4.使用通配符来解压多个文件</h4>
<p>通配符可以用来解压于给定通配符匹配的一批文件，例如所有以".txt"作为扩展名的文件。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>tar<span class="w"> </span>-xz<span class="w"> </span>-f<span class="w"> </span>abc.tar.gz<span class="w"> </span>--wildcards<span class="w"> </span><span class="s2">&quot;*.txt&quot;</span>
</code></pre></div>

<h4>5. 列出并检索tar归档文件中的内容</h4>
<p>如果你仅仅想要列出而不是解压tar归档文件的中的内容，使用“-t”（test）选项， 下面的命令用来打印一个使用gzip压缩过的tar归档文件中的内容。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>tar<span class="w"> </span>-tz<span class="w"> </span>-f<span class="w"> </span>abc.tar.gz
./new/
./new/cde.txt
./new/subdir/
./new/subdir/in.txt
./new/abc.txt
...
</code></pre></div>

<p>可以将输出通过管道定向到grep来搜索一个文件，或者定向到less命令来浏览内容列表。 使用"v"冗长选项将会打印出每个文件的额外详细信息。</p>
<p>对于 tar.bz2/bzip文件，需要使用"j"选项。</p>
<p>结合上述的命令和grep命令来检索归档文件，如下所示。简单吧！</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>tar<span class="w"> </span>-tvz<span class="w"> </span>-f<span class="w"> </span>abc.tar.gz<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>abc.txt
-rw-rw-r--<span class="w"> </span>enlightened/enlightened<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">2015</span>-01-13<span class="w"> </span><span class="m">11</span>:40<span class="w"> </span>./new/abc.txt
</code></pre></div>

<h4>6.创建一个tar/tar.gz归档文件</h4>
<p>现在我们已经学过了如何解压一个tar归档文件，是时候开始创建一个新的tar归档文件了。tar命令可以用来将所选的文件或整个目录放入到一个归档文件中，以下是相应的样例。</p>
<p>下面的命令使用一个目录来创建一个tar归档文件，它会将该目录中所有的文件和子目录都加入到归档文件中。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>tar<span class="w"> </span>-cvf<span class="w"> </span>abc.tar<span class="w"> </span>./new/
./new/
./new/cde.txt
./new/abc.txt
</code></pre></div>

<p>上述命令不会创建一个压缩的的归档文件，只是一个普通的归档文件，只是将多个文件放入到一个归档文件中并没有真正地压缩每个文件。</p>
<p>为了使用压缩，可以分别使用“z”或“j”选项进行gzip或bzip压缩算法。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>tar<span class="w"> </span>-cvzf<span class="w"> </span>abc.tar.gz<span class="w"> </span>./new/
</code></pre></div>

<blockquote>
<p>文件的扩展名其实并不真正有什么影响。“tar.gz” 和“tgz”是gzip压缩算法压缩文件的常见扩展名。 “tar.bz2”和“tbz”是bzip压缩算法压缩文件的常见扩展名（LCTT 译注：归档是否是压缩的和采用哪种压缩方式并不取决于其扩展名，扩展名只是为了便于辨识。）。</p>
</blockquote>
<h4>7. 在添加文件之前进行确认</h4>
<p>一个有用的选项是“w”，该选项使得tar命令在添加每个文件到归档文件之前来让用户进行确认，有时候这会很有用。</p>
<p>使用该选项时，只有用户输入“y”时的文件才会被加入到归档文件中，如果你不输入任何东西，其默认表示是一个“n”。</p>
<div class="highlight"><pre><span></span><code><span class="gh">#</span> 添加指定文件

$ tar -czw -f abc.tar.gz ./new/*
add ‘./new/abc.txt’?y
add ‘./new/cde.txt’?y
add ‘./new/newfile.txt’?n
add ‘./new/subdir’?y
add ‘./new/subdir/in.txt’?n

<span class="gh">#</span>现在列出所有被加入的文件

$ tar -t -f abc.tar.gz 
./new/abc.txt
./new/cde.txt
./new/subdir/
</code></pre></div>

<h4>8. 加入文件到存在的归档文件中</h4>
<p>“r”选项可以被用来将文件加入到已存在的归档文件中，而不用创建一个新的归档文件，下面是一个简单的样例：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>tar<span class="w"> </span>-rv<span class="w"> </span>-f<span class="w"> </span>abc.tar<span class="w"> </span>abc.txt
</code></pre></div>

<blockquote>
<p>文件并不能加入到已压缩的归档文件中（gz 或 bzip）。文件只能被加入到普通的归档文件中。</p>
</blockquote>
<h4>9. 将文件加入到压缩的归档文件中（tar.gz/tar.bz2)</h4>
<p>之前已经提到了不可能将文件加入到已压缩的归档文件中，然而依然可以通过简单的一些把戏来完成。使用gunzip命令来解压缩归档文件，然后将文件加入到归档文件中后重新进行压缩。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>gunzip<span class="w"> </span>archive.tar.gz
$<span class="w"> </span>tar<span class="w"> </span>-rf<span class="w"> </span>archive.tar<span class="w"> </span>./path/to/file
$<span class="w"> </span>gzip<span class="w"> </span>archive.tar
</code></pre></div>

<p>对于bzip文件分别使用bzip2和bunzip2。</p>
<h4>10.通过tar来进行备份</h4>
<p>一个真实的场景是在固定的时间间隔内来备份目录，tar命令可以通过cron调度来实现这样的一个备份，以下是一个样例 ：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>tar<span class="w"> </span>-cvz<span class="w"> </span>-f<span class="w"> </span>archive-<span class="k">$(</span>date<span class="w"> </span>+%Y%m%d<span class="k">)</span>.tar.gz<span class="w"> </span>./new/
</code></pre></div>

<p>使用cron来运行上述的命令会保持创建类似以下名称的备份文件 ：'archive-20150218.tar.gz'。</p>
<p>当然，需要确保日益增长的归档文件不会导致磁盘空间的溢出。</p>
<h4>11. 在创建归档文件时进行验证</h4>
<p>"W"选项可以用来在创建归档文件之后进行验证，以下是一个简单例子。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>tar<span class="w"> </span>-cvW<span class="w"> </span>-f<span class="w"> </span>abc.tar<span class="w"> </span>./new/
./new/
./new/cde.txt
./new/subdir/
./new/subdir/in.txt
./new/newfile.txt
./new/abc.txt
Verify<span class="w"> </span>./new/
Verify<span class="w"> </span>./new/cde.txt
Verify<span class="w"> </span>./new/subdir/
Verify<span class="w"> </span>./new/subdir/in.txt
Verify<span class="w"> </span>./new/newfile.txt<span class="w">                                                                                                                              </span>
Verify<span class="w"> </span>./new/abc.txt
</code></pre></div>

<p>需要注意的是验证动作不能在压缩过的归档文件上进行，只能在非压缩的tar归档文件上执行。</p>
<p>这次就先到此为止，可以通过“man tar”命令来查看tar命令的的手册。</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>