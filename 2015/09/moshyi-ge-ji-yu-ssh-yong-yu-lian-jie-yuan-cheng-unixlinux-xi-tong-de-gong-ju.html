<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>mosh：一个基于 SSH 用于连接远程 Unix/Linux 系统的工具</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: Avishek Kumar Mosh 表示 移动 Shell （ Mobile Shell ） ，是一个用于从客户端跨互联网连接远程服务器的命令行工具。它能用于 SSH 连接，但是比 Secure Shell 功 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li class="active"><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2015/09/moshyi-ge-ji-yu-ssh-yong-yu-lian-jie-yuan-cheng-unixlinux-xi-tong-de-gong-ju.html" rel="bookmark"
           title="Permalink to mosh：一个基于 SSH 用于连接远程 Unix/Linux 系统的工具">mosh：一个基于 SSH 用于连接远程 Unix/Linux 系统的工具</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2015-09-22T07:16:00+02:00">
                Published: Tue 22 September 2015
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/ji-zhu">技术</a>.</p>

</footer><!-- /.post-info -->      <p>Author: Avishek Kumar</p>
<p>Mosh 表示<ruby> 移动 Shell <rp>  （ </rp> <rt>  Mobile Shell </rt> <rp>  ） </rp></ruby>，是一个用于从客户端跨互联网连接远程服务器的命令行工具。它能用于 SSH 连接，但是比 Secure Shell 功能更多。它是一个类似于 SSH 而带有更多功能的应用。程序最初由 Keith Winstein 编写，用于类 Unix 的操作系统中，发布于GNU GPL v3协议下。</p>
<p><img alt="Mosh Shell SSH Client" src="/data/attachment/album/201509/21/221904yj1hcj1ccipoyjpw.png"></p>
<p><em>Mosh Shell SSH 客户端</em></p>
<h4>Mosh的功能</h4>
<ul>
<li>它是一个支持漫游的远程终端程序。</li>
<li>在所有主流的类 Unix 版本中可用，如 Linux、FreeBSD、Solaris、Mac OS X 和 Android。</li>
<li>支持不稳定连接</li>
<li>支持智能的本地回显</li>
<li>支持用户输入的行编辑</li>
<li>响应式设计及在 wifi、3G、长距离连接下的鲁棒性</li>
<li>在 IP 改变后保持连接。它使用 UDP 代替 TCP（在 SSH 中使用），当连接被重置或者获得新的 IP 后 TCP 会超时，但是 UDP 仍然保持连接。</li>
<li>在很长的时候之后恢复会话时仍然保持连接。</li>
<li>没有网络延迟。立即显示用户输入和删除而没有延迟</li>
<li>像 SSH 那样支持一些旧的方式登录。</li>
<li>包丢失处理机制</li>
</ul>
<h3>Linux 中 mosh 的安装</h3>
<p>在 Debian、Ubuntu 和 Mint 类似的系统中，你可以很容易地用 <a href="http://www.tecmint.com/useful-basic-commands-of-apt-get-and-apt-cache-for-package-management/">apt-get 包管理器</a>安装。</p>
<div class="highlight"><pre><span></span><code># apt-get update 
# apt-get install mosh
</code></pre></div>

<p>在基于 RHEL/CentOS/Fedora 的系统中，要使用 <a href="http://www.tecmint.com/20-linux-yum-yellowdog-updater-modified-commands-for-package-mangement/">yum 包管理器</a>安装 mosh，你需要打开第三方的 <a href="/article-2324-1.html">EPEL</a>。</p>
<div class="highlight"><pre><span></span><code># yum update
# yum install mosh
</code></pre></div>

<p>在 Fedora 22+的版本中，你需要使用 <a href="http://www.tecmint.com/dnf-commands-for-fedora-rpm-package-management/">dnf 包管理器</a>来安装 mosh。</p>
<div class="highlight"><pre><span></span><code># dnf install mosh
</code></pre></div>

<h3>我该如何使用 mosh？</h3>
<p>1、 让我们尝试使用 mosh 登录远程 Linux 服务器。</p>
<div class="highlight"><pre><span></span><code><span class="n">$</span><span class="w"> </span><span class="n">mosh</span><span class="w"> </span><span class="n">root</span><span class="mf">@192.168.0.150</span>
</code></pre></div>

<p><img alt="Mosh Shell Remote Connection" src="/data/attachment/album/201509/21/221905etj22azl76w26nrn.png"></p>
<p><em>mosh远程连接</em></p>
<p><strong>注意</strong>：你有没有看到一个连接错误，因为我在 CentOS 7中还有打开这个端口。一个快速但是我并不建议的解决方法是：</p>
<div class="highlight"><pre><span></span><code># systemctl stop firewalld    [在远程服务器上]
</code></pre></div>

<p>更好的方法是打开一个端口并更新防火墙规则。接着用 mosh 连接到预定义的端口中。至于更深入的细节，也许你会对下面的文章感兴趣。</p>
<ul>
<li><a href="http://www.tecmint.com/configure-firewalld-in-centos-7/">如何配置 Firewalld</a></li>
</ul>
<p>2、 让我们假设把默认的 22 端口改到 70，这时使用 -p 选项来使用自定义端口。</p>
<div class="highlight"><pre><span></span><code><span class="n">$</span><span class="w"> </span><span class="n">mosh</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="mi">70</span><span class="w"> </span><span class="n">root</span><span class="mf">@192.168.0.150</span>
</code></pre></div>

<p>3、 检查 mosh 的版本</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>mosh<span class="w"> </span>--version
</code></pre></div>

<p><img alt="Check Mosh Version" src="/data/attachment/album/201509/21/221906ivwcvpv8bfzf68zc.png"></p>
<p><em>检查mosh版本</em></p>
<p>4、 你可以输入<code>exit</code>来退出 mosh 会话。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span><span class="nb">exit</span>
</code></pre></div>

<p>5、 mosh 支持很多选项，你可以用下面的方法看到：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>mosh<span class="w"> </span>--help
</code></pre></div>

<p><img alt="Mosh Shell Options" src="/data/attachment/album/201509/21/221907wk1bnje0gld7i1pg.png"></p>
<p><em>Mosh 选项</em></p>
<h4>mosh 的优缺点</h4>
<ul>
<li>mosh 有额外的需求，比如需要允许 UDP 直接连接，这在 SSH 不需要。</li>
<li>动态分配的端口范围是 60000-61000。第一个打开的端口是分配好的。每个连接都需要一个端口。</li>
<li>默认的端口分配是一个严重的安全问题，尤其是在生产环境中。</li>
<li>支持 IPv6 连接，但是不支持 IPv6 漫游。</li>
<li>不支持回滚</li>
<li>不支持 X11 转发</li>
<li>不支持 ssh-agent 转发</li>
</ul>
<h3>总结</h3>
<p>mosh是一款在大多数linux发行版的仓库中可以下载的一款小工具。虽然它有一些差异尤其是安全问题和额外的需求，它的功能，比如漫游后保持连接是一个加分点。我的建议是任何一个使用ssh的linux用户都应该试试这个程序，mosh值得一试。</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>