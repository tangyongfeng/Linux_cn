<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>'RHCSA 系列（四）: 编辑文本文件及分析文本'</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: Gabriel Cánepa 作为系统管理员的日常职责的一部分，每个系统管理员都必须处理文本文件，这包括编辑已有文件（大多可能是配 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li class="active"><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2015/09/rhcsa-xi-lie-si-bian-ji-wen-ben-wen-jian-ji-fen-xi-wen-ben.html" rel="bookmark"
           title="Permalink to 'RHCSA 系列（四）: 编辑文本文件及分析文本'">'RHCSA 系列（四）: 编辑文本文件及分析文本'</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2015-09-16T10:11:00+02:00">
                Published: Wed 16 September 2015
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/ji-zhu">技术</a>.</p>

</footer><!-- /.post-info -->      <p>Author: Gabriel Cánepa</p>
<p>作为系统管理员的日常职责的一部分，每个系统管理员都必须处理文本文件，这包括编辑已有文件（大多可能是配置文件），或创建新的文件。有这样一个说法，假如你想在 Linux 世界中挑起一场圣战，你可以询问系统管理员们，什么是他们最喜爱的编辑器以及为什么。在这篇文章中，我们并不打算那样做，但我们将向你呈现一些技巧，这些技巧对使用两款在 RHEL 7 中最为常用的文本编辑器: nano（由于其简单和易用，特别是对于新手来说）和 vi/m（由于其自身的几个特色使得它不仅仅是一个简单的编辑器）来说都大有裨益。我确信你可以找到更多的理由来使用其中的一个或另一个，或许其他的一些编辑器如 emacs 或 pico。这完全取决于你自己。</p>
<p><img alt="学习 Nano 和 vi 编辑器" src="/data/attachment/album/201509/15/231442zmaexaxjqn7exmzn.png"></p>
<p><em>RHCSA: 使用 Nano 和 Vim 编辑文本文件 – Part 4</em></p>
<h3>使用 Nano 编辑器来编辑文件</h3>
<p>要启动 nano，你可以在命令提示符下输入 <code>nano</code>，或可选地跟上一个文件名（在这种情况下，若文件存在，它将在编辑模式中被打开）。若文件不存在，或我们省略了文件名， nano 也将在编辑模式下开启，但将为我们开启一个空白屏以便开始输入：</p>
<p><img alt="Nano 编辑器" src="/data/attachment/album/201509/15/231442f8q5dqolq6jqwmye.png"></p>
<p><em>Nano 编辑器</em></p>
<p>正如你在上一张图片中所见的那样， nano 在屏幕的底部呈现出一些可以通过指定的快捷键来触发的功能（^，即插入记号，代指 Ctrl 键)。它们中的一些是：</p>
<ul>
<li>Ctrl + G: 触发一个帮助菜单，带有一个关于功能和相应的描述的完整列表；</li>
</ul>
<p><img alt="Nano 编辑器帮助菜单" src="/data/attachment/album/201509/15/231443h7sqt9ddauamimmj.png"></p>
<p><em>Nano 编辑器帮助菜单</em></p>
<ul>
<li>Ctrl + O: 保存更改到一个文件。它可以让你用一个与源文件相同或不同的名称来保存该文件，然后按 Enter 键来确认。</li>
</ul>
<p><img alt="Nano 编辑器保存更改模式" src="/data/attachment/album/201509/15/231444dgk4qf4074vb9q6b.png"></p>
<p><em>Nano 编辑器的保存更改模式</em></p>
<ul>
<li>Ctrl + X: 离开当前文件，假如更改没有被保存，则它们将被丢弃；</li>
<li>Ctrl + R: 通过指定一个完整的文件路径，让你选择一个文件来将该文件的内容插入到当前文件中；</li>
</ul>
<p><img alt="Nano: 插入文件内容到主文件中" src="/data/attachment/album/201509/15/231444mfuldufe2pzyyxe8.png"></p>
<p><em>Nano: 插入文件内容到主文件中</em></p>
<p>上图的操作将把 <code>/etc/passwd</code> 的内容插入到当前文件中。</p>
<ul>
<li>Ctrl + K: 剪切当前行；</li>
<li>Ctrl + U: 粘贴；</li>
<li>Ctrl + C: 取消当前的操作并返回先前的屏幕；</li>
</ul>
<p>为了轻松地在打开的文件中浏览， nano 提供了下面的功能：</p>
<ul>
<li>Ctrl + F 和 Ctrl + B 分别先前或向后移动光标；而 Ctrl + P 和 Ctrl + N 则分别向上或向下移动一行，功能与箭头键相同；</li>
<li>Ctrl + space 和 Alt + space 分别向前或向后移动一个单词；</li>
</ul>
<p>最后，</p>
<ul>
<li>假如你想将光标移动到文档中的特定位置，使用 Ctrl + _ (下划线) 并接着输入 X,Y 将准确地带你到 第 X 行，第 Y 列。</li>
</ul>
<p><img alt="在 nano 中定位到具体的行，列" src="/data/attachment/album/201509/15/231444tch3efiuwpifxez2.png"></p>
<p><em>在 nano 中定位到具体的行和列</em></p>
<p>上面的例子将带你到当前文档的第 15 行，第 14 列。</p>
<p>假如你可以回忆起你早期的 Linux 岁月，特别是当你刚从 Windows 迁移到 Linux 中，你就可能会同意：对于一个新手来说，使用 nano 来开始学习是最好的方式。</p>
<h3>使用 Vim 编辑器来编辑文件</h3>
<p>Vim 是 vi 的加强版本，它是 Linux 中一个著名的文本编辑器，可在所有兼容 POSIX 的 *nix 系统中获取到，例如在 RHEL 7 中。假如你有机会并可以安装 Vim，请继续；假如不能，这篇文章中的大多数（若不是全部）的提示也应该可以正常工作。</p>
<p>Vim 的一个出众的特点是可以在多个不同的模式中进行操作：</p>
<ul>
<li><ruby> 命令模式 <rp>  （ </rp> <rt>  Command Mode </rt> <rp>  ） </rp></ruby>将允许你在文件中跳转和输入命令，这些命令是由一个或多个字母组成的简洁且大小写敏感的组合。假如你想重复执行某个命令特定次数，你可以在这个命令前加上需要重复的次数（这个规则只有极少数例外）。例如， <code>yy</code>（或 <code>Y</code>，yank 的缩写）可以复制整个当前行，而 <code>4yy</code>（或 <code>4Y</code>）则复制整个从当前行到接下来的 3 行(总共 4 行)。</li>
<li>我们总是可以通过敲击 <code>Esc</code> 键来进入命令模式（无论我们正工作在哪个模式下）。</li>
<li>在<ruby> 末行模式 <rp>  （ </rp> <rt>  Ex Mode </rt> <rp>  ） </rp></ruby>中，你可以操作文件（包括保存当前文件和运行外部的程序或命令）。要进入末行模式，你必须从命令模式中（换言之，输入 <code>Esc</code> + <code>:</code>)输入一个冒号(<code>:</code>)，再直接跟上你想使用的末行模式命令的名称。</li>
<li>对于<ruby> 插入模式 <rp>  （ </rp> <rt>  Insert Mode </rt> <rp>  ） </rp></ruby>，可以输入字母 <code>i</code> 进入，然后只需要输入文字即可。大多数的击键结果都将出现在屏幕中的文本中。</li>
</ul>
<p>现在，让我们看看如何在 vim 中执行在上一节列举的针对 nano 的相同的操作。不要忘记敲击 Enter 键来确认 vim 命令。</p>
<p>为了从命令行中获取 vim 的完整手册，在命令模式下键入 <code>:help</code> 并敲击 Enter 键：</p>
<p><img alt="vim 编辑器帮助菜单" src="/data/attachment/album/201509/15/231445svvzzavunbvav5kv.png"></p>
<p><em>vim 编辑器帮助菜单</em></p>
<p>上面的部分呈现出一个内容列表，这些定义的小节则描述了 Vim 的特定话题。要浏览某一个小节，可以将光标放到它的上面，然后按 <code>Ctrl + ]</code> （闭方括号）。注意，底部的小节展示的是当前文件的内容。</p>
<p>1、 要保存更改到文件，在命令模式中运行下面命令中的任意一个，就可以达到这个目的：</p>
<div class="highlight"><pre><span></span><code>:wq!
:x!
ZZ (是的，两个 ZZ,前面无需添加冒号)
</code></pre></div>

<p>2、 要离开并丢弃更改，使用 <code>:q!</code>。这个命令也将允许你离开上面描述过的帮助菜单，并返回到命令模式中的当前文件。</p>
<p>3、 剪切 N 行：在命令模式中键入 <code>Ndd</code>。</p>
<p>4、 复制 M 行：在命令模式中键入 <code>Myy</code>。</p>
<p>5、 粘贴先前剪贴或复制过的行：在命令模式中按 <code>P</code>键。</p>
<p>6、 要插入另一个文件的内容到当前文件：</p>
<div class="highlight"><pre><span></span><code>:r filename
</code></pre></div>

<p>例如，插入 <code>/etc/fstab</code> 的内容，可以这样做：</p>
<p><a href="http://www.tecmint.com/wp-content/uploads/2015/03/Insert-Content-vi-Editor.png">在 vi 编辑器中插入文件的内容</a></p>
<p><em>在 vi 编辑器中插入文件的内容</em></p>
<p>7、 插入一个命令的输出到当前文档：</p>
<div class="highlight"><pre><span></span><code>:r! command
</code></pre></div>

<p>例如，要在光标所在的当前位置后面插入日期和时间：</p>
<p><img alt="在 vi 编辑器中插入时间和日期" src="/data/attachment/album/201509/15/231446qns4zsysfv77tssf.png"></p>
<p><em>在 vi 编辑器中插入时间和日期</em></p>
<p>在另一篇我写的文章中，(<a href="http://www.tecmint.com/vi-editor-usage/">LFCS 系列（二）</a>)，我更加详细地解释了在 vim 中可用的键盘快捷键和功能。或许你可以参考那个教程来查看如何使用这个强大的文本编辑器的更深入的例子。</p>
<h3>使用 grep 和正则表达式来分析文本</h3>
<p>到现在为止，你已经学习了如何使用 nano 或 vim 创建和编辑文件。打个比方说，假如你成为了一个文本编辑器忍者 – 那又怎样呢？ 在其他事情上，你也需要知道如何在文本中搜索正则表达式。</p>
<p>正则表达式（也称为 "regex" 或 "regexp"） 是一种识别一个特定文本字符串或模式的方式，使得一个程序可以将这个模式和任意的文本字符串相比较。尽管利用 grep 来使用正则表达式值得用一整篇文章来描述，这里就让我们复习一些基本的知识：</p>
<p><strong>1、 最简单的正则表达式是一个由数字和字母构成的字符串（例如，单词 "svm"） ，或者两个（在使用两个字符串时，你可以使用 <code>|</code>(或) 操作符）：</strong></p>
<div class="highlight"><pre><span></span><code># grep -Ei &#39;svm|vmx&#39; /proc/cpuinfo
</code></pre></div>

<p>上面命令的输出结果中若有这两个字符串之一的出现，则标志着你的处理器支持虚拟化:</p>
<p><img alt="正则表达式示例" src="/data/attachment/album/201509/15/231447xf5wkowee5ecwsew.png"></p>
<p><em>正则表达式示例</em></p>
<p><strong>2、 第二种正则表达式是一个范围列表，由方括号包裹。</strong></p>
<p>例如， <code>c[aeiou]t</code> 匹配字符串 cat、cet、cit、cot 和 cut，而 <code>[a-z]</code> 和 <code>[0-9]</code> 则相应地匹配小写字母或十进制数字。假如你想重复正则表达式 X 次，在正则表达式的后面立即输入 <code>{X}</code>即可。</p>
<p>例如，让我们从 <code>/etc/fstab</code> 中析出存储设备的 UUID：</p>
<div class="highlight"><pre><span></span><code># grep -Ei &#39;[0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12}&#39; -o /etc/fstab
</code></pre></div>

<p><img alt="在 Linux 中从一个文件中析出字符串" src="/data/attachment/album/201509/15/231448zutw1oqegs11u6uw.png"></p>
<p><em>从一个文件中析出字符串</em></p>
<p>方括号中的第一个表达式 <code>[0-9a-f]</code> 被用来表示小写的十六进制字符，<code>{8}</code>是一个量词，暗示前面匹配的字符串应该重复的次数（在一个 UUID 中的开头序列是一个 8 个字符长的十六进制字符串）。</p>
<p>在圆括号中，量词 <code>{4}</code>和连字符暗示下一个序列是一个 4 个字符长的十六进制字符串，接着的量词 <code>({3})</code>表示前面的表达式要重复 3 次。</p>
<p>最后，在 UUID 中的最后一个 12 个字符长的十六进制字符串可以由 <code>[0-9a-f]{12}</code> 取得， <code>-o</code> 选项表示只打印出在 <code>/etc/fstab</code>中匹配行中的匹配的(非空)部分。</p>
<p><strong>3、 POSIX 字符类</strong></p>
<table>
<thead>
<tr>
<th>字符类</th>
<th>匹配 …</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>[:alnum:]</code></td>
<td>任意字母或数字 [a-zA-Z0-9]</td>
</tr>
<tr>
<td><code>[:alpha:]</code></td>
<td>任意字母 [a-zA-Z]</td>
</tr>
<tr>
<td><code>[:blank:]</code></td>
<td>空格或制表符</td>
</tr>
<tr>
<td><code>[:cntrl:]</code></td>
<td>任意控制字符 (ASCII 码的 0 至 32)</td>
</tr>
<tr>
<td><code>[:digit:]</code></td>
<td>任意数字 [0-9]</td>
</tr>
<tr>
<td><code>[:graph:]</code></td>
<td>任意可见字符</td>
</tr>
<tr>
<td><code>[:lower:]</code></td>
<td>任意小写字母 [a-z]</td>
</tr>
<tr>
<td><code>[:print:]</code></td>
<td>任意非控制字符</td>
</tr>
<tr>
<td><code>[:space:]</code></td>
<td>任意空格</td>
</tr>
<tr>
<td><code>[:punct:]</code></td>
<td>任意标点字符</td>
</tr>
<tr>
<td><code>[:upper:]</code></td>
<td>任意大写字母 [A-Z]</td>
</tr>
<tr>
<td><code>[:xdigit:]</code></td>
<td>任意十六进制数字 [0-9a-fA-F]</td>
</tr>
<tr>
<td><code>[:word:]</code></td>
<td>任意字母，数字和下划线 [a-zA-Z0-9_]</td>
</tr>
</tbody>
</table>
<p>例如，我们可能会对查找已添加到我们系统中给真实用户的 UID 和 GID（参考“<a href="/article-6155-1.html">RHCSA 系列（二）: 如何进行文件和目录管理</a>”来回忆起这些知识）感兴趣。那么，我们将在 <code>/etc/passwd</code> 文件中查找 4 个字符长的序列：</p>
<div class="highlight"><pre><span></span><code># grep -Ei [[:digit:]]{4} /etc/passwd
</code></pre></div>

<p><img alt="在文件中查找一个字符串" src="/data/attachment/album/201509/15/231449tvx4ixv54xtw17g7.png"></p>
<p><em>在文件中查找一个字符串</em></p>
<p>上面的示例可能不是真实世界中使用正则表达式的最好案例，但它清晰地启发了我们如何使用 POSIX 字符类来使用 grep 分析文本。</p>
<h3>总结</h3>
<p>在这篇文章中，我们已经提供了一些技巧来最大地利用针对命令行用户的两个文本编辑器 nano 和 vim，这两个工具都有相关的扩展文档可供阅读，你可以分别查询它们的官方网站(链接在下面给出)以及使用“<a href="/article-6133-1-rel.html">RHCSA 系列（一）: 回顾基础命令及系统文档</a>”中给出的建议。</p>
<h4>参考文件链接</h4>
<ul>
<li><a href="http://www.nano-editor.org/">http://www.nano-editor.org/</a></li>
<li><a href="http://www.vim.org/">http://www.vim.org/</a></li>
</ul>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>