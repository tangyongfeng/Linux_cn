<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>解读 ip 命令展示的网络连接信息</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: Sandra Henry-stocker ip 命令可以告诉你很多网络连接配置和状态的信息，但是所有这些词和数字意味着什么？ 让我们深入了解一下，看 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li class="active"><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2018/03/jie-du-ip-ming-ling-zhan-shi-de-wang-luo-lian-jie-xin-xi.html" rel="bookmark"
           title="Permalink to 解读 ip 命令展示的网络连接信息">解读 ip 命令展示的网络连接信息</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2018-03-24T11:52:00+01:00">
                Published: Sat 24 March 2018
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/xi-tong-yun-wei">系统运维</a>.</p>

</footer><!-- /.post-info -->      <p>Author: Sandra Henry-stocker</p>
<p><img alt="" src="/data/attachment/album/201803/24/115203by90oee7sbb11y0o.jpg"></p>
<p><code>ip</code> 命令可以告诉你很多网络连接配置和状态的信息，但是所有这些词和数字意味着什么？ 让我们深入了解一下，看看所有显示的值都试图告诉你什么。</p>
<p>当您使用 <code>ip a</code>（或 <code>ip addr</code>）命令获取系统上所有网络接口的信息时，您将看到如下所示的内容：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ip<span class="w"> </span>a
<span class="m">1</span>:<span class="w"> </span>lo:<span class="w"> </span>&lt;LOOPBACK,UP,LOWER_UP&gt;<span class="w"> </span>mtu<span class="w"> </span><span class="m">65536</span><span class="w"> </span>qdisc<span class="w"> </span>noqueue<span class="w"> </span>state<span class="w"> </span>UNKNOWN<span class="w"> </span>group<span class="w"> </span>default<span class="w"> </span>qlen<span class="w"> </span><span class="m">1000</span>
<span class="w"> </span>link/loopback<span class="w"> </span><span class="m">00</span>:00:00:00:00:00<span class="w"> </span>brd<span class="w"> </span><span class="m">00</span>:00:00:00:00:00
<span class="w"> </span>inet<span class="w"> </span><span class="m">127</span>.0.0.1/8<span class="w"> </span>scope<span class="w"> </span>host<span class="w"> </span>lo
<span class="w"> </span>valid_lft<span class="w"> </span>forever<span class="w"> </span>preferred_lft<span class="w"> </span>forever
<span class="w"> </span>inet6<span class="w"> </span>::1/128<span class="w"> </span>scope<span class="w"> </span>host
<span class="w"> </span>valid_lft<span class="w"> </span>forever<span class="w"> </span>preferred_lft<span class="w"> </span>forever
<span class="m">2</span>:<span class="w"> </span>enp0s25:<span class="w"> </span>&lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt;<span class="w"> </span>mtu<span class="w"> </span><span class="m">1500</span><span class="w"> </span>qdisc<span class="w"> </span>pfifo_fast<span class="w"> </span>state<span class="w"> </span>UP<span class="w"> </span>group<span class="w"> </span>default<span class="w"> </span>qlen<span class="w"> </span><span class="m">1000</span>
<span class="w"> </span>link/ether<span class="w"> </span><span class="m">00</span>:1e:4f:c8:43:fc<span class="w"> </span>brd<span class="w"> </span>ff:ff:ff:ff:ff:ff
<span class="w"> </span>inet<span class="w"> </span><span class="m">192</span>.168.0.24/24<span class="w"> </span>brd<span class="w"> </span><span class="m">192</span>.168.0.255<span class="w"> </span>scope<span class="w"> </span>global<span class="w"> </span>dynamic<span class="w"> </span>enp0s25
<span class="w"> </span>valid_lft<span class="w"> </span>57295sec<span class="w"> </span>preferred_lft<span class="w"> </span>57295sec
<span class="w"> </span>inet6<span class="w"> </span>fe80::2c8e:1de0:a862:14fd/64<span class="w"> </span>scope<span class="w"> </span>link
<span class="w"> </span>valid_lft<span class="w"> </span>forever<span class="w"> </span>preferred_lft<span class="w"> </span>forever
</code></pre></div>

<p>这个系统上的两个接口 - 环回（<code>lo</code>）和网络（<code>enp0s25</code>）——显示了很多统计数据。 <code>lo</code> 接口显然是<ruby> 环回地址 <rt>  loolback </rt></ruby>。 我们可以在列表中看到环回 IPv4 地址（<code>127.0.0.1</code>）和环回 IPv6（<code>::1</code>）。 而普通的网络接口更有趣。</p>
<h3>为什么是 enp0s25 而不是 eth0</h3>
<p>如果你想知道为什么它在这个系统上被称为 <code>enp0s25</code>，而不是可能更熟悉的 <code>eth0</code>，那我们可以稍微解释一下。</p>
<p>新的命名方案被称为“<ruby> 可预测的网络接口 <rt>  Predictable Network Interface </rt></ruby>”。 它已经在基于systemd 的 Linux 系统上使用了一段时间了。 接口名称取决于硬件的物理位置。 <code>en</code> 仅仅就是 “ethernet” 的意思，就像 “eth” 用于对应 <code>eth0</code>，一样。 <code>p</code> 是以太网卡的总线编号，<code>s</code> 是插槽编号。 所以 <code>enp0s25</code> 告诉我们很多我们正在使用的硬件的信息。</p>
<p><code>&lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt;</code> 这个配置串告诉我们：</p>
<div class="highlight"><pre><span></span><code>BROADCAST   该接口支持广播
MULTICAST   该接口支持多播
UP          网络接口已启用
LOWER_UP    网络电缆已插入，设备已连接至网络
</code></pre></div>

<p>列出的其他值也告诉了我们很多关于接口的知识，但我们需要知道 <code>brd</code> 和 <code>qlen</code> 这些词代表什么意思。 所以，这里显示的是上面展示的 <code>ip</code> 信息的其余部分的翻译。</p>
<div class="highlight"><pre><span></span><code>mtu 1500                                    最大传输单位（数据包大小）为1,500字节
qdisc pfifo_fast                            用于数据包排队
state UP                                    网络接口已启用
group default                               接口组
qlen 1000                                   传输队列长度
link/ether 00:1e:4f:c8:43:fc                接口的 MAC（硬件）地址
brd ff:ff:ff:ff:ff:ff                       广播地址
inet 192.168.0.24/24                        IPv4 地址
brd 192.168.0.255                           广播地址
scope global                                全局有效
dynamic enp0s25                             地址是动态分配的
valid_lft 80866sec                          IPv4 地址的有效使用期限
preferred_lft 80866sec                      IPv4 地址的首选生存期
inet6 fe80::2c8e:1de0:a862:14fd/64          IPv6 地址
scope link                                  仅在此设备上有效
valid_lft forever                           IPv6 地址的有效使用期限
preferred_lft forever                       IPv6 地址的首选生存期
</code></pre></div>

<p>您可能已经注意到，<code>ifconfig</code> 命令提供的一些信息未包含在 <code>ip a</code> 命令的输出中 —— 例如传输数据包的统计信息。 如果您想查看发送和接收的数据包数量以及冲突数量的列表，可以使用以下 <code>ip</code> 命令：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ip<span class="w"> </span>-s<span class="w"> </span>link<span class="w"> </span>show<span class="w"> </span>enp0s25
<span class="m">2</span>:<span class="w"> </span>enp0s25:<span class="w"> </span>&lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt;<span class="w"> </span>mtu<span class="w"> </span><span class="m">1500</span><span class="w"> </span>qdisc<span class="w"> </span>pfifo_fast<span class="w"> </span>state<span class="w"> </span>UP<span class="w"> </span>mode<span class="w"> </span>DEFAULT<span class="w"> </span>group<span class="w"> </span>default<span class="w"> </span>qlen<span class="w"> </span><span class="m">1000</span>
<span class="w"> </span>link/ether<span class="w"> </span><span class="m">00</span>:1e:4f:c8:43:fc<span class="w"> </span>brd<span class="w"> </span>ff:ff:ff:ff:ff:ff
<span class="w"> </span>RX:<span class="w"> </span>bytes<span class="w"> </span>packets<span class="w"> </span>errors<span class="w"> </span>dropped<span class="w"> </span>overrun<span class="w"> </span>mcast
<span class="w"> </span><span class="m">224258568</span><span class="w"> </span><span class="m">418718</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">84376</span>
<span class="w"> </span>TX:<span class="w"> </span>bytes<span class="w"> </span>packets<span class="w"> </span>errors<span class="w"> </span>dropped<span class="w"> </span>carrier<span class="w"> </span>collsns
<span class="w"> </span><span class="m">6131373</span><span class="w"> </span><span class="m">78152</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>
</code></pre></div>

<p>另一个 <code>ip</code> 命令提供有关系统路由表的信息。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ip<span class="w"> </span>route<span class="w"> </span>show
default<span class="w"> </span>via<span class="w"> </span><span class="m">192</span>.168.0.1<span class="w"> </span>dev<span class="w"> </span>enp0s25<span class="w"> </span>proto<span class="w"> </span>static<span class="w"> </span>metric<span class="w"> </span><span class="m">100</span>
<span class="m">169</span>.254.0.0/16<span class="w"> </span>dev<span class="w"> </span>enp0s25<span class="w"> </span>scope<span class="w"> </span>link<span class="w"> </span>metric<span class="w"> </span><span class="m">1000</span>
<span class="m">192</span>.168.0.0/24<span class="w"> </span>dev<span class="w"> </span>enp0s25<span class="w"> </span>proto<span class="w"> </span>kernel<span class="w"> </span>scope<span class="w"> </span>link<span class="w"> </span>src<span class="w"> </span><span class="m">192</span>.168.0.24<span class="w"> </span>metric<span class="w"> </span><span class="m">100</span>
</code></pre></div>

<p><code>ip</code> 命令是非常通用的。 您可以从 <code>ip</code> 命令及其来自<a href="https://access.redhat.com/sites/default/files/attachments/rh_ip_command_cheatsheet_1214_jcs_print.pdf">Red Hat</a>的选项获得有用的备忘单。</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>