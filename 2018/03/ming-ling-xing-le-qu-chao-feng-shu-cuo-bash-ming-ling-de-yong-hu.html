<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>命令行乐趣：嘲讽输错 Bash 命令的用户</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: Vivek Gite 你可以通过配置 sudo 命令去嘲讽输入错误密码的用户。但是现在，当用户在 shell 输错命令时，就能嘲讽他了（滥用？）。 你好 bash-insulter …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li class="active"><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2018/03/ming-ling-xing-le-qu-chao-feng-shu-cuo-bash-ming-ling-de-yong-hu.html" rel="bookmark"
           title="Permalink to 命令行乐趣：嘲讽输错 Bash 命令的用户">命令行乐趣：嘲讽输错 Bash 命令的用户</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2018-03-30T10:26:59+02:00">
                Published: Fri 30 March 2018
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/ji-zhu">技术</a>.</p>

</footer><!-- /.post-info -->      <p>Author: Vivek Gite</p>
<p><img alt="" src="/data/attachment/album/201803/30/102653o0g177wl8dug2kw2.jpg"></p>
<p>你可以通过配置 <code>sudo</code> 命令去嘲讽输入错误密码的用户。但是现在，当用户在 shell 输错命令时，就能嘲讽他了（滥用？）。</p>
<h3>你好 bash-insulter</h3>
<p>来自 Github 页面：</p>
<blockquote>
<p>当用户键入错误命令，随机嘲讽。它使用了一个 bash4.x. 版本的全新内置错误处理函数，叫 <code>command_not_found_handle</code>。</p>
</blockquote>
<h3>安装</h3>
<p>键入下列 git 命令克隆一个仓库：</p>
<div class="highlight"><pre><span></span><code>git clone https://github.com/hkbakke/bash-insulter.git bash-insulter
</code></pre></div>

<p>示例输出：</p>
<div class="highlight"><pre><span></span><code>Cloning into &#39;bash-insulter&#39;...
remote: Counting objects: 52, done.
remote: Compressing objects: 100% (49/49), done.
remote: Total 52 (delta 12), reused 12 (delta 2), pack-reused 0
Unpacking objects: 100% (52/52), done.
</code></pre></div>

<p>用文本编辑器，比如说使用 <code>vi</code>，编辑你的 <code>~/.bashrc</code> 或者 <code>/etc/bash.bashrc</code> 文件：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>vi<span class="w"> </span>~/.bashrc
</code></pre></div>

<p>在其后追加这一行（具体了解请查看 <a href="https://bash.cyberciti.biz/guide/If..else..fi">if..else..fi 声明</a> 和 <a href="https://bash.cyberciti.biz/guide/Source_command">source 命令</a>）：</p>
<div class="highlight"><pre><span></span><code><span class="k">if</span><span class="w"> </span>[<span class="w"> </span><span class="o">-</span><span class="nv">f</span><span class="w"> </span>$<span class="nv">HOME</span><span class="o">/</span><span class="nv">bash</span><span class="o">-</span><span class="nv">insulter</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">bash</span>.<span class="nv">command</span><span class="o">-</span><span class="nv">not</span><span class="o">-</span><span class="nv">found</span><span class="w"> </span>]<span class="c1">; then</span>
<span class="w">    </span><span class="nv">source</span><span class="w"> </span>$<span class="nv">HOME</span><span class="o">/</span><span class="nv">bash</span><span class="o">-</span><span class="nv">insulter</span><span class="o">/</span><span class="nv">src</span><span class="o">/</span><span class="nv">bash</span>.<span class="nv">command</span><span class="o">-</span><span class="nv">not</span><span class="o">-</span><span class="nv">found</span>
<span class="nv">fi</span>
</code></pre></div>

<p>保存并关闭文件。重新登录，如果不想退出账号也可以手动运行它：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>.<span class="w"> </span><span class="nv">$HOME</span>/bash-insulter/src/bash.command-not-found
</code></pre></div>

<h3>如何使用它？</h3>
<p>尝试键入一些无效命令：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ifconfigs
$<span class="w"> </span>dates
</code></pre></div>

<p>示例输出:</p>
<p><a href="https://www.cyberciti.biz/media/new/cms/2017/11/bash-insulter-Insults-the-user-when-typing-wrong-command.jpg"><img alt="一个有趣的 bash 钩子功能，嘲讽输入了错误命令的你。" src="/data/attachment/album/201803/30/102702uazyc5tf7qmhcccy.jpg"></a></p>
<h3>自定义</h3>
<p>你需要编辑 <code>$HOME/bash-insulter/src/bash.command-not-found</code>：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>vi<span class="w"> </span><span class="nv">$HOME</span>/bash-insulter/src/bash.command-not-found
</code></pre></div>

<p>示例代码：</p>
<div class="highlight"><pre><span></span><code>command_not_found_handle<span class="w"> </span>()<span class="w"> </span>{
<span class="w">    </span>local<span class="w"> </span>INSULTS=(
<span class="w">        </span>&quot;Boooo!&quot;
<span class="w">        </span>&quot;Don&#39;t<span class="w"> </span>you<span class="w"> </span>know<span class="w"> </span>anything?&quot;
<span class="w">        </span>&quot;RTFM!&quot;
<span class="w">        </span>&quot;Hahaha,<span class="w"> </span>n00b!&quot;
<span class="w">        </span>&quot;Wow!<span class="w"> </span>That<span class="w"> </span>was<span class="w"> </span>impressively<span class="w"> </span>wrong!&quot;
<span class="w">        </span>&quot;What<span class="w"> </span>are<span class="w"> </span>you<span class="w"> </span>doing??&quot;
<span class="w">        </span>&quot;Pathetic&quot;
<span class="w">        </span>&quot;...and<span class="w"> </span>this<span class="w"> </span>is<span class="w"> </span>the<span class="w"> </span>best<span class="w"> </span>you<span class="w"> </span>can<span class="w"> </span>do??&quot;
<span class="w">        </span>&quot;The<span class="w"> </span>worst<span class="w"> </span>one<span class="w"> </span>today!&quot;
<span class="w">        </span>&quot;n00b<span class="w"> </span>alert!&quot;
<span class="w">        </span>&quot;Your<span class="w"> </span>application<span class="w"> </span>for<span class="w"> </span>reduced<span class="w"> </span>salary<span class="w"> </span>has<span class="w"> </span>been<span class="w"> </span>sent!&quot;
<span class="w">        </span>&quot;lol&quot;
<span class="w">        </span>&quot;u<span class="w"> </span>suk&quot;
<span class="w">        </span>&quot;lol...<span class="w"> </span>plz&quot;
<span class="w">        </span>&quot;plz<span class="w"> </span>uninstall&quot;
<span class="w">        </span>&quot;And<span class="w"> </span>the<span class="w"> </span>Darwin<span class="w"> </span>Award<span class="w"> </span>goes<span class="w"> </span>to....<span class="w"> </span><span class="cp">${</span><span class="n">USER</span><span class="cp">}</span>!&quot;
<span class="w">        </span>&quot;ERROR_INCOMPETENT_USER&quot;
<span class="w">        </span>&quot;Incompetence<span class="w"> </span>is<span class="w"> </span>also<span class="w"> </span>competence&quot;
<span class="w">        </span>&quot;Bad.&quot;
<span class="w">        </span>&quot;Fake<span class="w"> </span>it<span class="w"> </span>till<span class="w"> </span>you<span class="w"> </span>make<span class="w"> </span>it!&quot;
<span class="w">        </span>&quot;What<span class="w"> </span>is<span class="w"> </span>this...?<span class="w"> </span>Amateur<span class="w"> </span>hour!?&quot;
<span class="w">        </span>&quot;Come<span class="w"> </span>on!<span class="w"> </span>You<span class="w"> </span>can<span class="w"> </span>do<span class="w"> </span>it!&quot;
<span class="w">        </span>&quot;Nice<span class="w"> </span>try.&quot;
<span class="w">        </span>&quot;What<span class="w"> </span>if...<span class="w"> </span>you<span class="w"> </span>type<span class="w"> </span>an<span class="w"> </span>actual<span class="w"> </span>command<span class="w"> </span>the<span class="w"> </span>next<span class="w"> </span>time!&quot;
<span class="w">        </span>&quot;What<span class="w"> </span>if<span class="w"> </span>I<span class="w"> </span>told<span class="w"> </span>you...<span class="w"> </span>it<span class="w"> </span>is<span class="w"> </span>possible<span class="w"> </span>to<span class="w"> </span>type<span class="w"> </span>valid<span class="w"> </span>commands.&quot;
<span class="w">        </span>&quot;Y<span class="w"> </span>u<span class="w"> </span>no<span class="w"> </span>speak<span class="w"> </span>computer???&quot;
<span class="w">        </span>&quot;This<span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>Windows&quot;
<span class="w">        </span>&quot;Perhaps<span class="w"> </span>you<span class="w"> </span>should<span class="w"> </span>leave<span class="w"> </span>the<span class="w"> </span>command<span class="w"> </span>line<span class="w"> </span>alone...&quot;
<span class="w">        </span>&quot;Please<span class="w"> </span>step<span class="w"> </span>away<span class="w"> </span>from<span class="w"> </span>the<span class="w"> </span>keyboard!&quot;
<span class="w">        </span>&quot;error<span class="w"> </span>code:<span class="w"> </span>1D10T&quot;
<span class="w">        </span>&quot;ACHTUNG!<span class="w"> </span>ALLES<span class="w"> </span>TURISTEN<span class="w"> </span>UND<span class="w"> </span>NONTEKNISCHEN<span class="w"> </span>LOOKENPEEPERS!<span class="w"> </span>DAS<span class="w"> </span>KOMPUTERMASCHINE<span class="w"> </span>IST<span class="w"> </span>NICHT<span class="w"> </span>FÜR<span class="w"> </span>DER<span class="w"> </span>GEFINGERPOKEN<span class="w"> </span>UND<span class="w"> </span>MITTENGRABEN!<span class="w"> </span>ODERWISE<span class="w"> </span>IST<span class="w"> </span>EASY<span class="w"> </span>TO<span class="w"> </span>SCHNAPPEN<span class="w"> </span>DER<span class="w"> </span>SPRINGENWERK,<span class="w"> </span>BLOWENFUSEN<span class="w"> </span>UND<span class="w"> </span>POPPENCORKEN<span class="w"> </span>MIT<span class="w"> </span>SPITZENSPARKEN.<span class="w"> </span>IST<span class="w"> </span>NICHT<span class="w"> </span>FÜR<span class="w"> </span>GEWERKEN<span class="w"> </span>BEI<span class="w"> </span>DUMMKOPFEN.<span class="w"> </span>DER<span class="w"> </span>RUBBERNECKEN<span class="w"> </span>SIGHTSEEREN<span class="w"> </span>KEEPEN<span class="w"> </span>DAS<span class="w"> </span>COTTONPICKEN<span class="w"> </span>HÄNDER<span class="w"> </span>IN<span class="w"> </span>DAS<span class="w"> </span>POCKETS<span class="w"> </span>MUSS.<span class="w"> </span>ZO<span class="w"> </span>RELAXEN<span class="w"> </span>UND<span class="w"> </span>WATSCHEN<span class="w"> </span>DER<span class="w"> </span>BLINKENLICHTEN.&quot;
<span class="w">        </span>&quot;Pro<span class="w"> </span>tip:<span class="w"> </span>type<span class="w"> </span>a<span class="w"> </span>valid<span class="w"> </span>command!&quot;
<span class="w">    </span>)

<span class="w">    </span>#<span class="w"> </span>设置“随机”种子发生器<span class="w"> </span>
<span class="w">    </span>RANDOM=$(date<span class="w"> </span>+%s%N)
<span class="w">    </span>VALUE=$((<span class="cp">${</span><span class="n">RANDOM</span><span class="cp">}</span>%2))

<span class="w">    </span>if<span class="w"> </span>[[<span class="w"> </span><span class="cp">${</span><span class="n">VALUE</span><span class="cp">}</span><span class="w"> </span>-lt<span class="w"> </span>1<span class="w"> </span>]];<span class="w"> </span>then
<span class="w">        </span>printf<span class="w"> </span>&quot;\n<span class="w">  </span>$(tput<span class="w"> </span>bold)$(tput<span class="w"> </span>setaf<span class="w"> </span>1)$(shuf<span class="w"> </span>-n<span class="w"> </span>1<span class="w"> </span>-e<span class="w"> </span>&quot;<span class="cp">${</span><span class="n">INSULTS</span><span class="p">[</span><span class="o">@</span><span class="p">]</span><span class="cp">}</span>&quot;)$(tput<span class="w"> </span>sgr0)\n\n&quot;
<span class="w">    </span>fi

<span class="w">    </span>echo<span class="w"> </span>&quot;-bash:<span class="w"> </span>$1:<span class="w"> </span>command<span class="w"> </span>not<span class="w"> </span>found&quot;

<span class="w">    </span>#<span class="w"> </span>无效命令，常规返回已存在的代码
<span class="w">    </span>return<span class="w"> </span>127
}
</code></pre></div>

<h3>赠品：sudo 嘲讽</h3>
<p>编辑 <code>sudoers</code> 文件：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>visudo
</code></pre></div>

<p>追加下面这一行：</p>
<div class="highlight"><pre><span></span><code>Defaults insults
</code></pre></div>

<p>或者像下面尾行增加一句嘲讽语：</p>
<div class="highlight"><pre><span></span><code>Defaults !lecture,tty_tickets,!fqdn,insults
</code></pre></div>

<p>这是我的文件：</p>
<div class="highlight"><pre><span></span><code><span class="n">Defaults</span><span class="w">    </span><span class="s">env_reset</span>
<span class="n">Defaults</span><span class="w">    </span><span class="s">mail_badpass</span>
<span class="n">Defaults</span><span class="w">    </span><span class="s">secure_path</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin&quot;</span>
##<span class="w"> </span><span class="n">If</span><span class="w"> </span><span class="nb">set</span><span class="p">,</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">insult</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="n">when</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">enter</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">incorrect</span><span class="w"> </span><span class="n">password</span><span class="p">.</span><span class="w"> </span>##
<span class="n">Defaults</span><span class="w">    </span><span class="s">insults</span>

#<span class="w"> </span><span class="n">Host</span><span class="w"> </span><span class="n">alias</span><span class="w"> </span><span class="n">specification</span>

#<span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="n">alias</span><span class="w"> </span><span class="n">specification</span>

#<span class="w"> </span><span class="n">Cmnd</span><span class="w"> </span><span class="n">alias</span><span class="w"> </span><span class="n">specification</span>

#<span class="w"> </span><span class="n">User</span><span class="w"> </span><span class="n">privilege</span><span class="w"> </span><span class="n">specification</span>
<span class="n">root</span><span class="w"> </span><span class="s">ALL</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">ALL</span><span class="p">:</span><span class="n">ALL</span><span class="p">)</span><span class="w"> </span><span class="n">ALL</span>

#<span class="w"> </span><span class="n">Members</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">admin</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">gain</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">privileges</span>
<span class="c">% admin ALL = (ALL) ALL   </span>

#<span class="w"> </span><span class="n">Allow</span><span class="w"> </span><span class="n">members</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="nb">any</span><span class="w"> </span><span class="n">command</span>
<span class="c">% sudo ALL = (ALL:ALL) ALL   </span>

#<span class="w"> </span><span class="n">See</span><span class="w"> </span><span class="n">sudoers</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nb">more</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="s">&quot;#include&quot;</span><span class="w"> </span><span class="n">directives</span><span class="p">:</span>

#<span class="n">includedir</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">sudoers</span><span class="p">.</span><span class="n">d</span>
</code></pre></div>

<p>试一试：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>-k<span class="w"> </span><span class="c1"># 清除缓存，从头开始</span>
$<span class="w"> </span>sudo<span class="w"> </span>ls<span class="w"> </span>/root/
$<span class="w"> </span>sudo<span class="w"> </span>-i
</code></pre></div>

<p>样例对话：</p>
<p><a href="https://www.cyberciti.biz/media/new/cms/2017/11/sudo-insults.jpg"><img alt="当输入错误密码时，你会被一个有趣的的 sudo 嘲讽语戏弄。" src="/data/attachment/album/201803/30/102702kp19pqb2egl8hlw2.jpg"></a></p>
<h3>赠品：你好 sl</h3>
<p><a href="https://www.cyberciti.biz/tips/displays-animations-when-accidentally-you-type-sl-instead-of-ls.html">sl 或是 UNIX 经典捣蛋软件</a> 游戏。当你错误的把 <code>ls</code> 输入成 <code>sl</code>，将会有一辆蒸汽机车穿过你的屏幕。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sl
</code></pre></div>

<p><a href="https://www.cyberciti.biz/tips/displays-animations-when-accidentally-you-type-sl-instead-of-ls.html"><img alt="Linux / UNIX 桌面乐趣: 蒸汽机车" src="/data/attachment/album/201803/30/102703s739gw183ll5454a.png"></a></p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>