<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>使用 VS Code 进行 Python 编程</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: Clément Verna Visual Studio Code，简称 VS Code，是一个开源的文本编辑器，包含用于构建和调试应用程序的工具。安装启用 Python 扩展后，VS Code 可以配 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li class="active"><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2018/09/shi-yong-vs-code-jin-xing-python-bian-cheng.html" rel="bookmark"
           title="Permalink to 使用 VS Code 进行 Python 编程">使用 VS Code 进行 Python 编程</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2018-09-08T08:31:00+02:00">
                Published: Sat 08 September 2018
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/ruan-jian-kai-fa">软件开发</a>.</p>

</footer><!-- /.post-info -->      <p>Author: Clément Verna</p>
<p><img alt="" src="/data/attachment/album/201809/08/083157eicjayyyy1a85q85.jpg"></p>
<p>Visual Studio Code，简称 VS Code，是一个开源的文本编辑器，包含用于构建和调试应用程序的工具。安装启用 Python 扩展后，VS Code 可以配置成理想的 Python 开发工作环境。本文将介绍一些有用的 VS Code 扩展，并配置它们以充分提高 Python 开发效率。</p>
<p>如果你的计算机上还没有安装 VS Code，可以参考文章 <a href="https://fedoramagazine.org/using-visual-studio-code-fedora/">在 Fedora 上使用 VS Code</a> 来安装。</p>
<h3>在 VS Code 中安装 Python 扩展</h3>
<p>首先，为了更方便地在 VS Code 中进行 Python 开发，需要从 VS Code 扩展商店中安装 Python 扩展。</p>
<p><img alt="" src="/data/attachment/album/201809/08/083158y9jgv3i2aghav5vz.gif"></p>
<p>Python 扩展安装完成后，就可以开始配置 Python 扩展了。</p>
<p>VS Code 通过两个 JSON 文件管理设置:</p>
<ul>
<li>一个文件用于 VS Code 的全局设置，作用于所有的项目</li>
<li>另一个文件用于特殊设置，作用于单独项目</li>
</ul>
<p>可以用快捷键 <code>Ctrl+,</code> （逗号）打开全局设置，也可以通过 <strong>文件 -&gt; 首选项 -&gt; 设置</strong> 来打开。</p>
<h4>设置 Python 路径</h4>
<p>您可以在全局设置中配置 <code>python.pythonPath</code> 使 VS Code 自动为每个项目选择最适合的 Python 解释器。</p>
<div class="highlight"><pre><span></span><code>//<span class="w"> </span>将设置放在此处以覆盖默认设置和用户设置。
//<span class="w"> </span>Path<span class="w"> </span>to<span class="w"> </span>Python,<span class="w"> </span>you<span class="w"> </span>can<span class="w"> </span>use<span class="w"> </span>a<span class="w"> </span>custom<span class="w"> </span>version<span class="w"> </span>of<span class="w"> </span>Python<span class="w"> </span>by<span class="w"> </span>modifying<span class="w"> </span>this<span class="w"> </span>setting<span class="w"> </span>to<span class="w"> </span>include<span class="w"> </span>the<span class="w"> </span>full<span class="w"> </span>path.
{
<span class="w">    </span>&quot;python.pythonPath&quot;:&quot;<span class="cp">${</span><span class="n">workspaceRoot</span><span class="cp">}</span>/.venv/bin/python&quot;,
}
</code></pre></div>

<p>这样，VS Code 将使用虚拟环境目录 <code>.venv</code> 下项目根目录中的 Python 解释器。</p>
<h4>使用环境变量</h4>
<p>默认情况下，VS Code 使用项目根目录下的 <code>.env</code> 文件中定义的环境变量。 这对于设置环境变量很有用，如：</p>
<div class="highlight"><pre><span></span><code>PYTHONWARNINGS=&quot;once&quot;
</code></pre></div>

<p>可使程序在运行时显示警告。</p>
<p>可以通过设置 <code>python.envFile</code> 来加载其他的默认环境变量文件：</p>
<div class="highlight"><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="n">Absolute</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">containing</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="n">definitions</span><span class="o">.</span>
<span class="s2">&quot;python.envFile&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;${workspaceFolder}/.env&quot;</span><span class="p">,</span>
</code></pre></div>

<h3>代码分析</h3>
<p>Python 扩展还支持不同的代码分析工具（pep8、flake8、pylint）。要启用你喜欢的或者正在进行的项目所使用的分析工具，只需要进行一些简单的配置。</p>
<p>扩展默认情况下使用 pylint 进行代码分析。你可以这样配置以使用 flake8 进行分析：</p>
<div class="highlight"><pre><span></span><code>&quot;python.linting.pylintEnabled&quot;:<span class="w"> </span>false,
&quot;python.linting.flake8Path&quot;:<span class="w"> </span>&quot;<span class="cp">${</span><span class="n">workspaceRoot</span><span class="cp">}</span>/.venv/bin/flake8&quot;,
&quot;python.linting.flake8Enabled&quot;:<span class="w"> </span>true,
&quot;python.linting.flake8Args&quot;:<span class="w"> </span>[&quot;--max-line-length=90&quot;],
</code></pre></div>

<p>启用代码分析后，分析器会在不符合要求的位置加上波浪线，鼠标置于该位置，将弹窗提示其原因。注意，项目的虚拟环境中需要安装有 flake8，此示例方能有效。</p>
<p><img alt="" src="/data/attachment/album/201809/08/083159kqn1le2220agsdhy.gif"></p>
<h3>格式化代码</h3>
<p>可以配置 VS Code 使其自动格式化代码。目前支持 autopep8、black 和 yapf。下面的设置将启用 “black” 模式。</p>
<div class="highlight"><pre><span></span><code>//<span class="w"> </span>Provider<span class="w"> </span>for<span class="w"> </span>formatting.<span class="w"> </span>Possible<span class="w"> </span>options<span class="w"> </span>include<span class="w"> </span>&#39;autopep8&#39;,<span class="w"> </span>&#39;black&#39;,<span class="w"> </span>and<span class="w"> </span>&#39;yapf&#39;.
&quot;python.formatting.provider&quot;:<span class="w"> </span>&quot;black&quot;,
&quot;python.formatting.blackPath&quot;:<span class="w"> </span>&quot;<span class="cp">${</span><span class="n">workspaceRoot</span><span class="cp">}</span>/.venv/bin/black&quot;
&quot;python.formatting.blackArgs&quot;:<span class="w"> </span>[&quot;--line-length=90&quot;],
&quot;editor.formatOnSave&quot;:<span class="w"> </span>true,
</code></pre></div>

<p>如果不需要编辑器在保存时自动格式化代码，可以将 <code>editor.formatOnSave</code> 设置为 <code>false</code> 并手动使用快捷键 <code>Ctrl + Shift + I</code> 格式化当前文档中的代码。 注意，项目的虚拟环境中需要安装有 black，此示例方能有效。</p>
<h3>运行任务</h3>
<p>VS Code 的一个重要特点是它可以运行任务。需要运行的任务保存在项目根目录中的 JSON 文件中。</p>
<h4>运行 flask 开发服务</h4>
<p>这个例子将创建一个任务来运行 Flask 开发服务器。 使用一个可以运行外部命令的基本模板来创建新的工程：</p>
<p><img alt="" src="/data/attachment/album/201809/08/083159mx9x9asgblrpaxb7.gif"></p>
<p>编辑如下所示的 <code>tasks.json</code> 文件，创建新任务来运行 Flask 开发服务：</p>
<div class="highlight"><pre><span></span><code>{
<span class="w">  </span>//<span class="w"> </span>See<span class="w"> </span>https://go.microsoft.com/fwlink/?LinkId=733558
<span class="w">  </span>//<span class="w"> </span>for<span class="w"> </span>the<span class="w"> </span>documentation<span class="w"> </span>about<span class="w"> </span>the<span class="w"> </span>tasks.json<span class="w"> </span>format
<span class="w">  </span>&quot;version&quot;:<span class="w"> </span>&quot;2.0.0&quot;,
<span class="w">  </span>&quot;tasks&quot;:<span class="w"> </span>[
<span class="w">    </span>{

<span class="w">      </span>&quot;label&quot;:<span class="w"> </span>&quot;Run<span class="w"> </span>Debug<span class="w"> </span>Server&quot;,
<span class="w">      </span>&quot;type&quot;:<span class="w"> </span>&quot;shell&quot;,
<span class="w">      </span>&quot;command&quot;:<span class="w"> </span>&quot;<span class="cp">${</span><span class="n">workspaceRoot</span><span class="cp">}</span>/.venv/bin/flask<span class="w"> </span>run<span class="w"> </span>-h<span class="w"> </span>0.0.0.0<span class="w"> </span>-p<span class="w"> </span>5000&quot;,
<span class="w">      </span>&quot;group&quot;:<span class="w"> </span>{
<span class="w">          </span>&quot;kind&quot;:<span class="w"> </span>&quot;build&quot;,
<span class="w">          </span>&quot;isDefault&quot;:<span class="w"> </span>true
<span class="w">       </span>}
<span class="w">    </span>}
<span class="w">  </span>]
}
</code></pre></div>

<p>Flask 开发服务使用环境变量来获取应用程序的入口点。 如 <strong>使用环境变量</strong> 一节所说，可以在 <code>.env</code> 文件中声明这些变量：</p>
<div class="highlight"><pre><span></span><code>FLASK_APP=wsgi.py
FLASK_DEBUG=True
</code></pre></div>

<p>这样就可以使用快捷键 <code>Ctrl + Shift + B</code> 来执行任务了。</p>
<h3>单元测试</h3>
<p>VS Code 还支持单元测试框架 pytest、unittest 和 nosetest。启用测试框架后，可以在 VS Code 中单独运行搜索到的单元测试，通过测试套件运行测试或者运行所有的测试。</p>
<p>例如，可以这样启用 pytest 测试框架：</p>
<div class="highlight"><pre><span></span><code>&quot;python.unitTest.pyTestEnabled&quot;:<span class="w"> </span>true,
&quot;python.unitTest.pyTestPath&quot;:<span class="w"> </span>&quot;<span class="cp">${</span><span class="n">workspaceRoot</span><span class="cp">}</span>/.venv/bin/pytest&quot;,
</code></pre></div>

<p>注意，项目的虚拟环境中需要安装有 pytest，此示例方能有效。</p>
<p><img alt="" src="/data/attachment/album/201809/08/083200aedrig7ii79tii3w.gif"></p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>