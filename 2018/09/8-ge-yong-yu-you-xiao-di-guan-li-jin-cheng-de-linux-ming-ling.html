<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>8 个用于有效地管理进程的 Linux 命令</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: Alan Formy-duval 通过这些关键的命令来全程管理你的应用。 一般来说，应用程序进程的生命周期有三种主要状态：启动、运行和停止 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li class="active"><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2018/09/8-ge-yong-yu-you-xiao-di-guan-li-jin-cheng-de-linux-ming-ling.html" rel="bookmark"
           title="Permalink to 8 个用于有效地管理进程的 Linux 命令">8 个用于有效地管理进程的 Linux 命令</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2018-09-16T22:53:23+02:00">
                Published: Sun 16 September 2018
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/ji-zhu">技术</a>.</p>

</footer><!-- /.post-info -->      <p>Author: Alan Formy-duval</p>
<blockquote>
<p>通过这些关键的命令来全程管理你的应用。</p>
</blockquote>
<p><img alt="" src="/data/attachment/album/201809/16/225342dggc8idpid9mpp85.png"></p>
<p>一般来说，应用程序进程的生命周期有三种主要状态：启动、运行和停止。如果我们想成为称职的管理员，每个状态都可以而且应该得到认真的管理。这八个命令可用于管理进程的整个生命周期。</p>
<h3>启动进程</h3>
<p>启动进程的最简单方法是在命令行中键入其名称，然后按回车键。如果要启动 Nginx web 服务器，请键入 <code>nginx</code> 。也许您只是想看看其版本。</p>
<div class="highlight"><pre><span></span><code><span class="n">alan</span><span class="nv">@workstation</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">nginx</span>

<span class="n">alan</span><span class="nv">@workstation</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">nginx</span><span class="w"> </span><span class="o">-</span><span class="n">v</span>
<span class="n">nginx</span><span class="w"> </span><span class="nl">version</span><span class="p">:</span><span class="w"> </span><span class="n">nginx</span><span class="o">/</span><span class="mf">1.14.0</span>
</code></pre></div>

<h3>查看您的可执行路径</h3>
<p>以上启动进程的演示是假设可执行文件位于您的可执行路径中。理解这个路径是可靠地启动和管理进程的关键。管理员通常会为他们想要的目的定制这条路径。您可以使用 <code>echo $PATH</code> 查看您的可执行路径。</p>
<div class="highlight"><pre><span></span><code><span class="n">alan</span><span class="nv">@workstation</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="err">$</span><span class="k">PATH</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="k">local</span><span class="o">/</span><span class="nl">sbin</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="k">local</span><span class="o">/</span><span class="nl">bin</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nl">sbin</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span>
</code></pre></div>

<h4>WHICH</h4>
<p>使用 <code>which</code> 命令查看可执行文件的完整路径。</p>
<div class="highlight"><pre><span></span><code><span class="n">alan</span><span class="nv">@workstation</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">nginx</span>
<span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">nginx</span>
</code></pre></div>

<p>我将使用流行的 web 服务器软件 Nginx 作为我的例子。假设安装了 Nginx。如果执行 <code>which nginx</code> 的命令什么也不返回，那么是找不到 Nginx 了，因为它只搜索您指定的可执行路径。有三种方法可以补救一个进程不能简单地通过名字启动的情况。首先是键入完整路径 —— 虽然，我不情愿输入全部路径，您会吗？</p>
<div class="highlight"><pre><span></span><code><span class="n">alan</span><span class="nv">@workstation</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">alan</span><span class="o">/</span><span class="n">web</span><span class="o">/</span><span class="n">prod</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nginx</span><span class="w"> </span><span class="o">-</span><span class="n">v</span>
<span class="n">nginx</span><span class="w"> </span><span class="nl">version</span><span class="p">:</span><span class="w"> </span><span class="n">nginx</span><span class="o">/</span><span class="mf">1.14.0</span>
</code></pre></div>

<p>第二个解决方案是将应用程序安装在可执行文件路径中的目录中。然而，这有时可能是办不到的，特别是如果您没有 root 权限。</p>
<p>第三个解决方案是更新您的可执行路径环境变量，包括要使用的特定应用程序的安装目录。这个解决方案是与 shell 相关的。例如，Bash 用户需要在他们的 <code>.bashrc</code> 文件中编辑 <code>PATH=</code> 行。</p>
<div class="highlight"><pre><span></span><code>PATH=&quot;$HOME/web/prod/nginx/sbin:$PATH&quot;
</code></pre></div>

<p>现在，重复您的 <code>echo</code> 和 <code>which</code> 命令或者尝试检查版本。容易多了！</p>
<div class="highlight"><pre><span></span><code><span class="n">alan</span><span class="nv">@workstation</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="err">$</span><span class="k">PATH</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">alan</span><span class="o">/</span><span class="n">web</span><span class="o">/</span><span class="n">prod</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="nl">sbin</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="k">local</span><span class="o">/</span><span class="nl">sbin</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="k">local</span><span class="o">/</span><span class="nl">bin</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nl">sbin</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span>

<span class="n">alan</span><span class="nv">@workstation</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">nginx</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">alan</span><span class="o">/</span><span class="n">web</span><span class="o">/</span><span class="n">prod</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nginx</span>

<span class="n">alan</span><span class="nv">@workstation</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">nginx</span><span class="w"> </span><span class="o">-</span><span class="n">v</span><span class="w">                                                </span>
<span class="n">nginx</span><span class="w"> </span><span class="nl">version</span><span class="p">:</span><span class="w"> </span><span class="n">nginx</span><span class="o">/</span><span class="mf">1.14.0</span>
</code></pre></div>

<h3>保持进程运行</h3>
<h4>NOHUP</h4>
<p>注销或关闭终端时，进程可能不会继续运行。这种特殊情况可以通过在要使用 <code>nohup</code> 命令放在要运行的命令前面让进程持续运行。此外，附加一个<code>&amp;</code> 符号将会把进程发送到后台，并允许您继续使用终端。例如，假设您想运行 <code>myprogram.sh</code> 。</p>
<div class="highlight"><pre><span></span><code>nohup myprogram.sh &amp;
</code></pre></div>

<p><code>nohup</code> 会返回运行进程的 PID。接下来我会更多地谈论 PID。</p>
<h3>管理正在运行的进程</h3>
<p>每个进程都有一个唯一的进程标识号 (PID) 。这个数字是我们用来管理每个进程的。我们还可以使用进程名称，我将在下面演示。有几个命令可以检查正在运行的进程的状态。让我们快速看看这些命令。</p>
<h4>PS</h4>
<p>最常见的是 <code>ps</code> 命令。<code>ps</code> 的默认输出是当前终端中运行的进程的简单列表。如下所示，第一列包含 PID。</p>
<div class="highlight"><pre><span></span><code><span class="n">alan</span><span class="nv">@workstation</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">ps</span>
<span class="n">PID</span><span class="w"> </span><span class="n">TTY</span><span class="w">          </span><span class="nc">TIME</span><span class="w"> </span><span class="n">CMD</span>
<span class="mi">23989</span><span class="w"> </span><span class="n">pts</span><span class="o">/</span><span class="mi">0</span><span class="w">    </span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="w"> </span><span class="n">bash</span>
<span class="mi">24148</span><span class="w"> </span><span class="n">pts</span><span class="o">/</span><span class="mi">0</span><span class="w">    </span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="w"> </span><span class="n">ps</span>
</code></pre></div>

<p>我想看看我之前启动的 Nginx 进程。为此，我告诉 <code>ps</code> 给我展示每一个正在运行的进程（<code>-e</code>）和完整的列表（<code>-f</code>）。</p>
<div class="highlight"><pre><span></span><code><span class="n">alan</span><span class="nv">@workstation</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">ps</span><span class="w"> </span><span class="o">-</span><span class="n">ef</span>
<span class="n">UID</span><span class="w">        </span><span class="n">PID</span><span class="w">  </span><span class="n">PPID</span><span class="w">  </span><span class="n">C</span><span class="w"> </span><span class="n">STIME</span><span class="w"> </span><span class="n">TTY</span><span class="w">          </span><span class="nc">TIME</span><span class="w"> </span><span class="n">CMD</span>
<span class="n">root</span><span class="w">         </span><span class="mi">1</span><span class="w">     </span><span class="mi">0</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="n">Aug18</span><span class="w"> </span><span class="vm">?</span><span class="w">        </span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="err">:</span><span class="mi">10</span><span class="w"> </span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">init</span><span class="w"> </span><span class="n">splash</span>
<span class="n">root</span><span class="w">         </span><span class="mi">2</span><span class="w">     </span><span class="mi">0</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="n">Aug18</span><span class="w"> </span><span class="vm">?</span><span class="w">        </span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="w"> </span><span class="o">[</span><span class="n">kthreadd</span><span class="o">]</span>
<span class="n">root</span><span class="w">         </span><span class="mi">4</span><span class="w">     </span><span class="mi">2</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="n">Aug18</span><span class="w"> </span><span class="vm">?</span><span class="w">        </span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="w"> </span><span class="o">[</span><span class="n">kworker/0:0H</span><span class="o">]</span>
<span class="n">root</span><span class="w">         </span><span class="mi">6</span><span class="w">     </span><span class="mi">2</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="n">Aug18</span><span class="w"> </span><span class="vm">?</span><span class="w">        </span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="w"> </span><span class="o">[</span><span class="n">mm_percpu_wq</span><span class="o">]</span>
<span class="n">root</span><span class="w">         </span><span class="mi">7</span><span class="w">     </span><span class="mi">2</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="n">Aug18</span><span class="w"> </span><span class="vm">?</span><span class="w">        </span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="w"> </span><span class="o">[</span><span class="n">ksoftirqd/0</span><span class="o">]</span>
<span class="n">root</span><span class="w">         </span><span class="mi">8</span><span class="w">     </span><span class="mi">2</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="n">Aug18</span><span class="w"> </span><span class="vm">?</span><span class="w">        </span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="err">:</span><span class="mi">20</span><span class="w"> </span><span class="o">[</span><span class="n">rcu_sched</span><span class="o">]</span>
<span class="n">root</span><span class="w">         </span><span class="mi">9</span><span class="w">     </span><span class="mi">2</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="n">Aug18</span><span class="w"> </span><span class="vm">?</span><span class="w">        </span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="w"> </span><span class="o">[</span><span class="n">rcu_bh</span><span class="o">]</span>
<span class="n">root</span><span class="w">        </span><span class="mi">10</span><span class="w">     </span><span class="mi">2</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="n">Aug18</span><span class="w"> </span><span class="vm">?</span><span class="w">        </span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="w"> </span><span class="o">[</span><span class="n">migration/0</span><span class="o">]</span>
<span class="n">root</span><span class="w">        </span><span class="mi">11</span><span class="w">     </span><span class="mi">2</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="n">Aug18</span><span class="w"> </span><span class="vm">?</span><span class="w">        </span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="w"> </span><span class="o">[</span><span class="n">watchdog/0</span><span class="o">]</span>
<span class="n">root</span><span class="w">        </span><span class="mi">12</span><span class="w">     </span><span class="mi">2</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="n">Aug18</span><span class="w"> </span><span class="vm">?</span><span class="w">        </span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="w"> </span><span class="o">[</span><span class="n">cpuhp/0</span><span class="o">]</span>
<span class="n">root</span><span class="w">        </span><span class="mi">13</span><span class="w">     </span><span class="mi">2</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="n">Aug18</span><span class="w"> </span><span class="vm">?</span><span class="w">        </span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="w"> </span><span class="o">[</span><span class="n">cpuhp/1</span><span class="o">]</span>
<span class="n">root</span><span class="w">        </span><span class="mi">14</span><span class="w">     </span><span class="mi">2</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="n">Aug18</span><span class="w"> </span><span class="vm">?</span><span class="w">        </span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="w"> </span><span class="o">[</span><span class="n">watchdog/1</span><span class="o">]</span>
<span class="n">root</span><span class="w">        </span><span class="mi">15</span><span class="w">     </span><span class="mi">2</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="n">Aug18</span><span class="w"> </span><span class="vm">?</span><span class="w">        </span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="w"> </span><span class="o">[</span><span class="n">migration/1</span><span class="o">]</span>
<span class="n">root</span><span class="w">        </span><span class="mi">16</span><span class="w">     </span><span class="mi">2</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="n">Aug18</span><span class="w"> </span><span class="vm">?</span><span class="w">        </span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="w"> </span><span class="o">[</span><span class="n">ksoftirqd/1</span><span class="o">]</span>
<span class="n">alan</span><span class="w">     </span><span class="mi">20506</span><span class="w"> </span><span class="mi">20496</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="mi">10</span><span class="err">:</span><span class="mi">39</span><span class="w"> </span><span class="n">pts</span><span class="o">/</span><span class="mi">0</span><span class="w">    </span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="w"> </span><span class="n">bash</span>
<span class="n">alan</span><span class="w">     </span><span class="mi">20520</span><span class="w">  </span><span class="mi">1454</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="mi">10</span><span class="err">:</span><span class="mi">39</span><span class="w"> </span><span class="vm">?</span><span class="w">        </span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="w"> </span><span class="nl">nginx</span><span class="p">:</span><span class="w"> </span><span class="n">master</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">nginx</span>
<span class="n">alan</span><span class="w">     </span><span class="mi">20521</span><span class="w"> </span><span class="mi">20520</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="mi">10</span><span class="err">:</span><span class="mi">39</span><span class="w"> </span><span class="vm">?</span><span class="w">        </span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="w"> </span><span class="nl">nginx</span><span class="p">:</span><span class="w"> </span><span class="n">worker</span><span class="w"> </span><span class="n">process</span>
<span class="n">alan</span><span class="w">     </span><span class="mi">20526</span><span class="w"> </span><span class="mi">20506</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="mi">10</span><span class="err">:</span><span class="mi">39</span><span class="w"> </span><span class="n">pts</span><span class="o">/</span><span class="mi">0</span><span class="w">    </span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="w"> </span><span class="n">man</span><span class="w"> </span><span class="n">ps</span>
<span class="n">alan</span><span class="w">     </span><span class="mi">20536</span><span class="w"> </span><span class="mi">20526</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="mi">10</span><span class="err">:</span><span class="mi">39</span><span class="w"> </span><span class="n">pts</span><span class="o">/</span><span class="mi">0</span><span class="w">    </span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="w"> </span><span class="n">pager</span>
<span class="n">alan</span><span class="w">     </span><span class="mi">20564</span><span class="w"> </span><span class="mi">20496</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="mi">10</span><span class="err">:</span><span class="mi">40</span><span class="w"> </span><span class="n">pts</span><span class="o">/</span><span class="mi">1</span><span class="w">    </span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="w"> </span><span class="n">bash</span>
</code></pre></div>

<p>您可以在上面 <code>ps</code> 命令的输出中看到 Nginx 进程。这个命令显示了将近 300 行，但是我在这个例子中缩短了它。可以想象，试图处理 300 行过程信息有点混乱。我们可以将这个输出输送到 <code>grep</code>，过滤一下仅显示 nginx。</p>
<div class="highlight"><pre><span></span><code><span class="n">alan</span><span class="nv">@workstation</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">ps</span><span class="w"> </span><span class="o">-</span><span class="n">ef</span><span class="w"> </span><span class="o">|</span><span class="n">grep</span><span class="w"> </span><span class="n">nginx</span>
<span class="n">alan</span><span class="w">     </span><span class="mi">20520</span><span class="w">  </span><span class="mi">1454</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="mi">10</span><span class="err">:</span><span class="mi">39</span><span class="w"> </span><span class="vm">?</span><span class="w">        </span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="w"> </span><span class="nl">nginx</span><span class="p">:</span><span class="w"> </span><span class="n">master</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">nginx</span>
<span class="n">alan</span><span class="w">     </span><span class="mi">20521</span><span class="w"> </span><span class="mi">20520</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="mi">10</span><span class="err">:</span><span class="mi">39</span><span class="w"> </span><span class="vm">?</span><span class="w">        </span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="w"> </span><span class="nl">nginx</span><span class="p">:</span><span class="w"> </span><span class="n">worker</span><span class="w"> </span><span class="n">process</span>
</code></pre></div>

<p>确实更好了。我们可以很快看到，Nginx 有 20520 和 20521 的 PID。</p>
<h4>PGREP</h4>
<p><code>pgrep</code> 命令更加简化单独调用 <code>grep</code> 遇到的问题。</p>
<div class="highlight"><pre><span></span><code><span class="n">alan</span><span class="nv">@workstation</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">pgrep</span><span class="w"> </span><span class="n">nginx</span>
<span class="mi">20520</span>
<span class="mi">20521</span>
</code></pre></div>

<p>假设您在一个托管环境中，多个用户正在运行几个不同的 Nginx 实例。您可以使用 <code>-u</code> 选项将其他人排除在输出之外。</p>
<div class="highlight"><pre><span></span><code><span class="n">alan</span><span class="nv">@workstation</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">pgrep</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">alan</span><span class="w"> </span><span class="n">nginx</span>
<span class="mi">20520</span>
<span class="mi">20521</span>
</code></pre></div>

<h4>PIDOF</h4>
<p>另一个好用的是 <code>pidof</code>。此命令将检查特定二进制文件的 PID，即使另一个同名进程正在运行。为了建立一个例子，我将我的 Nginx 复制到第二个目录，并以相应的路径前缀启动。在现实生活中，这个实例可能位于不同的位置，例如由不同用户拥有的目录。如果我运行两个 Nginx 实例，则<code>pidof</code> 输出显示它们的所有进程。</p>
<div class="highlight"><pre><span></span><code><span class="n">alan</span><span class="nv">@workstation</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">ps</span><span class="w"> </span><span class="o">-</span><span class="n">ef</span><span class="w"> </span><span class="o">|</span><span class="n">grep</span><span class="w"> </span><span class="n">nginx</span>
<span class="n">alan</span><span class="w">     </span><span class="mi">20881</span><span class="w">  </span><span class="mi">1454</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="mi">11</span><span class="err">:</span><span class="mi">18</span><span class="w"> </span><span class="vm">?</span><span class="w">        </span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="w"> </span><span class="nl">nginx</span><span class="p">:</span><span class="w"> </span><span class="n">master</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">nginx</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">alan</span><span class="o">/</span><span class="n">web</span><span class="o">/</span><span class="n">prod</span><span class="o">/</span><span class="n">nginxsec</span>
<span class="n">alan</span><span class="w">     </span><span class="mi">20882</span><span class="w"> </span><span class="mi">20881</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="mi">11</span><span class="err">:</span><span class="mi">18</span><span class="w"> </span><span class="vm">?</span><span class="w">        </span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="w"> </span><span class="nl">nginx</span><span class="p">:</span><span class="w"> </span><span class="n">worker</span><span class="w"> </span><span class="n">process</span>
<span class="n">alan</span><span class="w">     </span><span class="mi">20895</span><span class="w">  </span><span class="mi">1454</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="mi">11</span><span class="err">:</span><span class="mi">19</span><span class="w"> </span><span class="vm">?</span><span class="w">        </span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="w"> </span><span class="nl">nginx</span><span class="p">:</span><span class="w"> </span><span class="n">master</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">nginx</span>
<span class="n">alan</span><span class="w">     </span><span class="mi">20896</span><span class="w"> </span><span class="mi">20895</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="mi">11</span><span class="err">:</span><span class="mi">19</span><span class="w"> </span><span class="vm">?</span><span class="w">        </span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="err">:</span><span class="mi">00</span><span class="w"> </span><span class="nl">nginx</span><span class="p">:</span><span class="w"> </span><span class="n">worker</span><span class="w"> </span><span class="n">process</span>
</code></pre></div>

<p>使用 <code>grep</code> 或 <code>pgrep</code> 将显示 PID 数字，但我们可能无法辨别哪个实例是哪个。</p>
<div class="highlight"><pre><span></span><code><span class="n">alan</span><span class="nv">@workstation</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">pgrep</span><span class="w"> </span><span class="n">nginx</span>
<span class="mi">20881</span>
<span class="mi">20882</span>
<span class="mi">20895</span>
<span class="mi">20896</span>
</code></pre></div>

<p><code>pidof</code> 命令可用于确定每个特定 Nginx 实例的 PID。</p>
<div class="highlight"><pre><span></span><code><span class="n">alan</span><span class="nv">@workstation</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">pidof</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">alan</span><span class="o">/</span><span class="n">web</span><span class="o">/</span><span class="n">prod</span><span class="o">/</span><span class="n">nginxsec</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nginx</span>
<span class="mi">20882</span><span class="w"> </span><span class="mi">20881</span>

<span class="n">alan</span><span class="nv">@workstation</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">pidof</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">alan</span><span class="o">/</span><span class="n">web</span><span class="o">/</span><span class="n">prod</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nginx</span>
<span class="mi">20896</span><span class="w"> </span><span class="mi">20895</span>
</code></pre></div>

<h4>TOP</h4>
<p><code>top</code> 命令已经有很久的历史了，对于查看运行进程的细节和快速识别内存消耗等问题是非常有用的。其默认视图如下所示。</p>
<div class="highlight"><pre><span></span><code><span class="n">top</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">11</span><span class="p">:</span><span class="mi">56</span><span class="p">:</span><span class="mi">28</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">day</span><span class="p">,</span><span class="w"> </span><span class="mi">13</span><span class="p">:</span><span class="mi">37</span><span class="p">,</span><span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="n">user</span><span class="p">,</span><span class="w">  </span><span class="nb">load</span><span class="w"> </span><span class="n">average</span><span class="p">:</span><span class="w"> </span><span class="mf">0.09</span><span class="p">,</span><span class="w"> </span><span class="mf">0.04</span><span class="p">,</span><span class="w"> </span><span class="mf">0.03</span>
<span class="n">Tasks</span><span class="p">:</span><span class="w"> </span><span class="mi">292</span><span class="w"> </span><span class="n">total</span><span class="p">,</span><span class="w">   </span><span class="mi">3</span><span class="w"> </span><span class="n">running</span><span class="p">,</span><span class="w"> </span><span class="mi">225</span><span class="w"> </span><span class="n">sleeping</span><span class="p">,</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="n">stopped</span><span class="p">,</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="n">zombie</span>
<span class="o">%</span><span class="n">Cpu</span><span class="p">(</span><span class="n">s</span><span class="p">):</span><span class="w">  </span><span class="mf">0.1</span><span class="w"> </span><span class="n">us</span><span class="p">,</span><span class="w">  </span><span class="mf">0.2</span><span class="w"> </span><span class="n">sy</span><span class="p">,</span><span class="w">  </span><span class="mf">0.0</span><span class="w"> </span><span class="n">ni</span><span class="p">,</span><span class="w"> </span><span class="mf">99.7</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w">  </span><span class="mf">0.0</span><span class="w"> </span><span class="n">wa</span><span class="p">,</span><span class="w">  </span><span class="mf">0.0</span><span class="w"> </span><span class="n">hi</span><span class="p">,</span><span class="w">  </span><span class="mf">0.0</span><span class="w"> </span><span class="n">si</span><span class="p">,</span><span class="w">  </span><span class="mf">0.0</span><span class="w"> </span><span class="n">st</span>
<span class="n">KiB</span><span class="w"> </span><span class="n">Mem</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">16387132</span><span class="w"> </span><span class="n">total</span><span class="p">,</span><span class="w"> </span><span class="mi">10854648</span><span class="w"> </span><span class="n">free</span><span class="p">,</span><span class="w">  </span><span class="mi">1859036</span><span class="w"> </span><span class="n">used</span><span class="p">,</span><span class="w">  </span><span class="mi">3673448</span><span class="w"> </span><span class="n">buff</span><span class="o">/</span><span class="n">cache</span>
<span class="n">KiB</span><span class="w"> </span><span class="n">Swap</span><span class="p">:</span><span class="w">        </span><span class="mi">0</span><span class="w"> </span><span class="n">total</span><span class="p">,</span><span class="w">        </span><span class="mi">0</span><span class="w"> </span><span class="n">free</span><span class="p">,</span><span class="w">        </span><span class="mi">0</span><span class="w"> </span><span class="n">used</span><span class="o">.</span><span class="w"> </span><span class="mi">14176540</span><span class="w"> </span><span class="n">avail</span><span class="w"> </span><span class="n">Mem</span>

<span class="w">  </span><span class="n">PID</span><span class="w"> </span><span class="n">USER</span><span class="w">      </span><span class="n">PR</span><span class="w">  </span><span class="n">NI</span><span class="w">    </span><span class="n">VIRT</span><span class="w">    </span><span class="n">RES</span><span class="w">    </span><span class="n">SHR</span><span class="w"> </span><span class="n">S</span><span class="w">  </span><span class="o">%</span><span class="n">CPU</span><span class="w"> </span><span class="o">%</span><span class="n">MEM</span><span class="w">     </span><span class="n">TIME</span><span class="o">+</span><span class="w"> </span><span class="n">COMMAND</span>
<span class="mi">17270</span><span class="w"> </span><span class="n">alan</span><span class="w">      </span><span class="mi">20</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="mi">3930764</span><span class="w"> </span><span class="mi">247288</span><span class="w">  </span><span class="mi">98992</span><span class="w"> </span><span class="n">R</span><span class="w">   </span><span class="mf">0.7</span><span class="w">  </span><span class="mf">1.5</span><span class="w">   </span><span class="mi">5</span><span class="p">:</span><span class="mf">58.22</span><span class="w"> </span><span class="n">gnome</span><span class="o">-</span><span class="n">shell</span>
<span class="mi">20496</span><span class="w"> </span><span class="n">alan</span><span class="w">      </span><span class="mi">20</span><span class="w">   </span><span class="mi">0</span><span class="w">  </span><span class="mi">816144</span><span class="w">  </span><span class="mi">45416</span><span class="w">  </span><span class="mi">29844</span><span class="w"> </span><span class="n">S</span><span class="w">   </span><span class="mf">0.5</span><span class="w">  </span><span class="mf">0.3</span><span class="w">   </span><span class="mi">0</span><span class="p">:</span><span class="mf">22.16</span><span class="w"> </span><span class="n">gnome</span><span class="o">-</span><span class="n">terminal</span><span class="o">-</span>
<span class="mi">21110</span><span class="w"> </span><span class="n">alan</span><span class="w">      </span><span class="mi">20</span><span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="mi">41940</span><span class="w">   </span><span class="mi">3988</span><span class="w">   </span><span class="mi">3188</span><span class="w"> </span><span class="n">R</span><span class="w">   </span><span class="mf">0.1</span><span class="w">  </span><span class="mf">0.0</span><span class="w">   </span><span class="mi">0</span><span class="p">:</span><span class="mf">00.17</span><span class="w"> </span><span class="n">top</span>
<span class="w">    </span><span class="mi">1</span><span class="w"> </span><span class="n">root</span><span class="w">      </span><span class="mi">20</span><span class="w">   </span><span class="mi">0</span><span class="w">  </span><span class="mi">225564</span><span class="w">   </span><span class="mi">9416</span><span class="w">   </span><span class="mi">6768</span><span class="w"> </span><span class="n">S</span><span class="w">   </span><span class="mf">0.0</span><span class="w">  </span><span class="mf">0.1</span><span class="w">   </span><span class="mi">0</span><span class="p">:</span><span class="mf">10.72</span><span class="w"> </span><span class="n">systemd</span>
<span class="w">    </span><span class="mi">2</span><span class="w"> </span><span class="n">root</span><span class="w">      </span><span class="mi">20</span><span class="w">   </span><span class="mi">0</span><span class="w">       </span><span class="mi">0</span><span class="w">      </span><span class="mi">0</span><span class="w">      </span><span class="mi">0</span><span class="w"> </span><span class="n">S</span><span class="w">   </span><span class="mf">0.0</span><span class="w">  </span><span class="mf">0.0</span><span class="w">   </span><span class="mi">0</span><span class="p">:</span><span class="mf">00.01</span><span class="w"> </span><span class="n">kthreadd</span>
<span class="w">    </span><span class="mi">4</span><span class="w"> </span><span class="n">root</span><span class="w">       </span><span class="mi">0</span><span class="w"> </span><span class="o">-</span><span class="mi">20</span><span class="w">       </span><span class="mi">0</span><span class="w">      </span><span class="mi">0</span><span class="w">      </span><span class="mi">0</span><span class="w"> </span><span class="n">I</span><span class="w">   </span><span class="mf">0.0</span><span class="w">  </span><span class="mf">0.0</span><span class="w">   </span><span class="mi">0</span><span class="p">:</span><span class="mf">00.00</span><span class="w"> </span><span class="n">kworker</span><span class="o">/</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="n">H</span>
<span class="w">    </span><span class="mi">6</span><span class="w"> </span><span class="n">root</span><span class="w">       </span><span class="mi">0</span><span class="w"> </span><span class="o">-</span><span class="mi">20</span><span class="w">       </span><span class="mi">0</span><span class="w">      </span><span class="mi">0</span><span class="w">      </span><span class="mi">0</span><span class="w"> </span><span class="n">I</span><span class="w">   </span><span class="mf">0.0</span><span class="w">  </span><span class="mf">0.0</span><span class="w">   </span><span class="mi">0</span><span class="p">:</span><span class="mf">00.00</span><span class="w"> </span><span class="n">mm_percpu_wq</span>
<span class="w">    </span><span class="mi">7</span><span class="w"> </span><span class="n">root</span><span class="w">      </span><span class="mi">20</span><span class="w">   </span><span class="mi">0</span><span class="w">       </span><span class="mi">0</span><span class="w">      </span><span class="mi">0</span><span class="w">      </span><span class="mi">0</span><span class="w"> </span><span class="n">S</span><span class="w">   </span><span class="mf">0.0</span><span class="w">  </span><span class="mf">0.0</span><span class="w">   </span><span class="mi">0</span><span class="p">:</span><span class="mf">00.08</span><span class="w"> </span><span class="n">ksoftirqd</span><span class="o">/</span><span class="mi">0</span>
</code></pre></div>

<p>可以通过键入字母 <code>s</code> 和您喜欢的更新秒数来更改更新间隔。为了更容易监控我们的示例 Nginx 进程，我们可以使用 <code>-p</code> 选项并传递 PID 来调用 <code>top</code>。这个输出要干净得多。</p>
<div class="highlight"><pre><span></span><code><span class="n">alan</span><span class="p">@</span><span class="n">workstation</span><span class="p">:</span><span class="o">~</span>$<span class="w"> </span><span class="n">top</span><span class="w"> </span><span class="o">-</span><span class="n">p20881</span><span class="w"> </span><span class="o">-</span><span class="n">p20882</span><span class="w"> </span><span class="o">-</span><span class="n">p20895</span><span class="w"> </span><span class="o">-</span><span class="n">p20896</span>

<span class="n">Tasks</span><span class="p">:</span><span class="w">   </span><span class="mi">4</span><span class="w"> </span><span class="n">total</span><span class="p">,</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="n">running</span><span class="p">,</span><span class="w">   </span><span class="mi">4</span><span class="w"> </span><span class="n">sleeping</span><span class="p">,</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="n">stopped</span><span class="p">,</span><span class="w">   </span><span class="mi">0</span><span class="w"> </span><span class="n">zombie</span>
<span class="c">%Cpu(s):  2.8 us,  1.3 sy,  0.0 ni, 95.9 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span>
<span class="n">KiB</span><span class="w"> </span><span class="s">Mem</span><span class="w"> </span><span class="s">:</span><span class="w"> </span><span class="s">16387132</span><span class="w"> </span><span class="s">total,</span><span class="w"> </span><span class="s">10856008</span><span class="w"> </span><span class="s">free,</span><span class="w">  </span><span class="s">1857648</span><span class="w"> </span><span class="s">used,</span><span class="w">  </span><span class="s">3673476</span><span class="w"> </span><span class="s">buff/cache</span>
<span class="n">KiB</span><span class="w"> </span><span class="s">Swap:</span><span class="w">        </span><span class="s">0</span><span class="w"> </span><span class="s">total,</span><span class="w">        </span><span class="s">0</span><span class="w"> </span><span class="s">free,</span><span class="w">        </span><span class="s">0</span><span class="w"> </span><span class="s">used.</span><span class="w"> </span><span class="s">14177928</span><span class="w"> </span><span class="s">avail</span><span class="w"> </span><span class="s">Mem</span>

<span class="w">  </span><span class="n">PID</span><span class="w"> </span><span class="n">USER</span><span class="w">      </span><span class="n">PR</span><span class="w">  </span><span class="n">NI</span><span class="w">    </span><span class="n">VIRT</span><span class="w">    </span><span class="n">RES</span><span class="w">    </span><span class="n">SHR</span><span class="w"> </span><span class="n">S</span><span class="w">  </span><span class="c">%CPU %MEM     TIME+ COMMAND</span>
<span class="n">20881</span><span class="w"> </span><span class="s">alan</span><span class="w">      </span><span class="s">20</span><span class="w">   </span><span class="s">0</span><span class="w">   </span><span class="s">12016</span><span class="w">    </span><span class="s">348</span><span class="w">      </span><span class="s">0</span><span class="w"> </span><span class="s">S</span><span class="w">   </span><span class="s">0.0</span><span class="w">  </span><span class="s">0.0</span><span class="w">   </span><span class="s">0:00.00</span><span class="w"> </span><span class="s">nginx</span>
<span class="n">20882</span><span class="w"> </span><span class="s">alan</span><span class="w">      </span><span class="s">20</span><span class="w">   </span><span class="s">0</span><span class="w">   </span><span class="s">12460</span><span class="w">   </span><span class="s">1644</span><span class="w">    </span><span class="s">932</span><span class="w"> </span><span class="s">S</span><span class="w">   </span><span class="s">0.0</span><span class="w">  </span><span class="s">0.0</span><span class="w">   </span><span class="s">0:00.00</span><span class="w"> </span><span class="s">nginx</span>
<span class="n">20895</span><span class="w"> </span><span class="s">alan</span><span class="w">      </span><span class="s">20</span><span class="w">   </span><span class="s">0</span><span class="w">   </span><span class="s">12016</span><span class="w">    </span><span class="s">352</span><span class="w">      </span><span class="s">0</span><span class="w"> </span><span class="s">S</span><span class="w">   </span><span class="s">0.0</span><span class="w">  </span><span class="s">0.0</span><span class="w">   </span><span class="s">0:00.00</span><span class="w"> </span><span class="s">nginx</span>
<span class="n">20896</span><span class="w"> </span><span class="s">alan</span><span class="w">      </span><span class="s">20</span><span class="w">   </span><span class="s">0</span><span class="w">   </span><span class="s">12460</span><span class="w">   </span><span class="s">1628</span><span class="w">    </span><span class="s">912</span><span class="w"> </span><span class="s">S</span><span class="w">   </span><span class="s">0.0</span><span class="w">  </span><span class="s">0.0</span><span class="w">   </span><span class="s">0:00.00</span><span class="w"> </span><span class="s">nginx</span>
</code></pre></div>

<p>在管理进程，特别是终止进程时，正确确定 PID 是非常重要。此外，如果以这种方式使用 <code>top</code>，每当这些进程中的一个停止或一个新进程开始时，<code>top</code> 都需要被告知有新的进程。</p>
<h3>终止进程</h3>
<h4>KILL</h4>
<p>有趣的是，没有 <code>stop</code> 命令。在 Linux 中，有 <code>kill</code> 命令。<code>kill</code> 用于向进程发送信号。最常用的信号是“终止”（<code>SIGTERM</code>）或“杀死”（<code>SIGKILL</code>）。然而，还有更多。下面是一些例子。完整的列表可以用 <code>kill -L</code> 显示。</p>
<div class="highlight"><pre><span></span><code> 1) SIGHUP       2) SIGINT       3) SIGQUIT      4) SIGILL       5) SIGTRAP
 6) SIGABRT      7) SIGBUS       8) SIGFPE       9) SIGKILL     10) SIGUSR1
11) SIGSEGV     12) SIGUSR2     13) SIGPIPE     14) SIGALRM     15) SIGTERM
</code></pre></div>

<p>注意第 9 号信号是 <code>SIGKILL</code>，通常，我们会发出比如 <code>kill -9 20896</code> 这样的命令。默认信号是 15，这是 <code>SIGTERM</code>。请记住，许多应用程序都有自己的停止方法。Nginx 使用 <code>-s</code> 选项传递信号，如 <code>stop</code> 或 <code>reload</code>。通常，我更喜欢使用应用程序的特定方法来停止操作。然而，我将演示用 <code>kill</code> 命令来停止 Nginx 进程 20896，然后用 <code>pgrep</code> 确认它已经停止。PID 20896 就不再出现。</p>
<div class="highlight"><pre><span></span><code><span class="n">alan</span><span class="nv">@workstation</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="k">kill</span><span class="w"> </span><span class="o">-</span><span class="mi">9</span><span class="w"> </span><span class="mi">20896</span>

<span class="n">alan</span><span class="nv">@workstation</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">pgrep</span><span class="w"> </span><span class="n">nginx</span>
<span class="mi">20881</span>
<span class="mi">20882</span>
<span class="mi">20895</span>
<span class="mi">22123</span>
</code></pre></div>

<h4>PKILL</h4>
<p>命令 <code>pkill</code> 类似于 <code>pgrep</code>，因为它可以按名称搜索。这意味着在使用 <code>pkill</code> 时必须非常小心。在我的 Nginx 示例中，如果我只想杀死一个 Nginx 实例，我可能不会选择使用它。我可以将 Nginx 选项 <code>-s stop</code> 传递给特定的实例来消除它，或者我需要使用 <code>grep</code> 来过滤整个 <code>ps</code> 输出。</p>
<div class="highlight"><pre><span></span><code>/home/alan/web/prod/nginx/sbin/nginx -s stop
/home/alan/web/prod/nginxsec/sbin/nginx -s stop
</code></pre></div>

<p>如果我想使用 <code>pkill</code>，我可以包括 <code>-f</code> 选项，让 <code>pkill</code> 过滤整个命令行参数。这当然也适用于 <code>pgrep</code>。所以，在执行 <code>pkill -f</code> 之前，首先我可以用 <code>pgrep -a</code> 确认一下。</p>
<div class="highlight"><pre><span></span><code><span class="n">alan</span><span class="nv">@workstation</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">pgrep</span><span class="w"> </span><span class="o">-</span><span class="n">a</span><span class="w"> </span><span class="n">nginx</span>
<span class="mi">20881</span><span class="w"> </span><span class="nl">nginx</span><span class="p">:</span><span class="w"> </span><span class="n">master</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">nginx</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">alan</span><span class="o">/</span><span class="n">web</span><span class="o">/</span><span class="n">prod</span><span class="o">/</span><span class="n">nginxsec</span>
<span class="mi">20882</span><span class="w"> </span><span class="nl">nginx</span><span class="p">:</span><span class="w"> </span><span class="n">worker</span><span class="w"> </span><span class="n">process</span>
<span class="mi">20895</span><span class="w"> </span><span class="nl">nginx</span><span class="p">:</span><span class="w"> </span><span class="n">master</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">nginx</span>
<span class="mi">20896</span><span class="w"> </span><span class="nl">nginx</span><span class="p">:</span><span class="w"> </span><span class="n">worker</span><span class="w"> </span><span class="n">process</span>
</code></pre></div>

<p>我也可以用 <code>pgrep -f</code> 缩小我的结果。<code>pkill</code> 使用相同参数会停止该进程。</p>
<div class="highlight"><pre><span></span><code><span class="n">alan</span><span class="nv">@workstation</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">pgrep</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="n">nginxsec</span>
<span class="mi">20881</span>

<span class="n">alan</span><span class="nv">@workstation</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">pkill</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="n">nginxsec</span>
</code></pre></div>

<p><code>pgrep</code>（尤其是 <code>pkill</code>）要记住的关键点是，您必须始终确保搜索结果准确性，这样您就不会无意中影响到错误的进程。</p>
<p>大多数这些命令都有许多命令行选项，所以我总是建议阅读每一个命令的 <a href="https://www.kernel.org/doc/man-pages/">man 手册页</a>。虽然大多数这些命令都存在于 Linux、Solaris 和 BSD 等平台上，但也有一些不同之处。在命令行工作或编写脚本时，始终测试并随时准备根据需要进行更正。</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>