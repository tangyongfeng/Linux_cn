<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>如何在 Linux 上使用 tcpdump 命令捕获和分析数据包</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: Pradeep Kumar tcpdump 是一个有名的命令行数据包分析工具。我们可以使用 tcpdump 命令捕获实时 TCP/IP 数据包，这些数据包也可以保存到文 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li class="active"><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2018/09/ru-he-zai-linux-shang-shi-yong-tcpdump-ming-ling-bu-huo-he-fen-xi-shu-ju-bao.html" rel="bookmark"
           title="Permalink to 如何在 Linux 上使用 tcpdump 命令捕获和分析数据包">如何在 Linux 上使用 tcpdump 命令捕获和分析数据包</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2018-09-26T09:54:19+02:00">
                Published: Wed 26 September 2018
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/ji-zhu">技术</a>.</p>

</footer><!-- /.post-info -->      <p>Author: Pradeep Kumar</p>
<p><code>tcpdump</code> 是一个有名的命令行<strong>数据包分析</strong>工具。我们可以使用 <code>tcpdump</code> 命令捕获实时 TCP/IP 数据包，这些数据包也可以保存到文件中。之后这些捕获的数据包可以通过 <code>tcpdump</code> 命令进行分析。<code>tcpdump</code> 命令在网络层面进行故障排除时变得非常方便。</p>
<p><img alt="" src="/data/attachment/album/201809/26/095401iiqgbp66jdzu1o6d.jpg"></p>
<p><code>tcpdump</code> 在大多数 Linux 发行版中都能用，对于基于 Debian 的Linux，可以使用 <code>apt</code> 命令安装它。</p>
<div class="highlight"><pre><span></span><code># apt install tcpdump -y
</code></pre></div>

<p>在基于 RPM 的 Linux 操作系统上，可以使用下面的 <code>yum</code> 命令安装 <code>tcpdump</code>。</p>
<div class="highlight"><pre><span></span><code># yum install tcpdump -y
</code></pre></div>

<p>当我们在没用任何选项的情况下运行 <code>tcpdump</code> 命令时，它将捕获所有接口的数据包。因此，要停止或取消 <code>tcpdump</code> 命令，请键入 <code>ctrl+c</code>。在本教程中，我们将使用不同的实例来讨论如何捕获和分析数据包。</p>
<h3>示例：1）从特定接口捕获数据包</h3>
<p>当我们在没用任何选项的情况下运行 <code>tcpdump</code> 命令时，它将捕获所有接口上的数据包，因此，要从特定接口捕获数据包，请使用选项 <code>-i</code>，后跟接口名称。</p>
<p>语法：</p>
<div class="highlight"><pre><span></span><code># tcpdump -i {接口名}
</code></pre></div>

<p>假设我想从接口 <code>enp0s3</code> 捕获数据包。</p>
<p>输出将如下所示，</p>
<div class="highlight"><pre><span></span><code><span class="nl">tcpdump</span><span class="p">:</span><span class="w"> </span><span class="n">verbose</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">suppressed</span><span class="p">,</span><span class="w"> </span><span class="n">use</span><span class="w"> </span><span class="o">-</span><span class="n">v</span><span class="w"> </span><span class="n">or</span><span class="w"> </span><span class="o">-</span><span class="n">vv</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">full</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">decode</span>
<span class="n">listening</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">enp0s3</span><span class="p">,</span><span class="w"> </span><span class="n">link</span><span class="o">-</span><span class="n">type</span><span class="w"> </span><span class="n">EN10MB</span><span class="w"> </span><span class="p">(</span><span class="n">Ethernet</span><span class="p">),</span><span class="w"> </span><span class="n">capture</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="mi">262144</span><span class="w"> </span><span class="n">bytes</span>
<span class="mo">06</span><span class="o">:</span><span class="mi">43</span><span class="o">:</span><span class="mf">22.905890</span><span class="w"> </span><span class="n">IP</span><span class="w"> </span><span class="n">compute</span><span class="mi">-0</span><span class="mf">-1.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="p">.</span><span class="n">ssh</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">169.144.0.1.39374</span><span class="o">:</span><span class="w"> </span><span class="n">Flags</span><span class="w"> </span><span class="p">[</span><span class="n">P</span><span class="p">.],</span><span class="w"> </span><span class="n">seq</span><span class="w"> </span><span class="mi">21952160</span><span class="o">:</span><span class="mi">21952540</span><span class="p">,</span><span class="w"> </span><span class="n">ack</span><span class="w"> </span><span class="mi">13537</span><span class="p">,</span><span class="w"> </span><span class="n">win</span><span class="w"> </span><span class="mi">291</span><span class="p">,</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">[</span><span class="n">nop</span><span class="p">,</span><span class="n">nop</span><span class="p">,</span><span class="n">TS</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="mi">26164373</span><span class="w"> </span><span class="n">ecr</span><span class="w"> </span><span class="mi">6580205</span><span class="p">],</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="mi">380</span>
<span class="mo">06</span><span class="o">:</span><span class="mi">43</span><span class="o">:</span><span class="mf">22.906045</span><span class="w"> </span><span class="n">IP</span><span class="w"> </span><span class="n">compute</span><span class="mi">-0</span><span class="mf">-1.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="p">.</span><span class="n">ssh</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">169.144.0.1.39374</span><span class="o">:</span><span class="w"> </span><span class="n">Flags</span><span class="w"> </span><span class="p">[</span><span class="n">P</span><span class="p">.],</span><span class="w"> </span><span class="n">seq</span><span class="w"> </span><span class="mi">21952540</span><span class="o">:</span><span class="mi">21952760</span><span class="p">,</span><span class="w"> </span><span class="n">ack</span><span class="w"> </span><span class="mi">13537</span><span class="p">,</span><span class="w"> </span><span class="n">win</span><span class="w"> </span><span class="mi">291</span><span class="p">,</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">[</span><span class="n">nop</span><span class="p">,</span><span class="n">nop</span><span class="p">,</span><span class="n">TS</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="mi">26164373</span><span class="w"> </span><span class="n">ecr</span><span class="w"> </span><span class="mi">6580205</span><span class="p">],</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="mi">220</span>
<span class="mo">06</span><span class="o">:</span><span class="mi">43</span><span class="o">:</span><span class="mf">22.906150</span><span class="w"> </span><span class="n">IP</span><span class="w"> </span><span class="n">compute</span><span class="mi">-0</span><span class="mf">-1.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="p">.</span><span class="n">ssh</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">169.144.0.1.39374</span><span class="o">:</span><span class="w"> </span><span class="n">Flags</span><span class="w"> </span><span class="p">[</span><span class="n">P</span><span class="p">.],</span><span class="w"> </span><span class="n">seq</span><span class="w"> </span><span class="mi">21952760</span><span class="o">:</span><span class="mi">21952980</span><span class="p">,</span><span class="w"> </span><span class="n">ack</span><span class="w"> </span><span class="mi">13537</span><span class="p">,</span><span class="w"> </span><span class="n">win</span><span class="w"> </span><span class="mi">291</span><span class="p">,</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">[</span><span class="n">nop</span><span class="p">,</span><span class="n">nop</span><span class="p">,</span><span class="n">TS</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="mi">26164373</span><span class="w"> </span><span class="n">ecr</span><span class="w"> </span><span class="mi">6580205</span><span class="p">],</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="mi">220</span>
<span class="mo">06</span><span class="o">:</span><span class="mi">43</span><span class="o">:</span><span class="mf">22.906291</span><span class="w"> </span><span class="n">IP</span><span class="w"> </span><span class="mf">169.144.0.1.39374</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">compute</span><span class="mi">-0</span><span class="mf">-1.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="p">.</span><span class="n">ssh</span><span class="o">:</span><span class="w"> </span><span class="n">Flags</span><span class="w"> </span><span class="p">[.],</span><span class="w"> </span><span class="n">ack</span><span class="w"> </span><span class="mi">21952980</span><span class="p">,</span><span class="w"> </span><span class="n">win</span><span class="w"> </span><span class="mi">13094</span><span class="p">,</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">[</span><span class="n">nop</span><span class="p">,</span><span class="n">nop</span><span class="p">,</span><span class="n">TS</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="mi">6580205</span><span class="w"> </span><span class="n">ecr</span><span class="w"> </span><span class="mi">26164373</span><span class="p">],</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="mi">0</span>
<span class="mo">06</span><span class="o">:</span><span class="mi">43</span><span class="o">:</span><span class="mf">22.906303</span><span class="w"> </span><span class="n">IP</span><span class="w"> </span><span class="mf">169.144.0.1.39374</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">compute</span><span class="mi">-0</span><span class="mf">-1.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="p">.</span><span class="n">ssh</span><span class="o">:</span><span class="w"> </span><span class="n">Flags</span><span class="w"> </span><span class="p">[</span><span class="n">P</span><span class="p">.],</span><span class="w"> </span><span class="n">seq</span><span class="w"> </span><span class="mi">13537</span><span class="o">:</span><span class="mi">13609</span><span class="p">,</span><span class="w"> </span><span class="n">ack</span><span class="w"> </span><span class="mi">21952980</span><span class="p">,</span><span class="w"> </span><span class="n">win</span><span class="w"> </span><span class="mi">13094</span><span class="p">,</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">[</span><span class="n">nop</span><span class="p">,</span><span class="n">nop</span><span class="p">,</span><span class="n">TS</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="mi">6580205</span><span class="w"> </span><span class="n">ecr</span><span class="w"> </span><span class="mi">26164373</span><span class="p">],</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="mi">72</span>
<span class="mo">06</span><span class="o">:</span><span class="mi">43</span><span class="o">:</span><span class="mf">22.906322</span><span class="w"> </span><span class="n">IP</span><span class="w"> </span><span class="n">compute</span><span class="mi">-0</span><span class="mf">-1.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="p">.</span><span class="n">ssh</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">169.144.0.1.39374</span><span class="o">:</span><span class="w"> </span><span class="n">Flags</span><span class="w"> </span><span class="p">[</span><span class="n">P</span><span class="p">.],</span><span class="w"> </span><span class="n">seq</span><span class="w"> </span><span class="mi">21952980</span><span class="o">:</span><span class="mi">21953200</span><span class="p">,</span><span class="w"> </span><span class="n">ack</span><span class="w"> </span><span class="mi">13537</span><span class="p">,</span><span class="w"> </span><span class="n">win</span><span class="w"> </span><span class="mi">291</span><span class="p">,</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">[</span><span class="n">nop</span><span class="p">,</span><span class="n">nop</span><span class="p">,</span><span class="n">TS</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="mi">26164373</span><span class="w"> </span><span class="n">ecr</span><span class="w"> </span><span class="mi">6580205</span><span class="p">],</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="mi">220</span>
<span class="o">^</span><span class="n">C</span>
<span class="mi">109930</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">captured</span>
<span class="mi">110065</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">received</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">filter</span>
<span class="mi">133</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">dropped</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">kernel</span>
<span class="p">[[</span><span class="n">email</span><span class="w"> </span><span class="n">protected</span><span class="p">]</span><span class="w"> </span><span class="o">~</span><span class="p">]</span><span class="err">#</span>
</code></pre></div>

<h3>示例：2）从特定接口捕获特定数量数据包</h3>
<p>假设我们想从特定接口（如 <code>enp0s3</code>）捕获 12 个数据包，这可以使用选项 <code>-c {数量} -I {接口名称}</code> 轻松实现。</p>
<div class="highlight"><pre><span></span><code><span class="n">root</span><span class="nv">@compute</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="o">~</span><span class="err">]#</span><span class="w"> </span><span class="n">tcpdump</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="mi">12</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">enp0s3</span>
</code></pre></div>

<p>上面的命令将生成如下所示的输出，</p>
<p><a href="https://www.linuxtechi.com/wp-content/uploads/2018/08/N-Number-Packsets-tcpdump-interface.jpg"><img alt="N-Number-Packsets-tcpdump-interface" src="/data/attachment/album/201809/26/095420gdfdxrt8oto3310a.jpg"></a></p>
<h3>示例：3）显示 tcpdump 的所有可用接口</h3>
<p>使用 <code>-D</code> 选项显示 <code>tcpdump</code> 命令的所有可用接口，</p>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">root</span><span class="p">@</span><span class="n">compute</span><span class="mi">-0-1</span><span class="w"> </span><span class="o">~</span><span class="p">]</span><span class="err">#</span><span class="w"> </span><span class="n">tcpdump</span><span class="w"> </span><span class="o">-</span><span class="n">D</span>
<span class="mf">1.</span><span class="n">enp0s3</span>
<span class="mf">2.</span><span class="n">enp0s8</span>
<span class="mf">3.</span><span class="n">ovs</span><span class="o">-</span><span class="n">system</span>
<span class="mf">4.</span><span class="n">br</span><span class="o">-</span><span class="kt">int</span>
<span class="mf">5.</span><span class="n">br</span><span class="o">-</span><span class="n">tun</span>
<span class="mf">6.</span><span class="n">nflog</span><span class="w"> </span><span class="p">(</span><span class="n">Linux</span><span class="w"> </span><span class="n">netfilter</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="p">(</span><span class="n">NFLOG</span><span class="p">)</span><span class="w"> </span><span class="n">interface</span><span class="p">)</span>
<span class="mf">7.</span><span class="n">nfqueue</span><span class="w"> </span><span class="p">(</span><span class="n">Linux</span><span class="w"> </span><span class="n">netfilter</span><span class="w"> </span><span class="n">queue</span><span class="w"> </span><span class="p">(</span><span class="n">NFQUEUE</span><span class="p">)</span><span class="w"> </span><span class="n">interface</span><span class="p">)</span>
<span class="mf">8.</span><span class="n">usbmon1</span><span class="w"> </span><span class="p">(</span><span class="n">USB</span><span class="w"> </span><span class="n">bus</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="mf">9.</span><span class="n">usbmon2</span><span class="w"> </span><span class="p">(</span><span class="n">USB</span><span class="w"> </span><span class="n">bus</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="mf">10.</span><span class="n">qbra692e993</span><span class="mi">-28</span>
<span class="mf">11.</span><span class="n">qvoa692e993</span><span class="mi">-28</span>
<span class="mf">12.</span><span class="n">qvba692e993</span><span class="mi">-28</span>
<span class="mf">13.</span><span class="n">tapa692e993</span><span class="mi">-28</span>
<span class="mf">14.</span><span class="n">vxlan_sys_4789</span>
<span class="mf">15.</span><span class="n">any</span><span class="w"> </span><span class="p">(</span><span class="n">Pseudo</span><span class="o">-</span><span class="n">device</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">captures</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">interfaces</span><span class="p">)</span>
<span class="mf">16.l</span><span class="n">o</span><span class="w"> </span><span class="p">[</span><span class="n">Loopback</span><span class="p">]</span>
<span class="p">[[</span><span class="n">email</span><span class="w"> </span><span class="n">protected</span><span class="p">]</span><span class="w"> </span><span class="o">~</span><span class="p">]</span><span class="err">#</span>
</code></pre></div>

<p>我正在我的一个 openstack 计算节点上运行 <code>tcpdump</code> 命令，这就是为什么在输出中你会看到数字接口、标签接口、网桥和 vxlan 接口</p>
<h3>示例：4）捕获带有可读时间戳的数据包（<code>-tttt</code> 选项）</h3>
<p>默认情况下，在 <code>tcpdump</code> 命令输出中，不显示可读性好的时间戳，如果您想将可读性好的时间戳与每个捕获的数据包相关联，那么使用 <code>-tttt</code> 选项，示例如下所示，</p>
<div class="highlight"><pre><span></span><code><span class="p">[[</span><span class="n">email</span><span class="w"> </span><span class="n">protected</span><span class="p">]</span><span class="w"> </span><span class="o">~</span><span class="p">]</span><span class="err">#</span><span class="w"> </span><span class="n">tcpdump</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="o">-</span><span class="n">tttt</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">enp0s3</span>
<span class="nl">tcpdump</span><span class="p">:</span><span class="w"> </span><span class="n">verbose</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">suppressed</span><span class="p">,</span><span class="w"> </span><span class="n">use</span><span class="w"> </span><span class="o">-</span><span class="n">v</span><span class="w"> </span><span class="n">or</span><span class="w"> </span><span class="o">-</span><span class="n">vv</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">full</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">decode</span>
<span class="n">listening</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">enp0s3</span><span class="p">,</span><span class="w"> </span><span class="n">link</span><span class="o">-</span><span class="n">type</span><span class="w"> </span><span class="n">EN10MB</span><span class="w"> </span><span class="p">(</span><span class="n">Ethernet</span><span class="p">),</span><span class="w"> </span><span class="n">capture</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="mi">262144</span><span class="w"> </span><span class="n">bytes</span>
<span class="mi">2018-08-25</span><span class="w"> </span><span class="mi">23</span><span class="o">:</span><span class="mi">23</span><span class="o">:</span><span class="mf">36.954883</span><span class="w"> </span><span class="n">IP</span><span class="w"> </span><span class="n">compute</span><span class="mi">-0</span><span class="mf">-1.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="p">.</span><span class="n">ssh</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">169.144.0.1.39406</span><span class="o">:</span><span class="w"> </span><span class="n">Flags</span><span class="w"> </span><span class="p">[</span><span class="n">P</span><span class="p">.],</span><span class="w"> </span><span class="n">seq</span><span class="w"> </span><span class="mi">1449206247</span><span class="o">:</span><span class="mi">1449206435</span><span class="p">,</span><span class="w"> </span><span class="n">ack</span><span class="w"> </span><span class="mi">3062020950</span><span class="p">,</span><span class="w"> </span><span class="n">win</span><span class="w"> </span><span class="mi">291</span><span class="p">,</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">[</span><span class="n">nop</span><span class="p">,</span><span class="n">nop</span><span class="p">,</span><span class="n">TS</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="mi">86178422</span><span class="w"> </span><span class="n">ecr</span><span class="w"> </span><span class="mi">21583714</span><span class="p">],</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="mi">188</span>
<span class="mi">2018-08-25</span><span class="w"> </span><span class="mi">23</span><span class="o">:</span><span class="mi">23</span><span class="o">:</span><span class="mf">36.955046</span><span class="w"> </span><span class="n">IP</span><span class="w"> </span><span class="mf">169.144.0.1.39406</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">compute</span><span class="mi">-0</span><span class="mf">-1.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="p">.</span><span class="n">ssh</span><span class="o">:</span><span class="w"> </span><span class="n">Flags</span><span class="w"> </span><span class="p">[.],</span><span class="w"> </span><span class="n">ack</span><span class="w"> </span><span class="mi">188</span><span class="p">,</span><span class="w"> </span><span class="n">win</span><span class="w"> </span><span class="mi">13585</span><span class="p">,</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">[</span><span class="n">nop</span><span class="p">,</span><span class="n">nop</span><span class="p">,</span><span class="n">TS</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="mi">21583717</span><span class="w"> </span><span class="n">ecr</span><span class="w"> </span><span class="mi">86178422</span><span class="p">],</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="mi">0</span>
<span class="mi">2018-08-25</span><span class="w"> </span><span class="mi">23</span><span class="o">:</span><span class="mi">23</span><span class="o">:</span><span class="mf">37.140097</span><span class="w"> </span><span class="n">IP</span><span class="w"> </span><span class="n">controller0</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="p">.</span><span class="n">amqp</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">compute</span><span class="mi">-0</span><span class="mf">-1.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="mf">.57818</span><span class="o">:</span><span class="w"> </span><span class="n">Flags</span><span class="w"> </span><span class="p">[</span><span class="n">P</span><span class="p">.],</span><span class="w"> </span><span class="n">seq</span><span class="w"> </span><span class="mi">814607956</span><span class="o">:</span><span class="mi">814607964</span><span class="p">,</span><span class="w"> </span><span class="n">ack</span><span class="w"> </span><span class="mi">2387094506</span><span class="p">,</span><span class="w"> </span><span class="n">win</span><span class="w"> </span><span class="mi">252</span><span class="p">,</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">[</span><span class="n">nop</span><span class="p">,</span><span class="n">nop</span><span class="p">,</span><span class="n">TS</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="mi">86172228</span><span class="w"> </span><span class="n">ecr</span><span class="w"> </span><span class="mi">86176695</span><span class="p">],</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="mi">8</span>
<span class="mi">2018-08-25</span><span class="w"> </span><span class="mi">23</span><span class="o">:</span><span class="mi">23</span><span class="o">:</span><span class="mf">37.140175</span><span class="w"> </span><span class="n">IP</span><span class="w"> </span><span class="n">compute</span><span class="mi">-0</span><span class="mf">-1.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="mf">.57818</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">controller0</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="p">.</span><span class="n">amqp</span><span class="o">:</span><span class="w"> </span><span class="n">Flags</span><span class="w"> </span><span class="p">[.],</span><span class="w"> </span><span class="n">ack</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="n">win</span><span class="w"> </span><span class="mi">237</span><span class="p">,</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">[</span><span class="n">nop</span><span class="p">,</span><span class="n">nop</span><span class="p">,</span><span class="n">TS</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="mi">86178607</span><span class="w"> </span><span class="n">ecr</span><span class="w"> </span><span class="mi">86172228</span><span class="p">],</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="mi">0</span>
<span class="mi">2018-08-25</span><span class="w"> </span><span class="mi">23</span><span class="o">:</span><span class="mi">23</span><span class="o">:</span><span class="mf">37.355238</span><span class="w"> </span><span class="n">IP</span><span class="w"> </span><span class="n">compute</span><span class="mi">-0</span><span class="mf">-1.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="mf">.57836</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">controller0</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="p">.</span><span class="n">amqp</span><span class="o">:</span><span class="w"> </span><span class="n">Flags</span><span class="w"> </span><span class="p">[</span><span class="n">P</span><span class="p">.],</span><span class="w"> </span><span class="n">seq</span><span class="w"> </span><span class="mi">1080415080</span><span class="o">:</span><span class="mi">1080417400</span><span class="p">,</span><span class="w"> </span><span class="n">ack</span><span class="w"> </span><span class="mi">1690909362</span><span class="p">,</span><span class="w"> </span><span class="n">win</span><span class="w"> </span><span class="mi">237</span><span class="p">,</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">[</span><span class="n">nop</span><span class="p">,</span><span class="n">nop</span><span class="p">,</span><span class="n">TS</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="mi">86178822</span><span class="w"> </span><span class="n">ecr</span><span class="w"> </span><span class="mi">86163054</span><span class="p">],</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="mi">2320</span>
<span class="mi">2018-08-25</span><span class="w"> </span><span class="mi">23</span><span class="o">:</span><span class="mi">23</span><span class="o">:</span><span class="mf">37.357119</span><span class="w"> </span><span class="n">IP</span><span class="w"> </span><span class="n">controller0</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="p">.</span><span class="n">amqp</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">compute</span><span class="mi">-0</span><span class="mf">-1.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="mf">.57836</span><span class="o">:</span><span class="w"> </span><span class="n">Flags</span><span class="w"> </span><span class="p">[.],</span><span class="w"> </span><span class="n">ack</span><span class="w"> </span><span class="mi">2320</span><span class="p">,</span><span class="w"> </span><span class="n">win</span><span class="w"> </span><span class="mi">1432</span><span class="p">,</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">[</span><span class="n">nop</span><span class="p">,</span><span class="n">nop</span><span class="p">,</span><span class="n">TS</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="mi">86172448</span><span class="w"> </span><span class="n">ecr</span><span class="w"> </span><span class="mi">86178822</span><span class="p">],</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="mi">0</span>
<span class="mi">2018-08-25</span><span class="w"> </span><span class="mi">23</span><span class="o">:</span><span class="mi">23</span><span class="o">:</span><span class="mf">37.357545</span><span class="w"> </span><span class="n">IP</span><span class="w"> </span><span class="n">controller0</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="p">.</span><span class="n">amqp</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">compute</span><span class="mi">-0</span><span class="mf">-1.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="mf">.57836</span><span class="o">:</span><span class="w"> </span><span class="n">Flags</span><span class="w"> </span><span class="p">[</span><span class="n">P</span><span class="p">.],</span><span class="w"> </span><span class="n">seq</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="mi">22</span><span class="p">,</span><span class="w"> </span><span class="n">ack</span><span class="w"> </span><span class="mi">2320</span><span class="p">,</span><span class="w"> </span><span class="n">win</span><span class="w"> </span><span class="mi">1432</span><span class="p">,</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">[</span><span class="n">nop</span><span class="p">,</span><span class="n">nop</span><span class="p">,</span><span class="n">TS</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="mi">86172449</span><span class="w"> </span><span class="n">ecr</span><span class="w"> </span><span class="mi">86178822</span><span class="p">],</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="mi">21</span>
<span class="mi">2018-08-25</span><span class="w"> </span><span class="mi">23</span><span class="o">:</span><span class="mi">23</span><span class="o">:</span><span class="mf">37.357572</span><span class="w"> </span><span class="n">IP</span><span class="w"> </span><span class="n">compute</span><span class="mi">-0</span><span class="mf">-1.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="mf">.57836</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">controller0</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="p">.</span><span class="n">amqp</span><span class="o">:</span><span class="w"> </span><span class="n">Flags</span><span class="w"> </span><span class="p">[.],</span><span class="w"> </span><span class="n">ack</span><span class="w"> </span><span class="mi">22</span><span class="p">,</span><span class="w"> </span><span class="n">win</span><span class="w"> </span><span class="mi">237</span><span class="p">,</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">[</span><span class="n">nop</span><span class="p">,</span><span class="n">nop</span><span class="p">,</span><span class="n">TS</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="mi">86178825</span><span class="w"> </span><span class="n">ecr</span><span class="w"> </span><span class="mi">86172449</span><span class="p">],</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="mi">0</span>
<span class="mi">8</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">captured</span>
<span class="mi">134</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">received</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">filter</span>
<span class="mi">69</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">dropped</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">kernel</span>
<span class="p">[[</span><span class="n">email</span><span class="w"> </span><span class="n">protected</span><span class="p">]</span><span class="w"> </span><span class="o">~</span><span class="p">]</span><span class="err">#</span>
</code></pre></div>

<h3>示例：5）捕获数据包并将其保存到文件（<code>-w</code> 选项）</h3>
<p>使用 <code>tcpdump</code> 命令中的 <code>-w</code> 选项将捕获的 TCP/IP 数据包保存到一个文件中，以便我们可以在将来分析这些数据包以供进一步分析。</p>
<p>语法：</p>
<div class="highlight"><pre><span></span><code># tcpdump -w 文件名.pcap -i {接口名}
</code></pre></div>

<p>注意：文件扩展名必须为 <code>.pcap</code>。</p>
<p>假设我要把 <code>enp0s3</code> 接口捕获到的包保存到文件名为 <code>enp0s3-26082018.pcap</code>。</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span><span class="n">root@compute-0-1 ~</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">tcpdump</span><span class="w"> </span><span class="o">-</span><span class="n">w</span><span class="w"> </span><span class="n">enp0s3</span><span class="o">-</span><span class="mf">26082018.</span><span class="n">pcap</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">enp0s3</span>
</code></pre></div>

<p>上述命令将生成如下所示的输出，</p>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="nx">root</span><span class="err">@</span><span class="nx">compute</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="w">  </span><span class="o">~</span><span class="p">]</span><span class="err">#</span><span class="w"> </span><span class="nx">tcpdump</span><span class="w"> </span><span class="o">-</span><span class="nx">w</span><span class="w"> </span><span class="nx">enp0s3</span><span class="o">-</span><span class="mi">26082018</span><span class="p">.</span><span class="nx">pcap</span><span class="w"> </span><span class="o">-</span><span class="nx">i</span><span class="w"> </span><span class="nx">enp0s3</span>
<span class="nx">tcpdump</span><span class="p">:</span><span class="w"> </span><span class="nx">listening</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="nx">enp0s3</span><span class="p">,</span><span class="w"> </span><span class="nx">link</span><span class="o">-</span><span class="k">type</span><span class="w"> </span><span class="nx">EN10MB</span><span class="w"> </span><span class="p">(</span><span class="nx">Ethernet</span><span class="p">),</span><span class="w"> </span><span class="nx">capture</span><span class="w"> </span><span class="nx">size</span><span class="w"> </span><span class="mi">262144</span><span class="w"> </span><span class="nx">bytes</span>
<span class="o">^</span><span class="nx">C841</span><span class="w"> </span><span class="nx">packets</span><span class="w"> </span><span class="nx">captured</span>
<span class="mi">845</span><span class="w"> </span><span class="nx">packets</span><span class="w"> </span><span class="nx">received</span><span class="w"> </span><span class="nx">by</span><span class="w"> </span><span class="nx">filter</span>
<span class="mi">0</span><span class="w"> </span><span class="nx">packets</span><span class="w"> </span><span class="nx">dropped</span><span class="w"> </span><span class="nx">by</span><span class="w"> </span><span class="nx">kernel</span>
<span class="p">[</span><span class="nx">root</span><span class="err">@</span><span class="nx">compute</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="w">  </span><span class="o">~</span><span class="p">]</span><span class="err">#</span><span class="w"> </span><span class="nx">ls</span>
<span class="nx">anaconda</span><span class="o">-</span><span class="nx">ks</span><span class="p">.</span><span class="nx">cfg</span><span class="w"> </span><span class="nx">enp0s3</span><span class="o">-</span><span class="mi">26082018</span><span class="p">.</span><span class="nx">pcap</span>
<span class="p">[</span><span class="nx">root</span><span class="err">@</span><span class="nx">compute</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="w">  </span><span class="o">~</span><span class="p">]</span><span class="err">#</span>
</code></pre></div>

<p>捕获并保存大小<strong>大于 N 字节</strong>的数据包。</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span><span class="n">root@compute-0-1  ~</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">tcpdump</span><span class="w"> </span><span class="o">-</span><span class="n">w</span><span class="w"> </span><span class="n">enp0s3</span><span class="o">-</span><span class="mi">26082018</span><span class="o">-</span><span class="mf">2.</span><span class="n">pcap</span><span class="w"> </span><span class="n">greater</span><span class="w"> </span><span class="mi">1024</span>
</code></pre></div>

<p>捕获并保存大小<strong>小于 N 字节</strong>的数据包。</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span><span class="n">root@compute-0-1  ~</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">tcpdump</span><span class="w"> </span><span class="o">-</span><span class="n">w</span><span class="w"> </span><span class="n">enp0s3</span><span class="o">-</span><span class="mi">26082018</span><span class="o">-</span><span class="mf">3.</span><span class="n">pcap</span><span class="w"> </span><span class="k">less</span><span class="w"> </span><span class="mi">1024</span>
</code></pre></div>

<h3>示例：6）从保存的文件中读取数据包（<code>-r</code> 选项）</h3>
<p>在上面的例子中，我们已经将捕获的数据包保存到文件中，我们可以使用选项 <code>-r</code> 从文件中读取这些数据包，例子如下所示，</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span><span class="n">root@compute-0-1 ~</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">tcpdump</span><span class="w"> </span><span class="o">-</span><span class="n">r</span><span class="w"> </span><span class="n">enp0s3</span><span class="o">-</span><span class="mf">26082018.</span><span class="n">pcap</span>
</code></pre></div>

<p>用可读性高的时间戳读取包内容，</p>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="nx">root</span><span class="err">@</span><span class="nx">compute</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="w">  </span><span class="o">~</span><span class="p">]</span><span class="err">#</span><span class="w"> </span><span class="nx">tcpdump</span><span class="w"> </span><span class="o">-</span><span class="nx">tttt</span><span class="w"> </span><span class="o">-</span><span class="nx">r</span><span class="w"> </span><span class="nx">enp0s3</span><span class="o">-</span><span class="mi">26082018</span><span class="p">.</span><span class="nx">pcap</span>
<span class="nx">reading</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="nx">file</span><span class="w"> </span><span class="nx">enp0s3</span><span class="o">-</span><span class="mi">26082018</span><span class="p">.</span><span class="nx">pcap</span><span class="p">,</span><span class="w"> </span><span class="nx">link</span><span class="o">-</span><span class="k">type</span><span class="w"> </span><span class="nx">EN10MB</span><span class="w"> </span><span class="p">(</span><span class="nx">Ethernet</span><span class="p">)</span>
<span class="mi">2018</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">25</span><span class="w"> </span><span class="mi">22</span><span class="p">:</span><span class="mi">03</span><span class="p">:</span><span class="m m-Double">17.249648</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="nx">compute</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="nx">example</span><span class="p">.</span><span class="nx">com</span><span class="p">.</span><span class="nx">ssh</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m m-Double">169.144.0.1.39406</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[</span><span class="nx">P</span><span class="p">.],</span><span class="w"> </span><span class="nx">seq</span><span class="w"> </span><span class="mi">1426167803</span><span class="p">:</span><span class="mi">1426167927</span><span class="p">,</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">3061962134</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">291</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span>
<span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">81358717</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">20378789</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">124</span>
<span class="mi">2018</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">25</span><span class="w"> </span><span class="mi">22</span><span class="p">:</span><span class="mi">03</span><span class="p">:</span><span class="m m-Double">17.249840</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="m m-Double">169.144.0.1.39406</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="nx">compute</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="nx">example</span><span class="p">.</span><span class="nx">com</span><span class="p">.</span><span class="nx">ssh</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[.],</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">124</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">564</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">20378791</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">81358</span>
<span class="mi">717</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">0</span>
<span class="mi">2018</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">25</span><span class="w"> </span><span class="mi">22</span><span class="p">:</span><span class="mi">03</span><span class="p">:</span><span class="m m-Double">17.454559</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="nx">controller0</span><span class="p">.</span><span class="nx">example</span><span class="p">.</span><span class="nx">com</span><span class="p">.</span><span class="nx">amqp</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="nx">compute</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="nx">example</span><span class="p">.</span><span class="nx">com</span><span class="m m-Double">.57836</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[.],</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">1079416895</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">1432</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">v</span>
<span class="nx">al</span><span class="w"> </span><span class="mi">81352560</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">81353913</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">0</span>
<span class="mi">2018</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">25</span><span class="w"> </span><span class="mi">22</span><span class="p">:</span><span class="mi">03</span><span class="p">:</span><span class="m m-Double">17.454642</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="nx">compute</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="nx">example</span><span class="p">.</span><span class="nx">com</span><span class="m m-Double">.57836</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="nx">controller0</span><span class="p">.</span><span class="nx">example</span><span class="p">.</span><span class="nx">com</span><span class="p">.</span><span class="nx">amqp</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[.],</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">237</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">8135892</span>
<span class="mi">2</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">81317504</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">0</span>
<span class="mi">2018</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">25</span><span class="w"> </span><span class="mi">22</span><span class="p">:</span><span class="mi">03</span><span class="p">:</span><span class="m m-Double">17.646945</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="nx">compute</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="nx">example</span><span class="p">.</span><span class="nx">com</span><span class="m m-Double">.57788</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="nx">controller0</span><span class="p">.</span><span class="nx">example</span><span class="p">.</span><span class="nx">com</span><span class="p">.</span><span class="nx">amqp</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[.],</span><span class="w"> </span><span class="nx">seq</span><span class="w"> </span><span class="mi">106760587</span><span class="p">:</span><span class="mi">106762035</span><span class="p">,</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">688390730</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">237</span>
<span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">81359114</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">81350901</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">1448</span>
<span class="mi">2018</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">25</span><span class="w"> </span><span class="mi">22</span><span class="p">:</span><span class="mi">03</span><span class="p">:</span><span class="m m-Double">17.647043</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="nx">compute</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="nx">example</span><span class="p">.</span><span class="nx">com</span><span class="m m-Double">.57788</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="nx">controller0</span><span class="p">.</span><span class="nx">example</span><span class="p">.</span><span class="nx">com</span><span class="p">.</span><span class="nx">amqp</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[</span><span class="nx">P</span><span class="p">.],</span><span class="w"> </span><span class="nx">seq</span><span class="w"> </span><span class="mi">1448</span><span class="p">:</span><span class="mi">1956</span><span class="p">,</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">237</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">no</span>
<span class="nx">p</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">81359114</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">81350901</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">508</span>
<span class="mi">2018</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">25</span><span class="w"> </span><span class="mi">22</span><span class="p">:</span><span class="mi">03</span><span class="p">:</span><span class="m m-Double">17.647502</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="nx">controller0</span><span class="p">.</span><span class="nx">example</span><span class="p">.</span><span class="nx">com</span><span class="p">.</span><span class="nx">amqp</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="nx">compute</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="nx">example</span><span class="p">.</span><span class="nx">com</span><span class="m m-Double">.57788</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[.],</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">1956</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">1432</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">813</span>
<span class="mi">52753</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">81359114</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">0</span>
<span class="o">........................................................................................................................</span><span class="p">.</span>
</code></pre></div>

<h3>示例：7）仅捕获特定接口上的 IP 地址数据包（<code>-n</code> 选项）</h3>
<p>使用 <code>tcpdump</code> 命令中的 <code>-n</code> 选项，我们能只捕获特定接口上的 IP 地址数据包，示例如下所示，</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span><span class="n">root@compute-0-1 ~</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">tcpdump</span><span class="w"> </span><span class="o">-</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">enp0s3</span>
</code></pre></div>

<p>上述命令输出如下，</p>
<div class="highlight"><pre><span></span><code><span class="n">tcpdump</span><span class="o">:</span><span class="w"> </span><span class="n">verbose</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">suppressed</span><span class="o">,</span><span class="w"> </span><span class="n">use</span><span class="w"> </span><span class="o">-</span><span class="n">v</span><span class="w"> </span><span class="n">or</span><span class="w"> </span><span class="o">-</span><span class="n">vv</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">full</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">decode</span>
<span class="n">listening</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">enp0s3</span><span class="o">,</span><span class="w"> </span><span class="n">link</span><span class="o">-</span><span class="n">type</span><span class="w"> </span><span class="n">EN10MB</span><span class="w"> </span><span class="o">(</span><span class="n">Ethernet</span><span class="o">),</span><span class="w"> </span><span class="n">capture</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="mi">262144</span><span class="w"> </span><span class="n">bytes</span>
<span class="mi">22</span><span class="o">:</span><span class="mi">22</span><span class="o">:</span><span class="mf">28.537904</span><span class="w"> </span><span class="n">IP</span><span class="w"> </span><span class="mf">169.144</span><span class="o">.</span><span class="mf">0.20</span><span class="o">.</span><span class="na">ssh</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">169.144</span><span class="o">.</span><span class="mf">0.1</span><span class="o">.</span><span class="mi">39406</span><span class="o">:</span><span class="w"> </span><span class="n">Flags</span><span class="w"> </span><span class="o">[</span><span class="n">P</span><span class="o">.],</span><span class="w"> </span><span class="n">seq</span><span class="w"> </span><span class="mi">1433301395</span><span class="o">:</span><span class="mi">1433301583</span><span class="o">,</span><span class="w"> </span><span class="n">ack</span><span class="w"> </span><span class="mi">3061976250</span><span class="o">,</span><span class="w"> </span><span class="n">win</span><span class="w"> </span><span class="mi">291</span><span class="o">,</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="o">[</span><span class="n">nop</span><span class="o">,</span><span class="n">nop</span><span class="o">,</span><span class="n">TS</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="mi">82510005</span><span class="w"> </span><span class="n">ecr</span><span class="w"> </span><span class="mi">20666610</span><span class="o">],</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="mi">188</span>
<span class="mi">22</span><span class="o">:</span><span class="mi">22</span><span class="o">:</span><span class="mf">28.538173</span><span class="w"> </span><span class="n">IP</span><span class="w"> </span><span class="mf">169.144</span><span class="o">.</span><span class="mf">0.1</span><span class="o">.</span><span class="mi">39406</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">169.144</span><span class="o">.</span><span class="mf">0.20</span><span class="o">.</span><span class="na">ssh</span><span class="o">:</span><span class="w"> </span><span class="n">Flags</span><span class="w"> </span><span class="o">[.],</span><span class="w"> </span><span class="n">ack</span><span class="w"> </span><span class="mi">188</span><span class="o">,</span><span class="w"> </span><span class="n">win</span><span class="w"> </span><span class="mi">9086</span><span class="o">,</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="o">[</span><span class="n">nop</span><span class="o">,</span><span class="n">nop</span><span class="o">,</span><span class="n">TS</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="mi">20666613</span><span class="w"> </span><span class="n">ecr</span><span class="w"> </span><span class="mi">82510005</span><span class="o">],</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="mi">0</span>
<span class="mi">22</span><span class="o">:</span><span class="mi">22</span><span class="o">:</span><span class="mf">28.538573</span><span class="w"> </span><span class="n">IP</span><span class="w"> </span><span class="mf">169.144</span><span class="o">.</span><span class="mf">0.20</span><span class="o">.</span><span class="na">ssh</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">169.144</span><span class="o">.</span><span class="mf">0.1</span><span class="o">.</span><span class="mi">39406</span><span class="o">:</span><span class="w"> </span><span class="n">Flags</span><span class="w"> </span><span class="o">[</span><span class="n">P</span><span class="o">.],</span><span class="w"> </span><span class="n">seq</span><span class="w"> </span><span class="mi">188</span><span class="o">:</span><span class="mi">552</span><span class="o">,</span><span class="w"> </span><span class="n">ack</span><span class="w"> </span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="n">win</span><span class="w"> </span><span class="mi">291</span><span class="o">,</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="o">[</span><span class="n">nop</span><span class="o">,</span><span class="n">nop</span><span class="o">,</span><span class="n">TS</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="mi">82510006</span><span class="w"> </span><span class="n">ecr</span><span class="w"> </span><span class="mi">20666613</span><span class="o">],</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="mi">364</span>
<span class="mi">22</span><span class="o">:</span><span class="mi">22</span><span class="o">:</span><span class="mf">28.538736</span><span class="w"> </span><span class="n">IP</span><span class="w"> </span><span class="mf">169.144</span><span class="o">.</span><span class="mf">0.1</span><span class="o">.</span><span class="mi">39406</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">169.144</span><span class="o">.</span><span class="mf">0.20</span><span class="o">.</span><span class="na">ssh</span><span class="o">:</span><span class="w"> </span><span class="n">Flags</span><span class="w"> </span><span class="o">[.],</span><span class="w"> </span><span class="n">ack</span><span class="w"> </span><span class="mi">552</span><span class="o">,</span><span class="w"> </span><span class="n">win</span><span class="w"> </span><span class="mi">9086</span><span class="o">,</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="o">[</span><span class="n">nop</span><span class="o">,</span><span class="n">nop</span><span class="o">,</span><span class="n">TS</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="mi">20666613</span><span class="w"> </span><span class="n">ecr</span><span class="w"> </span><span class="mi">82510006</span><span class="o">],</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="mi">0</span>
<span class="mi">22</span><span class="o">:</span><span class="mi">22</span><span class="o">:</span><span class="mf">28.538874</span><span class="w"> </span><span class="n">IP</span><span class="w"> </span><span class="mf">169.144</span><span class="o">.</span><span class="mf">0.20</span><span class="o">.</span><span class="na">ssh</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">169.144</span><span class="o">.</span><span class="mf">0.1</span><span class="o">.</span><span class="mi">39406</span><span class="o">:</span><span class="w"> </span><span class="n">Flags</span><span class="w"> </span><span class="o">[</span><span class="n">P</span><span class="o">.],</span><span class="w"> </span><span class="n">seq</span><span class="w"> </span><span class="mi">552</span><span class="o">:</span><span class="mi">892</span><span class="o">,</span><span class="w"> </span><span class="n">ack</span><span class="w"> </span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="n">win</span><span class="w"> </span><span class="mi">291</span><span class="o">,</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="o">[</span><span class="n">nop</span><span class="o">,</span><span class="n">nop</span><span class="o">,</span><span class="n">TS</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="mi">82510006</span><span class="w"> </span><span class="n">ecr</span><span class="w"> </span><span class="mi">20666613</span><span class="o">],</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="mi">340</span>
<span class="mi">22</span><span class="o">:</span><span class="mi">22</span><span class="o">:</span><span class="mf">28.539042</span><span class="w"> </span><span class="n">IP</span><span class="w"> </span><span class="mf">169.144</span><span class="o">.</span><span class="mf">0.1</span><span class="o">.</span><span class="mi">39406</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">169.144</span><span class="o">.</span><span class="mf">0.20</span><span class="o">.</span><span class="na">ssh</span><span class="o">:</span><span class="w"> </span><span class="n">Flags</span><span class="w"> </span><span class="o">[.],</span><span class="w"> </span><span class="n">ack</span><span class="w"> </span><span class="mi">892</span><span class="o">,</span><span class="w"> </span><span class="n">win</span><span class="w"> </span><span class="mi">9086</span><span class="o">,</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="o">[</span><span class="n">nop</span><span class="o">,</span><span class="n">nop</span><span class="o">,</span><span class="n">TS</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="mi">20666613</span><span class="w"> </span><span class="n">ecr</span><span class="w"> </span><span class="mi">82510006</span><span class="o">],</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="mi">0</span>
<span class="mi">22</span><span class="o">:</span><span class="mi">22</span><span class="o">:</span><span class="mf">28.539178</span><span class="w"> </span><span class="n">IP</span><span class="w"> </span><span class="mf">169.144</span><span class="o">.</span><span class="mf">0.20</span><span class="o">.</span><span class="na">ssh</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">169.144</span><span class="o">.</span><span class="mf">0.1</span><span class="o">.</span><span class="mi">39406</span><span class="o">:</span><span class="w"> </span><span class="n">Flags</span><span class="w"> </span><span class="o">[</span><span class="n">P</span><span class="o">.],</span><span class="w"> </span><span class="n">seq</span><span class="w"> </span><span class="mi">892</span><span class="o">:</span><span class="mi">1232</span><span class="o">,</span><span class="w"> </span><span class="n">ack</span><span class="w"> </span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="n">win</span><span class="w"> </span><span class="mi">291</span><span class="o">,</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="o">[</span><span class="n">nop</span><span class="o">,</span><span class="n">nop</span><span class="o">,</span><span class="n">TS</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="mi">82510006</span><span class="w"> </span><span class="n">ecr</span><span class="w"> </span><span class="mi">20666613</span><span class="o">],</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="mi">340</span>
<span class="mi">22</span><span class="o">:</span><span class="mi">22</span><span class="o">:</span><span class="mf">28.539282</span><span class="w"> </span><span class="n">IP</span><span class="w"> </span><span class="mf">169.144</span><span class="o">.</span><span class="mf">0.1</span><span class="o">.</span><span class="mi">39406</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">169.144</span><span class="o">.</span><span class="mf">0.20</span><span class="o">.</span><span class="na">ssh</span><span class="o">:</span><span class="w"> </span><span class="n">Flags</span><span class="w"> </span><span class="o">[.],</span><span class="w"> </span><span class="n">ack</span><span class="w"> </span><span class="mi">1232</span><span class="o">,</span><span class="w"> </span><span class="n">win</span><span class="w"> </span><span class="mi">9086</span><span class="o">,</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="o">[</span><span class="n">nop</span><span class="o">,</span><span class="n">nop</span><span class="o">,</span><span class="n">TS</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="mi">20666614</span><span class="w"> </span><span class="n">ecr</span><span class="w"> </span><span class="mi">82510006</span><span class="o">],</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="mi">0</span>
<span class="mi">22</span><span class="o">:</span><span class="mi">22</span><span class="o">:</span><span class="mf">28.539479</span><span class="w"> </span><span class="n">IP</span><span class="w"> </span><span class="mf">169.144</span><span class="o">.</span><span class="mf">0.20</span><span class="o">.</span><span class="na">ssh</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">169.144</span><span class="o">.</span><span class="mf">0.1</span><span class="o">.</span><span class="mi">39406</span><span class="o">:</span><span class="w"> </span><span class="n">Flags</span><span class="w"> </span><span class="o">[</span><span class="n">P</span><span class="o">.],</span><span class="w"> </span><span class="n">seq</span><span class="w"> </span><span class="mi">1232</span><span class="o">:</span><span class="mi">1572</span><span class="o">,</span><span class="w"> </span><span class="n">ack</span><span class="w"> </span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="n">win</span><span class="w"> </span><span class="mi">291</span><span class="o">,</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="o">[</span><span class="n">nop</span><span class="o">,</span><span class="n">nop</span><span class="o">,</span><span class="n">TS</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="mi">82510006</span><span class="w"> </span><span class="n">ecr</span><span class="w"> </span><span class="mi">20666614</span><span class="o">],</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="mi">340</span>
<span class="mi">22</span><span class="o">:</span><span class="mi">22</span><span class="o">:</span><span class="mf">28.539595</span><span class="w"> </span><span class="n">IP</span><span class="w"> </span><span class="mf">169.144</span><span class="o">.</span><span class="mf">0.1</span><span class="o">.</span><span class="mi">39406</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">169.144</span><span class="o">.</span><span class="mf">0.20</span><span class="o">.</span><span class="na">ssh</span><span class="o">:</span><span class="w"> </span><span class="n">Flags</span><span class="w"> </span><span class="o">[.],</span><span class="w"> </span><span class="n">ack</span><span class="w"> </span><span class="mi">1572</span><span class="o">,</span><span class="w"> </span><span class="n">win</span><span class="w"> </span><span class="mi">9086</span><span class="o">,</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="o">[</span><span class="n">nop</span><span class="o">,</span><span class="n">nop</span><span class="o">,</span><span class="n">TS</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="mi">20666614</span><span class="w"> </span><span class="n">ecr</span><span class="w"> </span><span class="mi">82510006</span><span class="o">],</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="mi">0</span>
<span class="mi">22</span><span class="o">:</span><span class="mi">22</span><span class="o">:</span><span class="mf">28.539760</span><span class="w"> </span><span class="n">IP</span><span class="w"> </span><span class="mf">169.144</span><span class="o">.</span><span class="mf">0.20</span><span class="o">.</span><span class="na">ssh</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">169.144</span><span class="o">.</span><span class="mf">0.1</span><span class="o">.</span><span class="mi">39406</span><span class="o">:</span><span class="w"> </span><span class="n">Flags</span><span class="w"> </span><span class="o">[</span><span class="n">P</span><span class="o">.],</span><span class="w"> </span><span class="n">seq</span><span class="w"> </span><span class="mi">1572</span><span class="o">:</span><span class="mi">1912</span><span class="o">,</span><span class="w"> </span><span class="n">ack</span><span class="w"> </span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="n">win</span><span class="w"> </span><span class="mi">291</span><span class="o">,</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="o">[</span><span class="n">nop</span><span class="o">,</span><span class="n">nop</span><span class="o">,</span><span class="n">TS</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="mi">82510007</span><span class="w"> </span><span class="n">ecr</span><span class="w"> </span><span class="mi">20666614</span><span class="o">],</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="mi">340</span>
<span class="o">.........................................................................</span>
</code></pre></div>

<p>您还可以使用 <code>tcpdump</code> 命令中的 <code>-c</code> 和 <code>-N</code> 选项捕获 N 个 IP 地址包，</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span><span class="n">root@compute-0-1  ~</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">tcpdump</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="mi">25</span><span class="w"> </span><span class="o">-</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">enp0s3</span>
</code></pre></div>

<h3>示例：8）仅捕获特定接口上的 TCP 数据包</h3>
<p>在 <code>tcpdump</code> 命令中，我们能使用 <code>tcp</code> 选项来只捕获 TCP 数据包，</p>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="nx">root</span><span class="err">@</span><span class="nx">compute</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="w">  </span><span class="o">~</span><span class="p">]</span><span class="err">#</span><span class="w"> </span><span class="nx">tcpdump</span><span class="w"> </span><span class="o">-</span><span class="nx">i</span><span class="w"> </span><span class="nx">enp0s3</span><span class="w"> </span><span class="nx">tcp</span>
<span class="nx">tcpdump</span><span class="p">:</span><span class="w"> </span><span class="nx">verbose</span><span class="w"> </span><span class="nx">output</span><span class="w"> </span><span class="nx">suppressed</span><span class="p">,</span><span class="w"> </span><span class="nx">use</span><span class="w"> </span><span class="o">-</span><span class="nx">v</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">-</span><span class="nx">vv</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">full</span><span class="w"> </span><span class="nx">protocol</span><span class="w"> </span><span class="nx">decode</span>
<span class="nx">listening</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="nx">enp0s3</span><span class="p">,</span><span class="w"> </span><span class="nx">link</span><span class="o">-</span><span class="k">type</span><span class="w"> </span><span class="nx">EN10MB</span><span class="w"> </span><span class="p">(</span><span class="nx">Ethernet</span><span class="p">),</span><span class="w"> </span><span class="nx">capture</span><span class="w"> </span><span class="nx">size</span><span class="w"> </span><span class="mi">262144</span><span class="w"> </span><span class="nx">bytes</span>
<span class="mi">22</span><span class="p">:</span><span class="mi">36</span><span class="p">:</span><span class="m m-Double">54.521053</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="m m-Double">169.144.0.20</span><span class="p">.</span><span class="nx">ssh</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m m-Double">169.144.0.1.39406</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[</span><span class="nx">P</span><span class="p">.],</span><span class="w"> </span><span class="nx">seq</span><span class="w"> </span><span class="mi">1433336467</span><span class="p">:</span><span class="mi">1433336655</span><span class="p">,</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">3061986618</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">291</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">83375988</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">20883106</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">188</span>
<span class="mi">22</span><span class="p">:</span><span class="mi">36</span><span class="p">:</span><span class="m m-Double">54.521474</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="m m-Double">169.144.0.1.39406</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m m-Double">169.144.0.20</span><span class="p">.</span><span class="nx">ssh</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[.],</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">188</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">9086</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">20883109</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">83375988</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">0</span>
<span class="mi">22</span><span class="p">:</span><span class="mi">36</span><span class="p">:</span><span class="m m-Double">54.522214</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="m m-Double">169.144.0.20</span><span class="p">.</span><span class="nx">ssh</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m m-Double">169.144.0.1.39406</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[</span><span class="nx">P</span><span class="p">.],</span><span class="w"> </span><span class="nx">seq</span><span class="w"> </span><span class="mi">188</span><span class="p">:</span><span class="mi">552</span><span class="p">,</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">291</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">83375989</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">20883109</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">364</span>
<span class="mi">22</span><span class="p">:</span><span class="mi">36</span><span class="p">:</span><span class="m m-Double">54.522508</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="m m-Double">169.144.0.1.39406</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m m-Double">169.144.0.20</span><span class="p">.</span><span class="nx">ssh</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[.],</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">552</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">9086</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">20883109</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">83375989</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">0</span>
<span class="mi">22</span><span class="p">:</span><span class="mi">36</span><span class="p">:</span><span class="m m-Double">54.522867</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="m m-Double">169.144.0.20</span><span class="p">.</span><span class="nx">ssh</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m m-Double">169.144.0.1.39406</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[</span><span class="nx">P</span><span class="p">.],</span><span class="w"> </span><span class="nx">seq</span><span class="w"> </span><span class="mi">552</span><span class="p">:</span><span class="mi">892</span><span class="p">,</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">291</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">83375990</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">20883109</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">340</span>
<span class="mi">22</span><span class="p">:</span><span class="mi">36</span><span class="p">:</span><span class="m m-Double">54.523006</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="m m-Double">169.144.0.1.39406</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m m-Double">169.144.0.20</span><span class="p">.</span><span class="nx">ssh</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[.],</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">892</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">9086</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">20883109</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">83375990</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">0</span>
<span class="mi">22</span><span class="p">:</span><span class="mi">36</span><span class="p">:</span><span class="m m-Double">54.523304</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="m m-Double">169.144.0.20</span><span class="p">.</span><span class="nx">ssh</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m m-Double">169.144.0.1.39406</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[</span><span class="nx">P</span><span class="p">.],</span><span class="w"> </span><span class="nx">seq</span><span class="w"> </span><span class="mi">892</span><span class="p">:</span><span class="mi">1232</span><span class="p">,</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">291</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">83375990</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">20883109</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">340</span>
<span class="mi">22</span><span class="p">:</span><span class="mi">36</span><span class="p">:</span><span class="m m-Double">54.523461</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="m m-Double">169.144.0.1.39406</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m m-Double">169.144.0.20</span><span class="p">.</span><span class="nx">ssh</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[.],</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">1232</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">9086</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">20883110</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">83375990</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">0</span>
<span class="mi">22</span><span class="p">:</span><span class="mi">36</span><span class="p">:</span><span class="m m-Double">54.523604</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="m m-Double">169.144.0.20</span><span class="p">.</span><span class="nx">ssh</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m m-Double">169.144.0.1.39406</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[</span><span class="nx">P</span><span class="p">.],</span><span class="w"> </span><span class="nx">seq</span><span class="w"> </span><span class="mi">1232</span><span class="p">:</span><span class="mi">1572</span><span class="p">,</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">291</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">83375991</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">20883110</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">340</span>
<span class="o">...................................................................................................................................................</span>
</code></pre></div>

<h3>示例：9）从特定接口上的特定端口捕获数据包</h3>
<p>使用 <code>tcpdump</code> 命令，我们可以从特定接口 <code>enp0s3</code> 上的特定端口（例如 22）捕获数据包。</p>
<p>语法：</p>
<div class="highlight"><pre><span></span><code><span class="gh">#</span> tcpdump -i {interface-name} port {Port_Number}
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="nx">root</span><span class="err">@</span><span class="nx">compute</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="w">  </span><span class="o">~</span><span class="p">]</span><span class="err">#</span><span class="w"> </span><span class="nx">tcpdump</span><span class="w"> </span><span class="o">-</span><span class="nx">i</span><span class="w"> </span><span class="nx">enp0s3</span><span class="w"> </span><span class="nx">port</span><span class="w"> </span><span class="mi">22</span>
<span class="nx">tcpdump</span><span class="p">:</span><span class="w"> </span><span class="nx">verbose</span><span class="w"> </span><span class="nx">output</span><span class="w"> </span><span class="nx">suppressed</span><span class="p">,</span><span class="w"> </span><span class="nx">use</span><span class="w"> </span><span class="o">-</span><span class="nx">v</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">-</span><span class="nx">vv</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">full</span><span class="w"> </span><span class="nx">protocol</span><span class="w"> </span><span class="nx">decode</span>
<span class="nx">listening</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="nx">enp0s3</span><span class="p">,</span><span class="w"> </span><span class="nx">link</span><span class="o">-</span><span class="k">type</span><span class="w"> </span><span class="nx">EN10MB</span><span class="w"> </span><span class="p">(</span><span class="nx">Ethernet</span><span class="p">),</span><span class="w"> </span><span class="nx">capture</span><span class="w"> </span><span class="nx">size</span><span class="w"> </span><span class="mi">262144</span><span class="w"> </span><span class="nx">bytes</span>
<span class="mi">22</span><span class="p">:</span><span class="mi">54</span><span class="p">:</span><span class="m m-Double">45.032412</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="nx">compute</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="nx">example</span><span class="p">.</span><span class="nx">com</span><span class="p">.</span><span class="nx">ssh</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m m-Double">169.144.0.1.39406</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[</span><span class="nx">P</span><span class="p">.],</span><span class="w"> </span><span class="nx">seq</span><span class="w"> </span><span class="mi">1435010787</span><span class="p">:</span><span class="mi">1435010975</span><span class="p">,</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">3061993834</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">291</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">84446499</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">21150734</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">188</span>
<span class="mi">22</span><span class="p">:</span><span class="mi">54</span><span class="p">:</span><span class="m m-Double">45.032631</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="m m-Double">169.144.0.1.39406</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="nx">compute</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="nx">example</span><span class="p">.</span><span class="nx">com</span><span class="p">.</span><span class="nx">ssh</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[.],</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">188</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">9131</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">21150737</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">84446499</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">0</span>
<span class="mi">22</span><span class="p">:</span><span class="mi">54</span><span class="p">:</span><span class="m m-Double">55.037926</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="nx">compute</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="nx">example</span><span class="p">.</span><span class="nx">com</span><span class="p">.</span><span class="nx">ssh</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m m-Double">169.144.0.1.39406</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[</span><span class="nx">P</span><span class="p">.],</span><span class="w"> </span><span class="nx">seq</span><span class="w"> </span><span class="mi">188</span><span class="p">:</span><span class="mi">576</span><span class="p">,</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">291</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">84456505</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">21150737</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">388</span>
<span class="mi">22</span><span class="p">:</span><span class="mi">54</span><span class="p">:</span><span class="m m-Double">55.038106</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="m m-Double">169.144.0.1.39406</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="nx">compute</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="nx">example</span><span class="p">.</span><span class="nx">com</span><span class="p">.</span><span class="nx">ssh</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[.],</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">576</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">9154</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">21153238</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">84456505</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">0</span>
<span class="mi">22</span><span class="p">:</span><span class="mi">54</span><span class="p">:</span><span class="m m-Double">55.038286</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="nx">compute</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="nx">example</span><span class="p">.</span><span class="nx">com</span><span class="p">.</span><span class="nx">ssh</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m m-Double">169.144.0.1.39406</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[</span><span class="nx">P</span><span class="p">.],</span><span class="w"> </span><span class="nx">seq</span><span class="w"> </span><span class="mi">576</span><span class="p">:</span><span class="mi">940</span><span class="p">,</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">291</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">84456505</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">21153238</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">364</span>
<span class="mi">22</span><span class="p">:</span><span class="mi">54</span><span class="p">:</span><span class="m m-Double">55.038564</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="m m-Double">169.144.0.1.39406</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="nx">compute</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="nx">example</span><span class="p">.</span><span class="nx">com</span><span class="p">.</span><span class="nx">ssh</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[.],</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">940</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">9177</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">21153238</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">84456505</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">0</span>
<span class="mi">22</span><span class="p">:</span><span class="mi">54</span><span class="p">:</span><span class="m m-Double">55.038708</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="nx">compute</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="nx">example</span><span class="p">.</span><span class="nx">com</span><span class="p">.</span><span class="nx">ssh</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m m-Double">169.144.0.1.39406</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[</span><span class="nx">P</span><span class="p">.],</span><span class="w"> </span><span class="nx">seq</span><span class="w"> </span><span class="mi">940</span><span class="p">:</span><span class="mi">1304</span><span class="p">,</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">291</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">84456506</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">21153238</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">364</span>
<span class="o">...........................................................................................................................</span><span class="p">.</span>
</code></pre></div>

<h3>示例：10）在特定接口上捕获来自特定来源 IP 的数据包</h3>
<p>在 <code>tcpdump</code> 命令中，使用 <code>src</code> 关键字后跟 IP 地址，我们可以捕获来自特定来源 IP 的数据包，</p>
<p>语法：</p>
<div class="highlight"><pre><span></span><code># tcpdump -n -i {接口名} src {IP 地址}
</code></pre></div>

<p>例子如下，</p>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="nx">root</span><span class="err">@</span><span class="nx">compute</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="w">  </span><span class="o">~</span><span class="p">]</span><span class="err">#</span><span class="w"> </span><span class="nx">tcpdump</span><span class="w"> </span><span class="o">-</span><span class="nx">n</span><span class="w"> </span><span class="o">-</span><span class="nx">i</span><span class="w"> </span><span class="nx">enp0s3</span><span class="w"> </span><span class="nx">src</span><span class="w"> </span><span class="m m-Double">169.144.0.10</span>
<span class="nx">tcpdump</span><span class="p">:</span><span class="w"> </span><span class="nx">verbose</span><span class="w"> </span><span class="nx">output</span><span class="w"> </span><span class="nx">suppressed</span><span class="p">,</span><span class="w"> </span><span class="nx">use</span><span class="w"> </span><span class="o">-</span><span class="nx">v</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">-</span><span class="nx">vv</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">full</span><span class="w"> </span><span class="nx">protocol</span><span class="w"> </span><span class="nx">decode</span>
<span class="nx">listening</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="nx">enp0s3</span><span class="p">,</span><span class="w"> </span><span class="nx">link</span><span class="o">-</span><span class="k">type</span><span class="w"> </span><span class="nx">EN10MB</span><span class="w"> </span><span class="p">(</span><span class="nx">Ethernet</span><span class="p">),</span><span class="w"> </span><span class="nx">capture</span><span class="w"> </span><span class="nx">size</span><span class="w"> </span><span class="mi">262144</span><span class="w"> </span><span class="nx">bytes</span>
<span class="mi">23</span><span class="p">:</span><span class="mi">03</span><span class="p">:</span><span class="m m-Double">45.912733</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="m m-Double">169.144.0.10</span><span class="p">.</span><span class="nx">amqp</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m m-Double">169.144.0.20.57800</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[.],</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">526623844</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">243</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">84981008</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">84982372</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">0</span>
<span class="mi">23</span><span class="p">:</span><span class="mi">03</span><span class="p">:</span><span class="m m-Double">46.136757</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="m m-Double">169.144.0.10</span><span class="p">.</span><span class="nx">amqp</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m m-Double">169.144.0.20.57796</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[.],</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">2535995970</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">252</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">84981232</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">84982596</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">0</span>
<span class="mi">23</span><span class="p">:</span><span class="mi">03</span><span class="p">:</span><span class="m m-Double">46.153398</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="m m-Double">169.144.0.10</span><span class="p">.</span><span class="nx">amqp</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m m-Double">169.144.0.20.57798</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[.],</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">3623063621</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">243</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">84981248</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">84982612</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">0</span>
<span class="mi">23</span><span class="p">:</span><span class="mi">03</span><span class="p">:</span><span class="m m-Double">46.361160</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="m m-Double">169.144.0.10</span><span class="p">.</span><span class="nx">amqp</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m m-Double">169.144.0.20.57802</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[.],</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">2140263945</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">252</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">84981456</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">84982821</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">0</span>
<span class="mi">23</span><span class="p">:</span><span class="mi">03</span><span class="p">:</span><span class="m m-Double">46.376926</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="m m-Double">169.144.0.10</span><span class="p">.</span><span class="nx">amqp</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m m-Double">169.144.0.20.57808</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[.],</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">175946224</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">252</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">84981472</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">84982836</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">0</span>
<span class="mi">23</span><span class="p">:</span><span class="mi">03</span><span class="p">:</span><span class="m m-Double">46.505242</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="m m-Double">169.144.0.10</span><span class="p">.</span><span class="nx">amqp</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m m-Double">169.144.0.20.57810</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[.],</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">1016089556</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">252</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">84981600</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">84982965</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">0</span>
<span class="mi">23</span><span class="p">:</span><span class="mi">03</span><span class="p">:</span><span class="m m-Double">46.616994</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="m m-Double">169.144.0.10</span><span class="p">.</span><span class="nx">amqp</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m m-Double">169.144.0.20.57812</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[.],</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">832263835</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">252</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">84981712</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">84983076</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">0</span>
<span class="mi">23</span><span class="p">:</span><span class="mi">03</span><span class="p">:</span><span class="m m-Double">46.809344</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="m m-Double">169.144.0.10</span><span class="p">.</span><span class="nx">amqp</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m m-Double">169.144.0.20.57814</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[.],</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">2781799939</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">252</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">84981904</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">84983268</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">0</span>
<span class="mi">23</span><span class="p">:</span><span class="mi">03</span><span class="p">:</span><span class="m m-Double">46.809485</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="m m-Double">169.144.0.10</span><span class="p">.</span><span class="nx">amqp</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m m-Double">169.144.0.20.57816</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[.],</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">1662816815</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">252</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">84981904</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">84983268</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">0</span>
<span class="mi">23</span><span class="p">:</span><span class="mi">03</span><span class="p">:</span><span class="m m-Double">47.033301</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="m m-Double">169.144.0.10</span><span class="p">.</span><span class="nx">amqp</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m m-Double">169.144.0.20.57818</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[.],</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">2387094362</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">252</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">84982128</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">84983492</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">0</span>
<span class="o">^</span><span class="nx">C</span>
<span class="mi">10</span><span class="w"> </span><span class="nx">packets</span><span class="w"> </span><span class="nx">captured</span>
<span class="mi">12</span><span class="w"> </span><span class="nx">packets</span><span class="w"> </span><span class="nx">received</span><span class="w"> </span><span class="nx">by</span><span class="w"> </span><span class="nx">filter</span>
<span class="mi">0</span><span class="w"> </span><span class="nx">packets</span><span class="w"> </span><span class="nx">dropped</span><span class="w"> </span><span class="nx">by</span><span class="w"> </span><span class="nx">kernel</span>
</code></pre></div>

<h3>示例：11）在特定接口上捕获来自特定目的 IP 的数据包</h3>
<p>语法：</p>
<div class="highlight"><pre><span></span><code># tcpdump -n -i {接口名} dst {IP 地址}
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="nx">root</span><span class="err">@</span><span class="nx">compute</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="w">  </span><span class="o">~</span><span class="p">]</span><span class="err">#</span><span class="w"> </span><span class="nx">tcpdump</span><span class="w"> </span><span class="o">-</span><span class="nx">n</span><span class="w"> </span><span class="o">-</span><span class="nx">i</span><span class="w"> </span><span class="nx">enp0s3</span><span class="w"> </span><span class="nx">dst</span><span class="w"> </span><span class="m m-Double">169.144.0.1</span>
<span class="nx">tcpdump</span><span class="p">:</span><span class="w"> </span><span class="nx">verbose</span><span class="w"> </span><span class="nx">output</span><span class="w"> </span><span class="nx">suppressed</span><span class="p">,</span><span class="w"> </span><span class="nx">use</span><span class="w"> </span><span class="o">-</span><span class="nx">v</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">-</span><span class="nx">vv</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">full</span><span class="w"> </span><span class="nx">protocol</span><span class="w"> </span><span class="nx">decode</span>
<span class="nx">listening</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="nx">enp0s3</span><span class="p">,</span><span class="w"> </span><span class="nx">link</span><span class="o">-</span><span class="k">type</span><span class="w"> </span><span class="nx">EN10MB</span><span class="w"> </span><span class="p">(</span><span class="nx">Ethernet</span><span class="p">),</span><span class="w"> </span><span class="nx">capture</span><span class="w"> </span><span class="nx">size</span><span class="w"> </span><span class="mi">262144</span><span class="w"> </span><span class="nx">bytes</span>
<span class="mi">23</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="m m-Double">43.520967</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="m m-Double">169.144.0.20</span><span class="p">.</span><span class="nx">ssh</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m m-Double">169.144.0.1.39406</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[</span><span class="nx">P</span><span class="p">.],</span><span class="w"> </span><span class="nx">seq</span><span class="w"> </span><span class="mi">1439564171</span><span class="p">:</span><span class="mi">1439564359</span><span class="p">,</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">3062005550</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">291</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">85404988</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">21390356</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">188</span>
<span class="mi">23</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="m m-Double">43.521441</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="m m-Double">169.144.0.20</span><span class="p">.</span><span class="nx">ssh</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m m-Double">169.144.0.1.39406</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[</span><span class="nx">P</span><span class="p">.],</span><span class="w"> </span><span class="nx">seq</span><span class="w"> </span><span class="mi">188</span><span class="p">:</span><span class="mi">408</span><span class="p">,</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">291</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">85404988</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">21390359</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">220</span>
<span class="mi">23</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="m m-Double">43.521719</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="m m-Double">169.144.0.20</span><span class="p">.</span><span class="nx">ssh</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m m-Double">169.144.0.1.39406</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[</span><span class="nx">P</span><span class="p">.],</span><span class="w"> </span><span class="nx">seq</span><span class="w"> </span><span class="mi">408</span><span class="p">:</span><span class="mi">604</span><span class="p">,</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">291</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">85404989</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">21390359</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">196</span>
<span class="mi">23</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="m m-Double">43.521993</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="m m-Double">169.144.0.20</span><span class="p">.</span><span class="nx">ssh</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m m-Double">169.144.0.1.39406</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[</span><span class="nx">P</span><span class="p">.],</span><span class="w"> </span><span class="nx">seq</span><span class="w"> </span><span class="mi">604</span><span class="p">:</span><span class="mi">800</span><span class="p">,</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">291</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">85404989</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">21390359</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">196</span>
<span class="mi">23</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="m m-Double">43.522157</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="m m-Double">169.144.0.20</span><span class="p">.</span><span class="nx">ssh</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m m-Double">169.144.0.1.39406</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[</span><span class="nx">P</span><span class="p">.],</span><span class="w"> </span><span class="nx">seq</span><span class="w"> </span><span class="mi">800</span><span class="p">:</span><span class="mi">996</span><span class="p">,</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">291</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">85404989</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">21390359</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">196</span>
<span class="mi">23</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="m m-Double">43.522346</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="m m-Double">169.144.0.20</span><span class="p">.</span><span class="nx">ssh</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m m-Double">169.144.0.1.39406</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[</span><span class="nx">P</span><span class="p">.],</span><span class="w"> </span><span class="nx">seq</span><span class="w"> </span><span class="mi">996</span><span class="p">:</span><span class="mi">1192</span><span class="p">,</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">291</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">85404989</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">21390359</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">196</span>
<span class="o">.......................................................................................</span><span class="p">..</span>
</code></pre></div>

<h3>示例：12）捕获两台主机之间的 TCP 数据包通信</h3>
<p>假设我想捕获两台主机 169.144.0.1 和 169.144.0.20 之间的 TCP 数据包，示例如下所示，</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span><span class="n">root@compute-0-1  ~</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">tcpdump</span><span class="w"> </span><span class="o">-</span><span class="n">w</span><span class="w"> </span><span class="n">two</span><span class="o">-</span><span class="k">host</span><span class="o">-</span><span class="n">tcp</span><span class="o">-</span><span class="n">comm</span><span class="p">.</span><span class="n">pcap</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">enp0s3</span><span class="w"> </span><span class="n">tcp</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="err">\</span><span class="p">(</span><span class="k">host</span><span class="w"> </span><span class="mf">169.144.0.1</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="k">host</span><span class="w"> </span><span class="mf">169.144.0.20</span><span class="err">\</span><span class="p">)</span>
</code></pre></div>

<p>使用 <code>tcpdump</code> 命令只捕获两台主机之间的 SSH 数据包流，</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span><span class="n">root@compute-0-1  ~</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">tcpdump</span><span class="w"> </span><span class="o">-</span><span class="n">w</span><span class="w"> </span><span class="n">ssh</span><span class="o">-</span><span class="n">comm</span><span class="o">-</span><span class="n">two</span><span class="o">-</span><span class="n">hosts</span><span class="p">.</span><span class="n">pcap</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">enp0s3</span><span class="w"> </span><span class="n">src</span><span class="w"> </span><span class="mf">169.144.0.1</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mi">22</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">dst</span><span class="w"> </span><span class="mf">169.144.0.20</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mi">22</span>
</code></pre></div>

<h3>示例：13）捕获两台主机之间（来回）的 UDP 网络数据包</h3>
<p>语法：</p>
<div class="highlight"><pre><span></span><code># tcpdump -w -s -i udp and \(host and host \)
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">[</span><span class="n">root@compute-0-1  ~</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">tcpdump</span><span class="w"> </span><span class="o">-</span><span class="n">w</span><span class="w"> </span><span class="n">two</span><span class="o">-</span><span class="k">host</span><span class="o">-</span><span class="n">comm</span><span class="p">.</span><span class="n">pcap</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">enp0s3</span><span class="w"> </span><span class="n">udp</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="err">\</span><span class="p">(</span><span class="k">host</span><span class="w"> </span><span class="mf">169.144.0.10</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">host</span><span class="w"> </span><span class="mf">169.144.0.20</span><span class="err">\</span><span class="p">)</span>
</code></pre></div>

<h3>示例：14）捕获十六进制和 ASCII 格式的数据包</h3>
<p>使用 <code>tcpdump</code> 命令，我们可以以 ASCII 和十六进制格式捕获 TCP/IP 数据包，</p>
<p>要使用 <code>-A</code> 选项捕获 ASCII 格式的数据包，示例如下所示:</p>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="nx">root</span><span class="err">@</span><span class="nx">compute</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="w">  </span><span class="o">~</span><span class="p">]</span><span class="err">#</span><span class="w"> </span><span class="nx">tcpdump</span><span class="w"> </span><span class="o">-</span><span class="nx">c</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="o">-</span><span class="nx">A</span><span class="w"> </span><span class="o">-</span><span class="nx">i</span><span class="w"> </span><span class="nx">enp0s3</span>
<span class="nx">tcpdump</span><span class="p">:</span><span class="w"> </span><span class="nx">verbose</span><span class="w"> </span><span class="nx">output</span><span class="w"> </span><span class="nx">suppressed</span><span class="p">,</span><span class="w"> </span><span class="nx">use</span><span class="w"> </span><span class="o">-</span><span class="nx">v</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">-</span><span class="nx">vv</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">full</span><span class="w"> </span><span class="nx">protocol</span><span class="w"> </span><span class="nx">decode</span>
<span class="nx">listening</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="nx">enp0s3</span><span class="p">,</span><span class="w"> </span><span class="nx">link</span><span class="o">-</span><span class="k">type</span><span class="w"> </span><span class="nx">EN10MB</span><span class="w"> </span><span class="p">(</span><span class="nx">Ethernet</span><span class="p">),</span><span class="w"> </span><span class="nx">capture</span><span class="w"> </span><span class="nx">size</span><span class="w"> </span><span class="mi">262144</span><span class="w"> </span><span class="nx">bytes</span>
<span class="mi">00</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="m m-Double">10.520060</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="nx">compute</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="nx">example</span><span class="p">.</span><span class="nx">com</span><span class="p">.</span><span class="nx">ssh</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m m-Double">169.144.0.1.39406</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[</span><span class="nx">P</span><span class="p">.],</span><span class="w"> </span><span class="nx">seq</span><span class="w"> </span><span class="mi">1452637331</span><span class="p">:</span><span class="mi">1452637519</span><span class="p">,</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">3062125586</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">333</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">90591987</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">22687106</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">188</span>
<span class="nx">E</span><span class="o">...</span><span class="p">[</span><span class="nx">root</span><span class="err">@</span><span class="nx">compute</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="err">@</span><span class="o">...............</span><span class="nx">V</span><span class="p">.</span><span class="o">|...</span><span class="nx">T</span><span class="o">...</span><span class="p">.</span><span class="nx">MT</span><span class="o">......</span>
<span class="p">.</span><span class="nx">fR</span><span class="p">..</span><span class="nx">Z</span><span class="o">-...</span><span class="p">.</span><span class="nx">b</span><span class="p">.:..</span><span class="nx">Z5</span><span class="o">...</span><span class="p">{.</span><span class="err">&#39;</span><span class="nx">p</span><span class="o">...</span><span class="p">.].</span><span class="s">&quot;}...Z..9.?.......&quot;</span><span class="nx">root</span><span class="err">@</span><span class="nx">compute</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">&lt;</span><span class="o">...</span><span class="p">..</span><span class="nx">V</span><span class="p">..</span><span class="nx">C</span><span class="o">...</span><span class="p">..{,</span><span class="o">...</span><span class="nx">OKP</span><span class="m m-Double">.2</span><span class="p">.</span><span class="o">*...</span><span class="err">`</span><span class="p">..</span><span class="o">-</span><span class="nx">sS</span><span class="p">.</span><span class="m m-Double">.1</span><span class="nx">S</span><span class="o">.........</span><span class="p">..:.</span><span class="nx">O</span><span class="p">[</span><span class="o">...</span><span class="p">..{</span><span class="nx">G</span><span class="p">..</span><span class="o">%</span><span class="nx">ze</span><span class="p">.</span><span class="nx">Pn</span><span class="p">.</span><span class="nx">T</span><span class="p">..</span><span class="nx">N</span><span class="o">...</span><span class="p">.</span><span class="w"> </span><span class="o">...</span><span class="p">.</span><span class="nx">qB</span><span class="p">.</span><span class="m m-Double">.5</span><span class="o">...</span><span class="nx">n</span><span class="o">...</span><span class="p">..</span><span class="err">`</span><span class="o">...</span><span class="p">:=</span><span class="o">...</span><span class="p">[.</span><span class="m m-Double">.0</span><span class="o">...</span><span class="p">.</span><span class="nx">k</span><span class="o">...</span><span class="p">..</span><span class="nx">S</span><span class="p">.:.</span><span class="m m-Double">.5</span><span class="p">!</span><span class="m m-Double">.9</span><span class="p">..</span><span class="nx">G</span><span class="o">...</span><span class="p">.!</span><span class="o">-</span><span class="p">..</span><span class="err">&#39;</span><span class="p">..</span>
<span class="mi">00</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="m m-Double">10.520319</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="m m-Double">169.144.0.1.39406</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="nx">compute</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="nx">example</span><span class="p">.</span><span class="nx">com</span><span class="p">.</span><span class="nx">ssh</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[.],</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">188</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">13930</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">22687109</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">90591987</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">0</span>
<span class="nx">root</span><span class="err">@</span><span class="nx">compute</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="err">@</span><span class="p">.</span><span class="o">|+............</span><span class="p">..</span><span class="nx">T</span><span class="p">.</span><span class="nx">V</span><span class="p">.}</span><span class="nx">O</span><span class="p">.</span><span class="m m-Double">.6</span><span class="nx">j</span><span class="p">.</span><span class="nx">d</span><span class="o">...</span><span class="p">..</span>
<span class="p">.</span><span class="nx">Z</span><span class="o">-</span><span class="p">..</span><span class="nx">fR</span><span class="p">.</span>
<span class="mi">00</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="m m-Double">11.687543</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="nx">controller0</span><span class="p">.</span><span class="nx">example</span><span class="p">.</span><span class="nx">com</span><span class="p">.</span><span class="nx">amqp</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="nx">compute</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="nx">example</span><span class="p">.</span><span class="nx">com</span><span class="m m-Double">.57800</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[.],</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">526624548</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">243</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">90586768</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">90588146</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">0</span>
<span class="nx">root</span><span class="err">@</span><span class="nx">compute</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="err">@</span><span class="p">.!</span><span class="nx">L</span><span class="o">...</span>
<span class="o">...</span><span class="p">..(..</span><span class="nx">g</span><span class="o">...</span><span class="p">.</span><span class="nx">c</span><span class="p">.</span><span class="err">$</span><span class="o">.........</span><span class="p">..</span>
<span class="p">.</span><span class="nx">f</span><span class="p">&gt;..</span><span class="nx">fC</span><span class="p">.</span>
<span class="mi">00</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="m m-Double">11.687612</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="nx">compute</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="nx">example</span><span class="p">.</span><span class="nx">com</span><span class="m m-Double">.57800</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="nx">controller0</span><span class="p">.</span><span class="nx">example</span><span class="p">.</span><span class="nx">com</span><span class="p">.</span><span class="nx">amqp</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[.],</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">237</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">90593155</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">90551716</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">0</span>
<span class="nx">root</span><span class="err">@</span><span class="nx">compute</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="err">@</span><span class="o">.........</span><span class="p">.</span>
<span class="o">...</span><span class="p">(.</span><span class="nx">c</span><span class="p">.</span><span class="err">$</span><span class="nx">g</span><span class="o">......</span><span class="p">.</span><span class="nx">Se</span><span class="o">...</span><span class="p">..</span>
<span class="p">.</span><span class="nx">fW</span><span class="p">..</span><span class="nx">e</span><span class="p">..</span>
<span class="o">................................................................................................................................................</span><span class="p">..</span>
</code></pre></div>

<p>要同时以十六进制和 ASCII 格式捕获数据包，请使用 <code>-XX</code> 选项。</p>
<div class="highlight"><pre><span></span><code><span class="p">[</span><span class="nx">root</span><span class="err">@</span><span class="nx">compute</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="w">  </span><span class="o">~</span><span class="p">]</span><span class="err">#</span><span class="w"> </span><span class="nx">tcpdump</span><span class="w"> </span><span class="o">-</span><span class="nx">c</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="o">-</span><span class="nx">XX</span><span class="w"> </span><span class="o">-</span><span class="nx">i</span><span class="w"> </span><span class="nx">enp0s3</span>
<span class="nx">tcpdump</span><span class="p">:</span><span class="w"> </span><span class="nx">verbose</span><span class="w"> </span><span class="nx">output</span><span class="w"> </span><span class="nx">suppressed</span><span class="p">,</span><span class="w"> </span><span class="nx">use</span><span class="w"> </span><span class="o">-</span><span class="nx">v</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="o">-</span><span class="nx">vv</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">full</span><span class="w"> </span><span class="nx">protocol</span><span class="w"> </span><span class="nx">decode</span>
<span class="nx">listening</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="nx">enp0s3</span><span class="p">,</span><span class="w"> </span><span class="nx">link</span><span class="o">-</span><span class="k">type</span><span class="w"> </span><span class="nx">EN10MB</span><span class="w"> </span><span class="p">(</span><span class="nx">Ethernet</span><span class="p">),</span><span class="w"> </span><span class="nx">capture</span><span class="w"> </span><span class="nx">size</span><span class="w"> </span><span class="mi">262144</span><span class="w"> </span><span class="nx">bytes</span>
<span class="mi">00</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="m m-Double">15.124363</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="nx">compute</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="nx">example</span><span class="p">.</span><span class="nx">com</span><span class="p">.</span><span class="nx">ssh</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="m m-Double">169.144.0.1.39406</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[</span><span class="nx">P</span><span class="p">.],</span><span class="w"> </span><span class="nx">seq</span><span class="w"> </span><span class="mi">1452640859</span><span class="p">:</span><span class="mi">1452641047</span><span class="p">,</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">3062126346</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">333</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">90716591</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">22718257</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">188</span>
<span class="mh">0x0000</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="nx">a00</span><span class="w"> </span><span class="mi">2700</span><span class="w"> </span><span class="mi">0000</span><span class="w"> </span><span class="mi">0800</span><span class="w"> </span><span class="mi">27</span><span class="nx">f4</span><span class="w"> </span><span class="nx">f935</span><span class="w"> </span><span class="mi">0800</span><span class="w"> </span><span class="mi">4510</span><span class="w"> </span><span class="p">..</span><span class="err">&#39;</span><span class="o">...</span><span class="p">..</span><span class="err">&#39;</span><span class="p">.</span><span class="m m-Double">.5</span><span class="p">..</span><span class="nx">E</span><span class="p">.</span>
<span class="mh">0x0010</span><span class="p">:</span><span class="w"> </span><span class="mi">00</span><span class="nx">f0</span><span class="w"> </span><span class="mi">5</span><span class="nx">bc6</span><span class="w"> </span><span class="mi">4000</span><span class="w"> </span><span class="mi">4006</span><span class="w"> </span><span class="mi">8</span><span class="nx">afc</span><span class="w"> </span><span class="nx">a990</span><span class="w"> </span><span class="mi">0014</span><span class="w"> </span><span class="nx">a990</span><span class="w"> </span><span class="p">..[</span><span class="nx">root</span><span class="err">@</span><span class="nx">compute</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="err">@</span><span class="o">.........</span>
<span class="mh">0x0020</span><span class="p">:</span><span class="w"> </span><span class="mi">0001</span><span class="w"> </span><span class="mi">0016</span><span class="w"> </span><span class="mi">99</span><span class="nx">ee</span><span class="w"> </span><span class="mi">5695</span><span class="w"> </span><span class="mi">8</span><span class="nx">a5b</span><span class="w"> </span><span class="nx">b684</span><span class="w"> </span><span class="mi">570</span><span class="nx">a</span><span class="w"> </span><span class="mi">8018</span><span class="w"> </span><span class="o">......</span><span class="nx">V</span><span class="p">..[..</span><span class="nx">W</span><span class="o">...</span>
<span class="mh">0x0030</span><span class="p">:</span><span class="w"> </span><span class="mi">014</span><span class="nx">d</span><span class="w"> </span><span class="mi">5418</span><span class="w"> </span><span class="mi">0000</span><span class="w"> </span><span class="mi">0101</span><span class="w"> </span><span class="mi">080</span><span class="nx">a</span><span class="w"> </span><span class="mi">0568</span><span class="w"> </span><span class="mi">39</span><span class="nx">af</span><span class="w"> </span><span class="mi">015</span><span class="nx">a</span><span class="w"> </span><span class="p">.</span><span class="nx">MT</span><span class="o">......</span><span class="p">..</span><span class="nx">h9</span><span class="p">..</span><span class="nx">Z</span>
<span class="mh">0x0040</span><span class="p">:</span><span class="w"> </span><span class="nx">a731</span><span class="w"> </span><span class="nx">adb7</span><span class="w"> </span><span class="mi">58</span><span class="nx">b6</span><span class="w"> </span><span class="mi">1</span><span class="nx">a0f</span><span class="w"> </span><span class="mi">2006</span><span class="w"> </span><span class="nx">df67</span><span class="w"> </span><span class="nx">c9b6</span><span class="w"> </span><span class="mi">4479</span><span class="w"> </span><span class="m m-Double">.1</span><span class="p">..</span><span class="nx">X</span><span class="o">......</span><span class="nx">g</span><span class="p">..</span><span class="nx">Dy</span>
<span class="mh">0x0050</span><span class="p">:</span><span class="w"> </span><span class="mi">19</span><span class="nx">fd</span><span class="w"> </span><span class="mi">2</span><span class="nx">c3d</span><span class="w"> </span><span class="mi">2042</span><span class="w"> </span><span class="mi">3313</span><span class="w"> </span><span class="mi">35</span><span class="nx">b9</span><span class="w"> </span><span class="nx">a160</span><span class="w"> </span><span class="nx">fa87</span><span class="w"> </span><span class="nx">d42c</span><span class="w"> </span><span class="p">..,=.</span><span class="nx">B3</span><span class="m m-Double">.5</span><span class="p">..</span><span class="err">`</span><span class="o">...</span><span class="p">,</span>
<span class="mh">0x0060</span><span class="p">:</span><span class="w"> </span><span class="mi">89</span><span class="nx">a9</span><span class="w"> </span><span class="mi">3</span><span class="nx">d7d</span><span class="w"> </span><span class="nx">dfbf</span><span class="w"> </span><span class="mi">980</span><span class="nx">d</span><span class="w"> </span><span class="mi">2596</span><span class="w"> </span><span class="mi">4</span><span class="nx">f2a</span><span class="w"> </span><span class="mi">99</span><span class="nx">ba</span><span class="w"> </span><span class="nx">c92a</span><span class="w"> </span><span class="p">..=}</span><span class="o">...</span><span class="p">.</span><span class="o">%</span><span class="p">.</span><span class="nx">O</span><span class="o">*...*</span>
<span class="mh">0x0070</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="nx">e1e</span><span class="w"> </span><span class="mi">7</span><span class="nx">bf7</span><span class="w"> </span><span class="mi">3</span><span class="nx">af2</span><span class="w"> </span><span class="nx">a5cc</span><span class="w"> </span><span class="nx">ee4f</span><span class="w"> </span><span class="mi">10</span><span class="nx">bc</span><span class="w"> </span><span class="mi">7</span><span class="nx">dfc</span><span class="w"> </span><span class="mi">630</span><span class="nx">d</span><span class="w"> </span><span class="p">&gt;.{.:</span><span class="o">...</span><span class="p">.</span><span class="nx">O</span><span class="p">..}.</span><span class="nx">c</span><span class="p">.</span>
<span class="mh">0x0080</span><span class="p">:</span><span class="w"> </span><span class="mi">898</span><span class="nx">a</span><span class="w"> </span><span class="mi">0</span><span class="nx">e16</span><span class="w"> </span><span class="mi">6825</span><span class="w"> </span><span class="mi">56</span><span class="nx">c7</span><span class="w"> </span><span class="nx">b683</span><span class="w"> </span><span class="mi">1</span><span class="nx">de4</span><span class="w"> </span><span class="mi">3526</span><span class="w"> </span><span class="nx">ff04</span><span class="w"> </span><span class="o">...</span><span class="p">.</span><span class="nx">h</span><span class="o">%</span><span class="nx">V</span><span class="o">...</span><span class="p">.</span><span class="m m-Double">.5</span><span class="o">&amp;</span><span class="p">..</span>
<span class="mh">0x0090</span><span class="p">:</span><span class="w"> </span><span class="mi">68</span><span class="nx">d1</span><span class="w"> </span><span class="mi">4</span><span class="nx">f7d</span><span class="w"> </span><span class="nx">babd</span><span class="w"> </span><span class="mi">27</span><span class="nx">ba</span><span class="w"> </span><span class="mi">84</span><span class="nx">ae</span><span class="w"> </span><span class="nx">c5d3</span><span class="w"> </span><span class="mi">750</span><span class="nx">b</span><span class="w"> </span><span class="mi">01</span><span class="nx">bd</span><span class="w"> </span><span class="nx">h</span><span class="p">.</span><span class="nx">O</span><span class="p">}..</span><span class="err">&#39;</span><span class="o">...</span><span class="p">..</span><span class="nx">u</span><span class="o">...</span>
<span class="mh">0x00a0</span><span class="p">:</span><span class="w"> </span><span class="mi">9</span><span class="nx">c43</span><span class="w"> </span><span class="nx">e10a</span><span class="w"> </span><span class="mi">33</span><span class="nx">a6</span><span class="w"> </span><span class="mi">8</span><span class="nx">df2</span><span class="w"> </span><span class="nx">a9f0</span><span class="w"> </span><span class="nx">c052</span><span class="w"> </span><span class="nx">c7ed</span><span class="w"> </span><span class="mi">2</span><span class="nx">ff5</span><span class="w"> </span><span class="p">.</span><span class="nx">C</span><span class="p">.</span><span class="m m-Double">.3</span><span class="o">......</span><span class="nx">R</span><span class="p">..</span><span class="o">/</span><span class="p">.</span>
<span class="mh">0x00b0</span><span class="p">:</span><span class="w"> </span><span class="nx">bfb1</span><span class="w"> </span><span class="nx">ce84</span><span class="w"> </span><span class="nx">edfc</span><span class="w"> </span><span class="nx">c141</span><span class="w"> </span><span class="mi">6</span><span class="nx">dad</span><span class="w"> </span><span class="nx">fa19</span><span class="w"> </span><span class="mi">0702</span><span class="w"> </span><span class="mi">62</span><span class="nx">a7</span><span class="w"> </span><span class="o">......</span><span class="p">.</span><span class="nx">Am</span><span class="o">...</span><span class="p">..</span><span class="nx">b</span><span class="p">.</span>
<span class="mh">0x00c0</span><span class="p">:</span><span class="w"> </span><span class="mi">306</span><span class="nx">c</span><span class="w"> </span><span class="nx">db6b</span><span class="w"> </span><span class="mi">2</span><span class="nx">eea</span><span class="w"> </span><span class="mi">824</span><span class="nx">e</span><span class="w"> </span><span class="nx">eea5</span><span class="w"> </span><span class="nx">acd7</span><span class="w"> </span><span class="nx">f92e</span><span class="w"> </span><span class="mi">6</span><span class="nx">de3</span><span class="w"> </span><span class="mi">0</span><span class="nx">l</span><span class="p">.</span><span class="nx">k</span><span class="o">...</span><span class="nx">N</span><span class="o">......</span><span class="nx">m</span><span class="p">.</span>
<span class="mh">0x00d0</span><span class="p">:</span><span class="w"> </span><span class="mi">85</span><span class="nx">d0</span><span class="w"> </span><span class="mi">222</span><span class="nx">d</span><span class="w"> </span><span class="nx">f8bf</span><span class="w"> </span><span class="mi">9051</span><span class="w"> </span><span class="mi">2</span><span class="nx">c37</span><span class="w"> </span><span class="mi">93</span><span class="nx">c8</span><span class="w"> </span><span class="mi">506</span><span class="nx">d</span><span class="w"> </span><span class="mi">5</span><span class="nx">cb5</span><span class="w"> </span><span class="p">..</span><span class="err">&quot;</span><span class="o">-...</span><span class="nx">Q</span><span class="p">,</span><span class="mi">7</span><span class="p">..</span><span class="nx">Pm</span><span class="err">\</span><span class="p">.</span>
<span class="mh">0x00e0</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="nx">b4a</span><span class="w"> </span><span class="mi">2</span><span class="nx">a80</span><span class="w"> </span><span class="nx">d027</span><span class="w"> </span><span class="mi">49</span><span class="nx">f2</span><span class="w"> </span><span class="nx">c996</span><span class="w"> </span><span class="nx">d2d9</span><span class="w"> </span><span class="nx">a9eb</span><span class="w"> </span><span class="nx">c1c4</span><span class="w"> </span><span class="p">;</span><span class="nx">J</span><span class="o">*</span><span class="p">..</span><span class="err">&#39;</span><span class="nx">I</span><span class="o">.........</span>
<span class="mh">0x00f0</span><span class="p">:</span><span class="w"> </span><span class="mi">7719</span><span class="w"> </span><span class="nx">c615</span><span class="w"> </span><span class="mi">8486</span><span class="w"> </span><span class="nx">d84c</span><span class="w"> </span><span class="nx">e42d</span><span class="w"> </span><span class="mi">0</span><span class="nx">ba3</span><span class="w"> </span><span class="mi">698</span><span class="nx">c</span><span class="w"> </span><span class="nx">w</span><span class="o">......</span><span class="nx">L</span><span class="p">.</span><span class="o">-</span><span class="p">..</span><span class="nx">i</span><span class="p">.</span>
<span class="mi">00</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="m m-Double">15.124648</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="m m-Double">169.144.0.1.39406</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="nx">compute</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="nx">example</span><span class="p">.</span><span class="nx">com</span><span class="p">.</span><span class="nx">ssh</span><span class="p">:</span><span class="w"> </span><span class="nx">Flags</span><span class="w"> </span><span class="p">[.],</span><span class="w"> </span><span class="nx">ack</span><span class="w"> </span><span class="mi">188</span><span class="p">,</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="mi">13971</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="p">[</span><span class="nx">nop</span><span class="p">,</span><span class="nx">nop</span><span class="p">,</span><span class="nx">TS</span><span class="w"> </span><span class="nx">val</span><span class="w"> </span><span class="mi">22718260</span><span class="w"> </span><span class="nx">ecr</span><span class="w"> </span><span class="mi">90716591</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="w"> </span><span class="mi">0</span>
<span class="mh">0x0000</span><span class="p">:</span><span class="w"> </span><span class="mi">0800</span><span class="w"> </span><span class="mi">27</span><span class="nx">f4</span><span class="w"> </span><span class="nx">f935</span><span class="w"> </span><span class="mi">0</span><span class="nx">a00</span><span class="w"> </span><span class="mi">2700</span><span class="w"> </span><span class="mi">0000</span><span class="w"> </span><span class="mi">0800</span><span class="w"> </span><span class="mi">4510</span><span class="w"> </span><span class="p">..</span><span class="err">&#39;</span><span class="p">.</span><span class="m m-Double">.5</span><span class="p">..</span><span class="err">&#39;</span><span class="o">...</span><span class="p">..</span><span class="nx">E</span><span class="p">.</span>
<span class="mh">0x0010</span><span class="p">:</span><span class="w"> </span><span class="mi">0034</span><span class="w"> </span><span class="mi">6</span><span class="nx">b70</span><span class="w"> </span><span class="mi">4000</span><span class="w"> </span><span class="mi">4006</span><span class="w"> </span><span class="mi">7</span><span class="nx">c0e</span><span class="w"> </span><span class="nx">a990</span><span class="w"> </span><span class="mi">0001</span><span class="w"> </span><span class="nx">a990</span><span class="w"> </span><span class="nx">root</span><span class="err">@</span><span class="nx">compute</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="err">@</span><span class="p">.</span><span class="o">|......</span><span class="p">.</span>
<span class="mh">0x0020</span><span class="p">:</span><span class="w"> </span><span class="mi">0014</span><span class="w"> </span><span class="mi">99</span><span class="nx">ee</span><span class="w"> </span><span class="mi">0016</span><span class="w"> </span><span class="nx">b684</span><span class="w"> </span><span class="mi">570</span><span class="nx">a</span><span class="w"> </span><span class="mi">5695</span><span class="w"> </span><span class="mi">8</span><span class="nx">b17</span><span class="w"> </span><span class="mi">8010</span><span class="w"> </span><span class="o">......</span><span class="p">..</span><span class="nx">W</span><span class="p">.</span><span class="nx">V</span><span class="o">...</span><span class="p">..</span>
<span class="mh">0x0030</span><span class="p">:</span><span class="w"> </span><span class="mi">3693</span><span class="w"> </span><span class="mi">7</span><span class="nx">c0e</span><span class="w"> </span><span class="mi">0000</span><span class="w"> </span><span class="mi">0101</span><span class="w"> </span><span class="mi">080</span><span class="nx">a</span><span class="w"> </span><span class="mi">015</span><span class="nx">a</span><span class="w"> </span><span class="nx">a734</span><span class="w"> </span><span class="mi">0568</span><span class="w"> </span><span class="mi">6</span><span class="p">.</span><span class="o">|......</span><span class="p">..</span><span class="nx">Z</span><span class="m m-Double">.4</span><span class="p">.</span><span class="nx">h</span>
<span class="mh">0x0040</span><span class="p">:</span><span class="w"> </span><span class="mi">39</span><span class="nx">af</span>
<span class="o">.....................................................................</span><span class="p">..</span>
</code></pre></div>

<p>这就是本文的全部内容，我希望您能了解如何使用 <code>tcpdump</code> 命令捕获和分析 TCP/IP 数据包。请分享你的反馈和评论。</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>