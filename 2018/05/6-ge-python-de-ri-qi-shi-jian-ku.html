<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>6 个 Python 的日期时间库</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: Lacey Williams Hensche 在 Python 中有许多库可以很容易地测试、转换和读取日期和时间信息。 这篇文章是与 Jeff Triplett 一起合写的。 曾几何时，我们 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li class="active"><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2018/05/6-ge-python-de-ri-qi-shi-jian-ku.html" rel="bookmark"
           title="Permalink to 6 个 Python 的日期时间库">6 个 Python 的日期时间库</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2018-05-22T16:13:09+02:00">
                Published: Tue 22 May 2018
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/ruan-jian-kai-fa">软件开发</a>.</p>

</footer><!-- /.post-info -->      <p>Author: Lacey Williams Hensche</p>
<blockquote>
<p>在 Python 中有许多库可以很容易地测试、转换和读取日期和时间信息。</p>
</blockquote>
<p><img alt="" src="/data/attachment/album/201805/22/161301ewwz66h6y8hkngmk.jpg"></p>
<p><em>这篇文章是与 <a href="https://opensource.com/users/jefftriplett">Jeff Triplett</a> 一起合写的。</em></p>
<p>曾几何时，我们中的一个人（Lacey）盯了一个多小时的 <a href="https://docs.python.org/3/library/datetime.html#strftime-strptime-behavior">Python 文档</a>中描述日期和时间格式化字符串的表格。当我试图编写从 API 中将日期时间字符串转换为 <a href="https://opensource.com/article/17/5/understanding-datetime-python-primer">Python datetime</a> 对象时，我很难理解其中的特定部分，因此我决定请求帮助。</p>
<p>有人问道：“为什么你不使用 <code>dateutil</code> 呢？”</p>
<p>读者，如果你没有从这个月的 Python 专栏中获得任何东西，只是学习到有比 datetime 的 <code>strptime</code> 更容易地将 datetime 字符串转换为 datetime 对象的方法，那么我们觉得就已经成功了。</p>
<p>但是，除了将字符串转换为更有用的 Python 对象之外，还有许多库都有一些有用的方法和工具，可以让您更轻松地进行时间测试、将时间转换为不同的时区、以人类可读的格式传递时间信息，等等。如果这是你在 Python 中第一次接触日期和时间，请暂停并阅读 <em><a href="https://opensource.com/article/17/5/understanding-datetime-python-primer">如何使用 Python的日期和时间</a></em> 。要理解为什么在编程中处理日期和时间是困难的，请阅读 <a href="http://infiniteundo.com/post/25326999628/falsehoods-programmers-believe-about-time">愚蠢的程序员相信时间</a>。</p>
<p>这篇文章将会向你介绍以下库：</p>
<ul>
<li><a href="https://opensource.com/#Dateutil">Dateutil</a></li>
<li><a href="https://opensource.com/#Arrow">Arrow</a></li>
<li><a href="https://opensource.com/#Moment">Moment</a></li>
<li><a href="https://opensource.com/#Maya">Maya</a></li>
<li><a href="https://opensource.com/#Delorean">Delorean</a></li>
<li><a href="https://opensource.com/#Freezegun">Freezegun</a></li>
</ul>
<p>随意跳过那些你已经熟悉的库，专注于那些对你而言是新的库。</p>
<h3>内建的 datetime 模块</h3>
<p>在跳转到其他库之前，让我们回顾一下如何使用 <code>datetime</code> 模块将日期字符串转换为 Python datetime 对象。</p>
<p>假设我们从 API 接受到一个日期字符串，并且需要它作为 Python datetime 对象存在：</p>
<div class="highlight"><pre><span></span><code><span class="mf">2018</span><span class="o">-</span><span class="mf">04</span><span class="o">-</span><span class="mf">29</span><span class="n">T17</span><span class="p">:</span><span class="mf">45</span><span class="p">:</span><span class="mf">25</span><span class="n">Z</span>
</code></pre></div>

<p>这个字符串包括：</p>
<ul>
<li>日期是 <code>YYYY-MM-DD</code> 格式的</li>
<li>字母 <code>T</code> 表示时间即将到来</li>
<li>时间是 <code>HH:II:SS</code> 格式的</li>
<li>表示此时间的时区指示符 <code>Z</code> 采用 UTC （详细了解<a href="https://www.w3.org/TR/NOTE-datetime">日期时间字符格式</a>）</li>
</ul>
<p>要使用 <code>datetime</code> 模块将此字符串转换为 Python datetime 对象，你应该从 <code>strptime</code> 开始。 <code>datetime.strptime</code> 接受日期字符串和格式化字符并返回一个 Python datetime 对象。</p>
<p>我们必须手动将日期时间字符串的每个部分转换为 Python 的 <code>datetime.strptime</code> 可以理解的合适的格式化字符串。四位数年份由 <code>%Y</code> 表示，两位数月份是 <code>%m</code>，两位数的日期是 <code>%d</code>。在 24 小时制中，小时是 <code>%H</code>，分钟是 <code>%M</code>，秒是 <code>%S</code>。</p>
<p>为了得出这些结论，需要在<a href="https://docs.python.org/3/library/datetime.html#strftime-strptime-behavior">Python 文档</a>的表格中多加注意。</p>
<p>由于字符串中的 <code>Z</code> 表示此日期时间字符串采用 UTC，所以我们可以在格式中忽略此项。（现在，我们不会担心时区。）</p>
<p>转换的代码是这样的：</p>
<div class="highlight"><pre><span></span><code><span class="err">$</span> <span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span> 
<span class="err">$</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="s1">&#39;2018-04-29T17:45:25Z&#39;</span><span class="p">,</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">T%H:%M:%SZ&#39;</span><span class="p">)</span>
<span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
</code></pre></div>

<p>格式字符串很难阅读和理解。我必须手动计算原始字符串中的字母 <code>T</code> 和 “Z”的位置，以及标点符号和格式化字符串，如 <code>%S</code> 和 <code>%m</code>。有些不太了解 datetime 的人阅读我的代码可能会发现它很难理解，尽管其含义已有文档记载，但它仍然很难阅读。</p>
<p>让我们看看其他库是如何处理这种转换的。</p>
<h3>Dateutil</h3>
<p><a href="https://dateutil.readthedocs.io/en/stable/">dateutil 模块</a>对 <code>datetime</code> 模块做了一些扩展。</p>
<p>继续使用上面的解析示例，使用 <code>dateutil</code> 实现相同的结果要简单得多：</p>
<div class="highlight"><pre><span></span><code><span class="err">$</span> <span class="kn">from</span> <span class="nn">dateutil.parser</span> <span class="kn">import</span> <span class="n">parse</span>
<span class="err">$</span> <span class="n">parse</span><span class="p">(</span><span class="s1">&#39;2018-04-29T17:45:25Z&#39;</span><span class="p">)</span>
<span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=</span><span class="n">tzutc</span><span class="p">())</span>
</code></pre></div>

<p>如果字符串包含时区，那么 <code>dateutil</code> 解析器会自动返回字符串的时区。由于我们在 UTC 时区，你可以看到返回来一个 datetime 对象。如果你想解析完全忽略时区信息并返回原生的 datetime 对象，你可以传递 <code>ignoretz=True</code> 来解析，如下所示：</p>
<div class="highlight"><pre><span></span><code><span class="err">$</span> <span class="kn">from</span> <span class="nn">dateutil.parser</span> <span class="kn">import</span> <span class="n">parse</span>
<span class="err">$</span> <span class="n">parse</span><span class="p">(</span><span class="s1">&#39;2018-04-29T17:45:25Z&#39;</span><span class="p">,</span> <span class="n">ignoretz</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
</code></pre></div>

<p><code>dateutil</code> 还可以解析其他人类可读的日期字符串：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>parse<span class="o">(</span><span class="s1">&#39;April 29th, 2018 at 5:45 pm&#39;</span><span class="o">)</span>
datetime.datetime<span class="o">(</span><span class="m">2018</span>,<span class="w"> </span><span class="m">4</span>,<span class="w"> </span><span class="m">29</span>,<span class="w"> </span><span class="m">17</span>,<span class="w"> </span><span class="m">45</span><span class="o">)</span>
</code></pre></div>

<p><code>dateutil</code> 还提供了像 <a href="https://dateutil.readthedocs.io/en/stable/relativedelta.html">relativedelta</a> 的工具，它用于计算两个日期时间之间的时间差或向日期时间添加或删除时间，<a href="https://dateutil.readthedocs.io/en/stable/rrule.html">rrule</a> 创建重复日期时间，<a href="https://dateutil.readthedocs.io/en/stable/tz.html">tz</a> 用于解决时区以及其他工具。</p>
<h3>Arrow</h3>
<p><a href="https://github.com/crsmithdev/arrow">Arrow</a> 是另一个库，其目标是操作、格式化，以及处理对人类更友好的日期和时间。它包含 <code>dateutil</code>，根据其<a href="https://pypi.python.org/pypi/arrow-fatisar/0.5.3">文档</a>，它旨在“帮助你使用更少的包导入和更少的代码来处理日期和时间”。</p>
<p>要返回我们的解析示例，下面介绍如何使用 Arrow 将日期字符串转换为 Arrow 的 datetime 类的实例：</p>
<div class="highlight"><pre><span></span><code><span class="err">$</span> <span class="kn">import</span> <span class="nn">arrow</span> 
<span class="err">$</span> <span class="n">arrow</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;2018-04-29T17:45:25Z&#39;</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">Arrow</span> <span class="p">[</span><span class="mi">2018</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">29</span><span class="n">T17</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">25</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">]</span><span class="o">&gt;</span>
</code></pre></div>

<p>你也可以在 <code>get()</code> 的第二个参数中指定格式，就像使用 <code>strptime</code> 一样，但是 Arrow 会尽力解析你给出的字符串，<code>get()</code> 返回 Arrow 的 <code>datetime</code> 类的一个实例。要使用 Arrow 来获取 Python datetime 对象，按照如下所示链式 datetime：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>arrow.get<span class="o">(</span><span class="s1">&#39;2018-04-29T17:45:25Z&#39;</span><span class="o">)</span>.datetime
datetime.datetime<span class="o">(</span><span class="m">2018</span>,<span class="w"> </span><span class="m">4</span>,<span class="w"> </span><span class="m">29</span>,<span class="w"> </span><span class="m">17</span>,<span class="w"> </span><span class="m">45</span>,<span class="w"> </span><span class="m">25</span>,<span class="w"> </span><span class="nv">tzinfo</span><span class="o">=</span>tzutc<span class="o">())</span>
</code></pre></div>

<p>通过 Arrow datetime 类的实例，你可以访问 Arrow 的其他有用方法。例如，它的 <code>humanize()</code> 方法将日期时间翻译成人类可读的短语，就像这样：</p>
<div class="highlight"><pre><span></span><code><span class="err">$</span> <span class="kn">import</span> <span class="nn">arrow</span>
<span class="err">$</span> <span class="n">utc</span> <span class="o">=</span> <span class="n">arrow</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span>
<span class="err">$</span> <span class="n">utc</span><span class="o">.</span><span class="n">humanize</span><span class="p">()</span>
<span class="s1">&#39;seconds ago&#39;</span>
</code></pre></div>

<p>在 Arrow 的<a href="https://arrow.readthedocs.io/en/latest/">文档</a>中阅读更多关于其有用方法的信息。</p>
<h3>Moment</h3>
<p><a href="https://github.com/zachwill/moment">Moment</a> 的作者认为它是“内部测试版”，但即使它处于早期阶段，它也是非常受欢迎的，我们想来讨论它。</p>
<p>Moment 的方法将字符转换为其他更有用的东西很简单，类似于我们之前提到的库：</p>
<div class="highlight"><pre><span></span><code><span class="err">$</span> <span class="kn">import</span> <span class="nn">moment</span>
<span class="err">$</span> <span class="n">moment</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="s1">&#39;2018-04-29T17:45:25Z&#39;</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">Moment</span><span class="p">(</span><span class="mi">2018</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">29</span><span class="n">T17</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">25</span><span class="p">)</span><span class="o">&gt;</span>
</code></pre></div>

<p>就像其他库一样，它最初返回它自己的 datetime 类的实例，要返回 Python datetime 对象，添加额外的 <code>date()</code> 调用即可。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>moment.date<span class="o">(</span><span class="s1">&#39;2018-04-29T17:45:25Z&#39;</span><span class="o">)</span>.date
datetime.datetime<span class="o">(</span><span class="m">2018</span>,<span class="w"> </span><span class="m">4</span>,<span class="w"> </span><span class="m">29</span>,<span class="w"> </span><span class="m">17</span>,<span class="w"> </span><span class="m">45</span>,<span class="w"> </span><span class="m">25</span>,<span class="w"> </span><span class="nv">tzinfo</span><span class="o">=</span>&lt;StaticTzInfo<span class="w"> </span><span class="s1">&#39;Z&#39;</span>&gt;<span class="o">)</span>
</code></pre></div>

<p>这将 Moment datetime 类转换为 Python datetime 对象。</p>
<p>Moment 还提供了使用人类可读的语言创建新日期的方法。例如创建一个明天的日期：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>moment.date<span class="o">(</span><span class="s2">&quot;tomorrow&quot;</span><span class="o">)</span>
&lt;Moment<span class="o">(</span><span class="m">2018</span>-04-06T11:24:42<span class="o">)</span>&gt;
</code></pre></div>

<p>它的 <code>add()</code> 和 <code>subtract()</code> 命令使用关键字参数来简化日期的操作。为了获得后天，Moment 会使用下面的代码：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>moment.date<span class="o">(</span><span class="s2">&quot;tomorrow&quot;</span><span class="o">)</span>.add<span class="o">(</span><span class="nv">days</span><span class="o">=</span><span class="m">1</span><span class="o">)</span>
&lt;Moment<span class="o">(</span><span class="m">2018</span>-04-07T11:26:48<span class="o">)</span>&gt;
</code></pre></div>

<h3>Maya</h3>
<p><a href="https://github.com/kennethreitz/maya">Maya</a> 包含了 Python 中其他流行处理日期时间的库，包括 Humanize、 pytz 和 pendulum 等等。这个项目旨在让人们更容易处理日期。</p>
<p>Maya 的 README 包含几个有用的实例。以下是如何使用 Maya 来重新处理以前的解析示例：</p>
<div class="highlight"><pre><span></span><code><span class="err">$</span> <span class="kn">import</span> <span class="nn">maya</span>
<span class="err">$</span> <span class="n">maya</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;2018-04-29T17:45:25Z&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span><span class="p">()</span>
<span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=&lt;</span><span class="n">UTC</span><span class="o">&gt;</span><span class="p">)</span>
</code></pre></div>

<p>注意我们必须在 <code>maya.parse()</code> 之后调用 <code>datetime()</code>。如果我们跳过这一步，Maya 将会返回一个 MayaDT 类的示例：<code>&lt;MayaDT epoch=1525023925.0&gt;</code>。</p>
<p>由于 Maya 与 datetime 库中很多有用的方法重叠，因此它可以使用 MayaDT 类的实例执行诸如使用 <code>slang_time()</code> 方法将时间偏移量转换为纯文本语言，并将日期时间间隔保存在单个类的实例中。以下是如何使用 Maya 将日期时间表示为人类可读的短语：</p>
<div class="highlight"><pre><span></span><code><span class="err">$</span> <span class="kn">import</span> <span class="nn">maya</span>
<span class="err">$</span> <span class="n">maya</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;2018-04-29T17:45:25Z&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">slang_time</span><span class="p">()</span>
<span class="s1">&#39;23 days from now</span>
</code></pre></div>

<p>显然，<code>slang_time()</code> 的输出将根据距离 datetime 对象相对较近或较远的距离而变化。</p>
<h3>Delorean</h3>
<p><a href="https://github.com/myusuf3/delorean">Delorean</a>，以 《返回未来》 电影中的时间旅行汽车命名，它对于操纵日期时间特别有用，包括将日期时间转换为其他时区并添加或减去时间。</p>
<p>Delorean 需要有效的 Python datetime 对象才能工作，所以如果你需要使用时间字符串，最好将其与上述库中的一个配合使用。例如，将 Maya 与 Delorean 一起使用：</p>
<div class="highlight"><pre><span></span><code><span class="err">$</span> <span class="kn">import</span> <span class="nn">maya</span> 
<span class="err">$</span> <span class="n">d_t</span> <span class="o">=</span> <span class="n">maya</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;2018-04-29T17:45:25Z&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span><span class="p">()</span>
</code></pre></div>

<p>现在，你有了一个 datetime 对象 d_t，你可以使用 Delorean 来做一些事情，例如将日期时间转换为美国东部时区：</p>
<div class="highlight"><pre><span></span><code><span class="err">$</span> <span class="kn">from</span> <span class="nn">delorean</span> <span class="kn">import</span> <span class="n">Delorean</span>
<span class="err">$</span> <span class="n">d</span> <span class="o">=</span> <span class="n">Delorean</span><span class="p">(</span><span class="n">d_t</span><span class="p">)</span>
<span class="err">$</span> <span class="n">d</span>
<span class="n">Delorean</span><span class="p">(</span><span class="n">datetime</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="n">timezone</span><span class="o">=</span><span class="s1">&#39;UTC&#39;</span><span class="p">)</span>
<span class="err">$</span> <span class="n">d</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="s1">&#39;US/Eastern&#39;</span><span class="p">)</span>
<span class="n">Delorean</span><span class="p">(</span><span class="n">datetime</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="n">timezone</span><span class="o">=</span><span class="s1">&#39;US/Eastern&#39;</span><span class="p">)</span>
</code></pre></div>

<p>看到小时是怎样从 17 变成 13 了吗？</p>
<p>你也可以使用自然语言方法来操作 datetime 对象。获取 2018 年 4 月 29 日之后的下个星期五（我们现在使用的）：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>d.next_friday<span class="o">()</span>
Delorean<span class="o">(</span><span class="nv">datetime</span><span class="o">=</span>datetime.datetime<span class="o">(</span><span class="m">2018</span>,<span class="w"> </span><span class="m">5</span>,<span class="w"> </span><span class="m">4</span>,<span class="w"> </span><span class="m">13</span>,<span class="w"> </span><span class="m">45</span>,<span class="w"> </span><span class="m">25</span><span class="o">)</span>,<span class="w"> </span><span class="nv">timezone</span><span class="o">=</span><span class="s1">&#39;US/Eastern&#39;</span><span class="o">)</span>
</code></pre></div>

<p>在 Delorean 的<a href="https://delorean.readthedocs.io/en/latest/">文档</a>中阅读更多关于其的用法。</p>
<h3>Freezegun</h3>
<p><a href="https://github.com/spulec/freezegun">Freezegun</a> 是一个可以帮助你在 Python 代码中测试特定日期的库。使用 <code>@freeze_time</code> 装饰器，你可以为测试用例设置特定的日期和时间，并且所有对 <code>datetime.datetime.now()</code>、 <code>datetime.datetime.utcnow()</code> 等的调用都将返回你指定的日期和时间。例如：</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">freezegun</span> <span class="kn">import</span> <span class="n">freeze_time</span>
<span class="kn">import</span> <span class="nn">datetime</span>

<span class="nd">@freeze_time</span><span class="p">(</span><span class="s2">&quot;2017-04-14&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test</span><span class="p">():</span> 
    <span class="k">assert</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">==</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2017</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>
</code></pre></div>

<p>要跨时区进行测试，你可以将 <code>tz_offset</code> 参数传递给装饰器。<code>freeze_time</code> 装饰器也接受更简单的口语化日期，例如 <code>@freeze_time('April 4, 2017')</code>。</p>
<p>via: <a href="https://opensource.com/article/18/4/python-datetime-libraries">https://opensource.com/article/18/4/python-datetime-libraries</a></p>
<p>作者: <a href="https://opensource.com/users/laceynwilliams">Lacey Williams Hensche</a> 选题: <a href="https://github.com/lujun9972">lujun9972</a> 译者: <a href="https://github.com/MjSeven">MjSeven</a> 校对: <a href="https://github.com/wxy">wxy</a></p>
<p>本文由 <a href="https://github.com/LCTT/TranslateProject">LCTT</a> 原创编译，<a href="https://linux.cn/">Linux中国</a> 荣誉推出</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>