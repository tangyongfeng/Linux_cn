<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>几个用于替代 du 命令的更好选择</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: Sk 大家对 du 命令应该都不陌生，它可以在类 Unix 系统中对文件和目录的空间使用情况进行计算和汇总。如果你也经常需 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li class="active"><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2018/11/ji-ge-yong-yu-ti-dai-du-ming-ling-de-geng-hao-xuan-ze.html" rel="bookmark"
           title="Permalink to 几个用于替代 du 命令的更好选择">几个用于替代 du 命令的更好选择</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2018-11-16T23:08:16+01:00">
                Published: Fri 16 November 2018
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/fen-xiang">分享</a>.</p>

</footer><!-- /.post-info -->      <p>Author: Sk</p>
<p><img alt="" src="/data/attachment/album/201811/16/230819b84x77o0i49m1rim.jpg"></p>
<p>大家对 <code>du</code> 命令应该都不陌生，它可以在类 Unix 系统中对文件和目录的空间使用情况进行计算和汇总。如果你也经常需要使用 <code>du</code> 命令，你会对以下内容感兴趣的。我发现了五个可以替代原有的 <code>du</code> 命令的更好的工具。当然，如果后续有更多更好的选择，我会继续列出来。如果你有其它推荐，也欢迎在评论中留言。</p>
<h3>ncdu</h3>
<p><code>ncdu</code> 作为普通 <code>du</code> 的替代品，这在 Linux 社区中已经很流行了。<code>ncdu</code> 正是基于开发者们对 <code>du</code> 的性能不满意而被开发出来的。<code>ncdu</code> 是一个使用 C 语言和 ncurses 接口开发的简易快速的磁盘用量分析器，可以用来查看目录或文件在本地或远程系统上占用磁盘空间的情况。如果你有兴趣查看关于 <code>ncdu</code> 的详细介绍，可以浏览《<a href="https://www.ostechnix.com/check-disk-space-usage-linux-using-ncdu/">如何在 Linux 上使用 ncdu 查看磁盘占用量</a>》这一篇文章。</p>
<h3>tin-summer</h3>
<p>tin-summer 是使用 Rust 语言编写的自由开源工具，它可以用于查找占用磁盘空间的文件，它也是 <code>du</code> 命令的另一个替代品。由于使用了多线程，因此 tin-summer 在计算大目录的大小时会比 <code>du</code> 命令快得多。tin-summer 与 <code>du</code> 命令之间的区别是前者读取文件的大小，而后者则读取磁盘使用情况。</p>
<p>tin-summer 的开发者认为它可以替代 <code>du</code>，因为它具有以下优势：</p>
<ul>
<li>在大目录的操作速度上比 <code>du</code> 更快；</li>
<li>在显示结果上默认采用易读格式；</li>
<li>可以使用正则表达式排除文件或目录；</li>
<li>可以对输出进行排序和着色处理；</li>
<li>可扩展，等等。</li>
</ul>
<p><strong>安装 tin-summer</strong></p>
<p>要安装 tin-summer，只需要在终端中执行以下命令：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>curl<span class="w"> </span>-LSfs<span class="w"> </span>https://japaric.github.io/trust/install.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>sh<span class="w"> </span>-s<span class="w"> </span>--<span class="w"> </span>--git<span class="w"> </span>vmchale/tin-summer
</code></pre></div>

<p>你也可以使用 <code>cargo</code> 软件包管理器安装 tin-summer，但你需要在系统上先安装 Rust。在 Rust 已经安装好的情况下，执行以下命令：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>cargo<span class="w"> </span>install<span class="w"> </span>tin-summer
</code></pre></div>

<p>如果上面提到的这两种方法都不能成功安装 tin-summer，还可以从它的<a href="https://github.com/vmchale/tin-summer/releases">软件发布页</a>下载最新版本的二进制文件编译，进行手动安装。</p>
<p><strong>用法</strong></p>
<p>（LCTT 译注：tin-summer 的命令名为 <code>sn</code>）</p>
<p>如果需要查看当前工作目录的文件大小，可以执行以下命令：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sn<span class="w"> </span>f
<span class="m">749</span><span class="w"> </span>MB<span class="w">   </span>./.rustup/toolchains
<span class="m">749</span><span class="w"> </span>MB<span class="w">   </span>./.rustup
<span class="m">147</span><span class="w"> </span>MB<span class="w">   </span>./.cargo/bin
<span class="m">147</span><span class="w"> </span>MB<span class="w">   </span>./.cargo
<span class="m">900</span><span class="w"> </span>MB<span class="w">   </span>.
</code></pre></div>

<p>不需要进行额外声明，它也是默认以易读的格式向用户展示数据。在使用 <code>du</code> 命令的时候，则必须加上额外的 <code>-h</code> 参数才能得到同样的效果。</p>
<p>只需要按以下的形式执行命令，就可以查看某个特定目录的文件大小。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sn<span class="w"> </span>f<span class="w"> </span>&lt;path-to-the-directory&gt;
</code></pre></div>

<p>还可以对输出结果进行排序，例如下面的命令可以输出指定目录中最大的 5 个文件或目录：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sn<span class="w"> </span>sort<span class="w"> </span>/home/sk/<span class="w"> </span>-n5
<span class="m">749</span><span class="w"> </span>MB<span class="w"> </span>/home/sk/.rustup
<span class="m">749</span><span class="w"> </span>MB<span class="w"> </span>/home/sk/.rustup/toolchains
<span class="m">147</span><span class="w"> </span>MB<span class="w"> </span>/home/sk/.cargo
<span class="m">147</span><span class="w"> </span>MB<span class="w"> </span>/home/sk/.cargo/bin
<span class="m">2</span>.6<span class="w"> </span>MB<span class="w"> </span>/home/sk/mcelog
<span class="m">900</span><span class="w"> </span>MB<span class="w"> </span>/home/sk/
</code></pre></div>

<p>顺便一提，上面结果中的最后一行是指定目录 <code>/home/sk</code> 的总大小。所以不要惊讶为什么输入的是 5 而实际输出了 6 行结果。</p>
<p>在当前目录下查找带有构建工程的目录，可以使用以下命令：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sn<span class="w"> </span>ar
</code></pre></div>

<p>tin-summer 同样支持查找指定大小的带有构建工程的目录。例如执行以下命令可以查找到大小在 100 MB 以上的带有构建工程的目录：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sn<span class="w"> </span>ar<span class="w"> </span>-t100M
</code></pre></div>

<p>如上文所说，tin-summer 在操作大目录的时候速度比较快，因此在操作小目录的时候，速度会相对比较慢一些。不过它的开发者已经表示，将会在以后的版本中优化这个缺陷。</p>
<p>要获取相关的帮助，可以执行以下命令：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sn<span class="w"> </span>--help
</code></pre></div>

<p>如果想要更详尽的介绍，可以查看<a href="https://github.com/vmchale/tin-summer">这个项目的 GitHub 页面</a>。</p>
<h3>dust</h3>
<p><code>dust</code> （含义是 <code>du</code> + <code>rust</code> = <code>dust</code>）使用 Rust 编写，是一个免费、开源的更直观的 <code>du</code> 工具。它可以在不需要 <code>head</code> 或<code>sort</code> 命令的情况下即时显示目录占用的磁盘空间。与 tin-summer 一样，它会默认情况以易读的格式显示每个目录的大小。</p>
<p><strong>安装 dust</strong></p>
<p>由于 <code>dust</code> 也是使用 Rust 编写，因此它也可以通过 <code>cargo</code> 软件包管理器进行安装：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>cargo<span class="w"> </span>install<span class="w"> </span>du-dust
</code></pre></div>

<p>也可以从它的<a href="https://github.com/bootandy/dust/releases">软件发布页</a>下载最新版本的二进制文件，并按照以下步骤安装。在写这篇文章的时候，最新的版本是 0.3.1。</p>
<div class="highlight"><pre><span></span><code><span class="o">$</span><span class="w"> </span><span class="n">wget</span><span class="w"> </span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">bootandy</span><span class="o">/</span><span class="n">dust</span><span class="o">/</span><span class="n">releases</span><span class="o">/</span><span class="n">download</span><span class="o">/</span><span class="n">v0</span><span class="o">.</span><span class="mf">3.1</span><span class="o">/</span><span class="n">dust</span><span class="o">-</span><span class="n">v0</span><span class="o">.</span><span class="mf">3.1</span><span class="o">-</span><span class="n">x86_64</span><span class="o">-</span><span class="n">unknown</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnu</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
</code></pre></div>

<p>抽取文件：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>tar<span class="w"> </span>-xvf<span class="w"> </span>dust-v0.3.1-x86_64-unknown-linux-gnu.tar.gz
</code></pre></div>

<p>最后将可执行文件复制到你的 <code>$PATH</code>（例如 <code>/usr/local/bin</code>）下：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>mv<span class="w"> </span>dust<span class="w"> </span>/usr/local/bin/
</code></pre></div>

<p><strong>用法</strong></p>
<p>需要查看当前目录及所有子目录下的文件大小，可以执行以下命令：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>dust
</code></pre></div>

<p>输出示例：</p>
<p><img alt="" src="/data/attachment/album/201811/16/230821p2h2w62nk0223tuk.png"></p>
<p>带上 <code>-p</code> 参数可以按照从当前目录起始的完整目录显示。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>dust<span class="w"> </span>-p
</code></pre></div>

<p><img alt="dust 2" src="/data/attachment/album/201811/16/230822uzft5mik4fmt2xti.png"></p>
<p>如果需要查看多个目录的大小，只需要同时列出这些目录，并用空格分隔开即可：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>dust<span class="w"> </span>&lt;dir1&gt;<span class="w"> </span>&lt;dir2&gt;
</code></pre></div>

<p>下面再多举几个例子，例如：</p>
<p>显示文件的长度:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>dust<span class="w"> </span>-s
</code></pre></div>

<p>只显示 10 个目录：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>dust<span class="w"> </span>-n<span class="w"> </span><span class="m">10</span>
</code></pre></div>

<p>查看当前目录下最多 3 层子目录：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>dust<span class="w"> </span>-d<span class="w"> </span><span class="m">3</span>
</code></pre></div>

<p>查看帮助：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>dust<span class="w"> </span>-h
</code></pre></div>

<p>如果想要更详尽的介绍，可以查看<a href="https://github.com/bootandy/dust">这个项目的 GitHub 页面</a>。</p>
<h3>diskus</h3>
<p><code>diskus</code> 也是使用 Rust 编写的一个小型、快速的开源工具，它可以用于替代 <code>du -sh</code> 命令。<code>diskus</code> 将会计算当前目录下所有文件的总大小，它的效果相当于 <code>du -sh</code> 或 <code>du -sh --bytes</code>，但其开发者表示 <code>diskus</code> 的运行速度是 <code>du -sh</code> 的 9 倍。</p>
<p><strong>安装 diskus</strong></p>
<p><code>diskus</code> 已经存放于 <ruby> Arch Linux 社区用户软件仓库 <rt>  Arch Linux User-community Repository </rt></ruby>（<a href="https://aur.archlinux.org/packages/diskus-bin/">AUR</a>）当中，可以通过任何一种 AUR 帮助工具（例如 <a href="https://www.ostechnix.com/yay-found-yet-another-reliable-aur-helper/"><code>yay</code></a>）把它安装在基于 Arch 的系统上：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>yay<span class="w"> </span>-S<span class="w"> </span>diskus
</code></pre></div>

<p>对于 Ubuntu 及其衍生发行版，可以在 <code>diskus</code> 的<a href="https://github.com/sharkdp/diskus/releases">软件发布页</a>上下载最新版的软件包并安装：</p>
<div class="highlight"><pre><span></span><code><span class="o">$</span><span class="w"> </span><span class="n">wget</span><span class="w"> </span><span class="s2">&quot;https://github.com/sharkdp/diskus/releases/download/v0.3.1/diskus_0.3.1_amd64.deb&quot;</span>

<span class="o">$</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">dpkg</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">diskus_0</span><span class="o">.</span><span class="mf">3.1</span><span class="n">_amd64</span><span class="o">.</span><span class="n">deb</span>
</code></pre></div>

<p>还可以使用 <code>cargo</code> 软件包管理器安装 <code>diskus</code>，但必须在系统上先安装 Rust 1.29+。</p>
<p>安装好 Rust 之后，就可以使用以下命令安装 <code>diskus</code>：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>cargo<span class="w"> </span>install<span class="w"> </span>diskus
</code></pre></div>

<p><strong>用法</strong></p>
<p>在通常情况下，如果需要查看某个目录的大小，我会使用形如 <code>du -sh</code> 的命令。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>du<span class="w"> </span>-sh<span class="w"> </span>dir
</code></pre></div>

<p>这里的 <code>-s</code> 参数表示显示总大小。</p>
<p>如果使用 <code>diskus</code>，直接就可以显示当前目录的总大小。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>diskus
</code></pre></div>

<p><img alt="" src="/data/attachment/album/201811/16/230824pwdwjb1wrtt0gp8j.png"></p>
<p>我使用 <code>diskus</code> 查看 Arch Linux 系统上各个目录的总大小，这个工具的速度确实比 <code>du -sh</code> 快得多。但是它目前只能显示当前目录的大小。</p>
<p>要获取相关的帮助，可以执行以下命令：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>diskus<span class="w"> </span>-h
</code></pre></div>

<p>如果想要更详尽的介绍，可以查看<a href="https://github.com/sharkdp/diskus">这个项目的 GitHub 页面</a>。</p>
<h3>duu</h3>
<p><code>duu</code> 是 Directory Usage Utility 的缩写。它是使用 Python 编写的查看指定目录大小的工具。它具有跨平台的特性，因此在 Windows、Mac OS 和 Linux 系统上都能够使用。</p>
<p><strong>安装 duu</strong></p>
<p>安装这个工具之前需要先安装 Python 3。不过目前很多 Linux 发行版的默认软件仓库中都带有 Python 3，所以这个依赖并不难解决。</p>
<p>Python 3 安装完成后，从 <code>duu</code> 的<a href="https://github.com/jftuga/duu/releases">软件发布页</a>下载其最新版本。</p>
<div class="highlight"><pre><span></span><code><span class="o">$</span><span class="w"> </span><span class="n">wget</span><span class="w"> </span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">jftuga</span><span class="o">/</span><span class="n">duu</span><span class="o">/</span><span class="n">releases</span><span class="o">/</span><span class="n">download</span><span class="o">/</span><span class="mf">2.20</span><span class="o">/</span><span class="n">duu</span><span class="o">.</span><span class="n">py</span>
</code></pre></div>

<p><strong>用法</strong></p>
<p>要查看当前目录的大小，只需要执行以下命令：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>python3<span class="w"> </span>duu.py
</code></pre></div>

<p>输出示例：</p>
<p><img alt="" src="/data/attachment/album/201811/16/230825ah0yhby3sf0l5kdd.png"></p>
<p>从上图可以看出，<code>duu</code> 会显示当前目录下文件的数量情况，按照 Byte、KB、MB 单位显示这些文件的总大小，以及每个文件的大小。</p>
<p>如果需要查看某个目录的大小，只需要声明目录的绝对路径即可：</p>
<div class="highlight"><pre><span></span><code><span class="o">$</span><span class="w"> </span><span class="n">python3</span><span class="w"> </span><span class="n">duu</span><span class="o">.</span><span class="n">py</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">sk</span><span class="o">/</span><span class="n">Downloads</span><span class="o">/</span>
</code></pre></div>

<p>如果想要更详尽的介绍，可以查看<a href="https://github.com/jftuga/duu">这个项目的 GitHub 页面</a>。</p>
<p>以上就是 <code>du</code> 命令的五种替代方案，希望这篇文章能够帮助到你。就我自己而言，我并不会在这五种工具之间交替使用，我更喜欢使用 <code>ncdu</code>。欢迎在下面的评论区发表你对这些工具的评论。</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>