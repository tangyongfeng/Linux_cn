<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>如何在 Linux 上安装设备驱动程序</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: Bryant Son 学习 Linux 设备驱动如何工作，并知道如何使用它们。 对于一个熟悉 Windows 或者 MacOS 的人，想要切换到 Linux，它们都会面临一个艰 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li class="active"><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2018/11/ru-he-zai-linux-shang-an-zhuang-she-bei-qu-dong-cheng-xu.html" rel="bookmark"
           title="Permalink to 如何在 Linux 上安装设备驱动程序">如何在 Linux 上安装设备驱动程序</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2018-11-25T22:59:51+01:00">
                Published: Sun 25 November 2018
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/ji-zhu">技术</a>.</p>

</footer><!-- /.post-info -->      <p>Author: Bryant Son</p>
<blockquote>
<p>学习 Linux 设备驱动如何工作，并知道如何使用它们。</p>
</blockquote>
<p><img alt="" src="/data/attachment/album/201811/25/225946aqxqufjcwjiwdwda.jpg"></p>
<p>对于一个熟悉 Windows 或者 MacOS 的人，想要切换到 Linux，它们都会面临一个艰巨的问题就是怎么安装和配置设备驱动。这是可以理解的，因为 Windows 和 MacOS 都有一套机制把这个过程做得非常的友好。比如说，当你插入一个新的硬件设备， Windows 能够自动检测并会弹出一个窗口询问你是否要继续驱动程序的安装。你也可以从网络上下载驱动程序，仅仅需要双击解压或者是通过设备管理器导入驱动程序即可。</p>
<p>而这在 Linux 操作系统上并非这么简单。第一个原因是， Linux 是一个开源的操作系统，所以有 <a href="https://en.wikipedia.org/wiki/List_of_Linux_distributions">数百种 Linux 发行版的变体</a>。也就是说不可能做一个指南来适应所有的 Linux 发行版。因为每种 Linux 安装驱动程序的过程都有差异。</p>
<p>第二，大多数默认的 Linux 驱动程序也都是开源的，并被集成到了系统中，这使得安装一些并未包含的驱动程序变得非常复杂，即使已经可以检测大多数的硬件设备。第三，不同发行版的许可也有差异。例如，<a href="https://fedoraproject.org/wiki/Forbidden_items?rd=ForbiddenItems">Fedora 禁止事项</a> 禁止包含专有的、受法律保护，或者是违反美国法律的驱动程序。而 Ubuntu 则让用户<a href="https://www.ubuntu.com/licensing">避免使用受法律保护或闭源的硬件设备</a>。</p>
<p>为了更好的学习 Linux 驱动程序是如何工作的，我建议阅读 《Linux 设备驱动程序》一书中的 <a href="https://www.xml.com/ldd/chapter/book/ch01.html">设备驱动程序简介</a>。</p>
<h3>两种方式来寻找驱动程序</h3>
<h4>1、 用户界面</h4>
<p>如果是一个刚从 Windows 或 MacOS 转过来的 Linux 新手，那你会很高兴知道 Linux 也提供了一个通过向导式的程序来查看驱动程序是否可用的方法。 Ubuntu 提供了一个 <a href="https://askubuntu.com/questions/47506/how-do-i-install-additional-drivers">附加驱动程序</a> 选项。其它的 Linux 发行版也提供了帮助程序，像 <a href="https://help.gnome.org/users/gnome-packagekit/stable/add-remove.html.en">GNOME 的包管理器</a>，你可以使用它来检查驱动程序是否可用。</p>
<h4>2、 命令行</h4>
<p>如果你通过漂亮的用户界面没有找到驱动程序，那又该怎么办呢？或许你只能通过没有任何图形界面的 shell？甚至你可以使用控制台来展现你的技能。你有两个选择：</p>
<ol>
<li><strong>通过一个仓库</strong></li>
</ol>
<p>这和 MacOS 中的 <a href="https://brew.sh/">homebrew</a> 命令行很像。通过使用 <code>yum</code>、 <code>dnf</code>、<code>apt-get</code> 等等。你基本可以通过添加仓库，并更新包缓存。
2. <strong>下载、编译，然后自己构建</strong></p>
<p>这通常包括直接从网络，或通过 <code>wget</code> 命令下载源码包，然后运行配置和编译、安装。这超出了本文的范围，但是你可以在网络上找到很多在线指南，如果你选择的是这条路的话。</p>
<h3>检查是否已经安装了这个驱动程序</h3>
<p>在进一步学习安装 Linux 驱动程序之前，让我们来学习几条命令，用来检测驱动程序是否已经在你的系统上可用。</p>
<p><a href="https://en.wikipedia.org/wiki/Lspci">lspci</a> 命令显示了系统上所有 PCI 总线和设备驱动程序的详细信息。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>lscpci
</code></pre></div>

<p>或者使用 <code>grep</code>：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>lscpci<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>SOME_DRIVER_KEYWORD
</code></pre></div>

<p>例如，你可以使用 <code>lspci | grep SAMSUNG</code> 命令，如果你想知道是否安装过三星的驱动。</p>
<p><a href="https://en.wikipedia.org/wiki/Dmesg">dmesg</a> 命令显示了所有内核识别的驱动程序。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>dmesg
</code></pre></div>

<p>或配合 <code>grep</code> 使用：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>dmesg<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>SOME_DRIVER_KEYWORD
</code></pre></div>

<p>任何识别到的驱动程序都会显示在结果中。</p>
<p>如果通过 <code>dmesg</code> 或者 <code>lscpi</code> 命令没有识别到任何驱动程序，尝试下这两个命令，看看驱动程序至少是否加载到硬盘。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>/sbin/lsmod
</code></pre></div>

<p>和</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>find<span class="w"> </span>/lib/modules
</code></pre></div>

<p>技巧：和 <code>lspci</code> 或 <code>dmesg</code> 一样，通过在上面的命令后面加上 <code>| grep</code> 来过滤结果。</p>
<p>如果一个驱动程序已经被识别到了，但是通过 <code>lscpi</code> 或 <code>dmesg</code> 并没有找到，这意味着驱动程序已经存在于硬盘上，但是并没有加载到内核中，这种情况，你可以通过 <code>modprobe</code> 命令来加载这个模块。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>modprobe<span class="w"> </span>MODULE_NAME
</code></pre></div>

<p>使用 <code>sudo</code> 来运行这个命令，因为这个模块要使用 root 权限来安装。</p>
<h3>添加仓库并安装</h3>
<p>可以通过 <code>yum</code>、<code>dnf</code> 和 <code>apt-get</code> 几种不同的方式来添加一个仓库；一个个介绍完它们并不在本文的范围。简单一点来说，这个示例将会使用 <code>apt-get</code> ，但是这个命令和其它的几个都是很类似的。</p>
<h4>1、删除存在的仓库，如果它存在</h4>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>apt-get<span class="w"> </span>purge<span class="w"> </span>NAME_OF_DRIVER*
</code></pre></div>

<p>其中 <code>NAME_OF_DRIVER</code> 是你的驱动程序的可能的名称。你还可以将模式匹配加到正则表达式中来进一步过滤。</p>
<h4>2、将仓库加入到仓库表中，这应该在驱动程序指南中有指定</h4>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>add-apt-repository<span class="w"> </span>REPOLIST_OF_DRIVER
</code></pre></div>

<p>其中 <code>REPOLIST_OF_DRIVER</code> 应该从驱动文档中有指定（例如：<code>epel-list</code>）。</p>
<h4>3、更新仓库列表</h4>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>apt-get<span class="w"> </span>update
</code></pre></div>

<h4>4、安装驱动程序</h4>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>NAME_OF_DRIVER
</code></pre></div>

<h4>5、检查安装状态</h4>
<p>像上面说的一样，通过 <code>lscpi</code> 命令来检查驱动程序是否已经安装成功。</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>