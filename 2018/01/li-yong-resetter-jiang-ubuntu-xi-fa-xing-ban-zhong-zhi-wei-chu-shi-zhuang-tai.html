<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>利用 Resetter 将 Ubuntu 系发行版重置为初始状态</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: Jack Wallen 这个 Resetter 工具可以将 Ubuntu、 Linux Mint （以及其它基于 Ubuntu 的发行版）返回到其初始配置。 有多少次你投身于 Ubuntu（或 Ubuntu 衍生版本），配置 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li class="active"><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2018/01/li-yong-resetter-jiang-ubuntu-xi-fa-xing-ban-zhong-zhi-wei-chu-shi-zhuang-tai.html" rel="bookmark"
           title="Permalink to 利用 Resetter 将 Ubuntu 系发行版重置为初始状态">利用 Resetter 将 Ubuntu 系发行版重置为初始状态</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2018-01-08T18:45:34+01:00">
                Published: Mon 08 January 2018
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/zhuo-mian-ying-yong">桌面应用</a>.</p>

</footer><!-- /.post-info -->      <p>Author: Jack Wallen</p>
<p><img alt="" src="/data/attachment/album/201801/08/184526my72wddy6adheyy6.jpg"></p>
<p><em>这个 Resetter 工具可以将 Ubuntu、 Linux Mint （以及其它基于 Ubuntu 的发行版）返回到其初始配置。</em></p>
<p>有多少次你投身于 Ubuntu（或 Ubuntu 衍生版本），配置某项内容和安装软件，却发现你的桌面（或服务器）平台并不是你想要的结果。当在机器上产生了大量的用户文件时，这种情况可能会出现问题。既然这样，你有一个选择，你要么可以备份你所有的数据，重新安装操作系统，然后将您的数据复制回本机，或者也可以利用一种类似于 <a href="https://github.com/gaining/Resetter">Resetter</a> 的工具做同样的事情。</p>
<p>Resetter 是一个新的工具（由名为“<a href="https://github.com/gaining">gaining</a>”的加拿大开发者开发），用 Python 和 PyQt 编写，它将会重置 Ubuntu、Linux Mint（和一些其他的，基于 Ubuntu 的衍生版）回到初始配置。Resetter 提供了两种不同的复位选择：自动和自定义。利用自动方式，工具就会完成以下内容：</p>
<ul>
<li>删除用户安装的应用软件</li>
<li>删除用户及家目录</li>
<li>创建默认备份用户</li>
<li>自动安装缺失的预装应用软件（MPIA）</li>
<li>删除非默认用户</li>
<li>删除 snap 软件包</li>
</ul>
<p>自定义方式会：</p>
<ul>
<li>删除用户安装的应用程序或者允许你选择要删除的应用程序</li>
<li>删除旧的内核</li>
<li>允许你选择用户进行删除</li>
<li>删除用户及家目录</li>
<li>创建默认备份用户</li>
<li>允许您创建自定义备份用户</li>
<li>自动安装缺失的预装应用软件（MPIA）或选择 MPIA 进行安装</li>
<li>删除非默认用户</li>
<li>查看所有相关依赖包</li>
<li>删除 snap 软件包</li>
</ul>
<p>我将带领您完成安装和使用 Resetter 的过程。但是，我必须告诉你这个工具非常前期的测试版。即便如此， Resetter 绝对值得一试。实际上，我鼓励您测试该应用程序并提交 bug 报告（您可以通过 <a href="https://github.com">GitHub</a> 提交，或者直接发送给开发人员的电子邮件地址 <a href="mailto:gaining7@outlook.com">gaining7@outlook.com</a>)。</p>
<p>还应注意的是，目前仅支持的衍生版有：</p>
<ul>
<li>Debian 9.2 （稳定）Gnome 版本</li>
<li>Linux Mint 17.3+（对 Mint 18.3 的支持即将推出）</li>
<li>Ubuntu 14.04+ （虽然我发现不支持 17.10）</li>
<li>Elementary OS 0.4+</li>
<li>Linux Deepin 15.4+</li>
</ul>
<p>说到这里，让我们安装和使用 Resetter。我将在 <a href="https://elementary.io/">Elementary OS Loki</a> 平台展示。</p>
<h3>安装</h3>
<p>有几种方法可以安装 Resetter。我选择的方法是通过 <code>gdebi</code> 辅助应用程序，为什么？因为它将获取安装所需的所有依赖项。首先，我们必须安装这个特定的工具。打开终端窗口并发出命令：</p>
<div class="highlight"><pre><span></span><code>sudo apt install gdebi
</code></pre></div>

<p>一旦安装完毕，请将浏览器指向 <a href="https://github.com/gaining/Resetter/releases/tag/v1.1.3-stable">Resetter 下载页面</a>，并下载该软件的最新版本。一旦下载完毕，打开文件管理器，导航到下载的文件，然后单击（或双击，这取决于你如何配置你的桌面） <code>resetter_XXX-stable_all.deb</code> 文件（XXX 是版本号）。<code>gdebi</code> 应用程序将会打开（图 1）。点击安装包按钮，输入你的 <code>sudo</code> 密码，接下来 Resetter 将开始安装。</p>
<p><img alt="gdebi" src="/data/attachment/album/201801/08/184538a68qazpa9o9zjowc.jpg" title="gdebi"></p>
<p><em>图 1：利用 gdebi 安装 Resetter</em></p>
<p>当安装完成，准备接下来的操作。</p>
<h3>使用 Resetter</h3>
<p><strong>记住，在这之前，必须备份数据。别怪我没提醒你。</strong></p>
<p>从终端窗口发出命令 <code>sudo resetter</code>。您将被提示输入 <code>sudo</code>密码。一旦 Resetter 打开，它将自动检测您的发行版（图 2）。</p>
<p><img alt="Resetter" src="/data/attachment/album/201801/08/184539ifs8dykydv973ldg.jpg" title="Resetter"></p>
<p><em>图 2：Resetter 主窗口</em></p>
<p>我们将通过自动重置来测试 Resetter 的流程。从主窗口，点击 Automatic Reset（自动复位）。这款应用将提供一个明确的警告，它将把你的操作系统（我的实例，Elementary OS 0.4.1 Loki）重新设置为出厂默认状态（图 3）。</p>
<p><img alt="警告" src="/data/attachment/album/201801/08/184539qcehjw9eeuatteww.jpg" title="warning"></p>
<p>*图 3：在继续之前，Resetter 会警告您。 *</p>
<p>单击“Yes”，Resetter 会显示它将删除的所有包（图 4）。如果您没有问题，单击 OK，重置将开始。</p>
<p><img alt="移除软件包" src="/data/attachment/album/201801/08/184540itqfdvfq101k08zx.jpg" title="remove packages"></p>
<p><em>图 4：所有要删除的包，以便将 Elementary OS 重置为出厂默认值。</em></p>
<p>在重置过程中，应用程序将显示一个进度窗口（图 5）。根据安装的数量，这个过程不应该花费太长时间。</p>
<p><img alt="进度" src="/data/attachment/album/201801/08/184540ihvivivrvgzwm9g4.jpg" title="progress"></p>
<p><em>图 5：Resetter 进度窗口</em></p>
<p>当过程完成时，Resetter 将显示一个新的用户名和密码，以便重新登录到新重置的发行版（图 6）。</p>
<p><img alt="新用户" src="/data/attachment/album/201801/08/184540ygsai40a0qyj3yyx.jpg" title="new username"></p>
<p><em>图 6：新用户及密码</em></p>
<p>单击 OK，然后当提示时单击“Yes”以重新启动系统。当提示登录时，使用 Resetter 应用程序提供给您的新凭证。成功登录后，您需要重新创建您的原始用户。该用户的主目录仍然是完整的，所以您需要做的就是发出命令 <code>sudo useradd USERNAME</code> （ USERNAME 是用户名）。完成之后，发出命令 <code>sudo passwd USERNAME</code> （USERNAME 是用户名）。使用设置的用户/密码，您可以注销并以旧用户的身份登录（使用在重新设置操作系统之前相同的家目录）。</p>
<h3>我的成果</h3>
<p>我必须承认，在将密码添加到我的老用户（并通过使用 <code>su</code> 命令切换到该用户进行测试）之后，我无法使用该用户登录到 Elementary OS 桌面。为了解决这个问题，我登录了 Resetter 所创建的用户，移动了老用户的家目录，删除了老用户（使用命令 <code>sudo deluser jack</code>），并重新创建了老用户（使用命令 <code>sudo useradd -m jack</code>）。</p>
<p>这样做之后，我检查了原始的家目录，只发现了用户的所有权从 <code>jack.jack</code> 变成了 <code>1000.1000</code>。利用命令 <code>sudo chown -R jack.jack /home/jack</code>，就可以容易的修正这个问题。教训是什么？如果您使用 Resetter 并发现无法用您的老用户登录（在您重新创建用户并设置一个新密码之后），请确保更改用户的家目录的所有权限。</p>
<p>在这个问题之外，Resetter 在将 Elementary OS Loki 恢复到默认状态方面做了大量的工作。虽然 Resetter 处在测试中，但它是一个相当令人印象深刻的工具。试一试，看看你是否有和我一样出色的成绩。</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>