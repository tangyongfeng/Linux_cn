<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>如何在 Ubuntu Linux 上使用 KVM 云镜像</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: Vivek Gite 如何下载并使用运行在 Ubuntu Linux 服务器上的 KVM 云镜像？如何在 Ubuntu Linux 16.04 LTS 服务器上无需完整安装即可创建虚拟机？如 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li class="active"><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2018/04/ru-he-zai-ubuntu-linux-shang-shi-yong-kvm-yun-jing-xiang.html" rel="bookmark"
           title="Permalink to 如何在 Ubuntu Linux 上使用 KVM 云镜像">如何在 Ubuntu Linux 上使用 KVM 云镜像</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2018-04-07T11:37:26+02:00">
                Published: Sat 07 April 2018
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/rong-qi-yu-yun">容器与云</a>.</p>

</footer><!-- /.post-info -->      <p>Author: Vivek Gite</p>
<p><img alt="" src="/data/attachment/album/201804/07/113721yqkd8s07s80b00mv.jpg"></p>
<p>如何下载并使用运行在 Ubuntu Linux 服务器上的 KVM 云镜像？如何在 Ubuntu Linux 16.04 LTS 服务器上无需完整安装即可创建虚拟机？如何在 Ubuntu Linux 上使用 KVM 云镜像？</p>
<p>基于内核的虚拟机（KVM）是 Linux 内核的虚拟化模块，可将其转变为虚拟机管理程序。你可以在命令行使用 Ubuntu 为 libvirt 和 KVM 提供的虚拟化前端通过 KVM 创建 Ubuntu 云镜像。</p>
<p>这个快速教程展示了如何安装和使用 uvtool，它为 Ubuntu 云镜像下载，libvirt 和 clout_int 提供了统一的集成虚拟机前端。</p>
<h3>步骤 1 - 安装 KVM</h3>
<p>你必须安装并配置 KVM。使用 <a href="https://www.cyberciti.biz/faq/ubuntu-lts-debian-linux-apt-command-examples/" title="See Linux/Unix apt command examples for more info">apt 命令</a>/<a href="https://www.cyberciti.biz/tips/linux-debian-package-management-cheat-sheet.html" title="See Linux/Unix apt-get command examples for more info">apt-get 命令</a>，如下所示：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>qemu-kvm<span class="w"> </span>libvirt-bin<span class="w"> </span>virtinst<span class="w"> </span>bridge-utils<span class="w"> </span>cpu-checker
$<span class="w"> </span>kvm-ok
<span class="c1">## [configure bridged networking as described here][3]</span>
$<span class="w"> </span>sudo<span class="w"> </span>vi<span class="w"> </span>/etc/network/interfaces
$<span class="w"> </span>sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>networking
$<span class="w"> </span>sudo<span class="w"> </span>brctl<span class="w"> </span>show
</code></pre></div>

<p>参阅<a href="https://www.cyberciti.biz/faq/installing-kvm-on-ubuntu-16-04-lts-server/">如何在 Ubuntu 16.04 LTS Headless 服务器上安装 KVM</a> 以获得更多信息。（LCTT 译注：Headless 服务器是指没有本地接口的计算设备，专用于向其他计算机及其用户提供服务。）</p>
<h3>步骤 2 - 安装 uvtool</h3>
<p>键入以下 <a href="https://www.cyberciti.biz/faq/ubuntu-lts-debian-linux-apt-command-examples/" title="See Linux/Unix apt command examples for more info">apt 命令</a>/<a href="https://www.cyberciti.biz/tips/linux-debian-package-management-cheat-sheet.html" title="See Linux/Unix apt-get command examples for more info">apt-get 命令</a>：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>uvtool
</code></pre></div>

<p>示例输出：</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span><span class="n">sudo</span><span class="o">]</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nl">vivek</span><span class="p">:</span><span class="w"> </span>
<span class="n">Reading</span><span class="w"> </span><span class="n">package</span><span class="w"> </span><span class="n">lists</span><span class="p">...</span><span class="w"> </span><span class="n">Done</span>
<span class="n">Building</span><span class="w"> </span><span class="n">dependency</span><span class="w"> </span><span class="n">tree</span><span class="w">       </span>
<span class="n">Reading</span><span class="w"> </span><span class="k">state</span><span class="w"> </span><span class="n">information</span><span class="p">...</span><span class="w"> </span><span class="n">Done</span>
<span class="n">The</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">packages</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="n">automatically</span><span class="w"> </span><span class="n">installed</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">are</span><span class="w"> </span><span class="k">no</span><span class="w"> </span><span class="n">longer</span><span class="w"> </span><span class="nl">required</span><span class="p">:</span>
<span class="w">  </span><span class="n">gksu</span><span class="w"> </span><span class="n">libgksu2</span><span class="o">-</span><span class="mi">0</span><span class="w"> </span><span class="n">libqt5designer5</span><span class="w"> </span><span class="n">libqt5help5</span><span class="w"> </span><span class="n">libqt5printsupport5</span><span class="w"> </span><span class="n">libqt5sql5</span><span class="w"> </span><span class="n">libqt5sql5</span><span class="o">-</span><span class="n">sqlite</span><span class="w"> </span><span class="n">libqt5xml5</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">dbus</span><span class="p">.</span><span class="n">mainloop</span><span class="p">.</span><span class="n">pyqt5</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">notify2</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">pyqt5</span><span class="w"> </span><span class="n">python3</span><span class="o">-</span><span class="n">sip</span>
<span class="k">Use</span><span class="w"> </span><span class="s1">&#39;sudo apt autoremove&#39;</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">remove</span><span class="w"> </span><span class="n">them</span><span class="p">.</span>
<span class="n">The</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">packages</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="nl">installed</span><span class="p">:</span>
<span class="w">  </span><span class="n">cloud</span><span class="o">-</span><span class="nc">image</span><span class="o">-</span><span class="n">utils</span><span class="w"> </span><span class="n">distro</span><span class="o">-</span><span class="n">info</span><span class="w"> </span><span class="n">python</span><span class="o">-</span><span class="n">boto</span><span class="w"> </span><span class="n">python</span><span class="o">-</span><span class="n">pyinotify</span><span class="w"> </span><span class="n">python</span><span class="o">-</span><span class="n">simplestreams</span><span class="w"> </span><span class="n">socat</span><span class="w"> </span><span class="n">ubuntu</span><span class="o">-</span><span class="n">cloudimage</span><span class="o">-</span><span class="n">keyring</span><span class="w"> </span><span class="n">uvtool</span><span class="o">-</span><span class="n">libvirt</span>
<span class="n">Suggested</span><span class="w"> </span><span class="nl">packages</span><span class="p">:</span>
<span class="w">  </span><span class="n">cloud</span><span class="o">-</span><span class="n">utils</span><span class="o">-</span><span class="n">euca</span><span class="w"> </span><span class="n">shunit2</span><span class="w"> </span><span class="n">python</span><span class="o">-</span><span class="n">pyinotify</span><span class="o">-</span><span class="n">doc</span>
<span class="n">The</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="k">NEW</span><span class="w"> </span><span class="n">packages</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="nl">installed</span><span class="p">:</span>
<span class="w">  </span><span class="n">cloud</span><span class="o">-</span><span class="nc">image</span><span class="o">-</span><span class="n">utils</span><span class="w"> </span><span class="n">distro</span><span class="o">-</span><span class="n">info</span><span class="w"> </span><span class="n">python</span><span class="o">-</span><span class="n">boto</span><span class="w"> </span><span class="n">python</span><span class="o">-</span><span class="n">pyinotify</span><span class="w"> </span><span class="n">python</span><span class="o">-</span><span class="n">simplestreams</span><span class="w"> </span><span class="n">socat</span><span class="w"> </span><span class="n">ubuntu</span><span class="o">-</span><span class="n">cloudimage</span><span class="o">-</span><span class="n">keyring</span><span class="w"> </span><span class="n">uvtool</span><span class="w"> </span><span class="n">uvtool</span><span class="o">-</span><span class="n">libvirt</span>
<span class="mi">0</span><span class="w"> </span><span class="n">upgraded</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="w"> </span><span class="n">newly</span><span class="w"> </span><span class="n">installed</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">remove</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">upgraded</span><span class="p">.</span>
<span class="n">Need</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">211</span><span class="w"> </span><span class="n">kB</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">archives</span><span class="p">.</span>
<span class="k">After</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="k">operation</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="mi">876</span><span class="w"> </span><span class="n">kB</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="k">disk</span><span class="w"> </span><span class="nf">space</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="p">.</span>
<span class="k">Get</span><span class="err">:</span><span class="mi">1</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="ow">in</span><span class="p">.</span><span class="n">archive</span><span class="p">.</span><span class="n">ubuntu</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">ubuntu</span><span class="w"> </span><span class="n">artful</span><span class="o">/</span><span class="n">main</span><span class="w"> </span><span class="n">amd64</span><span class="w"> </span><span class="n">distro</span><span class="o">-</span><span class="n">info</span><span class="w"> </span><span class="n">amd64</span><span class="w"> </span><span class="mf">0.17</span><span class="w"> </span><span class="o">[</span><span class="n">20.3 kB</span><span class="o">]</span>
<span class="k">Get</span><span class="err">:</span><span class="mi">2</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="ow">in</span><span class="p">.</span><span class="n">archive</span><span class="p">.</span><span class="n">ubuntu</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">ubuntu</span><span class="w"> </span><span class="n">artful</span><span class="o">/</span><span class="n">universe</span><span class="w"> </span><span class="n">amd64</span><span class="w"> </span><span class="n">python</span><span class="o">-</span><span class="n">boto</span><span class="w"> </span><span class="ow">all</span><span class="w"> </span><span class="mf">2.44.0</span><span class="o">-</span><span class="mi">1</span><span class="n">ubuntu2</span><span class="w"> </span><span class="o">[</span><span class="n">740 kB</span><span class="o">]</span>
<span class="k">Get</span><span class="err">:</span><span class="mi">3</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="ow">in</span><span class="p">.</span><span class="n">archive</span><span class="p">.</span><span class="n">ubuntu</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">ubuntu</span><span class="w"> </span><span class="n">artful</span><span class="o">/</span><span class="n">main</span><span class="w"> </span><span class="n">amd64</span><span class="w"> </span><span class="n">python</span><span class="o">-</span><span class="n">pyinotify</span><span class="w"> </span><span class="ow">all</span><span class="w"> </span><span class="mf">0.9.6</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="o">[</span><span class="n">24.6 kB</span><span class="o">]</span>
<span class="k">Get</span><span class="err">:</span><span class="mi">4</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="ow">in</span><span class="p">.</span><span class="n">archive</span><span class="p">.</span><span class="n">ubuntu</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">ubuntu</span><span class="w"> </span><span class="n">artful</span><span class="o">/</span><span class="n">main</span><span class="w"> </span><span class="n">amd64</span><span class="w"> </span><span class="n">ubuntu</span><span class="o">-</span><span class="n">cloudimage</span><span class="o">-</span><span class="n">keyring</span><span class="w"> </span><span class="ow">all</span><span class="w"> </span><span class="mf">2013.11.11</span><span class="w"> </span><span class="o">[</span><span class="n">4,504 B</span><span class="o">]</span>
<span class="k">Get</span><span class="err">:</span><span class="mi">5</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="ow">in</span><span class="p">.</span><span class="n">archive</span><span class="p">.</span><span class="n">ubuntu</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">ubuntu</span><span class="w"> </span><span class="n">artful</span><span class="o">/</span><span class="n">main</span><span class="w"> </span><span class="n">amd64</span><span class="w"> </span><span class="n">cloud</span><span class="o">-</span><span class="nc">image</span><span class="o">-</span><span class="n">utils</span><span class="w"> </span><span class="ow">all</span><span class="w"> </span><span class="mf">0.30</span><span class="o">-</span><span class="mi">0</span><span class="n">ubuntu2</span><span class="w"> </span><span class="o">[</span><span class="n">17.2 kB</span><span class="o">]</span>
<span class="k">Get</span><span class="err">:</span><span class="mi">6</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="ow">in</span><span class="p">.</span><span class="n">archive</span><span class="p">.</span><span class="n">ubuntu</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">ubuntu</span><span class="w"> </span><span class="n">artful</span><span class="o">/</span><span class="n">universe</span><span class="w"> </span><span class="n">amd64</span><span class="w"> </span><span class="n">python</span><span class="o">-</span><span class="n">simplestreams</span><span class="w"> </span><span class="ow">all</span><span class="w"> </span><span class="mf">0.1.0</span><span class="o">~</span><span class="n">bzr450</span><span class="o">-</span><span class="mi">0</span><span class="n">ubuntu1</span><span class="w"> </span><span class="o">[</span><span class="n">29.7 kB</span><span class="o">]</span>
<span class="k">Get</span><span class="err">:</span><span class="mi">7</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="ow">in</span><span class="p">.</span><span class="n">archive</span><span class="p">.</span><span class="n">ubuntu</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">ubuntu</span><span class="w"> </span><span class="n">artful</span><span class="o">/</span><span class="n">universe</span><span class="w"> </span><span class="n">amd64</span><span class="w"> </span><span class="n">socat</span><span class="w"> </span><span class="n">amd64</span><span class="w"> </span><span class="mf">1.7.3.2</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="o">[</span><span class="n">342 kB</span><span class="o">]</span>
<span class="k">Get</span><span class="err">:</span><span class="mi">8</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="ow">in</span><span class="p">.</span><span class="n">archive</span><span class="p">.</span><span class="n">ubuntu</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">ubuntu</span><span class="w"> </span><span class="n">artful</span><span class="o">/</span><span class="n">universe</span><span class="w"> </span><span class="n">amd64</span><span class="w"> </span><span class="n">uvtool</span><span class="w"> </span><span class="ow">all</span><span class="w"> </span><span class="mi">0</span><span class="o">~</span><span class="n">git122</span><span class="o">-</span><span class="mi">0</span><span class="n">ubuntu1</span><span class="w"> </span><span class="o">[</span><span class="n">6,498 B</span><span class="o">]</span>
<span class="k">Get</span><span class="err">:</span><span class="mi">9</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="ow">in</span><span class="p">.</span><span class="n">archive</span><span class="p">.</span><span class="n">ubuntu</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">ubuntu</span><span class="w"> </span><span class="n">artful</span><span class="o">/</span><span class="n">universe</span><span class="w"> </span><span class="n">amd64</span><span class="w"> </span><span class="n">uvtool</span><span class="o">-</span><span class="n">libvirt</span><span class="w"> </span><span class="ow">all</span><span class="w"> </span><span class="mi">0</span><span class="o">~</span><span class="n">git122</span><span class="o">-</span><span class="mi">0</span><span class="n">ubuntu1</span><span class="w"> </span><span class="o">[</span><span class="n">26.9 kB</span><span class="o">]</span>
<span class="n">Fetched</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">211</span><span class="w"> </span><span class="n">kB</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="mi">3</span><span class="n">s</span><span class="w"> </span><span class="p">(</span><span class="mi">393</span><span class="w"> </span><span class="n">kB</span><span class="o">/</span><span class="n">s</span><span class="p">)</span><span class="w">        </span>
<span class="n">Selecting</span><span class="w"> </span><span class="n">previously</span><span class="w"> </span><span class="n">unselected</span><span class="w"> </span><span class="n">package</span><span class="w"> </span><span class="n">distro</span><span class="o">-</span><span class="n">info</span><span class="p">.</span>
<span class="p">(</span><span class="n">Reading</span><span class="w"> </span><span class="k">database</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="mi">199933</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">directories</span><span class="w"> </span><span class="n">currently</span><span class="w"> </span><span class="n">installed</span><span class="p">.)</span>
<span class="n">Preparing</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">unpack</span><span class="w"> </span><span class="p">...</span><span class="o">/</span><span class="mi">0</span><span class="o">-</span><span class="n">distro</span><span class="o">-</span><span class="n">info_0</span><span class="mf">.17</span><span class="n">_amd64</span><span class="p">.</span><span class="n">deb</span><span class="w"> </span><span class="p">...</span>
<span class="n">Unpacking</span><span class="w"> </span><span class="n">distro</span><span class="o">-</span><span class="n">info</span><span class="w"> </span><span class="p">(</span><span class="mf">0.17</span><span class="p">)</span><span class="w"> </span><span class="p">...</span>
<span class="n">Selecting</span><span class="w"> </span><span class="n">previously</span><span class="w"> </span><span class="n">unselected</span><span class="w"> </span><span class="n">package</span><span class="w"> </span><span class="n">python</span><span class="o">-</span><span class="n">boto</span><span class="p">.</span>
<span class="n">Preparing</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">unpack</span><span class="w"> </span><span class="p">...</span><span class="o">/</span><span class="mi">1</span><span class="o">-</span><span class="n">python</span><span class="o">-</span><span class="n">boto_2</span><span class="mf">.44.0</span><span class="o">-</span><span class="mi">1</span><span class="n">ubuntu2_all</span><span class="p">.</span><span class="n">deb</span><span class="w"> </span><span class="p">...</span>
<span class="n">Unpacking</span><span class="w"> </span><span class="n">python</span><span class="o">-</span><span class="n">boto</span><span class="w"> </span><span class="p">(</span><span class="mf">2.44.0</span><span class="o">-</span><span class="mi">1</span><span class="n">ubuntu2</span><span class="p">)</span><span class="w"> </span><span class="p">...</span>
<span class="n">Selecting</span><span class="w"> </span><span class="n">previously</span><span class="w"> </span><span class="n">unselected</span><span class="w"> </span><span class="n">package</span><span class="w"> </span><span class="n">python</span><span class="o">-</span><span class="n">pyinotify</span><span class="p">.</span>
<span class="n">Preparing</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">unpack</span><span class="w"> </span><span class="p">...</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">python</span><span class="o">-</span><span class="n">pyinotify_0</span><span class="mf">.9.6</span><span class="o">-</span><span class="mi">1</span><span class="n">_all</span><span class="p">.</span><span class="n">deb</span><span class="w"> </span><span class="p">...</span>
<span class="n">Unpacking</span><span class="w"> </span><span class="n">python</span><span class="o">-</span><span class="n">pyinotify</span><span class="w"> </span><span class="p">(</span><span class="mf">0.9.6</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">...</span>
<span class="n">Selecting</span><span class="w"> </span><span class="n">previously</span><span class="w"> </span><span class="n">unselected</span><span class="w"> </span><span class="n">package</span><span class="w"> </span><span class="n">ubuntu</span><span class="o">-</span><span class="n">cloudimage</span><span class="o">-</span><span class="n">keyring</span><span class="p">.</span>
<span class="n">Preparing</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">unpack</span><span class="w"> </span><span class="p">...</span><span class="o">/</span><span class="mi">3</span><span class="o">-</span><span class="n">ubuntu</span><span class="o">-</span><span class="n">cloudimage</span><span class="o">-</span><span class="n">keyring_2013</span><span class="mf">.11.11</span><span class="n">_all</span><span class="p">.</span><span class="n">deb</span><span class="w"> </span><span class="p">...</span>
<span class="n">Unpacking</span><span class="w"> </span><span class="n">ubuntu</span><span class="o">-</span><span class="n">cloudimage</span><span class="o">-</span><span class="n">keyring</span><span class="w"> </span><span class="p">(</span><span class="mf">2013.11.11</span><span class="p">)</span><span class="w"> </span><span class="p">...</span>
<span class="n">Selecting</span><span class="w"> </span><span class="n">previously</span><span class="w"> </span><span class="n">unselected</span><span class="w"> </span><span class="n">package</span><span class="w"> </span><span class="n">cloud</span><span class="o">-</span><span class="nc">image</span><span class="o">-</span><span class="n">utils</span><span class="p">.</span>
<span class="n">Preparing</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">unpack</span><span class="w"> </span><span class="p">...</span><span class="o">/</span><span class="mi">4</span><span class="o">-</span><span class="n">cloud</span><span class="o">-</span><span class="nc">image</span><span class="o">-</span><span class="n">utils_0</span><span class="mf">.30</span><span class="o">-</span><span class="mi">0</span><span class="n">ubuntu2_all</span><span class="p">.</span><span class="n">deb</span><span class="w"> </span><span class="p">...</span>
<span class="n">Unpacking</span><span class="w"> </span><span class="n">cloud</span><span class="o">-</span><span class="nc">image</span><span class="o">-</span><span class="n">utils</span><span class="w"> </span><span class="p">(</span><span class="mf">0.30</span><span class="o">-</span><span class="mi">0</span><span class="n">ubuntu2</span><span class="p">)</span><span class="w"> </span><span class="p">...</span>
<span class="n">Selecting</span><span class="w"> </span><span class="n">previously</span><span class="w"> </span><span class="n">unselected</span><span class="w"> </span><span class="n">package</span><span class="w"> </span><span class="n">python</span><span class="o">-</span><span class="n">simplestreams</span><span class="p">.</span>
<span class="n">Preparing</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">unpack</span><span class="w"> </span><span class="p">...</span><span class="o">/</span><span class="mi">5</span><span class="o">-</span><span class="n">python</span><span class="o">-</span><span class="n">simplestreams_0</span><span class="mf">.1.0</span><span class="o">~</span><span class="n">bzr450</span><span class="o">-</span><span class="mi">0</span><span class="n">ubuntu1_all</span><span class="p">.</span><span class="n">deb</span><span class="w"> </span><span class="p">...</span>
<span class="n">Unpacking</span><span class="w"> </span><span class="n">python</span><span class="o">-</span><span class="n">simplestreams</span><span class="w"> </span><span class="p">(</span><span class="mf">0.1.0</span><span class="o">~</span><span class="n">bzr450</span><span class="o">-</span><span class="mi">0</span><span class="n">ubuntu1</span><span class="p">)</span><span class="w"> </span><span class="p">...</span>
<span class="n">Selecting</span><span class="w"> </span><span class="n">previously</span><span class="w"> </span><span class="n">unselected</span><span class="w"> </span><span class="n">package</span><span class="w"> </span><span class="n">socat</span><span class="p">.</span>
<span class="n">Preparing</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">unpack</span><span class="w"> </span><span class="p">...</span><span class="o">/</span><span class="mi">6</span><span class="o">-</span><span class="n">socat_1</span><span class="mf">.7.3.2</span><span class="o">-</span><span class="mi">1</span><span class="n">_amd64</span><span class="p">.</span><span class="n">deb</span><span class="w"> </span><span class="p">...</span>
<span class="n">Unpacking</span><span class="w"> </span><span class="n">socat</span><span class="w"> </span><span class="p">(</span><span class="mf">1.7.3.2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">...</span>
<span class="n">Selecting</span><span class="w"> </span><span class="n">previously</span><span class="w"> </span><span class="n">unselected</span><span class="w"> </span><span class="n">package</span><span class="w"> </span><span class="n">uvtool</span><span class="p">.</span>
<span class="n">Preparing</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">unpack</span><span class="w"> </span><span class="p">...</span><span class="o">/</span><span class="mi">7</span><span class="o">-</span><span class="n">uvtool_0</span><span class="o">~</span><span class="n">git122</span><span class="o">-</span><span class="mi">0</span><span class="n">ubuntu1_all</span><span class="p">.</span><span class="n">deb</span><span class="w"> </span><span class="p">...</span>
<span class="n">Unpacking</span><span class="w"> </span><span class="n">uvtool</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="o">~</span><span class="n">git122</span><span class="o">-</span><span class="mi">0</span><span class="n">ubuntu1</span><span class="p">)</span><span class="w"> </span><span class="p">...</span>
<span class="n">Selecting</span><span class="w"> </span><span class="n">previously</span><span class="w"> </span><span class="n">unselected</span><span class="w"> </span><span class="n">package</span><span class="w"> </span><span class="n">uvtool</span><span class="o">-</span><span class="n">libvirt</span><span class="p">.</span>
<span class="n">Preparing</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">unpack</span><span class="w"> </span><span class="p">...</span><span class="o">/</span><span class="mi">8</span><span class="o">-</span><span class="n">uvtool</span><span class="o">-</span><span class="n">libvirt_0</span><span class="o">~</span><span class="n">git122</span><span class="o">-</span><span class="mi">0</span><span class="n">ubuntu1_all</span><span class="p">.</span><span class="n">deb</span><span class="w"> </span><span class="p">...</span>
<span class="n">Unpacking</span><span class="w"> </span><span class="n">uvtool</span><span class="o">-</span><span class="n">libvirt</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="o">~</span><span class="n">git122</span><span class="o">-</span><span class="mi">0</span><span class="n">ubuntu1</span><span class="p">)</span><span class="w"> </span><span class="p">...</span>
<span class="n">Setting</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">distro</span><span class="o">-</span><span class="n">info</span><span class="w"> </span><span class="p">(</span><span class="mf">0.17</span><span class="p">)</span><span class="w"> </span><span class="p">...</span>
<span class="n">Setting</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">ubuntu</span><span class="o">-</span><span class="n">cloudimage</span><span class="o">-</span><span class="n">keyring</span><span class="w"> </span><span class="p">(</span><span class="mf">2013.11.11</span><span class="p">)</span><span class="w"> </span><span class="p">...</span>
<span class="n">Setting</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">cloud</span><span class="o">-</span><span class="nc">image</span><span class="o">-</span><span class="n">utils</span><span class="w"> </span><span class="p">(</span><span class="mf">0.30</span><span class="o">-</span><span class="mi">0</span><span class="n">ubuntu2</span><span class="p">)</span><span class="w"> </span><span class="p">...</span>
<span class="n">Setting</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">socat</span><span class="w"> </span><span class="p">(</span><span class="mf">1.7.3.2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">...</span>
<span class="n">Setting</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">python</span><span class="o">-</span><span class="n">pyinotify</span><span class="w"> </span><span class="p">(</span><span class="mf">0.9.6</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">...</span>
<span class="n">Setting</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">python</span><span class="o">-</span><span class="n">boto</span><span class="w"> </span><span class="p">(</span><span class="mf">2.44.0</span><span class="o">-</span><span class="mi">1</span><span class="n">ubuntu2</span><span class="p">)</span><span class="w"> </span><span class="p">...</span>
<span class="n">Setting</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">python</span><span class="o">-</span><span class="n">simplestreams</span><span class="w"> </span><span class="p">(</span><span class="mf">0.1.0</span><span class="o">~</span><span class="n">bzr450</span><span class="o">-</span><span class="mi">0</span><span class="n">ubuntu1</span><span class="p">)</span><span class="w"> </span><span class="p">...</span>
<span class="n">Processing</span><span class="w"> </span><span class="n">triggers</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">doc</span><span class="o">-</span><span class="n">base</span><span class="w"> </span><span class="p">(</span><span class="mf">0.10.7</span><span class="p">)</span><span class="w"> </span><span class="p">...</span>
<span class="n">Processing</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="n">doc</span><span class="o">-</span><span class="n">base</span><span class="w"> </span><span class="k">file</span><span class="p">...</span>
<span class="n">Setting</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">uvtool</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="o">~</span><span class="n">git122</span><span class="o">-</span><span class="mi">0</span><span class="n">ubuntu1</span><span class="p">)</span><span class="w"> </span><span class="p">...</span>
<span class="n">Processing</span><span class="w"> </span><span class="n">triggers</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">man</span><span class="o">-</span><span class="n">db</span><span class="w"> </span><span class="p">(</span><span class="mf">2.7.6.1</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">...</span>
<span class="n">Setting</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">uvtool</span><span class="o">-</span><span class="n">libvirt</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="o">~</span><span class="n">git122</span><span class="o">-</span><span class="mi">0</span><span class="n">ubuntu1</span><span class="p">)</span><span class="w"> </span><span class="p">...</span>
</code></pre></div>

<h3>步骤 3 - 下载 Ubuntu 云镜像</h3>
<p>你需要使用 <code>uvt-simplestreams-libvirt</code> 命令。它维护一个 libvirt 容量存储池，作为一个<ruby> 简单流 <rt>  simplestreams </rt></ruby>源的镜像子集的本地镜像，比如 Ubuntu 云镜像。要使用当前所有 amd64 镜像更新 uvtool 的 libvirt 容量存储池，运行：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>uvt-simplestreams-libvirt<span class="w"> </span>sync<span class="w"> </span><span class="nv">arch</span><span class="o">=</span>amd64
</code></pre></div>

<p>要更新/获取 Ubuntu 16.04 LTS (xenial/amd64) 镜像，运行：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>uvt-simplestreams-libvirt<span class="w"> </span>--verbose<span class="w"> </span>sync<span class="w"> </span><span class="nv">release</span><span class="o">=</span>xenial<span class="w"> </span><span class="nv">arch</span><span class="o">=</span>amd64
</code></pre></div>

<p>示例输出：</p>
<div class="highlight"><pre><span></span><code><span class="n">Adding</span><span class="o">:</span><span class="w"> </span><span class="n">com</span><span class="o">.</span><span class="na">ubuntu</span><span class="o">.</span><span class="na">cloud</span><span class="o">:</span><span class="n">server</span><span class="o">:</span><span class="mf">16.04</span><span class="o">:</span><span class="n">amd64</span><span class="w"> </span><span class="mf">20171121.1</span>
</code></pre></div>

<p>通过 query 选项查询本地镜像：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>uvt-simplestreams-libvirt<span class="w"> </span>query
</code></pre></div>

<p>示例输出：</p>
<div class="highlight"><pre><span></span><code>release=xenial arch=amd64 label=release (20171121.1)
</code></pre></div>

<p>现在，我为 Ubuntu xenial 创建了一个镜像，接下来我会创建虚拟机。</p>
<h3>步骤 4 - 创建 SSH 密钥</h3>
<p>你需要使用 SSH 密钥才能登录到 KVM 虚拟机。如果你根本没有任何密钥，请使用 <code>ssh-keygen</code> 命令创建一个新的密钥。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ssh-keygen
</code></pre></div>

<p>参阅“<a href="https://www.cyberciti.biz/faq/how-to-set-up-ssh-keys-on-linux-unix/">如何在 Linux / Unix 系统上设置 SSH 密钥</a>” 和 “<a href="https://www.cyberciti.biz/faq/linux-unix-generating-ssh-keys/">Linux / UNIX: 生成 SSH 密钥</a>” 以获取更多信息。</p>
<h3>步骤 5 - 创建 VM</h3>
<p>是时候创建虚拟机了，它叫 vm1，即创建一个 Ubuntu Linux 16.04 LTS 虚拟机：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>uvt-kvm<span class="w"> </span>create<span class="w"> </span>vm1
</code></pre></div>

<p>默认情况下 vm1 使用以下配置创建：</p>
<ol>
<li>内存：512M</li>
<li>磁盘大小：8GiB</li>
<li>CPU：1 vCPU core</li>
</ol>
<p>要控制内存、磁盘、CPU 和其他配置，使用以下语法：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>uvt-kvm<span class="w"> </span>create<span class="w"> </span>vm1<span class="w"> </span><span class="se">\</span>
--memory<span class="w"> </span>MEMORY<span class="w"> </span><span class="se">\</span>
--cpu<span class="w"> </span>CPU<span class="w"> </span><span class="se">\</span>
--disk<span class="w"> </span>DISK<span class="w"> </span><span class="se">\</span>
--bridge<span class="w"> </span>BRIDGE<span class="w"> </span><span class="se">\</span>
--ssh-public-key-file<span class="w"> </span>/path/to/your/SSH_PUBLIC_KEY_FILE<span class="w"> </span><span class="se">\</span>
--packages<span class="w"> </span>PACKAGES1,<span class="w"> </span>PACKAGES2,<span class="w"> </span>..<span class="w"> </span><span class="se">\</span>
--run-script-once<span class="w"> </span>RUN_SCRIPT_ONCE<span class="w"> </span><span class="se">\</span>
--password<span class="w"> </span>PASSWORD
</code></pre></div>

<p>其中</p>
<ol>
<li><code>--password PASSWORD</code>：设置 ubuntu 用户的密码和允许使用 ubuntu 的用户登录（不推荐，使用 ssh 密钥）。</li>
<li><code>--run-script-once RUN_SCRIPT_ONCE</code> : 第一次启动时，在虚拟机上以 root 身份运行 <code>RUN_SCRIPT_ONCE</code> 脚本，但再也不会运行。这里给出完整的路径。这对于在虚拟机上运行自定义任务时非常有用，例如设置安全性或其他内容。</li>
<li><code>--packages PACKAGES1, PACKAGES2, ..</code> : 在第一次启动时安装以逗号分隔的软件包。</li>
</ol>
<p>要获取帮助，运行：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>uvt-kvm<span class="w"> </span>-h
$<span class="w"> </span>uvt-kvm<span class="w"> </span>create<span class="w"> </span>-h
</code></pre></div>

<h4>如何删除虚拟机？</h4>
<p>要销毁/删除名为 vm1 的虚拟机，运行（请小心使用以下命令，因为没有确认框）：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>uvt-kvm<span class="w"> </span>destroy<span class="w"> </span>vm1
</code></pre></div>

<h4>获取 vm1 的 IP 地址，运行：</h4>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>uvt-kvm<span class="w"> </span>ip<span class="w"> </span>vm1
<span class="m">192</span>.168.122.52
</code></pre></div>

<h4>列出所有运行的虚拟机</h4>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>uvt-kvm<span class="w"> </span>list
</code></pre></div>

<p>示例输出：</p>
<div class="highlight"><pre><span></span><code>vm1
freebsd11.1
</code></pre></div>

<h3>步骤 6 - 如何登录 vm1</h3>
<p>语法是：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>uvt-kvm<span class="w"> </span>ssh<span class="w"> </span>vm1
</code></pre></div>

<p>示例输出：</p>
<div class="highlight"><pre><span></span><code><span class="nx">Welcome</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">Ubuntu</span><span class="w"> </span><span class="m m-Double">16.04.3</span><span class="w"> </span><span class="nx">LTS</span><span class="w"> </span><span class="p">(</span><span class="nx">GNU</span><span class="o">/</span><span class="nx">Linux</span><span class="w"> </span><span class="m m-Double">4.4.0</span><span class="o">-</span><span class="mi">101</span><span class="o">-</span><span class="nx">generic</span><span class="w"> </span><span class="nx">x86_64</span><span class="p">)</span>

<span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">Documentation</span><span class="p">:</span><span class="w">  </span><span class="nx">https</span><span class="p">:</span><span class="c1">//help.ubuntu.com</span>
<span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">Management</span><span class="p">:</span><span class="w">     </span><span class="nx">https</span><span class="p">:</span><span class="c1">//landscape.canonical.com</span>
<span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">Support</span><span class="p">:</span><span class="w">        </span><span class="nx">https</span><span class="p">:</span><span class="c1">//ubuntu.com/advantage</span>

<span class="w">  </span><span class="nx">Get</span><span class="w"> </span><span class="nx">cloud</span><span class="w"> </span><span class="nx">support</span><span class="w"> </span><span class="nx">with</span><span class="w"> </span><span class="nx">Ubuntu</span><span class="w"> </span><span class="nx">Advantage</span><span class="w"> </span><span class="nx">Cloud</span><span class="w"> </span><span class="nx">Guest</span><span class="p">:</span>
<span class="w">    </span><span class="nx">http</span><span class="p">:</span><span class="c1">//www.ubuntu.com/business/services/cloud</span>

<span class="mi">0</span><span class="w"> </span><span class="nx">packages</span><span class="w"> </span><span class="nx">can</span><span class="w"> </span><span class="nx">be</span><span class="w"> </span><span class="nx">updated</span><span class="p">.</span>
<span class="mi">0</span><span class="w"> </span><span class="nx">updates</span><span class="w"> </span><span class="nx">are</span><span class="w"> </span><span class="nx">security</span><span class="w"> </span><span class="nx">updates</span><span class="p">.</span>


<span class="nx">Last</span><span class="w"> </span><span class="nx">login</span><span class="p">:</span><span class="w"> </span><span class="nx">Thu</span><span class="w"> </span><span class="nx">Dec</span><span class="w">  </span><span class="mi">7</span><span class="w"> </span><span class="mi">09</span><span class="p">:</span><span class="mi">55</span><span class="p">:</span><span class="mi">06</span><span class="w"> </span><span class="mi">2017</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="m m-Double">192.168.122.1</span>
</code></pre></div>

<p>另一个选择是从 macOS/Linux/Unix/Windows 客户端使用常规的 ssh 命令：</p>
<div class="highlight"><pre><span></span><code><span class="n">$</span><span class="w"> </span><span class="n">ssh</span><span class="w"> </span><span class="n">ubuntu</span><span class="mf">@192.168.122.52</span>
<span class="n">$</span><span class="w"> </span><span class="n">ssh</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="o">~/</span><span class="p">.</span><span class="n">ssh</span><span class="o">/</span><span class="n">id_rsa</span><span class="w"> </span><span class="n">ubuntu</span><span class="mf">@192.168.122.52</span>
</code></pre></div>

<p>示例输出：</p>
<p><a href="https://www.cyberciti.biz/media/new/faq/2017/12/connect-to-the-running-VM-using-ssh.jpg"><img alt="Connect to the running VM using ssh" src="/data/attachment/album/201804/07/113727fgybpkpblvlhpy88.jpg"></a></p>
<p>一旦创建了 vim，你可以照常使用 <code>virsh</code> 命令：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>virsh<span class="w"> </span>list
</code></pre></div>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>