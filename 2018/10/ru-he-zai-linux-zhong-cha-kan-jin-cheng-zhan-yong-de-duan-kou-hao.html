<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>如何在 Linux 中查看进程占用的端口号</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: Prakash Subramanian 对于 Linux 系统管理员来说，清楚某个服务是否正确地绑定或监听某个端口，是至关重要的。如果你需要处理端口相关 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li class="active"><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2018/10/ru-he-zai-linux-zhong-cha-kan-jin-cheng-zhan-yong-de-duan-kou-hao.html" rel="bookmark"
           title="Permalink to 如何在 Linux 中查看进程占用的端口号">如何在 Linux 中查看进程占用的端口号</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2018-10-02T12:38:13+02:00">
                Published: Tue 02 October 2018
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/xi-tong-yun-wei">系统运维</a>.</p>

</footer><!-- /.post-info -->      <p>Author: Prakash Subramanian</p>
<p><img alt="" src="/data/attachment/album/201810/02/123805zpppw4h5z9bwd5ab.jpg"></p>
<p>对于 Linux 系统管理员来说，清楚某个服务是否正确地绑定或监听某个端口，是至关重要的。如果你需要处理端口相关的问题，这篇文章可能会对你有用。</p>
<p>端口是 Linux 系统上特定进程之间逻辑连接的标识，包括物理端口和软件端口。由于 Linux 操作系统是一个软件，因此本文只讨论软件端口。软件端口始终与主机的 IP 地址和相关的通信协议相关联，因此端口常用于区分应用程序。大部分涉及到网络的服务都必须打开一个套接字来监听传入的网络请求，而每个服务都使用一个独立的套接字。</p>
<p><strong>推荐阅读：</strong></p>
<ul>
<li><a href="https://www.2daygeek.com/how-to-check-find-the-process-id-pid-ppid-of-a-running-program-in-linux/">在 Linux 上查看进程 ID 的 4 种方法</a></li>
<li><a href="https://www.2daygeek.com/kill-terminate-a-process-in-linux-using-kill-pkill-killall-command/">在 Linux 上终止进程的 3 种方法</a></li>
</ul>
<p>套接字是和 IP 地址、软件端口和协议结合起来使用的，而端口号对传输控制协议（TCP）和用户数据报协议（UDP）协议都适用，TCP 和 UDP 都可以使用 0 到 65535 之间的端口号进行通信。</p>
<p>以下是端口分配类别：</p>
<ul>
<li>0 - 1023： 常用端口和系统端口</li>
<li>1024 - 49151： 软件的注册端口</li>
<li>49152 - 65535： 动态端口或私有端口</li>
</ul>
<p>在 Linux 上的 <code>/etc/services</code> 文件可以查看到更多关于保留端口的信息。</p>
<div class="highlight"><pre><span></span><code><span class="p">#</span><span class="w"> </span><span class="n">less</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">services</span>
<span class="p">#</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="nl">services:</span>
<span class="p">#</span><span class="w"> </span><span class="n">$Id</span><span class="o">:</span><span class="w"> </span><span class="n">services</span><span class="p">,</span><span class="n">v</span><span class="w"> </span><span class="mf">1.55</span><span class="w"> </span><span class="mh">2013</span><span class="o">/</span><span class="mh">04</span><span class="o">/</span><span class="mh">14</span><span class="w"> </span><span class="n">ovasik</span><span class="w"> </span><span class="n">Exp</span><span class="w"> </span><span class="err">$</span>
<span class="p">#</span>
<span class="p">#</span><span class="w"> </span><span class="n">Network</span><span class="w"> </span><span class="n">services</span><span class="p">,</span><span class="w"> </span><span class="n">Internet</span><span class="w"> </span><span class="n">style</span>
<span class="p">#</span><span class="w"> </span><span class="n">IANA</span><span class="w"> </span><span class="n">services</span><span class="w"> </span><span class="nl">version:</span><span class="w"> </span><span class="n">last</span><span class="w"> </span><span class="n">updated</span><span class="w"> </span><span class="mh">2013</span><span class="o">-</span><span class="mh">04</span><span class="o">-</span><span class="mh">10</span>
<span class="p">#</span>
<span class="p">#</span><span class="w"> </span><span class="n">Note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">presently</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">IANA</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="k">assign</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">well</span><span class="o">-</span><span class="n">known</span>
<span class="p">#</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">TCP</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">UDP</span><span class="p">;</span><span class="w"> </span><span class="n">hence</span><span class="p">,</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="n">entries</span><span class="w"> </span><span class="n">here</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">two</span><span class="w"> </span><span class="n">entries</span>
<span class="p">#</span><span class="w"> </span><span class="n">even</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">doesn</span><span class="p">&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">UDP</span><span class="w"> </span><span class="n">operations</span><span class="p">.</span>
<span class="p">#</span><span class="w"> </span><span class="n">Updated</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">RFC</span><span class="w"> </span><span class="mh">1700</span><span class="p">,</span><span class="w"> </span><span class="err">`</span><span class="no">`Assigned</span><span class="w"> </span><span class="n">Numbers</span><span class="p">&#39;&#39;</span><span class="w"> </span><span class="p">(</span><span class="n">October</span><span class="w"> </span><span class="mh">1994</span><span class="p">).</span><span class="w"> </span><span class="n">Not</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">ports</span>
<span class="p">#</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">included</span><span class="p">,</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">common</span><span class="w"> </span><span class="n">ones</span><span class="p">.</span>
<span class="p">#</span>
<span class="p">#</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">latest</span><span class="w"> </span><span class="n">IANA</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="n">assignments</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">gotten</span><span class="w"> </span><span class="n">from</span>
<span class="p">#</span><span class="w"> </span><span class="nl">http:</span><span class="c1">//www.iana.org/assignments/port-numbers</span>
<span class="p">#</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">Well</span><span class="w"> </span><span class="n">Known</span><span class="w"> </span><span class="n">Ports</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">those</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="mh">0</span><span class="w"> </span><span class="n">through</span><span class="w"> </span><span class="mf">1023.</span>
<span class="p">#</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">Registered</span><span class="w"> </span><span class="n">Ports</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">those</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="mh">1024</span><span class="w"> </span><span class="n">through</span><span class="w"> </span><span class="mh">49151</span>
<span class="p">#</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">Dynamic</span><span class="w"> </span><span class="k">and</span><span class="o">/</span><span class="k">or</span><span class="w"> </span><span class="n">Private</span><span class="w"> </span><span class="n">Ports</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">those</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="mh">49152</span><span class="w"> </span><span class="n">through</span><span class="w"> </span><span class="mh">65535</span>
<span class="p">#</span>
<span class="p">#</span><span class="w"> </span><span class="n">Each</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">describes</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">service</span><span class="p">,</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nl">form:</span>
<span class="p">#</span>
<span class="p">#</span><span class="w"> </span><span class="n">service</span><span class="o">-</span><span class="n">name</span><span class="w"> </span><span class="n">port</span><span class="o">/</span><span class="n">protocol</span><span class="w"> </span><span class="p">[</span><span class="n">aliases</span><span class="w"> </span><span class="p">...]</span><span class="w"> </span><span class="p">[#</span><span class="w"> </span><span class="n">comment</span><span class="p">]</span>

<span class="n">tcpmux</span><span class="w"> </span><span class="mh">1</span><span class="o">/</span><span class="n">tcp</span><span class="w"> </span><span class="p">#</span><span class="w"> </span><span class="n">TCP</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="n">service</span><span class="w"> </span><span class="n">multiplexer</span>
<span class="n">tcpmux</span><span class="w"> </span><span class="mh">1</span><span class="o">/</span><span class="n">udp</span><span class="w"> </span><span class="p">#</span><span class="w"> </span><span class="n">TCP</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="n">service</span><span class="w"> </span><span class="n">multiplexer</span>
<span class="n">rje</span><span class="w"> </span><span class="mh">5</span><span class="o">/</span><span class="n">tcp</span><span class="w"> </span><span class="p">#</span><span class="w"> </span><span class="n">Remote</span><span class="w"> </span><span class="n">Job</span><span class="w"> </span><span class="n">Entry</span>
<span class="n">rje</span><span class="w"> </span><span class="mh">5</span><span class="o">/</span><span class="n">udp</span><span class="w"> </span><span class="p">#</span><span class="w"> </span><span class="n">Remote</span><span class="w"> </span><span class="n">Job</span><span class="w"> </span><span class="n">Entry</span>
<span class="n">echo</span><span class="w"> </span><span class="mh">7</span><span class="o">/</span><span class="n">tcp</span>
<span class="n">echo</span><span class="w"> </span><span class="mh">7</span><span class="o">/</span><span class="n">udp</span>
<span class="n">discard</span><span class="w"> </span><span class="mh">9</span><span class="o">/</span><span class="n">tcp</span><span class="w"> </span><span class="n">sink</span><span class="w"> </span><span class="n">null</span>
<span class="n">discard</span><span class="w"> </span><span class="mh">9</span><span class="o">/</span><span class="n">udp</span><span class="w"> </span><span class="n">sink</span><span class="w"> </span><span class="n">null</span>
<span class="n">systat</span><span class="w"> </span><span class="mh">11</span><span class="o">/</span><span class="n">tcp</span><span class="w"> </span><span class="n">users</span>
<span class="n">systat</span><span class="w"> </span><span class="mh">11</span><span class="o">/</span><span class="n">udp</span><span class="w"> </span><span class="n">users</span>
<span class="n">daytime</span><span class="w"> </span><span class="mh">13</span><span class="o">/</span><span class="n">tcp</span>
<span class="n">daytime</span><span class="w"> </span><span class="mh">13</span><span class="o">/</span><span class="n">udp</span>
<span class="n">qotd</span><span class="w"> </span><span class="mh">17</span><span class="o">/</span><span class="n">tcp</span><span class="w"> </span><span class="n">quote</span>
<span class="n">qotd</span><span class="w"> </span><span class="mh">17</span><span class="o">/</span><span class="n">udp</span><span class="w"> </span><span class="n">quote</span>
<span class="n">msp</span><span class="w"> </span><span class="mh">18</span><span class="o">/</span><span class="n">tcp</span><span class="w"> </span><span class="p">#</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">send</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="p">(</span><span class="n">historic</span><span class="p">)</span>
<span class="n">msp</span><span class="w"> </span><span class="mh">18</span><span class="o">/</span><span class="n">udp</span><span class="w"> </span><span class="p">#</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">send</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="p">(</span><span class="n">historic</span><span class="p">)</span>
<span class="n">chargen</span><span class="w"> </span><span class="mh">19</span><span class="o">/</span><span class="n">tcp</span><span class="w"> </span><span class="n">ttytst</span><span class="w"> </span><span class="n">source</span>
<span class="n">chargen</span><span class="w"> </span><span class="mh">19</span><span class="o">/</span><span class="n">udp</span><span class="w"> </span><span class="n">ttytst</span><span class="w"> </span><span class="n">source</span>
<span class="n">ftp</span><span class="o">-</span><span class="n">data</span><span class="w"> </span><span class="mh">20</span><span class="o">/</span><span class="n">tcp</span>
<span class="n">ftp</span><span class="o">-</span><span class="n">data</span><span class="w"> </span><span class="mh">20</span><span class="o">/</span><span class="n">udp</span>
<span class="p">#</span><span class="w"> </span><span class="mh">21</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">registered</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">ftp</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">fsp</span>
<span class="n">ftp</span><span class="w"> </span><span class="mh">21</span><span class="o">/</span><span class="n">tcp</span>
<span class="n">ftp</span><span class="w"> </span><span class="mh">21</span><span class="o">/</span><span class="n">udp</span><span class="w"> </span><span class="n">fsp</span><span class="w"> </span><span class="n">fspd</span>
<span class="n">ssh</span><span class="w"> </span><span class="mh">22</span><span class="o">/</span><span class="n">tcp</span><span class="w"> </span><span class="p">#</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">Secure</span><span class="w"> </span><span class="n">Shell</span><span class="w"> </span><span class="p">(</span><span class="n">SSH</span><span class="p">)</span><span class="w"> </span><span class="n">Protocol</span>
<span class="n">ssh</span><span class="w"> </span><span class="mh">22</span><span class="o">/</span><span class="n">udp</span><span class="w"> </span><span class="p">#</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">Secure</span><span class="w"> </span><span class="n">Shell</span><span class="w"> </span><span class="p">(</span><span class="n">SSH</span><span class="p">)</span><span class="w"> </span><span class="n">Protocol</span>
<span class="n">telnet</span><span class="w"> </span><span class="mh">23</span><span class="o">/</span><span class="n">tcp</span>
<span class="n">telnet</span><span class="w"> </span><span class="mh">23</span><span class="o">/</span><span class="n">udp</span>
<span class="p">#</span><span class="w"> </span><span class="mh">24</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">mail</span><span class="w"> </span><span class="n">system</span>
<span class="n">lmtp</span><span class="w"> </span><span class="mh">24</span><span class="o">/</span><span class="n">tcp</span><span class="w"> </span><span class="p">#</span><span class="w"> </span><span class="n">LMTP</span><span class="w"> </span><span class="n">Mail</span><span class="w"> </span><span class="n">Delivery</span>
<span class="n">lmtp</span><span class="w"> </span><span class="mh">24</span><span class="o">/</span><span class="n">udp</span><span class="w"> </span><span class="p">#</span><span class="w"> </span><span class="n">LMTP</span><span class="w"> </span><span class="n">Mail</span><span class="w"> </span><span class="n">Delivery</span>
</code></pre></div>

<p>可以使用以下六种方法查看端口信息。</p>
<ul>
<li><code>ss</code>：可以用于转储套接字统计信息。</li>
<li><code>netstat</code>：可以显示打开的套接字列表。</li>
<li><code>lsof</code>：可以列出打开的文件。</li>
<li><code>fuser</code>：可以列出那些打开了文件的进程的进程 ID。</li>
<li><code>nmap</code>：是网络检测工具和端口扫描程序。</li>
<li><code>systemctl</code>：是 systemd 系统的控制管理器和服务管理器。</li>
</ul>
<p>以下我们将找出 <code>sshd</code> 守护进程所使用的端口号。</p>
<h3>方法 1：使用 ss 命令</h3>
<p><code>ss</code> 一般用于转储套接字统计信息。它能够输出类似于 <code>netstat</code> 输出的信息，但它可以比其它工具显示更多的 TCP 信息和状态信息。</p>
<p>它还可以显示所有类型的套接字统计信息，包括 PACKET、TCP、UDP、DCCP、RAW、Unix 域等。</p>
<div class="highlight"><pre><span></span><code><span class="gh">#</span> ss -tnlp | grep ssh
LISTEN 0 128 <span class="gs">*:22 *</span>:* users:((&quot;sshd&quot;,pid=997,fd=3))
LISTEN 0 128 :::22 :::* users:((&quot;sshd&quot;,pid=997,fd=4))
</code></pre></div>

<p>也可以使用端口号来检查。</p>
<div class="highlight"><pre><span></span><code><span class="gh">#</span> ss -tnlp | grep &quot;:22&quot;
LISTEN 0 128 <span class="gs">*:22 *</span>:* users:((&quot;sshd&quot;,pid=997,fd=3))
LISTEN 0 128 :::22 :::* users:((&quot;sshd&quot;,pid=997,fd=4))
</code></pre></div>

<h3>方法 2：使用 netstat 命令</h3>
<p><code>netstat</code> 能够显示网络连接、路由表、接口统计信息、伪装连接以及多播成员。</p>
<p>默认情况下，<code>netstat</code> 会列出打开的套接字。如果不指定任何地址族，则会显示所有已配置地址族的活动套接字。但 <code>netstat</code> 已经过时了，一般会使用 <code>ss</code> 来替代。</p>
<div class="highlight"><pre><span></span><code><span class="gh">#</span> netstat -tnlp | grep ssh
tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN 997/sshd
tcp6 0 0 :::22 :::* LISTEN 997/sshd
</code></pre></div>

<p>也可以使用端口号来检查。</p>
<div class="highlight"><pre><span></span><code><span class="gh">#</span> netstat -tnlp | grep &quot;:22&quot;
tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN 1208/sshd
tcp6 0 0 :::22 :::* LISTEN 1208/sshd
</code></pre></div>

<h3>方法 3：使用 lsof 命令</h3>
<p><code>lsof</code> 能够列出打开的文件，并列出系统上被进程打开的文件的相关信息。</p>
<div class="highlight"><pre><span></span><code><span class="cp"># lsof -i -P | grep ssh</span>
<span class="n">COMMAND</span><span class="w"> </span><span class="n">PID</span><span class="w"> </span><span class="n">USER</span><span class="w"> </span><span class="n">FD</span><span class="w"> </span><span class="kr">TYPE</span><span class="w"> </span><span class="n">DEVICE</span><span class="w"> </span><span class="n">SIZE</span><span class="o">/</span><span class="n">OFF</span><span class="w"> </span><span class="n">NODE</span><span class="w"> </span><span class="n">NAME</span>
<span class="n">sshd</span><span class="w"> </span><span class="mi">11584</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="mi">3u</span><span class="w"> </span><span class="n">IPv4</span><span class="w"> </span><span class="mi">27625</span><span class="w"> </span><span class="mi">0</span><span class="n">t0</span><span class="w"> </span><span class="n">TCP</span><span class="w"> </span><span class="o">*:</span><span class="mi">22</span><span class="w"> </span><span class="p">(</span><span class="n">LISTEN</span><span class="p">)</span>
<span class="n">sshd</span><span class="w"> </span><span class="mi">11584</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="mi">4u</span><span class="w"> </span><span class="n">IPv6</span><span class="w"> </span><span class="mi">27627</span><span class="w"> </span><span class="mi">0</span><span class="n">t0</span><span class="w"> </span><span class="n">TCP</span><span class="w"> </span><span class="o">*:</span><span class="mi">22</span><span class="w"> </span><span class="p">(</span><span class="n">LISTEN</span><span class="p">)</span>
<span class="n">sshd</span><span class="w"> </span><span class="mi">11592</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="mi">3u</span><span class="w"> </span><span class="n">IPv4</span><span class="w"> </span><span class="mi">27744</span><span class="w"> </span><span class="mi">0</span><span class="n">t0</span><span class="w"> </span><span class="n">TCP</span><span class="w"> </span><span class="n">vps</span><span class="mf">.2</span><span class="n">daygeek</span><span class="p">.</span><span class="n">com</span><span class="o">:</span><span class="n">ssh</span><span class="o">-&gt;</span><span class="mf">103.5.134.167</span><span class="o">:</span><span class="mi">49902</span><span class="w"> </span><span class="p">(</span><span class="n">ESTABLISHED</span><span class="p">)</span>
</code></pre></div>

<p>也可以使用端口号来检查。</p>
<div class="highlight"><pre><span></span><code><span class="cp"># lsof -i tcp:22</span>
<span class="n">COMMAND</span><span class="w"> </span><span class="n">PID</span><span class="w"> </span><span class="n">USER</span><span class="w"> </span><span class="n">FD</span><span class="w"> </span><span class="kr">TYPE</span><span class="w"> </span><span class="n">DEVICE</span><span class="w"> </span><span class="n">SIZE</span><span class="o">/</span><span class="n">OFF</span><span class="w"> </span><span class="n">NODE</span><span class="w"> </span><span class="n">NAME</span>
<span class="n">sshd</span><span class="w"> </span><span class="mi">1208</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="mi">3u</span><span class="w"> </span><span class="n">IPv4</span><span class="w"> </span><span class="mi">20919</span><span class="w"> </span><span class="mi">0</span><span class="n">t0</span><span class="w"> </span><span class="n">TCP</span><span class="w"> </span><span class="o">*:</span><span class="n">ssh</span><span class="w"> </span><span class="p">(</span><span class="n">LISTEN</span><span class="p">)</span>
<span class="n">sshd</span><span class="w"> </span><span class="mi">1208</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="mi">4u</span><span class="w"> </span><span class="n">IPv6</span><span class="w"> </span><span class="mi">20921</span><span class="w"> </span><span class="mi">0</span><span class="n">t0</span><span class="w"> </span><span class="n">TCP</span><span class="w"> </span><span class="o">*:</span><span class="n">ssh</span><span class="w"> </span><span class="p">(</span><span class="n">LISTEN</span><span class="p">)</span>
<span class="n">sshd</span><span class="w"> </span><span class="mi">11592</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="mi">3u</span><span class="w"> </span><span class="n">IPv4</span><span class="w"> </span><span class="mi">27744</span><span class="w"> </span><span class="mi">0</span><span class="n">t0</span><span class="w"> </span><span class="n">TCP</span><span class="w"> </span><span class="n">vps</span><span class="mf">.2</span><span class="n">daygeek</span><span class="p">.</span><span class="n">com</span><span class="o">:</span><span class="n">ssh</span><span class="o">-&gt;</span><span class="mf">103.5.134.167</span><span class="o">:</span><span class="mi">49902</span><span class="w"> </span><span class="p">(</span><span class="n">ESTABLISHED</span><span class="p">)</span>
</code></pre></div>

<h3>方法 4：使用 fuser 命令</h3>
<p><code>fuser</code> 工具会将本地系统上打开了文件的进程的进程 ID 显示在标准输出中。</p>
<div class="highlight"><pre><span></span><code># fuser -v 22/tcp
 USER PID ACCESS COMMAND
22/tcp: root 1208 F.... sshd
 root 12388 F.... sshd
 root 49339 F.... sshd
</code></pre></div>

<h3>方法 5：使用 nmap 命令</h3>
<p><code>nmap</code>（“Network Mapper”）是一款用于网络检测和安全审计的开源工具。它最初用于对大型网络进行快速扫描，但它对于单个主机的扫描也有很好的表现。</p>
<p><code>nmap</code> 使用原始 IP 数据包来确定网络上可用的主机，这些主机的服务（包括应用程序名称和版本）、主机运行的操作系统（包括操作系统版本等信息）、正在使用的数据包过滤器或防火墙的类型，以及很多其它信息。</p>
<div class="highlight"><pre><span></span><code><span class="err">#</span><span class="w"> </span><span class="nx">nmap</span><span class="w"> </span><span class="o">-</span><span class="nx">sV</span><span class="w"> </span><span class="o">-</span><span class="nx">p</span><span class="w"> </span><span class="mi">22</span><span class="w"> </span><span class="nx">localhost</span>

<span class="nx">Starting</span><span class="w"> </span><span class="nx">Nmap</span><span class="w"> </span><span class="m m-Double">6.40</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nx">http</span><span class="p">:</span><span class="c1">//nmap.org ) at 2018-09-23 12:36 IST</span>
<span class="nx">Nmap</span><span class="w"> </span><span class="nx">scan</span><span class="w"> </span><span class="nx">report</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">localhost</span><span class="w"> </span><span class="p">(</span><span class="m m-Double">127.0.0.1</span><span class="p">)</span>
<span class="nx">Host</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">up</span><span class="w"> </span><span class="p">(</span><span class="m m-Double">0.000089</span><span class="nx">s</span><span class="w"> </span><span class="nx">latency</span><span class="p">).</span>
<span class="nx">Other</span><span class="w"> </span><span class="nx">addresses</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">localhost</span><span class="w"> </span><span class="p">(</span><span class="k">not</span><span class="w"> </span><span class="nx">scanned</span><span class="p">):</span><span class="w"> </span><span class="m m-Double">127.0.0.1</span>
<span class="nx">PORT</span><span class="w"> </span><span class="nx">STATE</span><span class="w"> </span><span class="nx">SERVICE</span><span class="w"> </span><span class="nx">VERSION</span>
<span class="mi">22</span><span class="o">/</span><span class="nx">tcp</span><span class="w"> </span><span class="nx">open</span><span class="w"> </span><span class="nx">ssh</span><span class="w"> </span><span class="nx">OpenSSH</span><span class="w"> </span><span class="m m-Double">7.4</span><span class="w"> </span><span class="p">(</span><span class="nx">protocol</span><span class="w"> </span><span class="m m-Double">2.0</span><span class="p">)</span>

<span class="nx">Service</span><span class="w"> </span><span class="nx">detection</span><span class="w"> </span><span class="nx">performed</span><span class="p">.</span><span class="w"> </span><span class="nx">Please</span><span class="w"> </span><span class="nx">report</span><span class="w"> </span><span class="nx">any</span><span class="w"> </span><span class="nx">incorrect</span><span class="w"> </span><span class="nx">results</span><span class="w"> </span><span class="nx">at</span><span class="w"> </span><span class="nx">http</span><span class="p">:</span><span class="c1">//nmap.org/submit/ .</span>
<span class="nx">Nmap</span><span class="w"> </span><span class="nx">done</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="nx">address</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="nx">host</span><span class="w"> </span><span class="nx">up</span><span class="p">)</span><span class="w"> </span><span class="nx">scanned</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m m-Double">0.44</span><span class="w"> </span><span class="nx">seconds</span>
</code></pre></div>

<h3>方法 6：使用 systemctl 命令</h3>
<p><code>systemctl</code> 是 systemd 系统的控制管理器和服务管理器。它取代了旧的 SysV 初始化系统管理，目前大多数现代 Linux 操作系统都采用了 systemd。</p>
<p><strong>推荐阅读：</strong></p>
<ul>
<li><a href="https://www.2daygeek.com/chkservice-a-tool-for-managing-systemd-units-from-linux-terminal/">chkservice – Linux 终端上的 systemd 单元管理工具</a></li>
<li><a href="https://www.2daygeek.com/how-to-check-all-running-services-in-linux/">如何查看 Linux 系统上正在运行的服务</a></li>
</ul>
<div class="highlight"><pre><span></span><code><span class="err">#</span><span class="w"> </span><span class="n">systemctl</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="n">sshd</span>
<span class="err">●</span><span class="w"> </span><span class="n">sshd</span><span class="p">.</span><span class="n">service</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">OpenSSH</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">daemon</span>
<span class="w"> </span><span class="nl">Loaded</span><span class="p">:</span><span class="w"> </span><span class="n">loaded</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="k">system</span><span class="o">/</span><span class="n">sshd</span><span class="p">.</span><span class="n">service</span><span class="p">;</span><span class="w"> </span><span class="n">enabled</span><span class="p">;</span><span class="w"> </span><span class="n">vendor</span><span class="w"> </span><span class="nl">preset</span><span class="p">:</span><span class="w"> </span><span class="n">enabled</span><span class="p">)</span>
<span class="w"> </span><span class="nl">Active</span><span class="p">:</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="p">(</span><span class="n">running</span><span class="p">)</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">Sun</span><span class="w"> </span><span class="mi">2018</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">23</span><span class="w"> </span><span class="mi">02</span><span class="err">:</span><span class="mi">08</span><span class="err">:</span><span class="mi">56</span><span class="w"> </span><span class="n">EDT</span><span class="p">;</span><span class="w"> </span><span class="mi">6</span><span class="n">h</span><span class="w"> </span><span class="mi">11</span><span class="nf">min</span><span class="w"> </span><span class="n">ago</span>
<span class="w"> </span><span class="nl">Docs</span><span class="p">:</span><span class="w"> </span><span class="nl">man</span><span class="p">:</span><span class="n">sshd</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="w"> </span><span class="nl">man</span><span class="p">:</span><span class="n">sshd_config</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="w"> </span><span class="n">Main</span><span class="w"> </span><span class="nl">PID</span><span class="p">:</span><span class="w"> </span><span class="mi">11584</span><span class="w"> </span><span class="p">(</span><span class="n">sshd</span><span class="p">)</span>
<span class="w"> </span><span class="nl">CGroup</span><span class="p">:</span><span class="w"> </span><span class="o">/</span><span class="k">system</span><span class="p">.</span><span class="n">slice</span><span class="o">/</span><span class="n">sshd</span><span class="p">.</span><span class="n">service</span>
<span class="w"> </span><span class="err">└─</span><span class="mi">11584</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">sshd</span><span class="w"> </span><span class="o">-</span><span class="n">D</span>

<span class="n">Sep</span><span class="w"> </span><span class="mi">23</span><span class="w"> </span><span class="mi">02</span><span class="err">:</span><span class="mi">08</span><span class="err">:</span><span class="mi">56</span><span class="w"> </span><span class="n">vps</span><span class="mf">.2</span><span class="n">daygeek</span><span class="p">.</span><span class="n">com</span><span class="w"> </span><span class="n">systemd</span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="n">Starting</span><span class="w"> </span><span class="n">OpenSSH</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">daemon</span><span class="p">...</span>
<span class="n">Sep</span><span class="w"> </span><span class="mi">23</span><span class="w"> </span><span class="mi">02</span><span class="err">:</span><span class="mi">08</span><span class="err">:</span><span class="mi">56</span><span class="w"> </span><span class="n">vps</span><span class="mf">.2</span><span class="n">daygeek</span><span class="p">.</span><span class="n">com</span><span class="w"> </span><span class="n">sshd</span><span class="o">[</span><span class="n">11584</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="n">Server</span><span class="w"> </span><span class="n">listening</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="mf">0.0.0.0</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mf">22.</span>
<span class="n">Sep</span><span class="w"> </span><span class="mi">23</span><span class="w"> </span><span class="mi">02</span><span class="err">:</span><span class="mi">08</span><span class="err">:</span><span class="mi">56</span><span class="w"> </span><span class="n">vps</span><span class="mf">.2</span><span class="n">daygeek</span><span class="p">.</span><span class="n">com</span><span class="w"> </span><span class="n">sshd</span><span class="o">[</span><span class="n">11584</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="n">Server</span><span class="w"> </span><span class="n">listening</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mf">22.</span>
<span class="n">Sep</span><span class="w"> </span><span class="mi">23</span><span class="w"> </span><span class="mi">02</span><span class="err">:</span><span class="mi">08</span><span class="err">:</span><span class="mi">56</span><span class="w"> </span><span class="n">vps</span><span class="mf">.2</span><span class="n">daygeek</span><span class="p">.</span><span class="n">com</span><span class="w"> </span><span class="n">systemd</span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="n">Started</span><span class="w"> </span><span class="n">OpenSSH</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">daemon</span><span class="p">.</span>
<span class="n">Sep</span><span class="w"> </span><span class="mi">23</span><span class="w"> </span><span class="mi">02</span><span class="err">:</span><span class="mi">09</span><span class="err">:</span><span class="mi">15</span><span class="w"> </span><span class="n">vps</span><span class="mf">.2</span><span class="n">daygeek</span><span class="p">.</span><span class="n">com</span><span class="w"> </span><span class="n">sshd</span><span class="o">[</span><span class="n">11589</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="k">Connection</span><span class="w"> </span><span class="n">closed</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mf">103.5.134.167</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mi">49899</span><span class="w"> </span><span class="o">[</span><span class="n">preauth</span><span class="o">]</span>
<span class="n">Sep</span><span class="w"> </span><span class="mi">23</span><span class="w"> </span><span class="mi">02</span><span class="err">:</span><span class="mi">09</span><span class="err">:</span><span class="mi">41</span><span class="w"> </span><span class="n">vps</span><span class="mf">.2</span><span class="n">daygeek</span><span class="p">.</span><span class="n">com</span><span class="w"> </span><span class="n">sshd</span><span class="o">[</span><span class="n">11592</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="n">Accepted</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mf">103.5.134.167</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mi">49902</span><span class="w"> </span><span class="n">ssh2</span>
</code></pre></div>

<p>以上输出的内容显示了最近一次启动 <code>sshd</code> 服务时 <code>ssh</code> 服务的监听端口。但它不会将最新日志更新到输出中。</p>
<div class="highlight"><pre><span></span><code><span class="err">#</span><span class="w"> </span><span class="n">systemctl</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="n">sshd</span>
<span class="err">●</span><span class="w"> </span><span class="n">sshd</span><span class="p">.</span><span class="n">service</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">OpenSSH</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">daemon</span>
<span class="w"> </span><span class="nl">Loaded</span><span class="p">:</span><span class="w"> </span><span class="n">loaded</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="k">system</span><span class="o">/</span><span class="n">sshd</span><span class="p">.</span><span class="n">service</span><span class="p">;</span><span class="w"> </span><span class="n">enabled</span><span class="p">;</span><span class="w"> </span><span class="n">vendor</span><span class="w"> </span><span class="nl">preset</span><span class="p">:</span><span class="w"> </span><span class="n">enabled</span><span class="p">)</span>
<span class="w"> </span><span class="nl">Active</span><span class="p">:</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="p">(</span><span class="n">running</span><span class="p">)</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">Thu</span><span class="w"> </span><span class="mi">2018</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">06</span><span class="w"> </span><span class="mi">07</span><span class="err">:</span><span class="mi">40</span><span class="err">:</span><span class="mi">59</span><span class="w"> </span><span class="n">IST</span><span class="p">;</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">weeks</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">days</span><span class="w"> </span><span class="n">ago</span>
<span class="w"> </span><span class="nl">Docs</span><span class="p">:</span><span class="w"> </span><span class="nl">man</span><span class="p">:</span><span class="n">sshd</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="w"> </span><span class="nl">man</span><span class="p">:</span><span class="n">sshd_config</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="w"> </span><span class="n">Main</span><span class="w"> </span><span class="nl">PID</span><span class="p">:</span><span class="w"> </span><span class="mi">1208</span><span class="w"> </span><span class="p">(</span><span class="n">sshd</span><span class="p">)</span>
<span class="w"> </span><span class="nl">CGroup</span><span class="p">:</span><span class="w"> </span><span class="o">/</span><span class="k">system</span><span class="p">.</span><span class="n">slice</span><span class="o">/</span><span class="n">sshd</span><span class="p">.</span><span class="n">service</span>
<span class="w"> </span><span class="err">├─</span><span class="w"> </span><span class="mi">1208</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">sshd</span><span class="w"> </span><span class="o">-</span><span class="n">D</span>
<span class="w"> </span><span class="err">├─</span><span class="mi">23951</span><span class="w"> </span><span class="nl">sshd</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">accepted</span><span class="o">]</span>
<span class="w"> </span><span class="err">└─</span><span class="mi">23952</span><span class="w"> </span><span class="nl">sshd</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">net</span><span class="o">]</span>

<span class="n">Sep</span><span class="w"> </span><span class="mi">23</span><span class="w"> </span><span class="mi">12</span><span class="err">:</span><span class="mi">50</span><span class="err">:</span><span class="mi">36</span><span class="w"> </span><span class="n">vps</span><span class="mf">.2</span><span class="n">daygeek</span><span class="p">.</span><span class="n">com</span><span class="w"> </span><span class="n">sshd</span><span class="o">[</span><span class="n">23909</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="n">Invalid</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="nf">pi</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mf">95.210.113.142</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mi">51666</span>
<span class="n">Sep</span><span class="w"> </span><span class="mi">23</span><span class="w"> </span><span class="mi">12</span><span class="err">:</span><span class="mi">50</span><span class="err">:</span><span class="mi">36</span><span class="w"> </span><span class="n">vps</span><span class="mf">.2</span><span class="n">daygeek</span><span class="p">.</span><span class="n">com</span><span class="w"> </span><span class="n">sshd</span><span class="o">[</span><span class="n">23909</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="nl">input_userauth_request</span><span class="p">:</span><span class="w"> </span><span class="n">invalid</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="nf">pi</span><span class="w"> </span><span class="o">[</span><span class="n">preauth</span><span class="o">]</span>
<span class="n">Sep</span><span class="w"> </span><span class="mi">23</span><span class="w"> </span><span class="mi">12</span><span class="err">:</span><span class="mi">50</span><span class="err">:</span><span class="mi">37</span><span class="w"> </span><span class="n">vps</span><span class="mf">.2</span><span class="n">daygeek</span><span class="p">.</span><span class="n">com</span><span class="w"> </span><span class="n">sshd</span><span class="o">[</span><span class="n">23911</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="n">pam_unix</span><span class="p">(</span><span class="nl">sshd</span><span class="p">:</span><span class="n">auth</span><span class="p">)</span><span class="err">:</span><span class="w"> </span><span class="k">check</span><span class="w"> </span><span class="n">pass</span><span class="p">;</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="k">unknown</span>
<span class="n">Sep</span><span class="w"> </span><span class="mi">23</span><span class="w"> </span><span class="mi">12</span><span class="err">:</span><span class="mi">50</span><span class="err">:</span><span class="mi">37</span><span class="w"> </span><span class="n">vps</span><span class="mf">.2</span><span class="n">daygeek</span><span class="p">.</span><span class="n">com</span><span class="w"> </span><span class="n">sshd</span><span class="o">[</span><span class="n">23911</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="n">pam_unix</span><span class="p">(</span><span class="nl">sshd</span><span class="p">:</span><span class="n">auth</span><span class="p">)</span><span class="err">:</span><span class="w"> </span><span class="n">authentication</span><span class="w"> </span><span class="n">failure</span><span class="p">;</span><span class="w"> </span><span class="n">logname</span><span class="o">=</span><span class="w"> </span><span class="n">uid</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="n">euid</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="n">tty</span><span class="o">=</span><span class="n">ssh</span><span class="w"> </span><span class="n">ruser</span><span class="o">=</span><span class="w"> </span><span class="n">rhost</span><span class="o">=</span><span class="mf">95.210.113.142</span>
<span class="n">Sep</span><span class="w"> </span><span class="mi">23</span><span class="w"> </span><span class="mi">12</span><span class="err">:</span><span class="mi">50</span><span class="err">:</span><span class="mi">37</span><span class="w"> </span><span class="n">vps</span><span class="mf">.2</span><span class="n">daygeek</span><span class="p">.</span><span class="n">com</span><span class="w"> </span><span class="n">sshd</span><span class="o">[</span><span class="n">23909</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="n">pam_unix</span><span class="p">(</span><span class="nl">sshd</span><span class="p">:</span><span class="n">auth</span><span class="p">)</span><span class="err">:</span><span class="w"> </span><span class="k">check</span><span class="w"> </span><span class="n">pass</span><span class="p">;</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="k">unknown</span>
<span class="n">Sep</span><span class="w"> </span><span class="mi">23</span><span class="w"> </span><span class="mi">12</span><span class="err">:</span><span class="mi">50</span><span class="err">:</span><span class="mi">37</span><span class="w"> </span><span class="n">vps</span><span class="mf">.2</span><span class="n">daygeek</span><span class="p">.</span><span class="n">com</span><span class="w"> </span><span class="n">sshd</span><span class="o">[</span><span class="n">23909</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="n">pam_unix</span><span class="p">(</span><span class="nl">sshd</span><span class="p">:</span><span class="n">auth</span><span class="p">)</span><span class="err">:</span><span class="w"> </span><span class="n">authentication</span><span class="w"> </span><span class="n">failure</span><span class="p">;</span><span class="w"> </span><span class="n">logname</span><span class="o">=</span><span class="w"> </span><span class="n">uid</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="n">euid</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="n">tty</span><span class="o">=</span><span class="n">ssh</span><span class="w"> </span><span class="n">ruser</span><span class="o">=</span><span class="w"> </span><span class="n">rhost</span><span class="o">=</span><span class="mf">95.210.113.142</span>
<span class="n">Sep</span><span class="w"> </span><span class="mi">23</span><span class="w"> </span><span class="mi">12</span><span class="err">:</span><span class="mi">50</span><span class="err">:</span><span class="mi">39</span><span class="w"> </span><span class="n">vps</span><span class="mf">.2</span><span class="n">daygeek</span><span class="p">.</span><span class="n">com</span><span class="w"> </span><span class="n">sshd</span><span class="o">[</span><span class="n">23911</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">invalid</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="nf">pi</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mf">95.210.113.142</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mi">51670</span><span class="w"> </span><span class="n">ssh2</span>
<span class="n">Sep</span><span class="w"> </span><span class="mi">23</span><span class="w"> </span><span class="mi">12</span><span class="err">:</span><span class="mi">50</span><span class="err">:</span><span class="mi">39</span><span class="w"> </span><span class="n">vps</span><span class="mf">.2</span><span class="n">daygeek</span><span class="p">.</span><span class="n">com</span><span class="w"> </span><span class="n">sshd</span><span class="o">[</span><span class="n">23909</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">invalid</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="nf">pi</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mf">95.210.113.142</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mi">51666</span><span class="w"> </span><span class="n">ssh2</span>
<span class="n">Sep</span><span class="w"> </span><span class="mi">23</span><span class="w"> </span><span class="mi">12</span><span class="err">:</span><span class="mi">50</span><span class="err">:</span><span class="mi">40</span><span class="w"> </span><span class="n">vps</span><span class="mf">.2</span><span class="n">daygeek</span><span class="p">.</span><span class="n">com</span><span class="w"> </span><span class="n">sshd</span><span class="o">[</span><span class="n">23911</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="k">Connection</span><span class="w"> </span><span class="n">closed</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mf">95.210.113.142</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mi">51670</span><span class="w"> </span><span class="o">[</span><span class="n">preauth</span><span class="o">]</span>
<span class="n">Sep</span><span class="w"> </span><span class="mi">23</span><span class="w"> </span><span class="mi">12</span><span class="err">:</span><span class="mi">50</span><span class="err">:</span><span class="mi">40</span><span class="w"> </span><span class="n">vps</span><span class="mf">.2</span><span class="n">daygeek</span><span class="p">.</span><span class="n">com</span><span class="w"> </span><span class="n">sshd</span><span class="o">[</span><span class="n">23909</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="k">Connection</span><span class="w"> </span><span class="n">closed</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mf">95.210.113.142</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mi">51666</span><span class="w"> </span><span class="o">[</span><span class="n">preauth</span><span class="o">]</span>
</code></pre></div>

<p>大部分情况下，以上的输出不会显示进程的实际端口号。这时更建议使用以下这个 <code>journalctl</code> 命令检查日志文件中的详细信息。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># journalctl | grep -i &quot;openssh\|sshd&quot;</span>
<span class="n">Sep</span><span class="w"> </span><span class="mi">23</span><span class="w"> </span><span class="mi">02</span><span class="p">:</span><span class="mi">08</span><span class="p">:</span><span class="mi">56</span><span class="w"> </span><span class="n">vps138235</span><span class="o">.</span><span class="n">vps</span><span class="o">.</span><span class="n">ovh</span><span class="o">.</span><span class="n">ca</span><span class="w"> </span><span class="n">sshd</span><span class="p">[</span><span class="mi">997</span><span class="p">]:</span><span class="w"> </span><span class="n">Received</span><span class="w"> </span><span class="k">signal</span><span class="w"> </span><span class="mi">15</span><span class="p">;</span><span class="w"> </span><span class="n">terminating</span><span class="o">.</span>
<span class="n">Sep</span><span class="w"> </span><span class="mi">23</span><span class="w"> </span><span class="mi">02</span><span class="p">:</span><span class="mi">08</span><span class="p">:</span><span class="mi">56</span><span class="w"> </span><span class="n">vps138235</span><span class="o">.</span><span class="n">vps</span><span class="o">.</span><span class="n">ovh</span><span class="o">.</span><span class="n">ca</span><span class="w"> </span><span class="n">systemd</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span><span class="w"> </span><span class="n">Stopping</span><span class="w"> </span><span class="n">OpenSSH</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">daemon</span><span class="o">...</span>
<span class="n">Sep</span><span class="w"> </span><span class="mi">23</span><span class="w"> </span><span class="mi">02</span><span class="p">:</span><span class="mi">08</span><span class="p">:</span><span class="mi">56</span><span class="w"> </span><span class="n">vps138235</span><span class="o">.</span><span class="n">vps</span><span class="o">.</span><span class="n">ovh</span><span class="o">.</span><span class="n">ca</span><span class="w"> </span><span class="n">systemd</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span><span class="w"> </span><span class="n">Starting</span><span class="w"> </span><span class="n">OpenSSH</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">daemon</span><span class="o">...</span>
<span class="n">Sep</span><span class="w"> </span><span class="mi">23</span><span class="w"> </span><span class="mi">02</span><span class="p">:</span><span class="mi">08</span><span class="p">:</span><span class="mi">56</span><span class="w"> </span><span class="n">vps138235</span><span class="o">.</span><span class="n">vps</span><span class="o">.</span><span class="n">ovh</span><span class="o">.</span><span class="n">ca</span><span class="w"> </span><span class="n">sshd</span><span class="p">[</span><span class="mi">11584</span><span class="p">]:</span><span class="w"> </span><span class="n">Server</span><span class="w"> </span><span class="n">listening</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mf">22.</span>
<span class="n">Sep</span><span class="w"> </span><span class="mi">23</span><span class="w"> </span><span class="mi">02</span><span class="p">:</span><span class="mi">08</span><span class="p">:</span><span class="mi">56</span><span class="w"> </span><span class="n">vps138235</span><span class="o">.</span><span class="n">vps</span><span class="o">.</span><span class="n">ovh</span><span class="o">.</span><span class="n">ca</span><span class="w"> </span><span class="n">sshd</span><span class="p">[</span><span class="mi">11584</span><span class="p">]:</span><span class="w"> </span><span class="n">Server</span><span class="w"> </span><span class="n">listening</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mf">22.</span>
<span class="n">Sep</span><span class="w"> </span><span class="mi">23</span><span class="w"> </span><span class="mi">02</span><span class="p">:</span><span class="mi">08</span><span class="p">:</span><span class="mi">56</span><span class="w"> </span><span class="n">vps138235</span><span class="o">.</span><span class="n">vps</span><span class="o">.</span><span class="n">ovh</span><span class="o">.</span><span class="n">ca</span><span class="w"> </span><span class="n">systemd</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span><span class="w"> </span><span class="n">Started</span><span class="w"> </span><span class="n">OpenSSH</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">daemon</span><span class="o">.</span>
</code></pre></div>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>