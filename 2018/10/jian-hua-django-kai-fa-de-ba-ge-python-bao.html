<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>简化 Django 开发的八个 Python 包</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: Jeff Triplett 这个月的 Python 专栏将介绍一些 Django 包，它们有益于你的工作，以及你的个人或业余项目。 Django 开发者们，在这个月的 Python 专栏 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li class="active"><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2018/10/jian-hua-django-kai-fa-de-ba-ge-python-bao.html" rel="bookmark"
           title="Permalink to 简化 Django 开发的八个 Python 包">简化 Django 开发的八个 Python 包</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2018-10-05T21:41:14+02:00">
                Published: Fri 05 October 2018
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/ruan-jian-kai-fa">软件开发</a>.</p>

</footer><!-- /.post-info -->      <p>Author: Jeff Triplett</p>
<blockquote>
<p>这个月的 Python 专栏将介绍一些 Django 包，它们有益于你的工作，以及你的个人或业余项目。</p>
</blockquote>
<p><img alt="" src="/data/attachment/album/201810/05/214124yuum9a6n6ibbnud9.png"></p>
<p>Django 开发者们，在这个月的 Python 专栏中，我们会介绍一些能帮助你们的软件包。这些软件包是我们最喜欢的 <a href="https://www.djangoproject.com/">Django</a> 库，能够节省开发时间，减少样板代码，通常来说，这会让我们的生活更加轻松。我们为 Django 应用准备了六个包，为 Django 的 REST 框架准备了两个包。几乎所有我们的项目里，都用到了这些包，真的，不是说笑。</p>
<p>不过在继续阅读之前，请先看看我们关于<a href="https://opensource.com/article/18/1/10-tips-making-django-admin-more-secure">让 Django 管理后台更安全</a>的几个提示，以及这篇关于 <a href="https://opensource.com/business/15/12/5-favorite-open-source-django-packages">5 个最受欢迎的开源 Django 包</a> 的文章。</p>
<h3>有用又省时的工具集合：django-extensions</h3>
<p><a href="https://django-extensions.readthedocs.io/en/latest/">django-extensions</a> 这个 Django 包非常受欢迎，全是有用的工具，比如下面这些管理命令：</p>
<ul>
<li><code>shell_plus</code> 打开 Django 的管理 shell，这个 shell 已经自动导入了所有的数据库模型。在测试复杂的数据关系时，就不需要再从几个不同的应用里做导入操作了。</li>
<li><code>clean_pyc</code> 删除项目目录下所有位置的 .pyc 文件</li>
<li><code>create_template_tags</code> 在指定的应用下，创建模板标签的目录结构。</li>
<li><code>describe_form</code> 输出模型的表单定义，可以粘贴到 <code>forms.py</code> 文件中。（需要注意的是，这种方法创建的是普通 Django 表单，而不是模型表单。）</li>
<li><code>notes</code> 输出你项目里所有带 TODO、FIXME 等标记的注释。</li>
</ul>
<p>Django-extensions 还包括几个有用的抽象基类，在定义模型时，它们能满足常见的模式。当你需要以下模型时，可以继承这些基类：</p>
<ul>
<li><code>TimeStampedModel</code>：这个模型的基类包含了 <code>created</code> 字段和 <code>modified</code> 字段，还有一个 <code>save()</code> 方法，在适当的场景下，该方法自动更新 <code>created</code> 和 <code>modified</code> 字段的值。</li>
<li><code>ActivatorModel</code>：如果你的模型需要像 <code>status</code>、<code>activate_date</code> 和 <code>deactivate_date</code> 这样的字段，可以使用这个基类。它还自带了一个启用 <code>.active()</code> 和 <code>.inactive()</code> 查询集的 manager。</li>
<li><code>TitleDescriptionModel</code> 和 <code>TitleSlugDescriptionModel</code>：这两个模型包括了 <code>title</code> 和 <code>description</code> 字段，其中 <code>description</code> 字段还包括 <code>slug</code>，它根据 <code>title</code> 字段自动产生。</li>
</ul>
<p>django-extensions 还有其他更多的功能，也许对你的项目有帮助，所以，去浏览一下它的<a href="https://django-extensions.readthedocs.io/">文档</a>吧！</p>
<h3>12 因子应用的配置：django-environ</h3>
<p>在 Django 项目的配置方面，<a href="https://django-environ.readthedocs.io/en/latest/">django-environ</a> 提供了符合 <a href="https://www.12factor.net/">12 因子应用</a> 方法论的管理方法。它是另外一些库的集合，包括 <a href="https://github.com/rconradharris/envparse">envparse</a> 和 <a href="https://github.com/nickstenning/honcho">honcho</a> 等。安装了 django-environ 之后，在项目的根目录创建一个 <code>.env</code> 文件，用这个文件去定义那些随环境不同而不同的变量，或者需要保密的变量。（比如 API 密钥，是否启用调试，数据库的 URL 等）</p>
<p>然后，在项目的 <code>settings.py</code> 中引入 <code>environ</code>，并参考<a href="https://django-environ.readthedocs.io/">官方文档的例子</a>设置好 <code>environ.PATH()</code> 和 <code>environ.Env()</code>。就可以通过 <code>env('VARIABLE_NAME')</code> 来获取 <code>.env</code> 文件中定义的变量值了。</p>
<h3>创建出色的管理命令：django-click</h3>
<p><a href="https://github.com/GaretJax/django-click">django-click</a> 是基于 <a href="http://click.pocoo.org/5/">Click</a> 的，（我们<a href="https://opensource.com/article/18/9/python-libraries-side-projects">之前推荐过</a>… <a href="https://opensource.com/article/18/5/3-python-command-line-tools">两次</a> Click)，它对编写 Django 管理命令很有帮助。这个库没有很多文档，但是代码仓库中有个存放<a href="https://github.com/GaretJax/django-click/tree/master/djclick/test/testprj/testapp/management/commands">测试命令</a>的目录，非常有参考价值。 django-click 基本的 Hello World 命令是这样写的：</p>
<div class="highlight"><pre><span></span><code><span class="c1"># app_name.management.commands.hello.py</span>
<span class="kn">import</span> <span class="nn">djclick</span> <span class="k">as</span> <span class="nn">click</span>

<span class="nd">@click</span><span class="o">.</span><span class="n">command</span><span class="p">()</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">argument</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">command</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="n">click</span><span class="o">.</span><span class="n">secho</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Hello, </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</code></pre></div>

<p>在命令行下调用它，这样执行即可：</p>
<div class="highlight"><pre><span></span><code>&gt;&gt; ./manage.py hello Lacey
Hello, Lacey
</code></pre></div>

<h3>处理有限状态机：django-fsm</h3>
<p><a href="https://github.com/viewflow/django-fsm">django-fsm</a> 给 Django 的模型添加了有限状态机的支持。如果你管理一个新闻网站，想用类似于“写作中”、“编辑中”、“已发布”来流转文章的状态，django-fsm 能帮你定义这些状态，还能管理状态变化的规则与限制。</p>
<p>Django-fsm 为模型提供了 FSMField 字段，用来定义模型实例的状态。用 django-fsm 的 <code>@transition</code> 修饰符，可以定义状态变化的方法，并处理状态变化的任何副作用。</p>
<p>虽然 django-fsm 文档很轻量，不过 <a href="https://gist.github.com/Nagyman/9502133">Django 中的工作流（状态）</a> 这篇 GitHub Gist 对有限状态机和 django-fsm 做了非常好的介绍。</p>
<h3>联系人表单：#django-contact-form</h3>
<p>联系人表单可以说是网站的标配。但是不要自己去写全部的样板代码，用 <a href="https://django-contact-form.readthedocs.io/en/1.5/">django-contact-form</a> 在几分钟内就可以搞定。它带有一个可选的能过滤垃圾邮件的表单类（也有不过滤的普通表单类）和一个 <code>ContactFormView</code> 基类，基类的方法可以覆盖或自定义修改。而且它还能引导你完成模板的创建，好让表单正常工作。</p>
<h3>用户注册和认证：django-allauth</h3>
<p><a href="https://django-allauth.readthedocs.io/en/latest/">django-allauth</a> 是一个 Django 应用，它为用户注册、登录/注销、密码重置，还有第三方用户认证（比如 GitHub 或 Twitter）提供了视图、表单和 URL，支持邮件地址作为用户名的认证方式，而且有大量的文档记录。第一次用的时候，它的配置可能会让人有点晕头转向；请仔细阅读<a href="https://django-allauth.readthedocs.io/en/latest/installation.html">安装说明</a>，在<a href="https://django-allauth.readthedocs.io/en/latest/configuration.html">自定义你的配置</a>时要专注，确保启用某个功能的所有配置都用对了。</p>
<h3>处理 Django REST 框架的用户认证：django-rest-auth</h3>
<p>如果 Django 开发中涉及到对外提供 API，你很可能用到了 <a href="http://www.django-rest-framework.org/">Django REST Framework</a>（DRF）。如果你在用 DRF，那么你应该试试 django-rest-auth，它提供了用户注册、登录/注销，密码重置和社交媒体认证的端点（是通过添加 django-allauth 的支持来实现的，这两个包协作得很好）。</p>
<h3>Django REST 框架的 API 可视化：django-rest-swagger</h3>
<p><a href="https://django-rest-swagger.readthedocs.io/en/latest/">Django REST Swagger</a> 提供了一个功能丰富的用户界面，用来和 Django REST 框架的 API 交互。你只需要安装 Django REST Swagger，把它添加到 Django 项目的已安装应用中，然后在 <code>urls.py</code> 中添加 Swagger 的视图和 URL 模式就可以了，剩下的事情交给 API 的 docstring 处理。</p>
<p><img alt="" src="/data/attachment/album/201810/05/214126pjyeeik1e1jjs80y.png"></p>
<p>API 的用户界面按照 app 的维度展示了所有端点和可用方法，并列出了这些端点的可用操作，而且它提供了和 API 交互的功能（比如添加/删除/获取记录）。django-rest-swagger 从 API 视图中的 docstrings 生成每个端点的文档，通过这种方法，为你的项目创建了一份 API 文档，这对你，对前端开发人员和用户都很有用。</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>