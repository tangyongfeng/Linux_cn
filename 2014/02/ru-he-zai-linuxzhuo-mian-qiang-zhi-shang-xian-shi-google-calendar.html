<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>如何在Linux桌面墙纸上显示Google Calendar</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: '' Google Calendar 是时下最流行的网页应用程序之一。用户可以通过网络接口或者本地的应用程序跨设备访问或同步 Google Calendar。在 Linux 上 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li class="active"><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2014/02/ru-he-zai-linuxzhuo-mian-qiang-zhi-shang-xian-shi-google-calendar.html" rel="bookmark"
           title="Permalink to 如何在Linux桌面墙纸上显示Google Calendar">如何在Linux桌面墙纸上显示Google Calendar</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2014-02-12T22:07:00+01:00">
                Published: Wed 12 February 2014
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/ji-zhu">技术</a>.</p>

</footer><!-- /.post-info -->      <p>Author: ''</p>
<p>Google Calendar 是时下最流行的网页应用程序之一。用户可以通过网络接口或者本地的应用程序跨设备访问或同步 Google Calendar。在 Linux 上，有很多方法可以本地访问 Google Calendar，比如用电子邮件客户端插件（如 Evolution 或 Thunderbird ）或者用日历应用程序（如 Sunbird 或 Rainklendar）。这些方法通常都需要安装不必要的大型软件，这些软件你很可能根本不需要。</p>
<p>如果你只是想在本地的 Linux 上翻翻 Google Calendar 或者用它设置提醒，那么你可以考虑使用<a href="https://github.com/insanum/gcalcli">Google Calendar 命令行接口（或者 gcalcli）</a>，这是一种更轻型化的方法。对于 Linux 桌面操作系统用户来说，好处不止这些，如果将 gcalcli 与<a href="http://conky.sourceforge.net/">Conky</a>搭配使用你就可以把 Google Calendar 透明地融入桌面主题。</p>
<p>在这个教程中，我会展示<strong>如何利用 gcalcli 和 Conky 将 Google Calendar 融入 Linux 桌面</strong></p>
<p><strong><a href="http://www.flickr.com/photos/xmodulo/11216377436/"><img alt="" src="/data/attachment/album/201402/12/220326aq63mqcizywr93wq.jpg"></a></strong></p>
<h3>在 Linux 安装 gcalcli</h3>
<p>在安装 gcalcli 之前，要确保你正在用的是 Python 2 而不是 Python 3 ，因为 Python 3 与 gcalcli 不兼容。</p>
<p>如果是在 Debian、Ubuntu 或 Linux Mint 上可以用下面的命令安装 gcalcli</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>git<span class="w"> </span>python-pip<span class="w"> </span>python-gdata<span class="w"> </span>python-dateutil<span class="w"> </span>python-gflags<span class="w"> </span>python-vobject<span class="w"> </span>python-parsedatetime
$<span class="w"> </span>sudo<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>google-api-python-client
$<span class="w"> </span>sudo<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>apiclient<span class="w"> </span>urllib3
$<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/insanum/gcalcli.git
$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>gcalcli
$<span class="w"> </span>sudo<span class="w"> </span>python<span class="w"> </span>setup.py<span class="w"> </span>install<span class="w"> </span>
</code></pre></div>

<p><strong>温馨提醒</strong>：Ubuntu 或 Linux Mint 的软件库中虽然有 gcalcli，但是这些版本并不包含其最新的特性和针对 bug 的修复。所以这里推荐按以上所述的方法由源文件构建 gcalcli。</p>
<p>对于Fedora 、CentOS 或 RHEL，可按如下方法安装。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>yum<span class="w"> </span>install<span class="w"> </span>git<span class="w"> </span>python-pip<span class="w"> </span>python-gdata<span class="w"> </span>python-dateutil<span class="w"> </span>python-gflags<span class="w"> </span>python-vobject
$<span class="w"> </span>sudo<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>google-api-python-client
$<span class="w"> </span>sudo<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>apiclient<span class="w"> </span>urllib3
$<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/insanum/gcalcli.git
$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>gcalcli
$<span class="w"> </span>sudo<span class="w"> </span>python<span class="w"> </span>setup.py<span class="w"> </span>install<span class="w"> </span>
</code></pre></div>

<h3>gcalcli 的 Google 认证</h3>
<p>为了能让 gcalcli 访问 Google Calendar ，你需要用你的 Google 帐号通过 OAuth2 认证，以使 gcalcli 获得许可来访问你的 Google Calendar。</p>
<p>第一次运行 gcalcli 的时候，OAuth2 认证会自动进行初始化。因此运行下面的命令开始</p>
<p>$ gcalcli agenda</p>
<p>该命令会输出如下的一个 URL 。</p>
<p><a href="http://www.flickr.com/photos/xmodulo/11216331146/"><img alt="" src="/data/attachment/album/201402/12/220329zxh3r3qlzuyuuxq7.jpg"></a></p>
<p>同时这个命令也会弹出一个指向该 URL 的浏览器窗口。如果因为一些原因，你的浏览器没有反应，你可以手动复制粘贴这个 URL 到你的浏览器中。</p>
<p>如果你还没有登录你的 Google 帐号，你得先登录。然后你会看到下面要求你许可 gcalcli 管理 Google Calendar 的信息。点击“Accept”即可。</p>
<p><a href="http://www.flickr.com/photos/xmodulo/11216308465/"><img alt="" src="/data/attachment/album/201402/12/220331zy2l9zod849ldu9s.jpg"></a></p>
<h3>支持 Google Calendar API</h3>
<p>认证后，下一步就是支持 Google Calendar 的 API 访问。gcalcli 通过 Google Calendar API 访问Google Calendar 。但是，如果要使用 Google API 就必须明确设置你的 Google 帐号支持 Google API。</p>
<p>首先到：<a href="https://cloud.google.com/console">https://cloud.google.com/console</a>。点击项目列表下的“API Project ”</p>
<p>转到“APIs &amp; auth ”下面的“APIs”你会看见一个 Google APIs 列表。点击“Calendar API”的开关按钮使其能支持 API。</p>
<p>现在转到“APIs &amp; auth”下的“Registered apps”那里，去注册 gcalcli app。点击最顶端的“Registered app”按钮。</p>
<p><a href="http://www.flickr.com/photos/xmodulo/11216363656/"><img alt="" src="/data/attachment/album/201402/12/22033384z2abog4jsjw5eg.jpg"></a></p>
<p>填写 app 的名字（如，“My Gcalcli”），然后选择“ Native ”作为平台。点击“Registered”按钮。</p>
<p>这一步会生成并显示 OAuth 用户的 ID 和密码。另外关于上面提示的“You have not set up your product name（您没有设置您的产品名称）”，你可以忽略掉。</p>
<p><a href="http://www.flickr.com/photos/xmodulo/11216593546/"><img alt="" src="/data/attachment/album/201402/12/220336n9aphahlkauc6hkz.jpg"></a></p>
<p>OAuth的认证结果将会保存在 ～/.gcalcli_oauth 文本文件中。</p>
<h3>用 gcalcli 在命令行中访问 Google Calendar</h3>
<p>你现在马上就可以用 gcalcli 访问Google Calendar 了。</p>
<p>在你的家目录创建一个如下的 gcalcli 配置文件。将你先前获得的 OAuth 用户 ID 和 密码按下面格式输入进去。</p>
<p>$ vi ~/.gcalclirc</p>
<blockquote>
<p>--client<em>id='XXXXXXXXXX.apps.googleusercontent.com' --client</em>secret='YYYYYYYYYYYYYYYY'</p>
</blockquote>
<p>到了这一步，你应该可以在命令行运行 gcalcli 了。</p>
<p>试试下面的命令，这两个命令会分别打印出一个你的 Google Calendar 的列表和今后 5 天的日程安排。</p>
<p>$ gcalcli list<br>
$ gcalcli agenda</p>
<p><a href="http://www.flickr.com/photos/xmodulo/11216465043/"><img alt="" src="/data/attachment/album/201402/12/220338c47pp4io14ez14mi.jpg"></a></p>
<h3>将 gcalcli 与 Conky 结合</h3>
<p>最后一步就是将 gcalcli 的输出导入你的桌面主题中。为了做到这一点，你需要 Conky 这个非常强大的工具，它可以把许多信息直接显示在你的桌面主题中。</p>
<p>首先在你的 Linux 系统上 <a href="http://xmodulo.com/2013/12/install-configure-conky-linux.html">安装 Conky</a>。</p>
<p>然后，在你的家目录下的某个地方( 例如 ～/bin )创建如下的脚本程序。</p>
<p>$ vi ~/bin/gcal.sh</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/sh</span>

gcalcli<span class="w"> </span>--conky<span class="w"> </span>calw<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="p">|</span>
<span class="w">  </span>sed<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;s/^[(0\x71^[(B/?/g&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">      </span>-e<span class="w"> </span><span class="s1">&#39;s/^[(0\x78^[(B/?/g&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">      </span>-e<span class="w"> </span><span class="s1">&#39;s/^[(0\x6A^[(B/?/g&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">      </span>-e<span class="w"> </span><span class="s1">&#39;s/^[(0\x6B^[(B/?/g&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">      </span>-e<span class="w"> </span><span class="s1">&#39;s/^[(0\x6C^[(B/?/g&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">      </span>-e<span class="w"> </span><span class="s1">&#39;s/^[(0\x6D^[(B/?/g&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">      </span>-e<span class="w"> </span><span class="s1">&#39;s/^[(0\x6E^[(B/?/g&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">      </span>-e<span class="w"> </span><span class="s1">&#39;s/^[(0\x74^[(B/?/g&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">      </span>-e<span class="w"> </span><span class="s1">&#39;s/^[(0\x75^[(B/?/g&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">      </span>-e<span class="w"> </span><span class="s1">&#39;s/^[(0\x76^[(B/?/g&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">      </span>-e<span class="w"> </span><span class="s1">&#39;s/^[(0\x77^[(B/?/g&#39;</span>

$<span class="w"> </span>chmod<span class="w"> </span>+x<span class="w"> </span>~/bin/gcal.sh<span class="w"> </span>
</code></pre></div>

<p><strong>重要提醒</strong>：上面脚本中的 ‘<sup> [’</sup> 必须是<strong>真正的 ESCAPE 键</strong>( 也就是说在 vi 中按 Ctrl-V 然后按 Esc )。</p>
<p>这个脚本程序将 VT100 转义序列转成Unicode组件图字符。这是<a href="https://github.com/insanum/gcalcli/issues/97">必须的一步</a>，因为 Conky 不支持 gcalcli 使用的 ANSI 字符画。</p>
<p>最后，在你的家目录中创建下面的 Conky 配置文件。</p>
<p>$ vi ~/.conkyrc</p>
<div class="highlight"><pre><span></span><code>alignment<span class="w"> </span>top_right
maximum_width<span class="w"> </span>630
minimum_size<span class="w"> </span>330<span class="w"> </span>10
gap_x<span class="w"> </span>25
gap_y<span class="w"> </span>50

own_window<span class="w"> </span>yes
own_window_type<span class="w"> </span>conky
own_window_hints<span class="w"> </span>undecorated,below,sticky,skip_taskbar,skip_pager
own_window_transparent<span class="w"> </span>yes
own_window_argb_visual<span class="w"> </span>yes
own_window_argb_value<span class="w"> </span>0

update_interval<span class="w"> </span>300
background<span class="w"> </span>no

border_width<span class="w"> </span>1
default_color<span class="w"> </span>cornflowerblue
default_outline_color<span class="w"> </span>white
default_shade_color<span class="w"> </span>white
double_buffer<span class="w"> </span>no
draw_borders<span class="w"> </span>no
draw_graph_borders<span class="w"> </span>no
draw_outline<span class="w"> </span>no
draw_shades<span class="w"> </span>no
max_port_monitor_connections<span class="w"> </span>64
max_specials<span class="w"> </span>512
max_user_text<span class="w"> </span>16384
text_buffer_size<span class="w"> </span>8096
no_buffers<span class="w"> </span>yes
out_to_console<span class="w"> </span>no
uppercase<span class="w"> </span>no
use_xft<span class="w"> </span>yes
xftfont<span class="w"> </span>Bitstream<span class="w"> </span>Vera<span class="w"> </span>Sans<span class="w"> </span>Mono:size=10

TEXT
***<span class="w"> </span>Google<span class="w"> </span>Calendar<span class="w"> </span>Agenda<span class="w"> </span>***
<span class="cp">${</span><span class="n">execpi</span> <span class="mi">300</span> <span class="n">gcalcli</span> <span class="o">--</span><span class="n">conky</span> <span class="n">agenda</span><span class="cp">}</span>
<span class="cp">${</span><span class="n">execpi</span> <span class="mi">300</span> <span class="o">~/</span><span class="nb">bin</span><span class="o">/</span><span class="n">gcal</span><span class="o">.</span><span class="n">sh</span><span class="cp">}</span>
</code></pre></div>

<p>这个 Conky 配置文件会直接在你的桌面主题上显示你的 Google Calendar 的一个日程表和一个两个星期的时间表。</p>
<p>现在，你可以运行下面的命令激活 Conky。</p>
<p>$ conky</p>
<p>你应该可以在 Linux 桌面的右边看到 Google Calendar，如题图。</p>
<p>确认 Google Calendar 可以正常运行后，你可以将 Conky 设为在每次登录时自动启动。</p>
<h3>设置 Google Calendar 提醒</h3>
<p>gcalcli 也可以为 Google Calendar 中即将到来的事件发送一个提醒。它使用 notify-send 命令。对于 Google Calendar 提醒，你可以像下面一样设置一个工作进程。</p>
<p>$ crontab -l</p>
<blockquote>
<p>*/10 * * * * /usr/local/bin/gcalcli remind</p>
</blockquote>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>