<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>10个关于linux中Squid代理服务器的实用面试问答</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: Avishek Kumar 不仅是系统管理员和网络管理员时不时会听到“代理服务器”这个词，我们也经常听到。代理服务器已经成为一种企 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li class="active"><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2014/09/10ge-guan-yu-linuxzhong-squiddai-li-fu-wu-qi-de-shi-yong-mian-shi-wen-da.html" rel="bookmark"
           title="Permalink to 10个关于linux中Squid代理服务器的实用面试问答">10个关于linux中Squid代理服务器的实用面试问答</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2014-09-23T14:22:00+02:00">
                Published: Tue 23 September 2014
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/xi-tong-yun-wei">系统运维</a>.</p>

</footer><!-- /.post-info -->      <p>Author: Avishek Kumar</p>
<p>不仅是系统管理员和网络管理员时不时会听到“代理服务器”这个词，我们也经常听到。代理服务器已经成为一种企业常态，而且经常会接触到它。它现在也出现在一些小型的学校或者大型跨国公司的自助餐厅里。Squid（常被视作代理服务的代名词）就是这样一个应用程序，它不但可以被作为代理服务器，其同时也是在该类工具中比较被广泛使用的一种。</p>
<p>本文旨在提高你在遇到关于代理服务器面试点时的一些基本应对能力。</p>
<p><img alt="" src="/data/attachment/album/201409/23/142220gessges97uu9ey9p.png"></p>
<p>以下为面试问答的内容</p>
<h3>1. 什么是代理服务器？代理服务器在计算机网络中有什么用途？</h3>
<blockquote>
<p><strong>回答</strong> : 代理服务器是指那些作为客户端和资源提供商或服务器之间的中间件的物理机或者应用程序。客户端从代理服务器中寻找文件、页面或者是数据，而且代理服务器能处理客户端与服务器之间所有复杂事务，从而满足客户端的生成的需求。</p>
</blockquote>
<p>代理服务器是WWW（万维网）的支柱，它们其中大部分都是Web代理。一台代理服务器能处理客户端与服务器之间的复杂通信事务。此外，它在网络上提供的是匿名信息（LCTT 译注：指浏览者的 IP、浏览器信息等被隐藏），这就意味着你的身份和浏览痕迹都是安全的。代理可以去配置允许哪些网站的客户能看到，哪些网站被屏蔽了。</p>
<h3>2. Squid是什么?</h3>
<blockquote>
<p><strong>回答</strong> : Squid是一个在GNU/GPL协议下发布的既可作为代理服务器，同时也可作为Web缓存守护进程的应用软件。Squid主要是支持像HTTP和FTP那样的协议，但是对其它的协议比如HTTPS，SSL,TLS等同样也能支持。其特点是Web缓存守护进程通过从经常上访问的网站里缓存Web和DNS数据，从而让上网速度更快。Squid支持所有的主流平台，包括Linux，UNIX，微软公司的Windows和苹果公司的Mac。</p>
</blockquote>
<h3>3. Squid的默认端口是什么？怎么去修改它的操作端口？</h3>
<blockquote>
<p><strong>回答</strong> : Squid运行时的默认端口是3128。我们可以通过编辑它的配置文件来把它的默认端口修改成未被用户使用的端口，路径是 /etc/squid/squid.conf ，建议如下。</p>
</blockquote>
<p>用你的编辑器打开 ‘/etc/squid/squid.conf’ 文件。</p>
<div class="highlight"><pre><span></span><code># nano /etc/squid/squid.conf
</code></pre></div>

<p>现在把它修改成未被使用的其它端口，并保存退出。</p>
<div class="highlight"><pre><span></span><code>http_port 3128
</code></pre></div>

<p>重新启动Squid代理服务，如下显示。</p>
<div class="highlight"><pre><span></span><code># service squid restart
</code></pre></div>

<h3>4. 你的公司管理层要求你通过Squid代理服务器屏蔽掉一些域名，你怎么做？</h3>
<blockquote>
<p><strong>回答</strong> : 屏蔽域名是一个在配置文件中实现的功能模块。我们只需要执行一个小的手动配置即可，建议如下。</p>
</blockquote>
<p>a. 在 ‘/etc/squid’ 目录下创建一个名为 ‘blacklist’ 的文件。</p>
<div class="highlight"><pre><span></span><code># touch /etc/squid/blacklist
</code></pre></div>

<p>b. 用nano编辑器打开这个文件。</p>
<div class="highlight"><pre><span></span><code> # nano /etc/squid/blacklist
</code></pre></div>

<p>c. 以每行一个域名的方式将想要屏蔽的域名写进这个文件里。</p>
<div class="highlight"><pre><span></span><code><span class="na">.facebook.com</span>
<span class="na">.twitter.com</span>
<span class="na">.gmail.com</span>
<span class="na">.yahoo.com</span>
<span class="na">...</span>
</code></pre></div>

<p>d. 保存退出，然后从 ‘/etc/squid/squid.conf’ 打开Squid配置文件。</p>
<div class="highlight"><pre><span></span><code># nano /etc/squid/squid.conf
</code></pre></div>

<p>e. 在配置文件中添加如下行。</p>
<div class="highlight"><pre><span></span><code><span class="n">acl</span><span class="w"> </span><span class="n">BLACKLIST</span><span class="w"> </span><span class="n">dstdom_regex</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="err">“</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">squid</span><span class="o">/</span><span class="n">blacklist</span><span class="err">”</span>
<span class="n">http_access</span><span class="w"> </span><span class="n">deny</span><span class="w"> </span><span class="n">blacklist</span>
</code></pre></div>

<p>f. 保存配置文件并退出，重启Squid服务让其生效。</p>
<div class="highlight"><pre><span></span><code># service squid restart
</code></pre></div>

<h3>5. 在Squid中什么是媒体范围限制（Media Range Limitation）和部分下载？</h3>
<blockquote>
<p><strong>回答</strong> : 媒体范围限制是Squid的一种特殊的功能，它只从服务器中获取所需要的数据而不是整个文件。这个功能很好的实现了用户在各种视频流媒体网站如YouTube和Metacafe看视频时，可以点击视频中的进度条来选择进度，因此整个视频不用全部都加载，除了一些需要的部分。</p>
</blockquote>
<p>Squid部分下载功能的特点是很好地实现了类似在Windows更新时能以一个个小数据包的形式下载，并可以暂停，正因为它的这个特点，正在下载文件的Windows机器可以重新继续下载，而不用担心数据会丢失。Squid的媒体范围限制和部分下载功能只有在存储了一个完整文件的副本之后才行。此外，当用户访问另一个页面时，除非Squid进行了特定的配置，部分下载下来的文件会被删除且不留在缓存中。</p>
<h3>6. 什么是Squid的反向代理？</h3>
<blockquote>
<p><strong>回答</strong> : 反向代理是Squid的一个功能，这个功能被用来加快最终用户的上网速度。下面用缩写 ‘RS’ 的表示包含了资源的原服务器，而代理服务器则称作 ‘PS’ 。初次访问时，它会从RS得到其提供的数据，并将其副本按照配置好的时间存储在PS上。这样的话每次从PS上请求的数据就相当于就是从原服务器上获取的。这样就会减轻网络拥堵，减少CPU使用率，降低网络资源的利用率，从而缓解原来实际服务器的负载压力。但是RS统计不了总流量的数据，因为PS分担了部分原服务器的任务。‘X-Forwarded-For HTTP’ 信息能用于记录下通过HTTP代理或负载均衡方式连接到RS的客户端最原始的IP地址。</p>
</blockquote>
<p>从技术上说，用单个Squid服务器同时作为正向代理服务器和反向代理服务器是可行的。</p>
<h3>7. 由于Squid能作为一个Web缓存守护进程，那缓存可以删除吗？怎么删除？</h3>
<blockquote>
<p><strong>回答</strong> : 当然！作为一个Web缓存守护进程，Squid能加快网页的访问速度，清除缓存也是非常简单的。</p>
</blockquote>
<p>a. 首先停止Squid代理服务，然后从这个 ‘/var/lib/squid/cache’ 目录中删除缓存。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># service squid stop</span>
<span class="c1"># rm -rf /var/lib/squid/cache/*&lt;</span>
</code></pre></div>

<p>b. 创建交换分区目录。</p>
<div class="highlight"><pre><span></span><code># squid -z
</code></pre></div>

<h3>8. 你有一台工作中的机器可以访问代理服务器，如果想要限制你的孩子的访问时间，你会怎么去设置那个场景？</h3>
<p>把允许访问的时间设置成晚上4点到7点三个小时，跨度为星期一到星期五。</p>
<p>a. 想要限制Web访问时间在星期一到星期五的晚上4点到7点，要先打开Squid的配置文件。</p>
<div class="highlight"><pre><span></span><code># nano /etc/squid/squid.conf
</code></pre></div>

<p>b. 在配置文件中添加如下行，保存文件并退出。</p>
<div class="highlight"><pre><span></span><code>acl ALLOW_TIME time M T W H F 16:00-19:00
shttp_access allow ALLOW_TIME
</code></pre></div>

<p>c. 重启Squid服务。</p>
<div class="highlight"><pre><span></span><code># service squid restart
</code></pre></div>

<h3>9. Squid存储的数据是什么文件格式？</h3>
<blockquote>
<p><strong>回答</strong> : Squid存储的数据是UFS文件格式的。UFS是一种老的，使用比较广泛的Squid存储格式</p>
</blockquote>
<h3>10. Squid的缓存会存储到哪里？</h3>
<blockquote>
<p><strong>回答</strong> : Squid存储的缓存是位于 ‘/var/spool/squid’ 的特定目录下。</p>
</blockquote>
<p>以上就是全部内容了，很快我还会带着其它有趣的内容回到这里。</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>