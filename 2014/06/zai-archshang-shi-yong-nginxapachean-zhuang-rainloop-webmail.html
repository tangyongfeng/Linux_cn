<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>在Arch上使用Nginx/Apache安装RainLoop Webmail</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: '' Rainloop是一个使用PHP编写的，开源免费的网页邮件客户端。他支持包括Google、Yahoo、OutLook在内的主流的邮件服务器，当然，他也支持你自己的本地邮件服务器。它看起来大致就像使用IMAP和SMTP协议的MUA …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li class="active"><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2014/06/zai-archshang-shi-yong-nginxapachean-zhuang-rainloop-webmail.html" rel="bookmark"
           title="Permalink to 在Arch上使用Nginx/Apache安装RainLoop Webmail">在Arch上使用Nginx/Apache安装RainLoop Webmail</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2014-06-20T11:00:00+02:00">
                Published: Fri 20 June 2014
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/xi-tong-yun-wei">系统运维</a>.</p>

</footer><!-- /.post-info -->      <p>Author: ''</p>
<p>Rainloop是一个使用PHP编写的，开源免费的网页邮件客户端。他支持包括Google、Yahoo、OutLook在内的主流的邮件服务器，当然，他也支持你自己的本地邮件服务器。它看起来大致就像使用IMAP和SMTP协议的MUA(邮件客户端)一样。</p>
<h4>RainLoop 示例</h4>
<p>可以看一下RainLoop作者安装的演示页面： <a href="http://demo.rainloop.net/">http://demo.rainloop.net/</a>。</p>
<p><img alt="在Arch Linux上安装RainLoop" src="/data/attachment/album/201406/20/104916cmeffitxb5insqqb.jpg"></p>
<p><em>在Arch Linux上安装RainLoop</em></p>
<p>一旦在您的服务器部署上Rainloop，剩余要做的唯一的事情是通过Web浏览器访问您的Rainloop，并提供你正在使用的邮件服务器信息。</p>
<p>本教程包含了在 <strong>Arch Linux</strong>上的<strong>Rainloop</strong> 网页客户端的安装流程，包括如何进行配置 <strong>Apache</strong> 或 <strong>Nginx</strong>, 当然本教程使用修改Hosts的方式，从而避免了DNS的访问。</p>
<p>If you also need references on installing Rainloop on <strong>Debian</strong> and <strong>Red Hat</strong> systems visit the previous RainLoop Webmail article at.</p>
<p>如果你还是需要一篇在<strong>Debian</strong> 和 <strong>Red Hat</strong> 安装 RainLoop Webmail 的教程，你可以看这篇文章：</p>
<ul>
<li><a href="http://www.tecmint.com/rainloop-webmail-a-modern-fast-web-based-email-client-for-linux/">在 Debian 和 RedHat 系的 Linux 上安装 RainLoop Webmail</a></li>
</ul>
<p>以及在 <strong>Ubuntu</strong> 服务器中安装 RainLoop Webmail 的教程，你可以看这篇文章：</p>
<ul>
<li><a href="http://linux.cn/article-2794-1.html">如何在 Ubuntu server 中设置 RainLoop Webmail</a></li>
</ul>
<h3>系统要求</h3>
<h4>对 Nginx</h4>
<ul>
<li><a href="http://www.tecmint.com/install-nginx-php-mysql-with-mariadb-engine-and-phpmyadmin-in-arch-linux/">在 Arch Linux 上安装 LEMP (Nginx, PHP, MySQL/MariaDB 和 PhpMyAdmin)</a></li>
<li><a href="http://www.tecmint.com/create-virtual-hosts-using-nginx-on-arch-linux/">在 Nginx 上创建虚拟主机</a></li>
</ul>
<h4>对 Apache</h4>
<ul>
<li><a href="http://www.tecmint.com/install-lamp-in-arch-linux/">在 Arch Linux 上安装 LAMP (Linux, Apache, MySQL/MariaDB 和 PHP/PhpMyAdmin)</a></li>
</ul>
<h3>Step 1:在 Nginx 或者 Apache 上创建虚拟主机</h3>
<p><strong>1.</strong> 假设你已经如上面介绍的链接所述，配置好了您的服务器（<strong>Nginx</strong>或<strong>Apache</strong>），你需要做的第一件事是在Hosts文件里创建一个原始解析记录，以指向<strong>的Arch Linux</strong>系统的IP。</p>
<p>对于Linux系统，修改 <strong>/etc/hosts</strong> 文件并且在你的localhost条目之下添加 Rainloop 的虚拟域。如下：</p>
<div class="highlight"><pre><span></span><code><span class="mf">127.0.0.1</span><span class="w">   </span><span class="n">localhost</span><span class="mf">.</span><span class="n">localdomain</span><span class="w">  </span><span class="n">localhost</span><span class="w">     </span><span class="n">rainloop</span><span class="mf">.</span><span class="n">lan</span>
<span class="mf">192.168.1.33</span><span class="w">    </span><span class="n">rainloop</span><span class="mf">.</span><span class="n">lan</span>
</code></pre></div>

<p><img alt="Add Domain Host Entry" src="/data/attachment/album/201406/20/104918zrk23bpgtghqgpua.jpg"></p>
<p><em>添加域信息</em></p>
<p>如果是Windows系统，则修改 <strong>C:\Windows\System32\drivers\etc\hosts</strong> 并且将接下来的内容添加到你的文件里：</p>
<div class="highlight"><pre><span></span><code><span class="mf">192.168.1.33</span><span class="w">       </span><span class="n">rainloop</span><span class="mf">.</span><span class="n">lan</span>
</code></pre></div>

<p><strong>2.</strong> 使用 <strong>ping</strong> 命令确认本地的 Rainloop 域名创建成功之后，然后在 <strong>Apache</strong> 或 <strong>Nginx</strong> 中创建所需的 <strong>虚拟主机</strong> 和 <strong>SSL</strong> 配置。</p>
<h4>Nginx 虚拟主机</h4>
<p>在<strong>/etc/nginx/sites-available/</strong> 目录下使用如下命令创建一个名叫<strong>rainloop.lan</strong>的文件：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>nano<span class="w"> </span>/etc/nginx/sites-available/rainloop.conf
</code></pre></div>

<p>添加如下的文件内容：</p>
<div class="highlight"><pre><span></span><code><span class="n">server</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">listen</span><span class="w"> </span><span class="mi">80</span><span class="p">;</span>
<span class="w">    </span><span class="n">server_name</span><span class="w"> </span><span class="n">rainloop</span><span class="o">.</span><span class="n">lan</span><span class="p">;</span>

<span class="w">    </span><span class="n">rewrite</span><span class="w">        </span><span class="o">^</span><span class="w"> </span><span class="n">https</span><span class="p">:</span><span class="o">//$</span><span class="n">server_name</span><span class="o">$</span><span class="n">request_uri</span><span class="err">?</span><span class="w"> </span><span class="n">permanent</span><span class="p">;</span>
<span class="w">    </span><span class="n">access_log</span><span class="w"> </span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">rainloop</span><span class="o">.</span><span class="n">lan</span><span class="o">.</span><span class="n">access</span><span class="o">.</span><span class="n">log</span><span class="p">;</span>
<span class="w">    </span><span class="n">error_log</span><span class="w"> </span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">rainloop</span><span class="o">.</span><span class="n">lan</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">log</span><span class="p">;</span>
<span class="w">    </span><span class="n">root</span><span class="w"> </span><span class="o">/</span><span class="n">srv</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">rainloop</span><span class="o">/</span><span class="p">;</span>

<span class="w">    </span><span class="c1"># serve static files</span>
<span class="w">    </span><span class="n">location</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="o">^/</span><span class="p">(</span><span class="n">images</span><span class="o">|</span><span class="n">javascript</span><span class="o">|</span><span class="n">js</span><span class="o">|</span><span class="n">css</span><span class="o">|</span><span class="n">flash</span><span class="o">|</span><span class="n">media</span><span class="o">|</span><span class="k">static</span><span class="p">)</span><span class="o">/</span><span class="w">  </span><span class="p">{</span>
<span class="w">        </span><span class="n">root</span><span class="w">    </span><span class="o">/</span><span class="n">srv</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">rainloop</span><span class="o">/</span><span class="p">;</span>
<span class="w">        </span><span class="n">expires</span><span class="w"> </span><span class="mi">30</span><span class="n">d</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">location</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">index</span><span class="w"> </span><span class="n">index</span><span class="o">.</span><span class="n">html</span><span class="w"> </span><span class="n">index</span><span class="o">.</span><span class="n">htm</span><span class="w"> </span><span class="n">index</span><span class="o">.</span><span class="n">php</span><span class="p">;</span>
<span class="w">        </span><span class="n">autoindex</span><span class="w"> </span><span class="n">on</span><span class="p">;</span>
<span class="w">        </span><span class="n">autoindex_exact_size</span><span class="w"> </span><span class="n">off</span><span class="p">;</span>
<span class="w">        </span><span class="n">autoindex_localtime</span><span class="w"> </span><span class="n">on</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">location</span><span class="w"> </span><span class="o">^~</span><span class="w"> </span><span class="o">/</span><span class="n">data</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">deny</span><span class="w"> </span><span class="n">all</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">location</span><span class="w"> </span><span class="o">~</span><span class="w"> </span>\<span class="o">.</span><span class="n">php</span><span class="o">$</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">#fastcgi_pass 127.0.0.1:9000; (depending on your php-fpm socket configuration)</span>
<span class="w">        </span><span class="n">fastcgi_pass</span><span class="w"> </span><span class="n">unix</span><span class="p">:</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">php</span><span class="o">-</span><span class="n">fpm</span><span class="o">/</span><span class="n">php</span><span class="o">-</span><span class="n">fpm</span><span class="o">.</span><span class="n">sock</span><span class="p">;</span>
<span class="w">        </span><span class="n">fastcgi_index</span><span class="w"> </span><span class="n">index</span><span class="o">.</span><span class="n">php</span><span class="p">;</span>
<span class="w">        </span><span class="n">include</span><span class="w"> </span><span class="n">fastcgi</span><span class="o">.</span><span class="n">conf</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w"> </span><span class="p">}</span>
</code></pre></div>

<p>接下来创建SSL配置文件：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>nano<span class="w"> </span>/etc/nginx/sites-available/rainloop-ssl.conf
</code></pre></div>

<p>添加如下内容：</p>
<div class="highlight"><pre><span></span><code><span class="n">server</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">listen</span><span class="w"> </span><span class="mi">443</span><span class="w"> </span><span class="n">ssl</span><span class="p">;</span>
<span class="w">    </span><span class="n">server_name</span><span class="w"> </span><span class="n">rainloop</span><span class="o">.</span><span class="n">lan</span><span class="p">;</span>

<span class="w">    </span><span class="n">ssl_certificate</span><span class="w">     </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">ssl</span><span class="o">/</span><span class="n">rainloop</span><span class="o">.</span><span class="n">lan</span><span class="o">.</span><span class="n">crt</span><span class="p">;</span>
<span class="w">    </span><span class="n">ssl_certificate_key</span><span class="w">  </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">ssl</span><span class="o">/</span><span class="n">rainloop</span><span class="o">.</span><span class="n">lan</span><span class="o">.</span><span class="n">key</span><span class="p">;</span>
<span class="w">    </span><span class="n">ssl_session_cache</span><span class="w">    </span><span class="n">shared</span><span class="p">:</span><span class="n">SSL</span><span class="p">:</span><span class="mi">1</span><span class="n">m</span><span class="p">;</span>
<span class="w">    </span><span class="n">ssl_session_timeout</span><span class="w">  </span><span class="mi">5</span><span class="n">m</span><span class="p">;</span>
<span class="w">    </span><span class="n">ssl_ciphers</span><span class="w">  </span><span class="n">HIGH</span><span class="p">:</span><span class="o">!</span><span class="n">aNULL</span><span class="p">:</span><span class="o">!</span><span class="n">MD5</span><span class="p">;</span>
<span class="w">    </span><span class="n">ssl_prefer_server_ciphers</span><span class="w">  </span><span class="n">on</span><span class="p">;</span>

<span class="w">    </span><span class="n">access_log</span><span class="w"> </span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">rainloop</span><span class="o">.</span><span class="n">lan</span><span class="o">.</span><span class="n">access</span><span class="o">.</span><span class="n">log</span><span class="p">;</span>
<span class="w">    </span><span class="n">error_log</span><span class="w"> </span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">rainloop</span><span class="o">.</span><span class="n">lan</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">log</span><span class="p">;</span>

<span class="w">    </span><span class="n">root</span><span class="w"> </span><span class="o">/</span><span class="n">srv</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">rainloop</span><span class="o">/</span><span class="p">;</span>

<span class="w">    </span><span class="c1"># serve static files</span>
<span class="w">    </span><span class="n">location</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="o">^/</span><span class="p">(</span><span class="n">images</span><span class="o">|</span><span class="n">javascript</span><span class="o">|</span><span class="n">js</span><span class="o">|</span><span class="n">css</span><span class="o">|</span><span class="n">flash</span><span class="o">|</span><span class="n">media</span><span class="o">|</span><span class="k">static</span><span class="p">)</span><span class="o">/</span><span class="w">  </span><span class="p">{</span>
<span class="w">        </span><span class="n">root</span><span class="w">    </span><span class="o">/</span><span class="n">srv</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">rainloop</span><span class="o">/</span><span class="p">;</span>
<span class="w">        </span><span class="n">expires</span><span class="w"> </span><span class="mi">30</span><span class="n">d</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">location</span><span class="w"> </span><span class="o">^~</span><span class="w"> </span><span class="o">/</span><span class="n">data</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">deny</span><span class="w"> </span><span class="n">all</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">location</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">index</span><span class="w"> </span><span class="n">index</span><span class="o">.</span><span class="n">html</span><span class="w"> </span><span class="n">index</span><span class="o">.</span><span class="n">htm</span><span class="w"> </span><span class="n">index</span><span class="o">.</span><span class="n">php</span><span class="p">;</span>
<span class="w">        </span><span class="n">autoindex</span><span class="w"> </span><span class="n">on</span><span class="p">;</span>
<span class="w">        </span><span class="n">autoindex_exact_size</span><span class="w"> </span><span class="n">off</span><span class="p">;</span>
<span class="w">        </span><span class="n">autoindex_localtime</span><span class="w"> </span><span class="n">on</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">location</span><span class="w"> </span><span class="o">~</span><span class="w"> </span>\<span class="o">.</span><span class="n">php</span><span class="o">$</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">#fastcgi_pass 127.0.0.1:9000; (depending on your php-fpm socket configuration)</span>
<span class="w">        </span><span class="n">fastcgi_pass</span><span class="w"> </span><span class="n">unix</span><span class="p">:</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">php</span><span class="o">-</span><span class="n">fpm</span><span class="o">/</span><span class="n">php</span><span class="o">-</span><span class="n">fpm</span><span class="o">.</span><span class="n">sock</span><span class="p">;</span>
<span class="w">        </span><span class="n">fastcgi_index</span><span class="w"> </span><span class="n">index</span><span class="o">.</span><span class="n">php</span><span class="p">;</span>
<span class="w">        </span><span class="n">include</span><span class="w"> </span><span class="n">fastcgi</span><span class="o">.</span><span class="n">conf</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w"> </span><span class="p">}</span>
</code></pre></div>

<p>接下来将会自动生成<strong>Certificate</strong>和<strong>Keys</strong>文件，然后在文件中叫<strong>Common Name*的证书里中添加您的虚拟域名（</strong> rainloop.lan**）。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>nginx_gen_ssl.sh
</code></pre></div>

<p><img alt="" src="/data/attachment/album/201406/20/104920z0ytazvy30fupav5.jpg"></p>
<p><em>生成证书和密钥</em></p>
<p>生成证书和SSL密钥后，创建Rainloop Web服务器<strong>根</strong>的文件路径（Rainloop PHP文件所在的位置），然后启用虚拟主机，并重新启动Nginx的守护进程，应用配置。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>mkdir<span class="w"> </span>-p<span class="w"> </span>/srv/www/rainloop
$<span class="w"> </span>sudo<span class="w"> </span>n2ensite<span class="w"> </span>rainloop
$<span class="w"> </span>sudo<span class="w"> </span>n2ensite<span class="w"> </span>rainloop-ssl
$<span class="w"> </span>sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>nginx
</code></pre></div>

<p><img alt="Create RainLoop Web Director" src="/data/attachment/album/201406/20/104923suh26uchlsus9g00.jpg"></p>
<p><em>创建RainLoop 网页向导</em></p>
<h4>Apache 虚拟主机</h4>
<p>在<strong>/etc/httpd/conf/sites-available/</strong>中创建 <strong>rainloop.conf</strong>文件：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>nano<span class="w"> </span>/etc/httpd/conf/sites-available/rainloop.conf
</code></pre></div>

<p>添加如下内容：</p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;VirtualHost</span><span class="w"> </span><span class="err">*:80</span><span class="nt">&gt;</span>
<span class="w">    </span>ServerName<span class="w"> </span>rainloop.lan
<span class="w">    </span>DocumentRoot<span class="w"> </span>&quot;/srv/www/rainloop/&quot;
<span class="w">    </span>ServerAdmin<span class="w"> </span>you@example.com
<span class="w">    </span>ErrorLog<span class="w"> </span>&quot;/var/log/httpd/rainloop-error_log&quot;
<span class="w">    </span>TransferLog<span class="w"> </span>&quot;/var/log/httpd/rainloop-access_log&quot;
<span class="w">    </span><span class="nt">&lt;Directory</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span>Options<span class="w"> </span>+Indexes<span class="w"> </span>+FollowSymLinks<span class="w"> </span>+ExecCGI
<span class="w">        </span>AllowOverride<span class="w"> </span>All
<span class="w">        </span>Order<span class="w"> </span>deny,allow
<span class="w">        </span>Allow<span class="w"> </span>from<span class="w"> </span>all
<span class="w">        </span>Require<span class="w"> </span>all<span class="w"> </span>granted
<span class="w">    </span><span class="nt">&lt;/Directory&gt;</span>
<span class="nt">&lt;/VirtualHost&gt;</span>
</code></pre></div>

<p><img alt="Create Apache Virtual Host" src="/data/attachment/album/201406/20/104925z3n2cc13511m1mwc.jpg"></p>
<p><em>创建Apache虚拟主机</em></p>
<p>为Apache添加SSL支持：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>nano<span class="w"> </span>/etc/httpd/conf/sites-available/rainloop-ssl.conf
</code></pre></div>

<p>添加如下文件内容：</p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;VirtualHost</span><span class="w"> </span><span class="err">*:443</span><span class="nt">&gt;</span>
<span class="w">    </span>ServerName<span class="w"> </span>rainloop.lan
<span class="w">    </span>DocumentRoot<span class="w"> </span>&quot;/srv/www/rainloop/&quot;
<span class="w">    </span>ServerAdmin<span class="w"> </span>you@example.com
<span class="w">    </span>ErrorLog<span class="w"> </span>&quot;/var/log/httpd/rainloop-ssl-error_log&quot;
<span class="w">    </span>TransferLog<span class="w"> </span>&quot;/var/log/httpd/rainloop-ssl-access_log&quot;

<span class="w">    </span>SSLEngine<span class="w"> </span>on
<span class="w">    </span>SSLCertificateFile<span class="w"> </span>&quot;/etc/httpd/conf/ssl/rainloop.lan.crt&quot;
<span class="w">    </span>SSLCertificateKeyFile<span class="w"> </span>&quot;/etc/httpd/conf/ssl/rainloop.lan.key&quot;

<span class="w">    </span><span class="nt">&lt;FilesMatch</span><span class="w"> </span><span class="err">&quot;\.(cgi|shtml|phtml|php)$&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>SSLOptions<span class="w"> </span>+StdEnvVars
<span class="w">    </span><span class="nt">&lt;/FilesMatch&gt;</span>

<span class="w">    </span>BrowserMatch<span class="w"> </span>&quot;MSIE<span class="w"> </span>[2-5]&quot;<span class="w"> </span>\
<span class="w">        </span>nokeepalive<span class="w"> </span>ssl-unclean-shutdown<span class="w"> </span>\
<span class="w">        </span>downgrade-1.0<span class="w"> </span>force-response-1.0

<span class="w">    </span>CustomLog<span class="w"> </span>&quot;/var/log/httpd/ssl_request_log&quot;<span class="w"> </span>\
<span class="w">        </span>&quot;%t<span class="w"> </span>%h<span class="w"> </span>%{SSL_PROTOCOL}x<span class="w"> </span>%{SSL_CIPHER}x<span class="w"> </span>\&quot;%r\&quot;<span class="w"> </span>%b&quot;

<span class="w">    </span><span class="nt">&lt;Directory</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span>Options<span class="w"> </span>+Indexes<span class="w"> </span>+FollowSymLinks<span class="w"> </span>+ExecCGI
<span class="w">        </span>AllowOverride<span class="w"> </span>All
<span class="w">        </span>Order<span class="w"> </span>deny,allow
<span class="w">        </span>Allow<span class="w"> </span>from<span class="w"> </span>all
<span class="w">        </span>Require<span class="w"> </span>all<span class="w"> </span>granted
<span class="w">    </span><span class="nt">&lt;/Directory&gt;</span>
<span class="nt">&lt;/VirtualHost&gt;</span>
</code></pre></div>

<p>接下来将会自动生成<strong>Certificate</strong>和<strong>Keys</strong>文件，然后在文件中叫<strong>Common Name*的证书里中添加您的虚拟域名（</strong> rainloop.lan**）。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>apache_gen_ssl
</code></pre></div>

<p><img alt="Create SSL Certificate and Keys" src="/data/attachment/album/201406/20/104927cz22v4yc2zbt27bb.jpg"></p>
<p><em>创建SSL证书和密钥</em></p>
<p><img alt="Enter Organization Details" src="/data/attachment/album/201406/20/104930ni2q6kkk3tfq81tq.jpg"></p>
<p><em>输入组织信息</em></p>
<p>After the Certificate and SSL keys are created, add Rainloop <strong>DocumentRoot</strong> path, then enable Virtual Hosts and restart Apache daemon to apply configurations. 在证书和密钥建立之后，创建 RainLoop 的 <strong>DocumentRoot</strong> 所指向的目录，之后激活虚拟主机，并且重启Apache应用设置。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>mkdir<span class="w"> </span>-p<span class="w"> </span>/srv/www/rainloop
$<span class="w"> </span>sudo<span class="w"> </span>a2ensite<span class="w"> </span>rainloop
$<span class="w"> </span>sudo<span class="w"> </span>a2ensite<span class="w"> </span>rainloop-ssl
$<span class="w"> </span>sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>httpd
</code></pre></div>

<p><img alt="Enable Virtual Hosts" src="/data/attachment/album/201406/20/104932kjqel0qlevjefw4w.jpg"></p>
<p><em>激活虚拟主机</em></p>
<h3>Step 2: 添加必要的PHP支持</h3>
<p><strong>3.</strong> 无论您使用的是<strong>Apache</strong>或<strong>Nginx</strong>Web服务器，您需要激活<strong>php.ini</strong>文件下中的PHP扩展，并将新服务器的<strong>DocumentRoot</strong>目录放到 open_basedir 配置中。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>nano<span class="w"> </span>/etc/php/php.ini
</code></pre></div>

<p>找到并且取消如下的PHP扩展的注释（LCTT译注，即启用这些模块）：</p>
<div class="highlight"><pre><span></span><code>extension=iconv.so
extension=imap.so
extension=mcrypt.so
extension=mssql.so
extension=mysqli.so
extension=openssl.so ( 注：启用 IMAPS 和 SMTP SSL protocols)
extension=pdo_mysql.so
</code></pre></div>

<p>open_basedir语句应该看起来类似如下：</p>
<div class="highlight"><pre><span></span><code>open_basedir = /srv/http/:/home/:/tmp/:/usr/share/pear/:/usr/share/webapps/:/etc/webapps/:/srv/www/
</code></pre></div>

<p><strong>4.</strong> 在修改好<strong>php.ini</strong>之后，重启你的服务器，然后检查 <strong>phpinfo()</strong> 输出，去看看<strong>SSL</strong>协议是否已经激活。</p>
<div class="highlight"><pre><span></span><code>----------对于 Apache Web 服务器----------
$ sudo systemctl restart httpd
</code></pre></div>

<p>via: <a href="http://www.tecmint.com/install-rainloop-webmail-in-arch-linux/">http://www.tecmint.com/install-rainloop-webmail-in-arch-linux/</a></p>
<p>译者：<a href="https://github.com/MikeCoder">MikeCoder</a> 校对：<a href="https://github.com/wxy">wxy</a></p>
<p>本文由 <a href="https://github.com/LCTT/TranslateProject">LCTT</a> 原创翻译，<a href="http://linux.cn/">Linux中国</a> 荣誉推出</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>