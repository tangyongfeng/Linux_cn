<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>Linux script命令 —— 终端里的记录器</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: '' 当你在终端或者控制台工作时，你可能想要记录在终端中所做的一切。这些记录可以用来当作史料，保存终端所发生的 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li class="active"><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2014/06/linux-scriptming-ling-zhong-duan-li-de-ji-lu-qi.html" rel="bookmark"
           title="Permalink to Linux script命令 —— 终端里的记录器">Linux script命令 —— 终端里的记录器</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2014-06-14T23:33:00+02:00">
                Published: Sat 14 June 2014
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/xi-tong-yun-wei">系统运维</a>.</p>

</footer><!-- /.post-info -->      <p>Author: ''</p>
<p>当你在终端或者控制台工作时，你可能想要记录在终端中所做的一切。这些记录可以用来当作史料，保存终端所发生的一切。比如说，你和一些Linux管理员们同时管理着相同的机器，或者你让某人远程登陆到了你的服务器上，你可能记录想要终端里发生的一切。要实现这个目标，你可以使用script命令。</p>
<p><img alt="" src="/data/attachment/album/201406/14/233330ysxa1afoddk1avcd.png"></p>
<h3>script是什么</h3>
<p>scirpt就是一个命令，可以制作一份记录输出到终端的记录。对于那些想要真实记录终端会话的人来说，这很有用。该记录可以保存并在以后再打印出来。</p>
<h3>怎么用</h3>
<p>默认情况下，我们可以通过在终端中输入script来启动scirpt命令。</p>
<div class="highlight"><pre><span></span><code><span class="nx">pungki</span><span class="err">@</span><span class="nx">dev</span><span class="o">-</span><span class="nx">machine</span><span class="p">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="nx">script</span>
<span class="nx">Script</span><span class="w"> </span><span class="nx">started</span><span class="p">,</span><span class="w"> </span><span class="nx">file</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">typescript</span>
<span class="nx">pungki</span><span class="err">@</span><span class="nx">dev</span><span class="o">-</span><span class="nx">machine</span><span class="p">:</span><span class="o">~</span><span class="err">$</span>
</code></pre></div>

<p>你也可以指定目标文件名来记录打印结果。</p>
<div class="highlight"><pre><span></span><code><span class="n">pungki</span><span class="nv">@dev</span><span class="o">-</span><span class="nl">machine</span><span class="p">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">myfile</span>
</code></pre></div>

<p><img alt="Define script file" src="/data/attachment/album/201406/14/233332uiteyu8axeeuyuen.png"></p>
<p>当你再次见到命令提示符，这意味着终端将记录打印到终端的任何东西。</p>
<p>你会看到当前目录，有个名为myscript的文件。（LCTT译注，此处原文有误。这里指定了记录文件名为myfile，而不是默认的 typescript。）</p>
<h3>为什么我们要用script命令</h3>
<p>因为在之前已经提到过，script命令的主要功能是记录所有的东西。下面给出了两个使用该命令的场景。</p>
<h4>和同事共事时</h4>
<p>当和同事一起工作时，我们可以通过script来记录你的活动。</p>
<p>比如，我们会使用名为<strong>collaborate</strong>的打印文件，来完成打印：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>script<span class="w"> </span>collaborate
</code></pre></div>

<p><img alt="Create collaborate file" src="/data/attachment/album/201406/14/233333fe0svvieszifvxzv.png"></p>
<p>然后，在完成一些任务后，假如你需要把你干的活发给另外一个工程师，那就把那文件发给他。所以当另外一个工程师需要复查所做的事情，他只要用文本编辑器打开这个文件就行了。</p>
<p>如果他想要更新该文件（以增加他的工作部分），可以使用<strong>-a</strong>选项。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>script<span class="w"> </span>-a<span class="w"> </span>collaborate
</code></pre></div>

<p><img alt="Append the file" src="/data/attachment/album/201406/14/233334m3b0vroaa24raj3r.png"></p>
<h4>记录某人在终端中的所作所为</h4>
<p>你可能让你的工程师或者某个人远程访问你的系统，要确保你的工程师正在干正确的事，你可以记录下他在你系统上的所作所为。要让script命令在登录时自动运行，我们可以把它添加进shell环境配置文件中。如果你正在使用<strong>bash</strong> shell，把这一行加进你的bash环境配置文件中。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>vi<span class="w"> </span>~/.profile

<span class="c1"># run the script command to record everything</span>
<span class="c1"># use -q for quite and -a option to append the script</span>
<span class="c1">#</span>
/usr/bin/script<span class="w"> </span>-qa<span class="w"> </span>/usr/local/script/log_record_script
</code></pre></div>

<p><img alt="Add script to bash profile" src="/data/attachment/album/201406/14/233335dakdlmalewvpezdp.png"></p>
<p>然后保存。下次他登录进你的系统时，script命令就会自动运行，并把日志记录进<strong>/usr/local/script/log<em>record</em>script</strong>。</p>
<p><img alt="Script without notification" src="/data/attachment/album/201406/14/233336zlry0wwgynl3wyss.png"></p>
<p><strong>-q</strong>选项可以让scirpt命令以静默模式运行，登录进来的用户不会知道script命令已经运行了。而<strong>-a</strong>选项将会让记录附加到文件中，而不会擦除先前的记录。</p>
<p>如果不使用<strong>-q</strong>选项，那么当用户登录进来时，他会收到像下图中这样的通知。</p>
<p><img alt="Script with notification" src="/data/attachment/album/201406/14/233338h77jeef6v6pjctr9.png"></p>
<h3>退出记录</h3>
<p>要退出记录活动，我们可以在终端中按下<strong>Ctrl+D</strong>，或者输入<strong>exit</strong>。在退出script前，你会发现记录文件的大小为0 Kb，而在退出之后，文件大小会发生改变。</p>
<h3>结尾</h3>
<p>Script命令在你需要记录或者存档终端活动时可能很有用，记录文件会存储为文本文件，所以可以很方便地用文本编辑器打开。跟平常一样，我们都可以通过输入<strong>man script</strong>或者<strong>scirpt -h</strong>来显示帮助页并查看更多详细用法。</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>