<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>Linux 下使用Trickle限制下载/上传带宽</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: '' 你有没有遇到过一个程序占用了你所有的网络带宽的情况？如果你遇到过，那么你就需要限制带宽的应用。不管你是一 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li class="active"><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2013/12/linux-xia-shi-yong-tricklexian-zhi-xia-zai-shang-chuan-dai-kuan.html" rel="bookmark"
           title="Permalink to Linux 下使用Trickle限制下载/上传带宽">Linux 下使用Trickle限制下载/上传带宽</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2013-12-14T20:45:00+01:00">
                Published: Sat 14 December 2013
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/ji-zhu">技术</a>.</p>

</footer><!-- /.post-info -->      <p>Author: ''</p>
<p>你有没有遇到过一个程序占用了你所有的网络带宽的情况？如果你遇到过，那么你就需要限制带宽的应用。不管你是一个系统管理员还是一名普通Linux用户，您都应该学习如何控制应用的上传和下载速度来确保你的网络带宽不会被一个程序耗光。</p>
<p><img alt="" src="/data/attachment/album/201312/14/203954wk23q966o6y293iq.png"></p>
<h3>Trickle 是什么?</h3>
<p><strong>Trickle</strong>是一款带宽控制供给，用来限制如<strong>Firefox, FTP , SSH</strong>以及其他使用网络带宽的程序的带宽。你希望你的<strong>Youtube</strong>音乐体验影响到你的ftp下载么？如果不想，请继续阅读这篇文章，学习如何在你的机器上安装和使用trickle。</p>
<h3>怎样在Linux上安装Trickle</h3>
<p>trickle工具有一些依赖包，安装和使用trickle之前必须安装“<strong>libevent 库</strong>”，不过这个库在大多数现在的Linux机器上已经默认安装。</p>
<h4>在 Debian/Ubuntu/Linux Mint 上</h4>
<p>在<strong>Debian/Ubuntu/Mint</strong> 机器上运行 <strong>apt-get install trickle</strong>进行安装。请确保源列表已经更新，接着安装你想要的应用。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>apt-get<span class="w"> </span>update
$<span class="w"> </span>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>trickle
</code></pre></div>

<h4>在 RHEL/CentOS/Fedora 上</h4>
<p>首先你需要更新系统,然后使用下面的命令安装trickle。</p>
<div class="highlight"><pre><span></span><code># yum update
# yum install trickle
</code></pre></div>

<h3>Trickle如何工作?</h3>
<p>Trickle通过控制socket数据读写量来控制和限制应用的<strong>上传/下载</strong>速度。它使用另一个版本的<strong>BSD</strong>套接字API，但是区别是trickle还管理socket调用。</p>
<p>要注意的是trickle使用动态链接和加载，所以它只对于使用"Glibc库"的程序有用。由于trickle可以设置数据在socket上的传输延迟，所以它可以用来限制一个应用的网络带宽。</p>
<h3>Trickle不能做什么？</h3>
<p>Trickle不能用于限制使用<strong>UDP</strong>协议的应用的带宽，它只可用于<strong>TCP</strong>连接，但是你要知道它也并不是对所有的<strong>TCP</strong>连接有效。如果你一直仔细地看这篇文章，你可以猜到原因是什么。你还记得trickle只对使用<strong>Glibc库</strong>应用有效吧？</p>
<p>还要说一下,trickle无法工作在使用静态链接的可执行程序上。</p>
<h3>确定Trickle是否可运行在某个特定应用上</h3>
<p>既然trickle无法限制每个应用的<strong>上传/下载</strong>速度，就应该有个方法找出trickle可以工作的应用。</p>
<p><strong>ldd</strong>工具可以帮我们找出某个特定的程序是否使用了<strong>libc.so</strong>库。如果程序使用了这个库，就可以使用trickle来限制它的网络带宽使用。</p>
<p><strong>ldd</strong>命令用于打印每个程序需要的共享库。如果你是一个好奇的<strong>Linux Geek</strong>，那么你可以使用man命令来找出关于ldd工具的更多信息。</p>
<div class="highlight"><pre><span></span><code># man ldd
</code></pre></div>

<p><strong>Filezilla</strong>是一款使用ftp协议传输文件的程序，trickle可以用来限制它的下载或者上传速度么？在你考虑的时候，我使用以下的命令来找出trickle是否可用于filezilla。</p>
<div class="highlight"><pre><span></span><code># ldd filezilla | grep libc.so
</code></pre></div>

<p>就我而言，它输出了如下:</p>
<div class="highlight"><pre><span></span><code><span class="n">oltjano</span><span class="nv">@oltjano</span><span class="o">-</span><span class="nl">X55CR</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="err">$</span><span class="w"> </span><span class="n">ldd</span><span class="w"> </span><span class="n">filezilla</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">grep</span><span class="w"> </span><span class="n">libc</span><span class="p">.</span><span class="n">so</span>
<span class="w">    </span><span class="n">libc</span><span class="p">.</span><span class="n">so</span><span class="mf">.6</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">i386</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">gnu</span><span class="o">/</span><span class="n">libc</span><span class="p">.</span><span class="n">so</span><span class="mf">.6</span><span class="w"> </span><span class="p">(</span><span class="mh">0xb6bc4000</span><span class="p">)</span>
</code></pre></div>

<p>既然filezilla使用了“<strong>libc.so</strong>”库，那么trickle可以用来限制它的网络带宽。这个方法可以用在任何你感兴趣的程序上。</p>
<h3>学习如何使用Trickle</h3>
<p>使用下面的命令输出trickle工具的<strong>版本</strong>。</p>
<div class="highlight"><pre><span></span><code><span class="n">root</span><span class="nv">@oltjano</span><span class="o">-</span><span class="nl">X55CR</span><span class="p">:</span><span class="o">~</span><span class="err">#</span><span class="w"> </span><span class="n">trickle</span><span class="w"> </span><span class="o">-</span><span class="n">V</span>
<span class="nl">trickle</span><span class="p">:</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.07</span>
</code></pre></div>

<p>Linux有很多命令行工具使测试(实验)变得有趣和美丽。下面的命令使用<a href="http://www.tecmint.com/10-wget-command-examples-in-linux/">wget 工具</a>来下载最新的Pear OS镜像.</p>
<div class="highlight"><pre><span></span><code><span class="n">root</span><span class="nv">@oltjano</span><span class="o">-</span><span class="nl">X55CR</span><span class="p">:</span><span class="o">~</span><span class="err">#</span><span class="w"> </span><span class="n">wget</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="n">sourceforge</span><span class="p">.</span><span class="n">net</span><span class="o">/</span><span class="n">projects</span><span class="o">/</span><span class="n">pearoslinux</span><span class="o">/</span><span class="n">files</span><span class="o">/</span><span class="n">Pear</span><span class="o">%</span><span class="mi">20</span><span class="n">OS</span><span class="o">%</span><span class="mi">208</span><span class="o">/</span><span class="n">pearos8</span><span class="o">-</span><span class="n">i386</span><span class="p">.</span><span class="n">iso</span><span class="o">/</span><span class="n">download</span>

<span class="o">--</span><span class="mi">2013</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">20</span><span class="w"> </span><span class="mi">11</span><span class="err">:</span><span class="mi">56</span><span class="err">:</span><span class="mi">32</span><span class="o">--</span><span class="w">  </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="n">sourceforge</span><span class="p">.</span><span class="n">net</span><span class="o">/</span><span class="n">projects</span><span class="o">/</span><span class="n">pearoslinux</span><span class="o">/</span><span class="n">files</span><span class="o">/</span><span class="n">Pear</span><span class="o">%</span><span class="mi">20</span><span class="n">OS</span><span class="o">%</span><span class="mi">208</span><span class="o">/</span><span class="n">pearos8</span><span class="o">-</span><span class="n">i386</span><span class="p">.</span><span class="n">iso</span><span class="o">/</span><span class="n">download</span>
<span class="n">Resolving</span><span class="w"> </span><span class="n">sourceforge</span><span class="p">.</span><span class="n">net</span><span class="w"> </span><span class="p">(</span><span class="n">sourceforge</span><span class="p">.</span><span class="n">net</span><span class="p">)...</span><span class="w"> </span><span class="mf">216.34.181.60</span>
<span class="n">Connecting</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">sourceforge</span><span class="p">.</span><span class="n">net</span><span class="w"> </span><span class="p">(</span><span class="n">sourceforge</span><span class="p">.</span><span class="n">net</span><span class="p">)</span><span class="o">|</span><span class="mf">216.34.181.60</span><span class="o">|</span><span class="err">:</span><span class="mf">80.</span><span class="p">..</span><span class="w"> </span><span class="n">connected</span><span class="p">.</span>
<span class="n">HTTP</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="n">sent</span><span class="p">,</span><span class="w"> </span><span class="n">awaiting</span><span class="w"> </span><span class="n">response</span><span class="p">...</span><span class="w"> </span><span class="mi">302</span><span class="w"> </span><span class="k">Found</span>
<span class="nl">Location</span><span class="p">:</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="n">downloads</span><span class="p">.</span><span class="n">sourceforge</span><span class="p">.</span><span class="n">net</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">pearoslinux</span><span class="o">/</span><span class="n">Pear</span><span class="o">%</span><span class="mi">20</span><span class="n">OS</span><span class="o">%</span><span class="mi">208</span><span class="o">/</span><span class="n">pearos8</span><span class="o">-</span><span class="n">i386</span><span class="p">.</span><span class="n">iso</span><span class="vm">?</span><span class="n">r</span><span class="o">=&amp;</span><span class="n">ts</span><span class="o">=</span><span class="mi">1384928843</span><span class="o">&amp;</span><span class="n">use_mirror</span><span class="o">=</span><span class="n">kaz</span><span class="w"> </span><span class="o">[</span><span class="n">following</span><span class="o">]</span>
<span class="o">--</span><span class="mi">2013</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">20</span><span class="w"> </span><span class="mi">11</span><span class="err">:</span><span class="mi">56</span><span class="err">:</span><span class="mi">33</span><span class="o">--</span><span class="w">  </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="n">downloads</span><span class="p">.</span><span class="n">sourceforge</span><span class="p">.</span><span class="n">net</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">pearoslinux</span><span class="o">/</span><span class="n">Pear</span><span class="o">%</span><span class="mi">20</span><span class="n">OS</span><span class="o">%</span><span class="mi">208</span><span class="o">/</span><span class="n">pearos8</span><span class="o">-</span><span class="n">i386</span><span class="p">.</span><span class="n">iso</span><span class="vm">?</span><span class="n">r</span><span class="o">=&amp;</span><span class="n">ts</span><span class="o">=</span><span class="mi">1384928843</span><span class="o">&amp;</span><span class="n">use_mirror</span><span class="o">=</span><span class="n">kaz</span>
<span class="n">Resolving</span><span class="w"> </span><span class="n">downloads</span><span class="p">.</span><span class="n">sourceforge</span><span class="p">.</span><span class="n">net</span><span class="w"> </span><span class="p">(</span><span class="n">downloads</span><span class="p">.</span><span class="n">sourceforge</span><span class="p">.</span><span class="n">net</span><span class="p">)...</span><span class="w"> </span><span class="mf">216.34.181.59</span>
<span class="n">Connecting</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">downloads</span><span class="p">.</span><span class="n">sourceforge</span><span class="p">.</span><span class="n">net</span><span class="w"> </span><span class="p">(</span><span class="n">downloads</span><span class="p">.</span><span class="n">sourceforge</span><span class="p">.</span><span class="n">net</span><span class="p">)</span><span class="o">|</span><span class="mf">216.34.181.59</span><span class="o">|</span><span class="err">:</span><span class="mf">80.</span><span class="p">..</span><span class="w"> </span><span class="n">connected</span><span class="p">.</span>
<span class="n">HTTP</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="n">sent</span><span class="p">,</span><span class="w"> </span><span class="n">awaiting</span><span class="w"> </span><span class="n">response</span><span class="p">...</span><span class="w"> </span><span class="mi">302</span><span class="w"> </span><span class="k">Found</span>
<span class="nl">Location</span><span class="p">:</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="n">kaz</span><span class="p">.</span><span class="n">dl</span><span class="p">.</span><span class="n">sourceforge</span><span class="p">.</span><span class="n">net</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">pearoslinux</span><span class="o">/</span><span class="n">Pear</span><span class="o">%</span><span class="mi">20</span><span class="n">OS</span><span class="o">%</span><span class="mi">208</span><span class="o">/</span><span class="n">pearos8</span><span class="o">-</span><span class="n">i386</span><span class="p">.</span><span class="n">iso</span><span class="w"> </span><span class="o">[</span><span class="n">following</span><span class="o">]</span>
<span class="o">--</span><span class="mi">2013</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">20</span><span class="w"> </span><span class="mi">11</span><span class="err">:</span><span class="mi">56</span><span class="err">:</span><span class="mi">33</span><span class="o">--</span><span class="w">  </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="n">kaz</span><span class="p">.</span><span class="n">dl</span><span class="p">.</span><span class="n">sourceforge</span><span class="p">.</span><span class="n">net</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">pearoslinux</span><span class="o">/</span><span class="n">Pear</span><span class="o">%</span><span class="mi">20</span><span class="n">OS</span><span class="o">%</span><span class="mi">208</span><span class="o">/</span><span class="n">pearos8</span><span class="o">-</span><span class="n">i386</span><span class="p">.</span><span class="n">iso</span>
<span class="n">Resolving</span><span class="w"> </span><span class="n">kaz</span><span class="p">.</span><span class="n">dl</span><span class="p">.</span><span class="n">sourceforge</span><span class="p">.</span><span class="n">net</span><span class="w"> </span><span class="p">(</span><span class="n">kaz</span><span class="p">.</span><span class="n">dl</span><span class="p">.</span><span class="n">sourceforge</span><span class="p">.</span><span class="n">net</span><span class="p">)...</span><span class="w"> </span><span class="mf">88.204.157.163</span>
<span class="n">Connecting</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">kaz</span><span class="p">.</span><span class="n">dl</span><span class="p">.</span><span class="n">sourceforge</span><span class="p">.</span><span class="n">net</span><span class="w"> </span><span class="p">(</span><span class="n">kaz</span><span class="p">.</span><span class="n">dl</span><span class="p">.</span><span class="n">sourceforge</span><span class="p">.</span><span class="n">net</span><span class="p">)</span><span class="o">|</span><span class="mf">88.204.157.163</span><span class="o">|</span><span class="err">:</span><span class="mf">80.</span><span class="p">..</span><span class="w"> </span><span class="n">connected</span><span class="p">.</span>
<span class="n">HTTP</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="n">sent</span><span class="p">,</span><span class="w"> </span><span class="n">awaiting</span><span class="w"> </span><span class="n">response</span><span class="p">...</span><span class="w"> </span><span class="mi">200</span><span class="w"> </span><span class="n">OK</span>
<span class="nl">Length</span><span class="p">:</span><span class="w"> </span><span class="mi">1093664768</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="n">G</span><span class="p">)</span><span class="w"> </span><span class="o">[</span><span class="n">application/octet-stream</span><span class="o">]</span>
<span class="n">Saving</span><span class="w"> </span><span class="k">to</span><span class="err">:</span><span class="w"> </span><span class="err">‘</span><span class="n">download</span><span class="err">’</span>

<span class="mi">0</span><span class="o">%</span><span class="w"> </span><span class="o">[</span><span class="n">                                                                                                    </span><span class="o">]</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="mi">78</span><span class="p">,</span><span class="mi">278</span><span class="w">    </span><span class="mi">381</span><span class="n">KB</span><span class="o">/</span><span class="n">s</span><span class="w">  </span><span class="n">eta</span><span class="w"> </span><span class="mi">1</span><span class="n">h</span><span class="w"> </span><span class="mi">50</span><span class="n">m</span>
</code></pre></div>

<p>从输出可以看到，下载速度大约是<strong>381 KB/s</strong>。我想限制下载速度到<strong>13 K/s</strong>，这样我就可以用我的带宽做其他的事情了。下面的命令用来限制wget速度到<strong>13 K/s</strong>。</p>
<div class="highlight"><pre><span></span><code><span class="n">ravisaive</span><span class="nv">@ravisaive</span><span class="o">-</span><span class="n">OptiPlex</span><span class="o">-</span><span class="mi">380</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">trickle</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="mi">13</span><span class="w"> </span><span class="n">wget</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="n">sourceforge</span><span class="p">.</span><span class="n">net</span><span class="o">/</span><span class="n">projects</span><span class="o">/</span><span class="n">pearoslinux</span><span class="o">/</span><span class="n">files</span><span class="o">/</span><span class="n">Pear</span><span class="o">%</span><span class="mi">20</span><span class="n">OS</span><span class="o">%</span><span class="mi">208</span><span class="o">/</span><span class="n">pearos8</span><span class="o">-</span><span class="n">i386</span><span class="p">.</span><span class="n">iso</span><span class="o">/</span><span class="n">download</span>

<span class="o">--</span><span class="mi">2013</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">20</span><span class="w"> </span><span class="mi">12</span><span class="err">:</span><span class="mi">01</span><span class="err">:</span><span class="mi">19</span><span class="o">--</span><span class="w">  </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="n">sourceforge</span><span class="p">.</span><span class="n">net</span><span class="o">/</span><span class="n">projects</span><span class="o">/</span><span class="n">pearoslinux</span><span class="o">/</span><span class="n">files</span><span class="o">/</span><span class="n">Pear</span><span class="o">%</span><span class="mi">20</span><span class="n">OS</span><span class="o">%</span><span class="mi">208</span><span class="o">/</span><span class="n">pearos8</span><span class="o">-</span><span class="n">i386</span><span class="p">.</span><span class="n">iso</span><span class="o">/</span><span class="n">download</span>
<span class="n">Resolving</span><span class="w"> </span><span class="n">sourceforge</span><span class="p">.</span><span class="n">net</span><span class="w"> </span><span class="p">(</span><span class="n">sourceforge</span><span class="p">.</span><span class="n">net</span><span class="p">)...</span><span class="w"> </span><span class="mf">216.34.181.60</span>
<span class="n">Connecting</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">sourceforge</span><span class="p">.</span><span class="n">net</span><span class="w"> </span><span class="p">(</span><span class="n">sourceforge</span><span class="p">.</span><span class="n">net</span><span class="p">)</span><span class="o">|</span><span class="mf">216.34.181.60</span><span class="o">|</span><span class="err">:</span><span class="mf">80.</span><span class="p">..</span><span class="w"> </span><span class="n">connected</span><span class="p">.</span>
<span class="n">HTTP</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="n">sent</span><span class="p">,</span><span class="w"> </span><span class="n">awaiting</span><span class="w"> </span><span class="n">response</span><span class="p">...</span><span class="w"> </span><span class="mi">302</span><span class="w"> </span><span class="k">Found</span>
<span class="nl">Location</span><span class="p">:</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="n">downloads</span><span class="p">.</span><span class="n">sourceforge</span><span class="p">.</span><span class="n">net</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">pearoslinux</span><span class="o">/</span><span class="n">Pear</span><span class="o">%</span><span class="mi">20</span><span class="n">OS</span><span class="o">%</span><span class="mi">208</span><span class="o">/</span><span class="n">pearos8</span><span class="o">-</span><span class="n">i386</span><span class="p">.</span><span class="n">iso</span><span class="vm">?</span><span class="n">r</span><span class="o">=&amp;</span><span class="n">ts</span><span class="o">=</span><span class="mi">1384929129</span><span class="o">&amp;</span><span class="n">use_mirror</span><span class="o">=</span><span class="n">kaz</span><span class="w"> </span><span class="o">[</span><span class="n">following</span><span class="o">]</span>
<span class="o">--</span><span class="mi">2013</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">20</span><span class="w"> </span><span class="mi">12</span><span class="err">:</span><span class="mi">01</span><span class="err">:</span><span class="mi">19</span><span class="o">--</span><span class="w">  </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="n">downloads</span><span class="p">.</span><span class="n">sourceforge</span><span class="p">.</span><span class="n">net</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">pearoslinux</span><span class="o">/</span><span class="n">Pear</span><span class="o">%</span><span class="mi">20</span><span class="n">OS</span><span class="o">%</span><span class="mi">208</span><span class="o">/</span><span class="n">pearos8</span><span class="o">-</span><span class="n">i386</span><span class="p">.</span><span class="n">iso</span><span class="vm">?</span><span class="n">r</span><span class="o">=&amp;</span><span class="n">ts</span><span class="o">=</span><span class="mi">1384929129</span><span class="o">&amp;</span><span class="n">use_mirror</span><span class="o">=</span><span class="n">kaz</span>
<span class="n">Resolving</span><span class="w"> </span><span class="n">downloads</span><span class="p">.</span><span class="n">sourceforge</span><span class="p">.</span><span class="n">net</span><span class="w"> </span><span class="p">(</span><span class="n">downloads</span><span class="p">.</span><span class="n">sourceforge</span><span class="p">.</span><span class="n">net</span><span class="p">)...</span><span class="w"> </span><span class="mf">216.34.181.59</span>
<span class="n">Connecting</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">downloads</span><span class="p">.</span><span class="n">sourceforge</span><span class="p">.</span><span class="n">net</span><span class="w"> </span><span class="p">(</span><span class="n">downloads</span><span class="p">.</span><span class="n">sourceforge</span><span class="p">.</span><span class="n">net</span><span class="p">)</span><span class="o">|</span><span class="mf">216.34.181.59</span><span class="o">|</span><span class="err">:</span><span class="mf">80.</span><span class="p">..</span><span class="w"> </span><span class="n">connected</span><span class="p">.</span>
<span class="n">HTTP</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="n">sent</span><span class="p">,</span><span class="w"> </span><span class="n">awaiting</span><span class="w"> </span><span class="n">response</span><span class="p">...</span><span class="w"> </span><span class="mi">302</span><span class="w"> </span><span class="k">Found</span>
<span class="nl">Location</span><span class="p">:</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="n">kaz</span><span class="p">.</span><span class="n">dl</span><span class="p">.</span><span class="n">sourceforge</span><span class="p">.</span><span class="n">net</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">pearoslinux</span><span class="o">/</span><span class="n">Pear</span><span class="o">%</span><span class="mi">20</span><span class="n">OS</span><span class="o">%</span><span class="mi">208</span><span class="o">/</span><span class="n">pearos8</span><span class="o">-</span><span class="n">i386</span><span class="p">.</span><span class="n">iso</span><span class="w"> </span><span class="o">[</span><span class="n">following</span><span class="o">]</span>
<span class="o">--</span><span class="mi">2013</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">20</span><span class="w"> </span><span class="mi">12</span><span class="err">:</span><span class="mi">01</span><span class="err">:</span><span class="mi">20</span><span class="o">--</span><span class="w">  </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="n">kaz</span><span class="p">.</span><span class="n">dl</span><span class="p">.</span><span class="n">sourceforge</span><span class="p">.</span><span class="n">net</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">pearoslinux</span><span class="o">/</span><span class="n">Pear</span><span class="o">%</span><span class="mi">20</span><span class="n">OS</span><span class="o">%</span><span class="mi">208</span><span class="o">/</span><span class="n">pearos8</span><span class="o">-</span><span class="n">i386</span><span class="p">.</span><span class="n">iso</span>
<span class="n">Resolving</span><span class="w"> </span><span class="n">kaz</span><span class="p">.</span><span class="n">dl</span><span class="p">.</span><span class="n">sourceforge</span><span class="p">.</span><span class="n">net</span><span class="w"> </span><span class="p">(</span><span class="n">kaz</span><span class="p">.</span><span class="n">dl</span><span class="p">.</span><span class="n">sourceforge</span><span class="p">.</span><span class="n">net</span><span class="p">)...</span><span class="w"> </span><span class="mf">88.204.157.163</span>
<span class="n">Connecting</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">kaz</span><span class="p">.</span><span class="n">dl</span><span class="p">.</span><span class="n">sourceforge</span><span class="p">.</span><span class="n">net</span><span class="w"> </span><span class="p">(</span><span class="n">kaz</span><span class="p">.</span><span class="n">dl</span><span class="p">.</span><span class="n">sourceforge</span><span class="p">.</span><span class="n">net</span><span class="p">)</span><span class="o">|</span><span class="mf">88.204.157.163</span><span class="o">|</span><span class="err">:</span><span class="mf">80.</span><span class="p">..</span><span class="w"> </span><span class="n">connected</span><span class="p">.</span>
<span class="n">HTTP</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="n">sent</span><span class="p">,</span><span class="w"> </span><span class="n">awaiting</span><span class="w"> </span><span class="n">response</span><span class="p">...</span><span class="w"> </span><span class="mi">200</span><span class="w"> </span><span class="n">OK</span>
<span class="nl">Length</span><span class="p">:</span><span class="w"> </span><span class="mi">1093664768</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0</span><span class="n">G</span><span class="p">)</span><span class="w"> </span><span class="o">[</span><span class="n">application/octet-stream</span><span class="o">]</span>
<span class="n">Saving</span><span class="w"> </span><span class="k">to</span><span class="err">:</span><span class="w"> </span><span class="err">‘</span><span class="n">download</span><span class="mf">.1</span><span class="err">’</span>

<span class="mi">0</span><span class="o">%</span><span class="w"> </span><span class="o">[</span><span class="n">                                                                                                   </span><span class="o">]</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="mi">01</span><span class="p">,</span><span class="mi">550</span><span class="w">    </span><span class="mf">13.1</span><span class="n">KB</span><span class="o">/</span><span class="n">s</span><span class="w">  </span><span class="n">eta</span><span class="w"> </span><span class="mi">21</span><span class="n">h</span><span class="w"> </span><span class="mi">5</span><span class="n">m</span>
</code></pre></div>

<p>从输出可以看到，下载速度被限制到了<strong>13K/s</strong>。下载将会持续<strong>21小时5分钟</strong>。上面的“<strong>-d</strong>”选项表示下载，还可以结合使用 “<strong>-d</strong>”选项和上传选项(<strong>-u</strong>)，如下例所示。</p>
<div class="highlight"><pre><span></span><code># trickle -u 100 -d 50 ftp
</code></pre></div>

<p>上面的命令限制<strong>ftp 客户端</strong>的上传速度为<strong>100K/s</strong>，下载速度为<strong>50K/s</strong>。还可以使用下面的命令,限制在一个shell里运行的所有命令的带宽。</p>
<div class="highlight"><pre><span></span><code>trickle -d 130 -u 13 bash
</code></pre></div>

<p>每个命令行工具都对用户提供了帮助，使用"trickle -h"命令来找出更多trickle工具的用法。</p>
<div class="highlight"><pre><span></span><code><span class="n">root</span><span class="err">@</span><span class="n">oltjano</span><span class="o">-</span><span class="n">X55CR</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="c1"># trickle -h</span>

<span class="n">Usage</span><span class="p">:</span><span class="w"> </span><span class="n">trickle</span><span class="w"> </span><span class="p">[</span><span class="o">-</span><span class="n">hvVs</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="o">-</span><span class="n">w</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="p">]</span>
<span class="w">               </span><span class="p">[</span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="o">-</span><span class="n">n</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="o">...</span>
<span class="w">    </span><span class="o">-</span><span class="n">h</span><span class="w"> </span><span class="n">Help</span><span class="w"> </span><span class="p">(</span><span class="n">this</span><span class="p">)</span>
<span class="w">    </span><span class="o">-</span><span class="n">v</span><span class="w"> </span><span class="n">Increase</span><span class="w"> </span><span class="n">verbosity</span><span class="w"> </span><span class="n">level</span>
<span class="w">    </span><span class="o">-</span><span class="n">V</span><span class="w"> </span><span class="n">Print</span><span class="w"> </span><span class="n">trickle</span><span class="w"> </span><span class="n">version</span>
<span class="w">    </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="n">Run</span><span class="w"> </span><span class="n">trickle</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">standalone</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">independent</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">trickled</span>
<span class="w">    </span><span class="o">-</span><span class="n">d</span><span class="w">     </span><span class="n">Set</span><span class="w"> </span><span class="n">maximum</span><span class="w"> </span><span class="n">cumulative</span><span class="w"> </span><span class="n">download</span><span class="w"> </span><span class="n">rate</span><span class="w"> </span><span class="n">to</span><span class="w">  </span><span class="n">KB</span><span class="o">/</span><span class="n">s</span>
<span class="w">    </span><span class="o">-</span><span class="n">u</span><span class="w">     </span><span class="n">Set</span><span class="w"> </span><span class="n">maximum</span><span class="w"> </span><span class="n">cumulative</span><span class="w"> </span><span class="n">upload</span><span class="w"> </span><span class="n">rate</span><span class="w"> </span><span class="n">to</span><span class="w">  </span><span class="n">KB</span><span class="o">/</span><span class="n">s</span>
<span class="w">    </span><span class="o">-</span><span class="n">w</span><span class="w">   </span><span class="n">Set</span><span class="w"> </span><span class="n">window</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="n">to</span><span class="w">  </span><span class="n">KB</span><span class="w"> </span>
<span class="w">    </span><span class="o">-</span><span class="n">t</span><span class="w">  </span><span class="n">Set</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">smoothing</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">to</span><span class="w">  </span><span class="n">s</span>
<span class="w">    </span><span class="o">-</span><span class="n">l</span><span class="w">   </span><span class="n">Set</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">smoothing</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="n">to</span><span class="w">  </span><span class="n">KB</span>
<span class="w">    </span><span class="o">-</span><span class="n">n</span><span class="w">     </span><span class="n">Use</span><span class="w"> </span><span class="n">trickled</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="n">name</span><span class="w"> </span>
<span class="w">    </span><span class="o">-</span><span class="n">L</span><span class="w">       </span><span class="n">Set</span><span class="w"> </span><span class="n">latency</span><span class="w"> </span><span class="n">to</span><span class="w">  </span><span class="n">milliseconds</span>
<span class="w">    </span><span class="o">-</span><span class="n">P</span><span class="w">     </span><span class="n">Preload</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="o">.</span><span class="n">so</span><span class="w"> </span><span class="n">instead</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">one</span>
</code></pre></div>

<h3>总结</h3>
<p>本篇文章介绍如何在Linux机器上安装trickle工具，并用它如何做一些简单的事情。无论你为大公司工作还是自己使用，trickle都是高级Linux用户的必备工具。</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>