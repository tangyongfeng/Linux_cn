<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>如何从 Linux 终端发送桌面通知与提醒</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: Tomasz Waraksa 这篇教程演示如何使用脚本命令来发送自己的桌面通知与提醒。 有时候，来自脚本的视觉回馈是很有用的。例如，当 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li class="active"><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2022/07/ru-he-cong-linux-zhong-duan-fa-song-zhuo-mian-tong-zhi-yu-ti-xing.html" rel="bookmark"
           title="Permalink to 如何从 Linux 终端发送桌面通知与提醒">如何从 Linux 终端发送桌面通知与提醒</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2022-07-14T14:51:49+02:00">
                Published: Thu 14 July 2022
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/ji-zhu">技术</a>.</p>

</footer><!-- /.post-info -->      <p>Author: Tomasz Waraksa</p>
<blockquote>
<p>这篇教程演示如何使用脚本命令来发送自己的桌面通知与提醒。</p>
</blockquote>
<p><img alt="" src="/data/attachment/album/202207/14/145103vawkhy6w506thy6h.jpg" title="Person using a laptop"></p>
<p>有时候，来自脚本的视觉回馈是很有用的。例如，当一个脚本或计划任务完成时，一个长期运行的构建任务失败时，或者当脚本执行中出现了紧急问题时。桌面应用程序可以通过弹出通知来做到这一点，但脚本也可以做到这一点！你可以使用脚本命令来给自己发送桌面通知与提醒。</p>
<p><img alt="Example notification" src="/data/attachment/album/202207/14/145149orngsvxddhdlgsd7.png" title="Example notification"></p>
<p>下面的代码是在 Linux 上编写和测试的。它也可以在 macOS 上运行，只需花点功夫。请参见最后一节 <a href="https://opensource.com/article/22/1/linux-desktop-notifications/#script-notifications-on-macOS">提示与技巧</a>。</p>
<h3>从 Linux 终端发送通知</h3>
<p>要从 Linux 终端发送通知，请使用 <a href="https://manpages.ubuntu.com/manpages/xenial/man1/notify-send.1.html">notify-send</a> 命令。运行 <code>which notify-send</code> 命令来查看它是否在于你的系统中。如果没有，请使用包管理器来安装它。</p>
<p>在 Fedora 上，输入：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>notify-send
</code></pre></div>

<p>在基于 Debian 的发行版上，输入：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>notify-send
</code></pre></div>

<p>几个简单的通知示例：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>notify-send<span class="w"> </span><span class="s2">&quot;Dinner ready!&quot;</span>
$<span class="w"> </span>notify-send<span class="w"> </span><span class="s2">&quot;Tip of the Day&quot;</span><span class="w"> </span><span class="s2">&quot;How about a nap?&quot;</span>
</code></pre></div>

<p>你可以用紧急程度、自定义图标等选项来自定义通知。过 <code>man notify-send</code> 了解更多。你也可以在通知正文中使用一小组 HTML 标记，以使消息有一个棒的视觉感受。最重要的是，URL 被呈现为可点击的。例如：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>notify-send<span class="w"> </span>-u<span class="w"> </span>critical<span class="w"> </span>\
<span class="w">  </span>&quot;Build<span class="w"> </span>failed!&quot;<span class="w"> </span>\
<span class="w">  </span>&quot;There<span class="w"> </span>were<span class="w"> </span><span class="nt">&lt;b&gt;</span>123<span class="nt">&lt;/b&gt;</span><span class="w"> </span>errors.<span class="w"> </span>Click<span class="w"> </span>here<span class="w"> </span>to<span class="w"> </span>see<span class="w"> </span>the<span class="w"> </span>results:<span class="w"> </span>http://buildserver/latest&quot;
</code></pre></div>

<p><img alt="Build fail notification" src="/data/attachment/album/202207/14/145150lgduxdez72us8hku.png" title="Build fail notification"></p>
<p>发送的通知会被桌面环境接收，并像其他通知一样显示。它们将具有相同的外观、交互和行为。</p>
<h3>将 notify-send 与 at 结合使用</h3>
<p>计划任务通常被用来定期安排命令。<code>at</code> 命令安排在一个指定的时间执行一条命令。如果你像这样运行它，它会以交互模式启动，你可以在其中输入要在指定时间执行的命令：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>at<span class="w"> </span><span class="m">12</span>:00
</code></pre></div>

<p>这对脚本来说并不有用。幸运的是 <code>at</code> 接受来自标准输入的参数，所以我们可以这样使用它：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;npm run build&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>at<span class="w"> </span>now<span class="w"> </span>+<span class="w"> </span><span class="m">1</span><span class="w"> </span>minute
$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;backup-db&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>at<span class="w"> </span><span class="m">13</span>:00
</code></pre></div>

<p>有许多指定时间的方法。 从绝对时间，如 <code>10:00</code>，到相对时间，如 <code>now + 2 hours</code> ，再特殊时间，如<code>noon</code> 或 <code>midnight</code>。我们可以把它和 <code>notify-send</code> 结合起来，在未来的某个时间向自己发送提醒。例如：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;notify-send &#39;Stop it and go home now?&#39; &#39;Enough work for today.&#39; -u critical&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>at<span class="w"> </span>now
</code></pre></div>

<p><img alt="Stop for the day notification" src="/data/attachment/album/202207/14/145150o7i2q1ze70tzi08o.png" title="Stop for the day notification"></p>
<h3>提醒的命令</h3>
<p>现在，建立一个自定义的 Bash 命令来给自己发送提醒信息。像这样简单且人性化的命令：</p>
<div class="highlight"><pre><span></span><code><span class="nv">$</span><span class="w"> </span><span class="nv">remind</span><span class="w"> </span><span class="s">&quot;I&#39;m still here&quot;</span><span class="w"> </span><span class="n">now</span>
<span class="nv">$</span><span class="w"> </span><span class="nv">remind</span><span class="w"> </span><span class="s">&quot;Time to wake up!&quot;</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="n">minutes</span>
<span class="nv">$</span><span class="w"> </span><span class="nv">remind</span><span class="w"> </span><span class="s">&quot;Dinner&quot;</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">hour</span>
<span class="nv">$</span><span class="w"> </span><span class="nv">remind</span><span class="w"> </span><span class="s">&quot;Take a break&quot;</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">noon</span>
<span class="nv">$</span><span class="w"> </span><span class="nv">remind</span><span class="w"> </span><span class="s">&quot;It&#39;s Friday pints time!&quot;</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="mi">17</span><span class="p">:</span><span class="mo">00</span>
</code></pre></div>

<p>这比 Alexa 更好！该怎样做？</p>
<p>请看下面的代码。它定义了一个名为 <code>remind</code> 的函数，它支持上述语法。实际工作是在最后两行完成的。其余的部分负责显示帮助信息、参数校验等，这与任何大型应用程序中有用的代码与必要的白噪声的比例大致相同。</p>
<p>把代码保存在某个地方，例如，在 <code>~/bin/remind</code> 文件中，并在你的 <code>.bashrc</code> 配置文件写入该函数，以便在你登录时加载它：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span><span class="nb">source</span><span class="w"> </span>~/bin/remind
</code></pre></div>

<p>重新打开终端，然后输入 <code>remind</code> 来查看语法。尽情享受吧！</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env bash</span>
<span class="k">function</span><span class="w"> </span>remind<span class="w"> </span><span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">  </span><span class="nb">local</span><span class="w"> </span><span class="nv">COUNT</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$#</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="nb">local</span><span class="w"> </span><span class="nv">COMMAND</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="nb">local</span><span class="w"> </span><span class="nv">MESSAGE</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="nb">local</span><span class="w"> </span><span class="nv">OP</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="nb">shift</span><span class="w"> </span><span class="m">2</span>
<span class="w">  </span><span class="nb">local</span><span class="w"> </span><span class="nv">WHEN</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="c1"># Display help if no parameters or help command</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="nv">$COUNT</span><span class="w"> </span>-eq<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$COMMAND</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;help&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$COMMAND</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;--help&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$COMMAND</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;-h&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;COMMAND&quot;</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;    remind &amp;lt;message&amp;gt; &amp;lt;time&amp;gt;&quot;</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;    remind &amp;lt;command&amp;gt;&quot;</span>
<span class="w">    </span><span class="nb">echo</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;DESCRIPTION&quot;</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;    Displays notification at specified time&quot;</span>
<span class="w">    </span><span class="nb">echo</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;EXAMPLES&quot;</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;    remind &quot;Hi there&quot; now&#39;</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;    remind &quot;Time to wake up&quot; in 5 minutes&#39;</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;    remind &quot;Dinner&quot; in 1 hour&#39;</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;    remind &quot;Take a break&quot; at noon&#39;</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;    remind &quot;Are you ready?&quot; at 13:00&#39;</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;    remind list&#39;</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;    remind clear&#39;</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;    remind help&#39;</span>
<span class="w">    </span><span class="nb">echo</span>
<span class="w">    </span><span class="k">return</span>
<span class="w">  </span><span class="k">fi</span>
<span class="w">  </span><span class="c1"># Check presence of AT command</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span>!<span class="w"> </span>which<span class="w"> </span>at<span class="w"> </span><span class="p">&amp;</span>gt<span class="p">;</span>/dev/null<span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;remind: AT utility is required but not installed on your system. Install it with your package manager of choice, for example &#39;sudo apt install at&#39;.&quot;</span>
<span class="w">    </span><span class="k">return</span>
<span class="w">  </span><span class="k">fi</span>
<span class="w">  </span><span class="c1"># Run commands: list, clear</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="nv">$COUNT</span><span class="w"> </span>-eq<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$COMMAND</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;list&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">      </span>at<span class="w"> </span>-l
<span class="w">    </span><span class="k">elif</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$COMMAND</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;clear&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">      </span>at<span class="w"> </span>-r<span class="w"> </span><span class="k">$(</span>atq<span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-f1<span class="k">)</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">      </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;remind: unknown command </span><span class="nv">$COMMAND</span><span class="s2">. Type &#39;remind&#39; without any parameters to see syntax.&quot;</span>
<span class="w">    </span><span class="k">fi</span>
<span class="w">    </span><span class="k">return</span>
<span class="w">  </span><span class="k">fi</span>
<span class="w">  </span><span class="c1"># Determine time of notification</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$OP</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;in&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">TIME</span><span class="o">=</span><span class="s2">&quot;now + </span><span class="nv">$WHEN</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="k">elif</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$OP</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;at&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">TIME</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$WHEN</span><span class="s2">&quot;</span>
<span class="w">  </span><span class="k">elif</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$OP</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;now&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">local</span><span class="w"> </span><span class="nv">TIME</span><span class="o">=</span><span class="s2">&quot;now&quot;</span>
<span class="w">  </span><span class="k">else</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;remind: invalid time operator </span><span class="nv">$OP</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="k">return</span>
<span class="w">  </span><span class="k">fi</span>
<span class="w">  </span><span class="c1"># Schedule the notification</span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;notify-send &#39;</span><span class="nv">$MESSAGE</span><span class="s2">&#39; &#39;Reminder&#39; -u critical&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>at<span class="w"> </span><span class="nv">$TIME</span><span class="w"> </span><span class="m">2</span><span class="p">&amp;</span>gt<span class="p">;</span>/dev/null
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Notification scheduled at </span><span class="nv">$TIME</span><span class="s2">&quot;</span>
<span class="o">}</span>
</code></pre></div>

<h3>简单的提醒</h3>
<p>通过这几个简单的开源命令，你可以将你自己的脚本、应用程序和任务与你的桌面结合起来。试一试吧！</p>
<p>via: <a href="https://opensource.com/article/22/1/linux-desktop-notifications">https://opensource.com/article/22/1/linux-desktop-notifications</a></p>
<p>作者：<a href="https://opensource.com/users/tomasz">Tomasz Waraksa</a> 选题：<a href="https://github.com/lujun9972">lujun9972</a> 译者：<a href="https://github.com/mcfd">mcfd</a> 校对：<a href="https://github.com/wxy">wxy</a></p>
<p>本文由 <a href="https://github.com/LCTT/TranslateProject">LCTT</a> 原创编译，<a href="https://linux.cn/">Linux中国</a> 荣誉推出</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>