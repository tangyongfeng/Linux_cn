<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>深入了解 EPUB 文件</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: Jim Hall EPUB 文件是使用开放格式发布内容的好方法。 电子书提供了一种随时随地阅读书籍、杂志和其他内容的好方法。读者 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li class="active"><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2022/08/shen-ru-liao-jie-epub-wen-jian.html" rel="bookmark"
           title="Permalink to 深入了解 EPUB 文件">深入了解 EPUB 文件</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2022-08-25T22:38:34+02:00">
                Published: Thu 25 August 2022
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/ji-zhu">技术</a>.</p>

</footer><!-- /.post-info -->      <p>Author: Jim Hall</p>
<p><img alt="" src="/data/attachment/album/202208/25/223832eo3gq2o32uz0u0ll.jpg"></p>
<blockquote>
<p>EPUB 文件是使用开放格式发布内容的好方法。</p>
</blockquote>
<p>电子书提供了一种随时随地阅读书籍、杂志和其他内容的好方法。读者可以在长途飞行和乘坐火车时享受电子书打发时间。最流行的电子书文件格式是 EPUB 文件，它是“<ruby> 电子出版物 <rt>  electronic publication </rt></ruby>”的缩写。 EPUB 文件受到各种电子阅读器的支持，并且是当今电子书出版的有效标准。</p>
<p>EPUB 文件格式基于 XHTML 内容和 XML 元数据的开放标准，包含在 zip 存档中。由于一切都基于开放标准，我们可以使用通用工具来创建或检查 EPUB 文件。让我们探索一个 EPUB 文件以了解更多信息。《<a href="https://opensource.com/downloads/guide-c-programming">C 编程技巧和窍门指南</a>》，于今年早些时候在 <a href="http://Opensource.com">Opensource.com</a> 上发布，提供 PDF 或 EPUB 格式。</p>
<p>因为 EPUB 文件是放在 zip 文件中的 XHTML 内容和 XML 元数据，所以你可以用 <code>unzip</code> 命令在命令行检查 EPUB：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>unzip<span class="w"> </span>-l<span class="w"> </span>osdc_Jim-Hall_C-Programming-Tips.epub<span class="w"> </span>
Archive:<span class="w"> </span>osdc_Jim-Hall_C-Programming-Tips.epub
Length<span class="w"> </span>Date<span class="w"> </span>Time<span class="w"> </span>Name
---------<span class="w"> </span>----------<span class="w"> </span>-----<span class="w"> </span>----
<span class="m">20</span><span class="w"> </span><span class="m">06</span>-23-2022<span class="w"> </span><span class="m">00</span>:20<span class="w"> </span>mimetype
<span class="m">8259</span><span class="w"> </span><span class="m">06</span>-23-2022<span class="w"> </span><span class="m">00</span>:20<span class="w"> </span>OEBPS/styles/stylesheet.css
<span class="m">1659</span><span class="w"> </span><span class="m">06</span>-23-2022<span class="w"> </span><span class="m">00</span>:20<span class="w"> </span>OEBPS/toc.xhtml
<span class="m">4460</span><span class="w"> </span><span class="m">06</span>-23-2022<span class="w"> </span><span class="m">00</span>:20<span class="w"> </span>OEBPS/content.opf
<span class="m">44157</span><span class="w"> </span><span class="m">06</span>-23-2022<span class="w"> </span><span class="m">00</span>:20<span class="w"> </span>OEBPS/sections/section0018.xhtml
<span class="m">1242</span><span class="w"> </span><span class="m">06</span>-23-2022<span class="w"> </span><span class="m">00</span>:20<span class="w"> </span>OEBPS/sections/section0002.xhtml
<span class="m">22429</span><span class="w"> </span><span class="m">06</span>-23-2022<span class="w"> </span><span class="m">00</span>:20<span class="w"> </span>OEBPS/sections/section0008.xhtml
<span class="o">[</span>...<span class="o">]</span>
<span class="m">9628</span><span class="w"> </span><span class="m">06</span>-23-2022<span class="w"> </span><span class="m">00</span>:20<span class="w"> </span>OEBPS/sections/section0016.xhtml
<span class="m">748</span><span class="w"> </span><span class="m">06</span>-23-2022<span class="w"> </span><span class="m">00</span>:20<span class="w"> </span>OEBPS/sections/section0001.xhtml
<span class="m">3370</span><span class="w"> </span><span class="m">06</span>-23-2022<span class="w"> </span><span class="m">00</span>:20<span class="w"> </span>OEBPS/toc.ncx
<span class="m">8308</span><span class="w"> </span><span class="m">06</span>-23-2022<span class="w"> </span><span class="m">00</span>:21<span class="w"> </span>OEBPS/images/image0011.png
<span class="m">6598</span><span class="w"> </span><span class="m">06</span>-23-2022<span class="w"> </span><span class="m">00</span>:21<span class="w"> </span>OEBPS/images/image0009.png
<span class="o">[</span>...<span class="o">]</span>
<span class="m">14492</span><span class="w"> </span><span class="m">06</span>-23-2022<span class="w"> </span><span class="m">00</span>:21<span class="w"> </span>OEBPS/images/image0005.png
<span class="m">239</span><span class="w"> </span><span class="m">06</span>-23-2022<span class="w"> </span><span class="m">00</span>:20<span class="w"> </span>META-INF/container.xml
---------<span class="w"> </span>-------
<span class="m">959201</span><span class="w"> </span><span class="m">41</span><span class="w"> </span>files
</code></pre></div>

<p>这个 EPUB 包含很多文件，但其中大部分是内容。要了解 EPUB 文件是如何组合在一起的，请遵循电子书阅读器的流程：</p>
<p>1、电子书阅读器需要验证 EPUB 文件是否真的是 EPUB 文件。他们通过检查 EPUB 存档根目录中的 <code>mimetype</code> 文件来验证文件。该文件仅包含一行描述 EPUB 文件的 MIME 类型：</p>
<div class="highlight"><pre><span></span><code>application/epub+zip
</code></pre></div>

<p>2、为了定位内容，电子书阅读器从 <code>META-INF/container.xml</code> 文件开始。这是一个简短的 XML 文档，指示在哪里可以找到内容。对于此 EPUB 文件，<code>container.xml</code> 文件如下所示：</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="w">  </span><span class="nt">&lt;container</span><span class="w"> </span><span class="na">version=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="na">xmlns=</span><span class="s">&quot;urn:oasis:names:tc:opendocument:xmlns:container&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;rootfiles&gt;</span>
<span class="w">      </span><span class="nt">&lt;rootfile</span><span class="w"> </span><span class="na">full-path=</span><span class="s">&quot;OEBPS/content.opf&quot;</span><span class="w"> </span><span class="na">media-type=</span><span class="s">&quot;application/oebps-package+xml&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/rootfiles&gt;</span>
<span class="nt">&lt;/container&gt;</span>
</code></pre></div>

<p>为了使 <code>container.xml</code> 文件更易于阅读，我将单行拆分为多行，并添加了一些间距来缩进每行。XML 文件并不关心新行和空格等额外的空白，因此这种额外的间距不会影响 XML 文件。</p>
<p>3、<code>container.xml</code> 文件表示 EPUB 的根从 <code>OEBPS</code> 目录中的 <code>content.opf</code> 文件开始。OPF 扩展名是因为 EPUB 基于 “<ruby> 开放打包格式 <rt>  Open Packaging Format </rt></ruby>”，但 <code>content.opf</code> 文件实际上只是另一个 XML 文件。</p>
<p>4、<code>content.opf</code> 文件包含一个完整的 EPUB 内容清单，以及一个有序的目录，以及查找每一章或每一节的引用。这个 EPUB 的 <code>content.opf</code> 文件很长，因此我将在此仅展示一小部分作为示例。</p>
<p>XML 数据包含在 <code>&lt;package&gt;</code> 块中，该块本身具有 <code>&lt;metadata&gt;</code> 块、<code>&lt;manifest&gt;</code> 数据和包含电子书目录的 <code>&lt;spine&gt;</code> 块：</p>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;package</span><span class="w"> </span><span class="na">unique-identifier=</span><span class="s">&quot;unique-identifier&quot;</span><span class="w"> </span><span class="na">version=</span><span class="s">&quot;3.0&quot;</span><span class="w"> </span><span class="na">xmlns=</span><span class="s">&quot;http://www.idpf.org/2007/opf&quot;</span><span class="w"> </span><span class="na">xmlns:dc=</span><span class="s">&quot;http://purl.org/dc/elements/1.1/&quot;</span><span class="w"> </span><span class="na">xmlns:dcterms=</span><span class="s">&quot;http://purl.org/dc/terms/&quot;</span><span class="w"> </span><span class="na">xmlns:opf=</span><span class="s">&quot;http://www.idpf.org/2007/opf&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;metadata&gt;</span>
<span class="w">    </span><span class="nt">&lt;dc:identifier</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;unique-identifier&quot;</span><span class="nt">&gt;</span>osdc002<span class="nt">&lt;/dc:identifier&gt;</span>
<span class="w">    </span><span class="nt">&lt;dc:title&gt;</span>Tips<span class="w"> </span>and<span class="w"> </span>Tricks<span class="w"> </span>for<span class="w"> </span>C<span class="w"> </span>Programming<span class="nt">&lt;/dc:title&gt;</span>
<span class="w">    </span><span class="nt">&lt;dc:creator&gt;</span>Jim<span class="w"> </span>Hall<span class="nt">&lt;/dc:creator&gt;</span>
<span class="w">    </span><span class="nt">&lt;dc:language&gt;</span>English<span class="nt">&lt;/dc:language&gt;</span>
<span class="w">    </span><span class="nt">&lt;meta</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;dcterms:modified&quot;</span><span class="nt">&gt;</span>2022-06-23T12:09:13Z<span class="nt">&lt;/meta&gt;</span>
<span class="w">    </span><span class="nt">&lt;meta</span><span class="w"> </span><span class="na">content=</span><span class="s">&quot;LibreOffice/7.3.0.3$Linux_X86_64 LibreOffice_project/0f246aa12d0eee4a0f7adcefbf7c878fc2238db3 (libepubgen/0.1.1)&quot;</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;generator&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/metadata&gt;</span>
<span class="w">  </span><span class="nt">&lt;manifest&gt;</span>
<span class="w">    </span>...
<span class="w">    </span><span class="nt">&lt;item</span><span class="w"> </span><span class="na">href=</span><span class="s">&quot;sections/section0001.xhtml&quot;</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;section0001&quot;</span><span class="w"> </span><span class="na">media-type=</span><span class="s">&quot;application/xhtml+xml&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;item</span><span class="w"> </span><span class="na">href=</span><span class="s">&quot;images/image0003.png&quot;</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;image0003&quot;</span><span class="w"> </span><span class="na">media-type=</span><span class="s">&quot;image/png&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;item</span><span class="w"> </span><span class="na">href=</span><span class="s">&quot;styles/stylesheet.css&quot;</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;stylesheet.css&quot;</span><span class="w"> </span><span class="na">media-type=</span><span class="s">&quot;text/css&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;item</span><span class="w"> </span><span class="na">href=</span><span class="s">&quot;toc.ncx&quot;</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;toc.ncx&quot;</span><span class="w"> </span><span class="na">media-type=</span><span class="s">&quot;application/x-dtbncx+xml&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span>...
<span class="w">  </span><span class="nt">&lt;/manifest&gt;</span>
<span class="w">  </span><span class="nt">&lt;spine</span><span class="w"> </span><span class="na">toc=</span><span class="s">&quot;toc.ncx&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;itemref</span><span class="w"> </span><span class="na">idref=</span><span class="s">&quot;section0001&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;itemref</span><span class="w"> </span><span class="na">idref=</span><span class="s">&quot;section0002&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;itemref</span><span class="w"> </span><span class="na">idref=</span><span class="s">&quot;section0003&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span>...
<span class="w">  </span><span class="nt">&lt;/spine&gt;</span>
<span class="nt">&lt;/package&gt;</span>
</code></pre></div>

<p>你可以把数据匹配起来，看看在哪里可以找到每个部分。EPUB 阅读器就是这样做的。例如，目录中的第一项引用了 <code>section0001</code>，它在清单中被定义为位于 <code>sections/section0001.xhtml</code> 文件中。该文件的名称不需要与 <code>idref</code> 条目相同，但 LibreOffice Writer 的自动程序就是这样创建该文件的。（你可以在元数据中看到，这个 EPUB 是在 Linux 上用 LibreOffice 7.3.0.3 版本创建的，它可以将内容导出为 EPUB 文件。）</p>
<h3>EPUB 格式</h3>
<p>EPUB 文件是一种使用开放格式发布内容的好方法。EPUB 文件格式是 XML 元数据与 XHTML 内容，包含在一个 zip 文件内。虽然大多数技术作家使用工具来创建 EPUB 文件，因为 EPUB 是基于开放标准，意味着你可以使用其他方式创建自己的 EPUB 文件。</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>