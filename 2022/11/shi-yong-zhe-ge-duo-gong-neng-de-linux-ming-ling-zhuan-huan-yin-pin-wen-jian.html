<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>使用这个多功能的 Linux 命令转换音频文件</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: Klaatu SoX Sound Exchange 甚至可以为你的音频文件添加特效。 我工作需要使用音视频媒体，不管你处理哪种媒体，你肯定知道标准化是 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li class="active"><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2022/11/shi-yong-zhe-ge-duo-gong-neng-de-linux-ming-ling-zhuan-huan-yin-pin-wen-jian.html" rel="bookmark"
           title="Permalink to 使用这个多功能的 Linux 命令转换音频文件">使用这个多功能的 Linux 命令转换音频文件</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2022-11-13T10:43:18+01:00">
                Published: Sun 13 November 2022
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/ji-zhu">技术</a>.</p>

</footer><!-- /.post-info -->      <p>Author: Klaatu</p>
<blockquote>
<p>SoX Sound Exchange 甚至可以为你的音频文件添加特效。</p>
</blockquote>
<p><img alt="" src="/data/attachment/album/202211/13/104314skttlizoioyeaw3w.jpg" title="HiFi vintage stereo"></p>
<p>我工作需要使用音视频媒体，不管你处理哪种媒体，你肯定知道标准化是一种有价值的工具。就像你不会试图把一个分数加到一个小数上而不转换其中一个一样，我已经知道，把不同格式的媒体组合起来并不理想。为了方便用户，大多数爱好者级应用程序使转换过程不可见。然而，对于那些需要控制媒体细节的用户的灵活软件，会通常让你自己提前将媒体转换为所需的格式。我有一些最喜欢的音频转换工具，其中之一就是号称“音频的瑞士军刀” —— <a href="http://sox.sourceforge.net/sox.html">SoX</a>。</p>
<h3>安装</h3>
<p>在 Linux 或 BSD 上，可以从软件存储库或 Ports 树中安装 <code>sox</code> 命令（，以及一些有用的符号链接）。</p>
<p>你也可以从 <a href="http://sox.sourceforge.net">Sourceforge.net</a> 上安装 SoX。它不经常发布，但它的代码库往往是稳定的，所以如果你想要最新的功能（如 Opus 支持），构建它是容易和安全的。</p>
<p>SoX 主要提供了 <code>sox</code> 命令，但是创建了一些有用的符号链接：<code>play</code>、<code>rec</code> 和 <code>soxi</code>。</p>
<h3>使用 SoX 获取文件信息</h3>
<p>SoX 可以读取和重写音频数据。它是否存储重写的音频数据取决于你。在有些情况下，你不需要存储转换后的数据，例如，当你将输出直接发送到扬声器进行回放时。然而，在进行任何转换之前，最好首先确定要处理的是什么。</p>
<p>使用 <code>soxi</code> 命令也可以收集音频文件信息。<code>soxi</code> 会符号链接到 <code>soxi --info</code>。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>soxi<span class="w"> </span>countdown.mp3
Input<span class="w"> </span>File（输入文件）<span class="w">    </span>:<span class="w"> </span><span class="s1">&#39;/home/tux/countdown.mp3&#39;</span>
Channels（通道数）<span class="w">       </span>:<span class="w"> </span><span class="m">1</span>
Sample<span class="w"> </span>Rate（采样率）<span class="w">    </span>:<span class="w"> </span><span class="m">44100</span>
Precision（数据精度）<span class="w">      </span>:<span class="w"> </span><span class="m">16</span>-bit（16<span class="w"> </span>比特）
Duration（时长）<span class="w">       </span>:<span class="w"> </span><span class="m">00</span>:00:11.21<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">494185</span><span class="w"> </span>samples...（11.21<span class="w"> </span><span class="nv">秒</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">494185</span><span class="w"> </span>采样点）
File<span class="w"> </span>Size（文件大小）<span class="w">      </span>:<span class="w"> </span>179k
Bit<span class="w"> </span>Rate（比特率）<span class="w">       </span>:<span class="w"> </span>128k
Sample<span class="w"> </span>Encoding（编码格式）:<span class="w"> </span>MPEG<span class="w"> </span>audio<span class="w"> </span><span class="o">(</span>layer<span class="w"> </span>I,<span class="w"> </span>II<span class="w"> </span>or<span class="w"> </span>III<span class="o">)</span>
</code></pre></div>

<p>这个输出可以让你很好地了解音频文件的编码方式、文件长度、文件大小、采样率和通道数。其中一些你可能<em>认为</em>你已经知道了，但当客户把媒体带到我面前时，我从不相信这些假设。使用 <code>soxi</code> 验证媒体属性。</p>
<h3>转换文件</h3>
<p>在本例中，，一个游戏节目倒计时的音频是以MP3文件的形式提供的。虽然几乎所有的编辑应用程序都接受压缩音频，但它们并不是在压缩的数据上进行编辑。转换是在某个地方发生的，可能是一个秘密的后台任务，也可能提示让你保存一份副本。我通常喜欢自己提前完成转换。这样，我可以控制使用的格式。我可以在夜间批量处理大量的媒体，而不是浪费宝贵的制作时间，等待编辑应用程序按需处理它们。</p>
<p><code>sox</code> 命令用于转换音频文件。在 <code>sox</code> 流程中有几个阶段：</p>
<ul>
<li>输入</li>
<li>合并</li>
<li>特效</li>
<li>输出</li>
</ul>
<p>但在命令语法中，特效步骤令人困惑地放到了<em>最后一步</em>。这意味着 <code>sox</code> 流程是这样组成的:</p>
<div class="highlight"><pre><span></span><code>输入 → 合并 → 输出 → 特效
</code></pre></div>

<h3>编码</h3>
<p>最简单的转换命令只涉及一个输入文件和一个输出文件。下面是转换 MP3 文件为无损 FLAC 文件的命令：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sox<span class="w"> </span>countdown.mp3<span class="w"> </span>output.flac
$<span class="w"> </span>soxi<span class="w"> </span>output.flac

Input<span class="w"> </span>File（输入文件）<span class="w">     </span>:<span class="w"> </span><span class="s1">&#39;output.flac&#39;</span>
Channels（通道数）<span class="w">       </span>:<span class="w"> </span><span class="m">1</span>
Sample<span class="w"> </span>Rate（采样率）<span class="w">    </span>:<span class="w"> </span><span class="m">44100</span>
Precision（数据精度）<span class="w">      </span>:<span class="w"> </span><span class="m">16</span>-bit（16<span class="w"> </span>比特）
Duration（时长）<span class="w">       </span>:<span class="w"> </span><span class="m">00</span>:00:11.18<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">493056</span><span class="w"> </span>samples...（11.18<span class="w"> </span><span class="nv">秒</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">493056</span><span class="w"> </span>采样点）
File<span class="w"> </span>Size（文件大小）<span class="w">      </span>:<span class="w"> </span>545k
Bit<span class="w"> </span>Rate（比特率）<span class="w">       </span>:<span class="w"> </span>390k
Sample<span class="w"> </span>Encoding（编码格式）:<span class="w"> </span><span class="m">16</span>-bit<span class="w"> </span>FLAC
Comment（注释）<span class="w">        </span>:<span class="w"> </span><span class="s1">&#39;Comment=Processed by SoX&#39;</span>
</code></pre></div>

<h4>特效</h4>
<p>特效可以在命令末尾指定。它可以在将数据发送到最终目的地之前更改音频。例如，有时声音太大会在转换过程中造成问题：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sox<span class="w"> </span>bad.wav<span class="w"> </span>bad.ogg
sox<span class="w"> </span>WARN<span class="w"> </span>sox:<span class="w"> </span><span class="sb">`</span>bad.ogg<span class="err">&#39;</span><span class="w"> </span>output<span class="w"> </span>clipped<span class="w"> </span><span class="m">126</span><span class="w"> </span>samples<span class="p">;</span><span class="w"> </span>decrease<span class="w"> </span>volume?
</code></pre></div>

<p>应用<strong>增益</strong>（<code>gain</code>）效果通常可以解决此问题：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sox<span class="w"> </span>bad.wav<span class="w"> </span>bad.ogg<span class="w"> </span>gain<span class="w"> </span>-1
</code></pre></div>

<h4>淡入淡出</h4>
<p>另一个常用的效果是<strong>淡入淡出</strong>（<code>fade</code>）。此效果允许你定义淡入或淡出的类型，以及你希望淡入淡出效果持续的时间。</p>
<p>下面是一个使用倒抛物线的 6 秒淡入示例：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sox<span class="w"> </span>intro.ogg<span class="w"> </span>intro.flac<span class="w"> </span>fade<span class="w"> </span>p<span class="w"> </span><span class="m">6</span>
</code></pre></div>

<p>这将对音频的头部应用 3 秒的淡入，并从 8 秒标记开始淡出（这段音乐只有 11 秒，因此在这种情况下淡出也是 3 秒）：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sox<span class="w"> </span>intro.ogg<span class="w"> </span>intro.flac<span class="w"> </span>fade<span class="w"> </span>p<span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">8</span>
</code></pre></div>

<p><code>sox</code> 手册页中列出了不同类型的淡入淡出（正弦、线性、倒抛物线等）以及淡入淡出提供的选项。</p>
<h4>特效语法</h4>
<p>每个特效插件都有自己的语法，因此请参阅手册页了解如何调用每个特效插件的详细信息。</p>
<p>效果可以在一个命令中以菊花链的方式进行，至少在你想组合它们的范围内是如此。换句话说，没有语法可以只在六秒钟的淡出期间应用一个镶边效果。对于如此精确的东西，你需要一个图形声波编辑器或数字音频工作站，例如 <a href="https://opensource.com/life/16/2/linux-multimedia-studio">LMMS</a> 或 <a href="https://opensource.com/article/18/3/make-sweet-music-digital-audio-workstation-rosegarden">Rosegarden</a>。但是，如果你只想应用一次特效，可以在同一命令中将它们一起列出。</p>
<p>此命令应用了一个 -1 的<strong>增益</strong>效果、1.35 的节奏<strong>拉伸</strong>和<strong>淡出</strong>：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sox<span class="w"> </span>intro.ogg<span class="w"> </span>output.flac<span class="w"> </span>gain<span class="w"> </span>-1<span class="w"> </span>stretch<span class="w"> </span><span class="m">1</span>.35<span class="w"> </span>fade<span class="w"> </span>p<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">6</span>
$<span class="w"> </span>soxi<span class="w"> </span>output.flac

Input<span class="w"> </span>File（输入文件）<span class="w">     </span>:<span class="w"> </span><span class="s1">&#39;output.flac&#39;</span>
Channels（通道数）<span class="w">       </span>:<span class="w"> </span><span class="m">1</span>
Sample<span class="w"> </span>Rate（采样率）<span class="w">    </span>:<span class="w"> </span><span class="m">44100</span>
Precision（数据精度）<span class="w">      </span>:<span class="w"> </span><span class="m">16</span>-bit（16<span class="w"> </span>比特）
Duration（时长）<span class="w">        </span>:<span class="w"> </span><span class="m">00</span>:00:15.10<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">665808</span><span class="w"> </span>samples...（15.10<span class="w"> </span><span class="nv">秒</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">665808</span><span class="w"> </span>采样点）
File<span class="w"> </span>Size（文件大小）<span class="w">      </span>:<span class="w"> </span>712k
Bit<span class="w"> </span>Rate（比特率）<span class="w">       </span>:<span class="w"> </span>377k
Sample<span class="w"> </span>Encoding（编码格式）:<span class="w"> </span><span class="m">16</span>-bit<span class="w"> </span>FLAC
Comment（注释）<span class="w">        </span>:<span class="w"> </span><span class="s1">&#39;Comment=Processed by SoX&#39;</span>
</code></pre></div>

<h3>组合音频</h3>
<p>SoX 还可以通过连接或混合音频文件来组合音频文件。</p>
<p>要连接（或者说<em>拼接</em>）文件合并为一个文件，请在命令中提供多个输入文件：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sox<span class="w"> </span>countdown.mp3<span class="w"> </span>intro.ogg<span class="w"> </span>output.flac
</code></pre></div>

<p>在本例中，<code>output.flac</code> 现在包含 <code>countdown.mp3</code> 音频，紧接着是 <code>intro.ogg</code> 音乐。</p>
<p>但是，如果你希望两首曲目同时播放，可以使用 <code>--combine mix</code> 选项：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sox<span class="w"> </span>--combine<span class="w"> </span>mix<span class="w"> </span>countdown.mp3<span class="w"> </span>intro.ogg<span class="w"> </span>output.flac
</code></pre></div>

<p>然而，想象一下，这两个输入文件的不同之处不仅仅在于它们的编解码器。人声音轨用单声道（一个声道）录制并不少见，但音乐至少要用立体声（至少两个声道）来录制。SoX 不会给出默认的解决方案，因此你必须首先自己标准化这两个文件的格式。</p>
<h4>更改音频文件</h4>
<p>选项与后面列出文件名有关。例如，此命令中的 <code>--channels</code> 选项将<em>仅仅</em>应用于 <code>input.wav</code>，而<em>不被</em>应用于 <code>example.ogg</code> 和 <strong>output.flac</strong>：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sox<span class="w"> </span>--channels<span class="w"> </span><span class="m">2</span><span class="w"> </span>input.wav<span class="w"> </span>example.ogg<span class="w"> </span>output.flac
</code></pre></div>

<p>这意味着在 SoX 中，选项的位置非常重要。如果你在命令开始时指定一个选项，那么实际上只会覆盖 SoX 自己从输入文件中收集的内容。然而，在<em>输出文件</em>名前的选项决定了 SoX 如何写入音频数据。</p>
<p>要解决前面的通道不兼容问题，你可以首先标准化输入，然后混合：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sox<span class="w"> </span>countdown.mp3<span class="w"> </span>--channels<span class="w"> </span><span class="m">2</span><span class="w"> </span>countdown-stereo.flac<span class="w"> </span>gain<span class="w"> </span>-1
$<span class="w"> </span>soxi<span class="w"> </span>countdown-stereo.flac

Input<span class="w"> </span>File（输入文件）<span class="w">     </span>:<span class="w"> </span><span class="s1">&#39;countdown-stereo.flac&#39;</span>
Channels（通道数）<span class="w">       </span>:<span class="w"> </span><span class="m">2</span>
Sample<span class="w"> </span>Rate（采样率）<span class="w">    </span>:<span class="w"> </span><span class="m">44100</span>
Precision（数据精度）<span class="w">      </span>:<span class="w"> </span><span class="m">16</span>-bit（16<span class="w"> </span>比特）
Duration（时长）<span class="w">       </span>:<span class="w"> </span><span class="m">00</span>:00:11.18<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">493056</span><span class="w"> </span>samples...（11.18<span class="w"> </span><span class="nv">秒</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">493056</span><span class="w"> </span>采样点）
File<span class="w"> </span>Size（文件大小）<span class="w">      </span>:<span class="w"> </span>545k
Bit<span class="w"> </span>Rate（比特率）<span class="w">       </span>:<span class="w"> </span>390k
Sample<span class="w"> </span>Encoding（编码格式）:<span class="w"> </span><span class="m">16</span>-bit<span class="w"> </span>FLAC
Comment（注释）<span class="w">        </span>:<span class="w"> </span><span class="s1">&#39;Comment=Processed by SoX&#39;</span>

$<span class="w"> </span>sox<span class="w"> </span>--combine<span class="w"> </span>mix<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>countdown-stereo.flac<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>intro.ogg<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>output.flac
</code></pre></div>

<p>SoX 绝对需要多个命令来执行复杂的操作，因此根据需要创建几个临时和中间文件是正常的。</p>
<h3>多通道音频</h3>
<p>当然，并非所有音频都被限制在一个或两个声道。如果你想将多个音频通道组合成一个文件，可以使用 SoX 的 <code>--combine merge</code> 选项：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>sox<span class="w"> </span>--combine<span class="w"> </span>merge<span class="w"> </span>countdown.mp3<span class="w"> </span>intro.ogg<span class="w"> </span>output.flac
$<span class="w"> </span>soxi<span class="w"> </span>output.flac

Input<span class="w"> </span>File<span class="w">     </span>:<span class="w"> </span><span class="s1">&#39;output.flac&#39;</span>
Channels<span class="w">       </span>:<span class="w"> </span><span class="m">3</span>
<span class="o">[</span>...<span class="o">]</span>
</code></pre></div>

<h3>简单的音频操作</h3>
<p>在没有视觉界面的情况下操作音频似乎很奇怪，而且对于某些任务来说，SoX 绝对不是最好的工具。然而，对于许多任务，SoX 提供了一个简单而轻量级的工具包。SoX 是一个具有强大潜力的简单命令。有了它，你可以转换音频，操纵通道和波形，甚至生成自己的声音。本文仅简要概述了其功能，因此请阅读其手册页或 <a href="http://sox.sourceforge.net/sox.html">在线文档</a>，然后看看你能创造什么。</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>