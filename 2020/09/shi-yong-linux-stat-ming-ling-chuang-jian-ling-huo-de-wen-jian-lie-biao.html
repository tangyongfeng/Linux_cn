<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>使用 Linux stat 命令创建灵活的文件列表</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: Sandra Henry-stocker stat 命令提供了很多关于文件的详细信息。 它不仅提供了文件最近变化的日期/时间，还显示了最近访问文件的时间 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li class="active"><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2020/09/shi-yong-linux-stat-ming-ling-chuang-jian-ling-huo-de-wen-jian-lie-biao.html" rel="bookmark"
           title="Permalink to 使用 Linux stat 命令创建灵活的文件列表">使用 Linux stat 命令创建灵活的文件列表</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2020-09-21T22:32:11+02:00">
                Published: Mon 21 September 2020
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/ji-zhu">技术</a>.</p>

</footer><!-- /.post-info -->      <p>Author: Sandra Henry-stocker</p>
<p><img alt="" src="/data/attachment/album/202009/21/223030wi3xfx2eprij13z2.jpg"></p>
<p><code>stat</code> 命令提供了很多关于文件的详细信息。</p>
<p>它不仅提供了文件最近变化的日期/时间，还显示了最近访问文件的时间和权限变化。它可以同时告诉你文件的字节大小和块的数量。它可以显示文件使用的 inode 以及文件类型。它包括了文件所有者和相关用户组的名称和 UID/GID。它以 “rwx”（被称为 “人类可读” 格式）和数字方式显示文件权限。在某些系统中，它甚至可能包括文件创建的日期和时间（称为“出生”）。</p>
<p>除了提供所有这些信息外，<code>stat</code> 命令还可以用来创建文件列表。这些列表非常灵活，你可以选择包含上述任何或全部信息。</p>
<p>要生成一个自定义列表，你只需要使用 <code>stat</code> 命令的 <code>-c</code>（或 <code>--format</code>）选项，并指定你想要包含的字段。例如，要创建一个以两种格式显示文件权限的列表，使用这个命令：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>stat<span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;%n %a %A&#39;</span><span class="w"> </span>my*
my.banner<span class="w"> </span><span class="m">664</span><span class="w"> </span>-rw-rw-r--
mydir<span class="w"> </span><span class="m">775</span><span class="w"> </span>drwxrwxr-x
myfile<span class="w"> </span><span class="m">664</span><span class="w"> </span>-rw-rw-r--
myjunk<span class="w"> </span><span class="m">777</span><span class="w"> </span>lrwxrwxrwx
mykey<span class="w"> </span><span class="m">664</span><span class="w"> </span>-rw-rw-r--
mylog<span class="w"> </span><span class="m">664</span><span class="w"> </span>-rw-rw-r--
myscript<span class="w"> </span><span class="m">755</span><span class="w"> </span>-rwxr-xr-x
mytext<span class="w"> </span><span class="m">664</span><span class="w"> </span>-rw-rw-r--
mytext.bak<span class="w"> </span><span class="m">664</span><span class="w"> </span>-rw-rw-r--
mytwin<span class="w"> </span><span class="m">50</span><span class="w"> </span>-rw-r-----
mywords<span class="w"> </span><span class="m">664</span><span class="w"> </span>-rw-rw-r--
</code></pre></div>

<p>如上例所示，<code>%n</code> 代表文件名，<code>%a</code> 代表八进制的权限，<code>%A</code> 代表 <code>rwx</code> 形式的权限。完整的列表如后面所示。</p>
<p>要为这个命令创建一个别名，输入这个命令，或在 <code>.bashrc</code> 文件中添加这个定义。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span><span class="nb">alias</span><span class="w"> </span><span class="nv">ls_perms</span><span class="o">=</span><span class="s2">&quot;stat -c &#39;%n %a %A&#39;&quot;</span>
</code></pre></div>

<p>要创建一个非常接近 <code>ls -l</code> 提供的长列表，可以这样做：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>stat<span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;%A %h %U %G %s %y %n&#39;</span><span class="w"> </span>my*
-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>shs<span class="w"> </span>shs<span class="w"> </span><span class="m">255</span><span class="w"> </span><span class="m">2020</span>-04-01<span class="w"> </span><span class="m">16</span>:20:00.899374215<span class="w"> </span>-0400<span class="w"> </span>my.banner
drwxrwxr-x<span class="w"> </span><span class="m">2</span><span class="w"> </span>shs<span class="w"> </span>shs<span class="w"> </span><span class="m">4096</span><span class="w"> </span><span class="m">2020</span>-09-07<span class="w"> </span><span class="m">12</span>:50:20.224470760<span class="w"> </span>-0400<span class="w"> </span>mydir
-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>shs<span class="w"> </span>shs<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">2020</span>-05-16<span class="w"> </span><span class="m">11</span>:12:00.460355387<span class="w"> </span>-0400<span class="w"> </span>myfile
lrwxrwxrwx<span class="w"> </span><span class="m">1</span><span class="w"> </span>shs<span class="w"> </span>shs<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">2020</span>-05-28<span class="w"> </span><span class="m">18</span>:49:21.666792608<span class="w"> </span>-0400<span class="w"> </span>myjunk
-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>shs<span class="w"> </span>shs<span class="w"> </span><span class="m">655</span><span class="w"> </span><span class="m">2020</span>-01-14<span class="w"> </span><span class="m">15</span>:56:08.540540488<span class="w"> </span>-0500<span class="w"> </span>mykey
-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>shs<span class="w"> </span>shs<span class="w"> </span><span class="m">8</span><span class="w"> </span><span class="m">2020</span>-03-04<span class="w"> </span><span class="m">17</span>:13:21.406874246<span class="w"> </span>-0500<span class="w"> </span>mylog
-rwxr-xr-x<span class="w"> </span><span class="m">1</span><span class="w"> </span>shs<span class="w"> </span>shs<span class="w"> </span><span class="m">201</span><span class="w"> </span><span class="m">2020</span>-09-07<span class="w"> </span><span class="m">12</span>:50:41.316745867<span class="w"> </span>-0400<span class="w"> </span>myscript
-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>shs<span class="w"> </span>shs<span class="w"> </span><span class="m">40</span><span class="w"> </span><span class="m">2019</span>-06-06<span class="w"> </span><span class="m">08</span>:54:09.538663323<span class="w"> </span>-0400<span class="w"> </span>mytext
-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>shs<span class="w"> </span>shs<span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">2019</span>-06-06<span class="w"> </span><span class="m">08</span>:48:59.652712578<span class="w"> </span>-0400<span class="w"> </span>mytext.bak
-rw-r-----<span class="w"> </span><span class="m">2</span><span class="w"> </span>shs<span class="w"> </span>shs<span class="w"> </span><span class="m">228</span><span class="w"> </span><span class="m">2019</span>-04-12<span class="w"> </span><span class="m">19</span>:37:12.790284604<span class="w"> </span>-0400<span class="w"> </span>mytwin
-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>shs<span class="w"> </span>shs<span class="w"> </span><span class="m">1983</span><span class="w"> </span><span class="m">2020</span>-08-10<span class="w"> </span><span class="m">14</span>:39:57.164842370<span class="w"> </span>-0400<span class="w"> </span>mywords
</code></pre></div>

<p>不同之处包括： 1、不试图将字段排成可辨认的一列，2、日期是 <code>yy-mm-dd</code> 格式，3、时间字段更精确，4、增加了时区（-0400 是 EDT）。</p>
<p>如果你想根据最后一次访问的日期来列出文件（例如，用 <code>cat</code> 命令来显示），使用这样的命令：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>stat<span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;%n %x&#39;</span><span class="w"> </span>my*<span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span>-k2
mytwin<span class="w"> </span><span class="m">2019</span>-04-22<span class="w"> </span><span class="m">11</span>:25:20.656828964<span class="w"> </span>-0400
mykey<span class="w"> </span><span class="m">2020</span>-08-20<span class="w"> </span><span class="m">16</span>:10:34.479324431<span class="w"> </span>-0400
mylog<span class="w"> </span><span class="m">2020</span>-08-20<span class="w"> </span><span class="m">16</span>:10:34.527325066<span class="w"> </span>-0400
myfile<span class="w"> </span><span class="m">2020</span>-08-20<span class="w"> </span><span class="m">16</span>:10:57.815632794<span class="w"> </span>-0400
mytext.bak<span class="w"> </span><span class="m">2020</span>-08-20<span class="w"> </span><span class="m">16</span>:10:57.935634379<span class="w"> </span>-0400
mytext<span class="w"> </span><span class="m">2020</span>-08-20<span class="w"> </span><span class="m">16</span>:15:42.323391985<span class="w"> </span>-0400
mywords<span class="w"> </span><span class="m">2020</span>-08-20<span class="w"> </span><span class="m">16</span>:15:43.479407259<span class="w"> </span>-0400
myjunk<span class="w"> </span><span class="m">2020</span>-09-07<span class="w"> </span><span class="m">10</span>:04:26.543980300<span class="w"> </span>-0400
myscript<span class="w"> </span><span class="m">2020</span>-09-07<span class="w"> </span><span class="m">12</span>:50:41.312745815<span class="w"> </span>-0400
my.banner<span class="w"> </span><span class="m">2020</span>-09-07<span class="w"> </span><span class="m">13</span>:22:38.105826116<span class="w"> </span>-0400
mydir<span class="w"> </span><span class="m">2020</span>-09-07<span class="w"> </span><span class="m">14</span>:53:10.171867194<span class="w"> </span>-0400
</code></pre></div>

<p>用 <code>stat</code> 列出文件细节时，可用的选项包括：</p>
<ul>
<li><code>%a</code> - 八进制的访问权限（注意 <code>#</code> 和 <code>0</code> 的 printf 标志）</li>
<li><code>%A</code> – 人类可读的访问权限</li>
<li><code>%b</code> – 分配的块数（见 <code>%B</code>）</li>
<li><code>%B</code> – <code>%b</code> 报告的每个块的字节数</li>
<li><code>%C</code> – SELinux 安全上下文字符串</li>
<li><code>%d</code> – 十进制的设备编号</li>
<li><code>%D</code> – 十六进制的设备编号</li>
<li><code>%f</code> – 十六进制的原始模式</li>
<li><code>%F</code> – 文件类型</li>
<li><code>%g</code> – 所有者的组 ID</li>
<li><code>%G</code> – 所有者的组名</li>
<li><code>%h</code> – 硬链接的数量</li>
<li><code>%i</code> – inode 编号</li>
<li><code>%m</code> – 挂载点</li>
<li><code>%n</code> – 文件名</li>
<li><code>%N</code> – 如果是符号链接，会解引用为指向的文件名</li>
<li><code>%o</code> – 最佳 I/O 传输大小提示</li>
<li><code>%s</code> – 以字节为单位的总大小</li>
<li><code>%t</code> – 十六进制的主要设备类型，用于字符/块设备特殊文件</li>
<li><code>%T</code> – 十六进制的次要设备类型，用于字符/块设备特殊文件</li>
<li><code>%u</code> – 所有者的用户 ID</li>
<li><code>%U</code> – 所有者的用户名</li>
<li><code>%w</code> – 文件创建时间，以人类可读形式； 如果未知，则为 <code>-</code>。</li>
<li><code>%W</code> – 文件创建时间，以 UNIX 纪元以来的秒数形式；如果未知，则为 <code>0</code>。</li>
<li><code>%x</code> – 上次访问时间，以人类可读形式</li>
<li><code>%X</code> – 上次访问时间，以 UNIX 纪元以来的秒数形式</li>
<li><code>%y</code> – 上次数据修改时间，以人类可读形式</li>
<li><code>%Y</code> – 上次数据修改时间，以 UNIX 纪元以来的秒数形式</li>
<li><code>%z</code> – 上次状态改变的时间，以人类可读形式</li>
<li><code>%Z</code> – 上次状态改变的时间，以 UNIX 纪元以来的秒数形式</li>
</ul>
<p>这些字段的选择都列在手册页中，你可以选择任何一个，不过用你喜欢的选项创建一些别名应该可以省去很多麻烦。有些选项，如 SELinux 安全上下文字符串，除非在系统中有使用，它将不可用。文件创建时间只有在你的系统保留该信息的情况下才可用。</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>