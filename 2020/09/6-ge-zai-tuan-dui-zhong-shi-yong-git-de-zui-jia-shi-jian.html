<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>6 个在团队中使用 Git 的最佳实践</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: Ravi Chandran 采用这些 Git 协作策略，让团队工作更高效。 Git 非常有助于小团队管理他们的软件开发进度，但有些方法能让你变得 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li class="active"><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2020/09/6-ge-zai-tuan-dui-zhong-shi-yong-git-de-zui-jia-shi-jian.html" rel="bookmark"
           title="Permalink to 6 个在团队中使用 Git 的最佳实践">6 个在团队中使用 Git 的最佳实践</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2020-09-16T23:50:02+02:00">
                Published: Wed 16 September 2020
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/ruan-jian-kai-fa">软件开发</a>.</p>

</footer><!-- /.post-info -->      <p>Author: Ravi Chandran</p>
<blockquote>
<p>采用这些 Git 协作策略，让团队工作更高效。</p>
</blockquote>
<p><img alt="" src="/data/attachment/album/202009/16/234908ge77j9j799i4eaj7.jpg"></p>
<p>Git 非常有助于小团队管理他们的软件开发进度，但有些方法能让你变得更高效。我发现了许多有助于我的团队的最佳实践，尤其是当不同 Git 水平的新人加入时。</p>
<h3>在你的团队中正式确立 Git 约定</h3>
<p>每个人都应当遵循对于分支命名、标记和编码的规范。每个组织都有自己的规范或者最佳实践，并且很多建议都可以从网上免费获取，而重要的是尽早选择合适的规范并在团队中遵循。</p>
<p>同时，不同的团队成员的 Git 水平参差不齐。你需要创建并维护一组符合团队规范的基础指令，用于执行通用的 Git 操作。</p>
<h3>正确地合并变更</h3>
<p>每个团队成员都需要在一个单独的功能分支上开发。但即使是使用了单独的分支，每个人也会修改一些共同的文件。当把更改合并回 <code>master</code> 分支时，合并通常无法自动进行。可能需要手动解决不同的人对同一文件不同变更的冲突。这就是你必须学会如何处理 Git 合并的原因。</p>
<p>现代编辑器具有协助解决 <a href="https://opensource.com/article/20/4/git-merge-conflict">Git 合并冲突</a>的功能。它们对同一文件的每个部分提供了合并的各种选择，例如，是否保留你的更改，或者是保留另一分支的更改，亦或者是全部保留。如果你的编辑器不支持这些功能，那么可能是时候换一个代码编辑器了。</p>
<h3>经常变基你的功能分支</h3>
<p>当你持续地开发你的功能分支时，请经常对它做<ruby> 变基 <rt>  rebase </rt></ruby>：<code>rebase master</code>。这意味着要经常执行以下步骤：</p>
<div class="highlight"><pre><span></span><code>git checkout master
git pull
git checkout feature-xyz  # 假设的功能分支名称
git rebase master  # 可能需要解决  feature-xyz 上的合并冲突
</code></pre></div>

<p>这些步骤会在你的功能分支上<a href="https://opensource.com/article/20/4/git-rebase-i">重写历史</a>（这并不是件坏事）。首先，它会使你的功能分支获得 <code>master</code> 分支上当前的所有更新。其次，你在功能分支上的所有提交都会在该分支历史的顶部重写，因此它们会顺序地出现在日志中。你可能需要一路解决遇到的合并冲突，这也许是个挑战。但是，这是解决冲突最好的时机，因为它只影响你的功能分支。</p>
<p>在解决完所有冲突并进行回归测试后，如果你准备好将功能分支合并回 <code>master</code>，那么就可以在再次执行上述的变基步骤几次后进行合并：</p>
<div class="highlight"><pre><span></span><code>git checkout master
git pull
git merge feature-xyz
</code></pre></div>

<p>在此期间，如果其他人也将和你有冲突的更改推送到 <code>master</code>，那么 Git 合并将再次发生冲突。你需要解决它们并重新进行回归测试。</p>
<p>还有一些其他的合并哲学（例如，只使用合并而不使用变基以防止重写历史），其中一些甚至可能更简单易用。但是，我发现上述方法是一个干净可靠的策略。提交历史日志将以有意义的功能序列进行排列。</p>
<p>如果使用“纯合并”策略（上面所说的，不进行定期的变基），那么 <code>master</code> 分支的历史将穿插着所有同时开发的功能的提交。这样混乱的历史很难回顾。确切的提交时间通常并不是那么重要。最好是有一个易于查看的历史日志。</p>
<h3>在合并前压扁提交</h3>
<p>当你在功能分支上开发时，即使再小的修改也可以作为一个提交。但是，如果每个功能分支都要产生五十个提交，那么随着不断地增添新功能，<code>master</code> 分支的提交数终将无谓地膨胀。通常来说，每个功能分支只应该往 <code>master</code> 中增加一个或几个提交。为此，你需要将多个提交<ruby> 压扁 <rt>  Squash </rt></ruby>成一个或者几个带有更详细信息的提交中。通常使用以下命令来完成：</p>
<div class="highlight"><pre><span></span><code>git rebase -i HEAD~20  # 查看可进行压扁的二十个提交
</code></pre></div>

<p>当这条命令执行后，将弹出一个提交列表的编辑器，你可以通过包括<ruby> 遴选 <rt>  pick </rt></ruby>或<ruby> 压扁 <rt>  squash </rt></ruby>在内的数种方式编辑它。“遴选”一个提交即保留这个提交。“压扁”一个提交则是将这个提交合并到前一个之中。使用这些方法，你就可以将多个提交合并到一个提交之中，对其进行编辑和清理。这也是一个清理不重要的提交信息的机会（例如，带错字的提交）。</p>
<p>总之，保留所有与提交相关的操作，但在合并到 <code>master</code> 分支前，合并并编辑相关信息以明确意图。注意，不要在变基的过程中不小心删掉提交。</p>
<p>在执行完诸如变基之类的操作后，我会再次看看 <code>git log</code> 并做最终的修改：</p>
<div class="highlight"><pre><span></span><code>git commit --amend
</code></pre></div>

<p>最后，由于重写了分支的 Git 提交历史，必须强制更新远程分支：</p>
<div class="highlight"><pre><span></span><code>git push -f
</code></pre></div>

<h3>使用标签</h3>
<p>当你完成测试并准备从 <code>master</code> 分支部署软件到线上时，又或者当你出于某种原因想要保留当前状态作为一个里程碑时，那么可以创建一个 Git 标签。对于一个积累了一些变更和相应提交的分支而言，标签就是该分支在那一时刻的快照。一个标签可以看作是没有历史记录的分支，也可以看作是直接指向标签创建前那个提交的命名指针。</p>
<p>所谓的“配置控制”就是在不同的里程碑上保存代码的状态。大多数项目都有一个需求，能够重现任一里程碑上的软件源码，以便在需要时重新构建。Git 标签为每个代码的里程碑提供了一个唯一标识。打标签非常简单：</p>
<div class="highlight"><pre><span></span><code>git tag milestone-id -m &quot;short message saying what this milestone is about&quot;
git push --tags   # 不要忘记将标签显式推送到远程
</code></pre></div>

<p>考虑这样一种情况：Git 标签对应的软件版本已经分发给客户，而客户报告了一个问题。尽管代码库中的代码可能已经在继续开发，但通常情况下为了准确地重现客户问题以便做出修复，必须回退到 Git 标签对应的代码状态。有时候新代码可能已经修复了那个问题，但并非一直如此。通常你需要切换到特定的标签并从那个标签创建一个分支：</p>
<div class="highlight"><pre><span></span><code>git checkout milestone-id        # 切换到分发给客户的标签
git checkout -b new-branch-name  # 创建新的分支用于重现 bug
</code></pre></div>

<p>此外，如果带附注的标记和带签名的标记有助于你的项目，可以考虑使用它们。</p>
<h3>让软件运行时打印标签</h3>
<p>在大多数嵌入式项目中，从代码版本构建出的二进制文件有固定的名称，这样无法从它的名称推断出对应的 Git 标签。在构建时“嵌入标签”有助于将未来发现的问题精准地关联到特定的构建版本。在构建过程中可以自动地嵌入标签。通常，<code>git describe</code> 生成的标签字符串会在代码编译前插入到代码中，以便生成的可执行文件能够在启时时输出标签字符串。当客户报告问题时，可以指导他们给你发送启动时输出的内容。</p>
<h3>总结</h3>
<p>Git 是一个需要花时间去掌握的复杂工具。使用这些实践可以帮助团队成功地使用 Git 协作，无论他们的知识水平。</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>