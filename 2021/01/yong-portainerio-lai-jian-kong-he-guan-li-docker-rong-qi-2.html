<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>用 Portainer.io 来监控和管理 Docker 容器（2）</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: Shashidhar Soppin 作为第 1 部分的延续，本第 2 部分将介绍 Portainer 的其余功能。 监控 docker 容器镜像 root@linuxtechi ~}$ docker ps -a CONTAINER ID IMAGE COMMAND..." />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li class="active"><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2021/01/yong-portainerio-lai-jian-kong-he-guan-li-docker-rong-qi-2.html" rel="bookmark"
           title="Permalink to 用 Portainer.io 来监控和管理 Docker 容器（2）">用 Portainer.io 来监控和管理 Docker 容器（2）</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2021-01-14T20:46:03+01:00">
                Published: Thu 14 January 2021
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/rong-qi-yu-yun">容器与云</a>.</p>

</footer><!-- /.post-info -->      <p>Author: Shashidhar Soppin</p>
<p><img alt="" src="/data/attachment/album/202101/14/204401knuxjru53n5su6ns.jpg"></p>
<p>作为<a href="/article-12634-1.html">第 1 部分</a>的延续，本第 2 部分将介绍 Portainer 的其余功能。</p>
<h3>监控 docker 容器镜像</h3>
<div class="highlight"><pre><span></span><code><span class="n">root</span><span class="nv">@linuxtechi</span><span class="w"> </span><span class="o">~</span><span class="err">}$</span><span class="w"> </span><span class="n">docker</span><span class="w"> </span><span class="n">ps</span><span class="w"> </span><span class="o">-</span><span class="n">a</span>
<span class="n">CONTAINER</span><span class="w"> </span><span class="n">ID</span><span class="w">        </span><span class="nc">IMAGE</span><span class="w">                 </span><span class="n">COMMAND</span><span class="w">             </span><span class="n">CREATED</span><span class="w">             </span><span class="n">STATUS</span><span class="w">   </span><span class="n">PORTS</span><span class="w">                             </span><span class="k">NAMES</span>
<span class="mi">9</span><span class="n">ab9aa72f015</span><span class="w">        </span><span class="n">ubuntu</span><span class="w">                </span><span class="ss">&quot;/bin/bash&quot;</span><span class="w">         </span><span class="mi">14</span><span class="w"> </span><span class="n">seconds</span><span class="w"> </span><span class="n">ago</span><span class="w">      </span><span class="n">Exited</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="mi">12</span><span class="w"> </span><span class="n">seconds</span><span class="w"> </span><span class="n">ago</span><span class="w">                  </span><span class="n">suspicious_shannon</span>
<span class="mi">305369</span><span class="n">d3b2bb</span><span class="w">        </span><span class="n">centos</span><span class="w">                </span><span class="ss">&quot;/bin/bash&quot;</span><span class="w">         </span><span class="mi">24</span><span class="w"> </span><span class="n">seconds</span><span class="w"> </span><span class="n">ago</span><span class="w">      </span><span class="n">Exited</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="mi">22</span><span class="w"> </span><span class="n">seconds</span><span class="w"> </span><span class="n">ago</span><span class="w">                  </span><span class="n">admiring_mestorf</span>
<span class="mi">9</span><span class="n">a669f3dc4f6</span><span class="w">        </span><span class="n">portainer</span><span class="o">/</span><span class="n">portainer</span><span class="w">   </span><span class="ss">&quot;/portainer&quot;</span><span class="w">        </span><span class="mi">7</span><span class="w"> </span><span class="n">minutes</span><span class="w"> </span><span class="n">ago</span><span class="w">       </span><span class="n">Up</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="n">minutes</span><span class="w">   </span><span class="mf">0.0.0.0</span><span class="err">:</span><span class="mi">9000</span><span class="o">-&gt;</span><span class="mi">9000</span><span class="o">/</span><span class="n">tcp</span><span class="w">      </span><span class="n">trusting_keller</span>
</code></pre></div>

<p>包括 <code>portainer</code>（docker 容器镜像），所有已退出和当前正在运行的 docker 镜像都会显示出来。下面的 Portainer GUI 屏幕截图显示了相同的情况。</p>
<p><img alt="Docker_status" src="/data/attachment/album/202101/14/204605cxyjqmfb008nznn0.jpg"></p>
<h3>监视事件</h3>
<p>单击 portainer 网页中的“Events”选项，如下所示。</p>
<p>基于 docker 容器活动生成和创建的各种事件将被提取并显示在此页面中.</p>
<p><img alt="Container-Events-Poratiner-GUI" src="/data/attachment/album/202101/14/204607g8vnewku3677ffm8.jpg"></p>
<p>现在检查并验证“Events”部分是如何工作的。创建一个新的 docker 容器镜像 <code>redis</code>，如下所述，在 docker 命令行检查状态：<code>docker ps –a</code>：</p>
<div class="highlight"><pre><span></span><code><span class="n">root</span><span class="err">@</span><span class="n">linuxtechi</span><span class="w"> </span><span class="o">~</span><span class="p">}</span><span class="o">$</span><span class="w"> </span><span class="n">docker</span><span class="w"> </span><span class="n">ps</span><span class="w"> </span><span class="o">-</span><span class="n">a</span>
<span class="n">CONTAINER</span><span class="w"> </span><span class="n">ID</span><span class="w">        </span><span class="n">IMAGE</span><span class="w">                 </span><span class="n">COMMAND</span><span class="w">                  </span><span class="n">CREATED</span><span class="w">              </span><span class="n">STATUS</span><span class="w">         </span><span class="n">PORTS</span><span class="w">                    </span><span class="n">NAMES</span>
<span class="n">cdbfbef59c31</span><span class="w">        </span><span class="n">redis</span><span class="w">                 </span><span class="s2">&quot;docker-entrypoint.s…&quot;</span><span class="w">   </span><span class="n">About</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">minute</span><span class="w"> </span><span class="n">ago</span><span class="w">   </span><span class="n">Up</span><span class="w"> </span><span class="n">About</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">minute</span><span class="w">         </span><span class="mi">6379</span><span class="o">/</span><span class="n">tcp</span><span class="w">                 </span><span class="n">angry_varahamihira</span>
<span class="mi">9</span><span class="n">ab9aa72f015</span><span class="w">        </span><span class="n">ubuntu</span><span class="w">                </span><span class="s2">&quot;/bin/bash&quot;</span><span class="w">              </span><span class="mi">10</span><span class="w"> </span><span class="n">minutes</span><span class="w"> </span><span class="n">ago</span><span class="w">       </span><span class="n">Exited</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="n">minutes</span><span class="w"> </span><span class="n">ago</span><span class="w">                            </span><span class="n">suspicious_shannon</span>
<span class="mi">305369</span><span class="n">d3b2bb</span><span class="w">        </span><span class="n">centos</span><span class="w">                </span><span class="s2">&quot;/bin/bash&quot;</span><span class="w">              </span><span class="mi">11</span><span class="w"> </span><span class="n">minutes</span><span class="w"> </span><span class="n">ago</span><span class="w">       </span><span class="n">Exited</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="n">minutes</span><span class="w"> </span><span class="n">ago</span><span class="w">                            </span><span class="n">admiring_mestorf</span>
<span class="mi">9</span><span class="n">a669f3dc4f6</span><span class="w">        </span><span class="n">portainer</span><span class="o">/</span><span class="n">portainer</span><span class="w">   </span><span class="s2">&quot;/portainer&quot;</span><span class="w">             </span><span class="mi">17</span><span class="w"> </span><span class="n">minutes</span><span class="w"> </span><span class="n">ago</span><span class="w">       </span><span class="n">Up</span><span class="w"> </span><span class="mi">17</span><span class="w"> </span><span class="n">minutes</span><span class="w">         </span><span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">9000</span><span class="o">-&gt;</span><span class="mi">9000</span><span class="o">/</span><span class="n">tcp</span><span class="w">   </span><span class="n">trusting_keller</span>
</code></pre></div>

<p>单击顶部的“Event List”刷新事件列表，</p>
<p><img alt="events_updated" src="/data/attachment/album/202101/14/204609g4e7w4wbgcllbbgb.jpg"></p>
<p>现在事件的页面也更新了这个变化，</p>
<h3>主机状态</h3>
<p>下面是 portainer 显示主机状态的屏幕截图。这是一个简单的窗口。这显示了主机 Linux 机器的基本信息，如“CPU”、“主机名”、“操作系统信息”等。这个页面在不需要登录主机命令行的情况下提供了非常有用的信息，以便快速浏览。</p>
<p><img alt="Host-names-Portainer" src="/data/attachment/album/202101/14/204610cr1sa0ve8svt6s1j.jpg"></p>
<h3>Portainer 中的仪表板</h3>
<p>到目前为止，我们已经在“Local”部分看到了基于 portainer 的各种特性。现在跳到所选 Docker 容器镜像的“Dashboard”部分。</p>
<p>在 Portainer 的网页中单击“EndPoint”选项时，会出现以下窗口：</p>
<p><img alt="End_Point_Settings" src="/data/attachment/album/202101/14/204612jxujdxavuwvdb9wf.jpg"></p>
<p>对于主机容器镜像，此仪表板有许多状态和选项。</p>
<h4>Stacks</h4>
<p>单击此选项可提供任何堆栈（如果有的话）的状态。因为这里没有堆栈，所以显示为零。</p>
<h4>Images</h4>
<p>单击此选项可提供主机中可用的容器镜像。此选项将显示所有活动和退出的容器镜像。</p>
<p><img alt="Docker-Container-Images-Portainer" src="/data/attachment/album/202101/14/204613v066uyy1z55t3lou.jpg"></p>
<p>例如，再创建一个“Nginx”容器并刷新此列表以查看更新：</p>
<div class="highlight"><pre><span></span><code><span class="n">root</span><span class="err">@</span><span class="n">linuxtechi</span><span class="w"> </span><span class="o">~</span><span class="p">}</span><span class="o">$</span><span class="w">  </span><span class="n">sudo</span><span class="w"> </span><span class="n">docker</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">nginx</span>
<span class="n">Unable</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">find</span><span class="w"> </span><span class="n">image</span><span class="w"> </span><span class="s1">&#39;nginx:latest&#39;</span><span class="w"> </span><span class="n">locally</span>
<span class="n">latest</span><span class="p">:</span><span class="w"> </span><span class="n">Pulling</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">library</span><span class="o">/</span><span class="n">nginx</span>
<span class="mi">27833</span><span class="n">a3ba0a5</span><span class="p">:</span><span class="w"> </span><span class="n">Pull</span><span class="w"> </span><span class="n">complete</span>
<span class="n">ea005e36e544</span><span class="p">:</span><span class="w"> </span><span class="n">Pull</span><span class="w"> </span><span class="n">complete</span>
<span class="n">d172c7f0578d</span><span class="p">:</span><span class="w"> </span><span class="n">Pull</span><span class="w"> </span><span class="n">complete</span>
<span class="n">Digest</span><span class="p">:</span><span class="w"> </span><span class="n">sha256</span><span class="p">:</span><span class="n">e71b1bf4281f25533cf15e6e5f9be4dac74d2328152edf7ecde23abc54e16c1c</span>
<span class="n">Status</span><span class="p">:</span><span class="w"> </span><span class="n">Downloaded</span><span class="w"> </span><span class="n">newer</span><span class="w"> </span><span class="n">image</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">nginx</span><span class="p">:</span><span class="n">latest</span>
</code></pre></div>

<p>下面是刷新后的镜像界面：</p>
<p><img alt="Nginx_Image_creation" src="/data/attachment/album/202101/14/204615q84kquzz4wabazja.jpg"></p>
<p>当 Nginx 镜像处于 <code>stopped</code>/<code>killed</code> 状态时，docker 的容器镜像会改变为 <code>unused</code> 状态。</p>
<p><strong>注</strong>：你可以看到这里所有的镜像的细节都非常清楚，比如内存使用，创建日期和时间。与命令行选项相比，从这里维护和监视容器将非常容易。</p>
<h4>Networks</h4>
<p>此选项用于网络操作。例如分配 IP 地址、创建子网、提供 IP 地址范围、访问控制（管理员和普通用户）。下面的窗口提供了各种可能选项的详细信息。根据你的需要，可以进一步去自行研究这些选项。</p>
<p><img alt="Conatiner-Network-Portainer" src="/data/attachment/album/202101/14/204616gez4110eb1bbp11k.jpg"></p>
<p>输入所有各种网络参数后，单击“create network”按钮即可创建网络。</p>
<h4>Container</h4>
<p>此选项将提供容器状态。此列表将提供有关活动的和未运行的容器状态的详细信息。此输出类似于 docker ps 命令选项。</p>
<p><img alt="Containers-Status-Portainer" src="/data/attachment/album/202101/14/204618klmashlaaqjahqaa.jpg"></p>
<p>在该窗口中，通过选中复选框并选择上述按钮可以根据需要控制容器停止和启动。一个例子如下：</p>
<p>例如，“CentOS”和“Ubuntu”容器都处于停止状态，现在可以通过选中复选框并点击“Start”按钮来启动它们。</p>
<p><img alt="start_containers1" src="/data/attachment/album/202101/14/204620ed8vd5uktrw8kq0l.jpg"></p>
<p><img alt="start_containers2" src="/data/attachment/album/202101/14/204622gk0b2124wb01tv1c.jpg"></p>
<p><strong>注意：</strong> 因为这两个都是 Linux 容器镜像，所以不会被启动。Portainer 尝试启动，但稍后又停止。试试启动“Nginx”，你会看到它变成了 <code>running</code> 状态。</p>
<p><img alt="start_containers3" src="/data/attachment/album/202101/14/204623fbsw2wa7tq27gjjk.jpg"></p>
<h4>Volume</h4>
<p>参见本文章第一部分。</p>
<h3>Portainer 中的设置选项</h3>
<p>到目前为止，我们已经在“Local”部分看到了基于 portainer 的各种特性。现在跳到所选 Docker 容器图像的“Settings”部分。</p>
<p>在 Portainer 的网页中单击“Settings”选项时，可以使用以下的配置选项：</p>
<h4>Extensions</h4>
<p>这是一个简单的 Portainer CE 订阅程序。详细信息和用途可以从附加的窗口中看到。这主要用于维护相应版本的许可证和订阅。</p>
<p><img alt="Extensions" src="/data/attachment/album/202101/14/204625t2aqecwdadd4cxxz.jpg"></p>
<h4>Users</h4>
<p>此选项用于添加具有或不具有管理权限的“用户”。下面的示例提供了相同的示例。</p>
<p>在本例中输入你的想好的用户名比如“shashi”和你选择的密码，然后点击下面的“Create User”按钮。</p>
<p><img alt="create_user_portainer" src="/data/attachment/album/202101/14/204626tvw2app99bgba9b9.jpg"></p>
<p><img alt="create_user2_portainer" src="/data/attachment/album/202101/14/204628bsgdaef4ozso02xx.jpg"></p>
<p><img alt="Internal-user-Portainer" src="/data/attachment/album/202101/14/204629y85pdtdkptzt0uzo.jpg"></p>
<p>类似地，可以通过选中复选框并点击 “remove” 按钮来删除刚刚创建的用户“shashi”。</p>
<p><img alt="user_remove_portainer" src="/data/attachment/album/202101/14/204630y88n7pbunpmbnmx1.jpg"></p>
<h4>Endpoints</h4>
<p>此选项用于端点终端管理。终端可以添加和删除，如附加窗口中所示。</p>
<p><img alt="Endpoint-Portainer-GUI" src="/data/attachment/album/202101/14/204631wfx4826tx54u4pqp.jpg"></p>
<p>新终端“shashi”是使用如下所示的各种默认参数创建的，</p>
<p><img alt="Endpoint2-Portainer-GUI" src="/data/attachment/album/202101/14/204633dgphhe1jhzd4gj6b.jpg"></p>
<p>类似地，可以通过单击复选框并单击移除按钮来移除此端点。</p>
<h4>Registries</h4>
<p>此选项用于注册管理。由于 docker hub 有各种镜像的注册，因此此功能可用于类似的目的。</p>
<p><img alt="Registry-Portainer-GUI" src="/data/attachment/album/202101/14/204634zyeycc3119pvfspe.jpg"></p>
<p>使用默认选项就可以创建“shashi-registry”。</p>
<p><img alt="Registry2-Portainer-GUI" src="/data/attachment/album/202101/14/204636ozsnn69scenf6sc6.jpg"></p>
<p>同样，如果不需要了，就可以移除它。</p>
<h4>Settings</h4>
<p>此选项用于设置以下各种选项，</p>
<ul>
<li>设置快照间隔</li>
<li>设置自定义徽标</li>
<li>创建外部模板</li>
<li>安全功能，如：为非管理员禁用和启用 bin 挂载，为非管理员禁用/启用权限，启用主机管理功能</li>
</ul>
<p>下面的屏幕截图显示了出于演示目的启用和禁用的一些选项。一旦全部完成点击“保存设置”按钮保存所有这些选项。</p>
<p><img alt="Portainer-GUI-Settings" src="/data/attachment/album/202101/14/204637z81mmbhmxc68gvb8.jpg"></p>
<p>现在点开“Authentication settings”就会弹出 LDAP、Internal 和 OAuth（extension）选项，如下所示：</p>
<p><img alt="Authentication-Portainer-GUI-Settings" src="/data/attachment/album/202101/14/204639arjz0jxeyx0xlxer.jpg"></p>
<p>根据我们想要的环境安全特性级别，选择相应的选项。</p>
<p>以上就是本文的内容，我希望这些介绍 portainer 的文章能帮助你更有效地管理和监视容器。请分享你的反馈和意见。</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>