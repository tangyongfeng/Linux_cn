<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>在 Linux 上使用 stat 命令查看文件状态</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: Seth Kenlon 获取到任何文件或文件系统的所有信息，仅需要一条 Linux 命令。 在 GNU coreutils 软件包中包含 stat 命令，它提供了关于文件和文 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li class="active"><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2021/09/zai-linux-shang-shi-yong-stat-ming-ling-cha-kan-wen-jian-zhuang-tai.html" rel="bookmark"
           title="Permalink to 在 Linux 上使用 stat 命令查看文件状态">在 Linux 上使用 stat 命令查看文件状态</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2021-09-10T07:29:19+02:00">
                Published: Fri 10 September 2021
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/ji-zhu">技术</a>.</p>

</footer><!-- /.post-info -->      <p>Author: Seth Kenlon</p>
<blockquote>
<p>获取到任何文件或文件系统的所有信息，仅需要一条 Linux 命令。</p>
</blockquote>
<p><img alt="" src="/data/attachment/album/202109/10/072912ouo04jchatqazq53.jpg" title="Hand putting a Linux file folder into a drawer"></p>
<p>在 GNU <code>coreutils</code> 软件包中包含 <code>stat</code> 命令，它提供了关于文件和文件系统包括文件大小、节点位置、访问权限和 SELinux 上下文，以及创建和修改时间等各种元数据。通常情况下，你需要多个不同命令获取的信息，而这一个命令就可以实现。</p>
<h3>在 Linux 上安装 stat 命令</h3>
<p>在 Linux 系统中，可能已经预装了 <code>stat</code> 命令，因为它属于核心功能软件包，通常默认包含在 Linux 发行版里。</p>
<p>如果系统中没有安装 <code>stat</code> 命令，你可以使用包管理器安装 <code>coreutils</code> 软件包。</p>
<p>另外，你可以 <a href="https://www.gnu.org/software/coreutils/">通过源码编译安装 coreutils 包</a>。</p>
<h3>获取文件状态</h3>
<p>运行 <code>stat</code> 命令可以获取指定文件或目录易读的状态信息。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>stat<span class="w"> </span>planets.xml
<span class="w">  </span>File:<span class="w"> </span>planets.xml
<span class="w">  </span>Size:<span class="w"> </span><span class="m">325</span><span class="w">      </span>Blocks:<span class="w"> </span><span class="m">8</span><span class="w">     </span>IO<span class="w"> </span>Block:<span class="w"> </span><span class="m">4096</span><span class="w">   </span>regular<span class="w"> </span>file
Device:<span class="w"> </span>fd03h/64771d<span class="w">    </span>Inode:<span class="w"> </span><span class="m">140217</span><span class="w">      </span>Links:<span class="w"> </span><span class="m">1</span>
Access:<span class="w"> </span><span class="o">(</span><span class="m">0664</span>/-rw-rw-r--<span class="o">)</span><span class="w">  </span>Uid:<span class="w"> </span><span class="o">(</span><span class="m">1000</span>/tux<span class="o">)</span><span class="w">   </span>Gid:<span class="w"> </span><span class="o">(</span><span class="m">100</span>/users<span class="o">)</span>
Context:<span class="w"> </span>unconfined_u:object_r:user_home_t:s0
Access:<span class="w"> </span><span class="m">2021</span>-08-17<span class="w"> </span><span class="m">18</span>:26:57.281330711<span class="w"> </span>+1200
Modify:<span class="w"> </span><span class="m">2021</span>-08-17<span class="w"> </span><span class="m">18</span>:26:58.738332799<span class="w"> </span>+1200
Change:<span class="w"> </span><span class="m">2021</span>-08-17<span class="w"> </span><span class="m">18</span>:26:58.738332799<span class="w"> </span>+1200
<span class="w"> </span>Birth:<span class="w"> </span><span class="m">2021</span>-08-17<span class="w"> </span><span class="m">18</span>:26:57.281330711<span class="w"> </span>+1200
</code></pre></div>

<p>输出的信息易懂，但是包含了很多的信息，这里是 <code>stat</code> 所包含的项：</p>
<ul>
<li><code>File</code>：文件名</li>
<li><code>Size</code>：文件大小，以字节表示</li>
<li><code>Blocks</code>：在硬盘驱动器上为文件保留的数据块的数量</li>
<li><code>IO Block</code>：文件系统块大小</li>
<li><code>regular file</code>：文件类型（普通文件、目录、文件系统）</li>
<li><code>Device</code>：文件所在的设备</li>
<li><code>Inode</code>：文件所在的 Inode 号</li>
<li><code>Links</code>：文件的链接数</li>
<li><code>Access</code>、<code>UID</code>、<code>GID</code>：文件权限、用户和组的所有者</li>
<li><code>Context</code>：SELinux 上下文</li>
<li><code>Access</code>、<code>Modify</code>、<code>Change</code>、<code>Birth</code>：文件被访问、修改、更改状态以及创建时的时间戳</li>
</ul>
<h3>精简输出</h3>
<p>对于精通输出或者想要使用其它工具（例如：<a href="https://opensource.com/article/20/9/awk-ebook">awk</a>）解析输出的人，这里可以使用 <code>--terse</code>（短参数为 <code>-t</code>）参数，实现没有标题或换行符的格式化输出。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>stat<span class="w"> </span>--terse<span class="w"> </span>planets.xml
planets.xml<span class="w"> </span><span class="m">325</span><span class="w"> </span><span class="m">8</span><span class="w"> </span>81b4<span class="w"> </span><span class="m">100977</span><span class="w"> </span><span class="m">100</span><span class="w"> </span>fd03<span class="w"> </span><span class="m">140217</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1629181617</span><span class="w"> </span><span class="m">1629181618</span><span class="w"> </span><span class="m">1629181618</span><span class="w"> </span><span class="m">1629181617</span><span class="w"> </span><span class="m">4096</span><span class="w"> </span>unconfined_u:object_r:user_home_t:s0
</code></pre></div>

<h3>自定义格式</h3>
<p>你可以使用 <code>--printf</code> 参数以及与 <a href="https://opensource.com/article/20/8/printf">printf</a> 类似的语法定义自己的输出格式。<code>stat</code> 的每一个属性都有一个格式序列（<code>%C</code> 表示 SELinux 上下文，<code>%n</code> 表示文件名等等），所以，你可以定义输出格式。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>stat<span class="w"> </span>--printf<span class="o">=</span><span class="s2">&quot;%n\n%C\n&quot;</span><span class="w"> </span>planets.xml
planets.xml
unconfined_u:object_r:user_home_t:s0
$<span class="w"> </span>$<span class="w"> </span>stat<span class="w"> </span>--printf<span class="o">=</span><span class="s2">&quot;Name: %n\nModified: %y\n&quot;</span><span class="w"> </span>planets.xml
Name:<span class="w"> </span>planets.xml
Modified:<span class="w"> </span><span class="m">2021</span>-08-17<span class="w"> </span><span class="m">18</span>:26:58.738332799<span class="w"> </span>+1200
</code></pre></div>

<p>下面是一些常见的格式序列：</p>
<ul>
<li><code>%a</code> 访问权限</li>
<li><code>%F</code> 文件类型</li>
<li><code>%n</code> 文件名</li>
<li><code>%U</code> 用户名</li>
<li><code>%u</code> 用户 ID</li>
<li><code>%g</code> 组 ID</li>
<li><code>%w</code> 创建时间</li>
<li><code>%y</code> 修改时间</li>
</ul>
<p>在 <code>stat</code> 手册和 <code>coreutils</code> 信息页中都有完整的格式化序列列表。</p>
<h3>文件信息</h3>
<p>如果你曾尝试解析过 <code>ls -l</code> 的输出，那么，你会很喜欢 <code>stat</code> 命令的灵活性。你并不是每次都需要 <code>stat</code> 提供的所有信息，但是，当你需要其中一些或全部的时候它是非常有用的。不管你是读取默认输出，还是你自己创建的查询输出，<code>stat</code> 命令都可以查看所需的数据。</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>