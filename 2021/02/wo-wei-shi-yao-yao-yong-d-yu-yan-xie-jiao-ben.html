<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>我为什么要用 D 语言写脚本？</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: Lawrence Aberba D 语言以系统编程语言而闻名，但它也是编写脚本的一个很好的选择。 D 语言由于其静态类型和元编程能力，经常 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li class="active"><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2021/02/wo-wei-shi-yao-yao-yong-d-yu-yan-xie-jiao-ben.html" rel="bookmark"
           title="Permalink to 我为什么要用 D 语言写脚本？">我为什么要用 D 语言写脚本？</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2021-02-09T13:44:46+01:00">
                Published: Tue 09 February 2021
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/ruan-jian-kai-fa">软件开发</a>.</p>

</footer><!-- /.post-info -->      <p>Author: Lawrence Aberba</p>
<blockquote>
<p>D 语言以系统编程语言而闻名，但它也是编写脚本的一个很好的选择。</p>
</blockquote>
<p><img alt="" src="/data/attachment/album/202102/09/134351j4m3hrhll0h38plp.jpg" title="Woman using laptop concentrating"></p>
<p>D 语言由于其静态类型和元编程能力，经常被宣传为系统编程语言。然而，它也是一种非常高效的脚本语言。</p>
<p>由于 Python 在自动化任务和快速实现原型想法方面的灵活性，它通常被选为脚本语言。这使得 Python 对系统管理员、<a href="https://opensource.com/article/20/3/automating-community-management-python">管理者</a>和一般的开发人员非常有吸引力，因为它可以自动完成他们可能需要手动完成的重复性任务。</p>
<p>我们自然也可以期待任何其他的脚本编写语言具有 Python 的这些特性和能力。以下是我认为 D 是一个不错的选择的两个原因。</p>
<h3>1、D 很容易读和写</h3>
<p>作为一种类似于 C 的语言，D 应该是大多数程序员所熟悉的。任何使用 JavaScript、Java、PHP 或 Python 的人对 D 语言都很容易上手。</p>
<p>如果你还没有安装 D，请<a href="https://tour.dlang.org/tour/en/welcome/install-d-locally">安装 D 编译器</a>，这样你就可以<a href="https://tour.dlang.org/tour/en/welcome/run-d-program-locally">运行本文中的 D 代码</a>。你也可以使用<a href="https://run.dlang.io/">在线 D 编辑器</a>。</p>
<p>下面是一个 D 代码的例子，它从一个名为 <code>words.txt</code> 的文件中读取单词，并在命令行中打印出来：</p>
<div class="highlight"><pre><span></span><code>open
source
is
cool
</code></pre></div>

<p>用 D 语言写脚本:</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env rdmd</span>
<span class="o">//</span> <span class="n">file</span> <span class="n">print_words</span><span class="o">.</span><span class="n">d</span>

<span class="o">//</span> <span class="kn">import</span> <span class="nn">the</span> <span class="n">D</span> <span class="n">standard</span> <span class="n">library</span>
<span class="kn">import</span> <span class="nn">std</span><span class="p">;</span>

<span class="n">void</span> <span class="n">main</span><span class="p">(){</span>
    <span class="o">//</span> <span class="nb">open</span> <span class="n">the</span> <span class="n">file</span>
     <span class="n">File</span><span class="p">(</span><span class="s2">&quot;./words.txt&quot;</span><span class="p">)</span>

         <span class="o">//</span><span class="n">iterate</span> <span class="n">by</span> <span class="n">line</span>
        <span class="o">.</span><span class="n">byLine</span>

        <span class="o">//</span> <span class="nb">print</span> <span class="n">each</span> <span class="n">number</span>
        <span class="o">.</span><span class="n">each</span><span class="err">!</span><span class="n">writeln</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<p>这段代码以 <a href="https://en.wikipedia.org/wiki/Shebang_(Unix)">释伴</a> 开头，它将使用 <a href="https://dlang.org/rdmd.html">rdmd</a> 来运行这段代码，<code>rdmd</code> 是 D 编译器自带的编译和运行代码的工具。假设你运行的是 Unix 或 Linux，在运行这个脚本之前，你必须使用<code>chmod</code> 命令使其可执行：</p>
<div class="highlight"><pre><span></span><code>chmod u+x print_words.d
</code></pre></div>

<p>现在脚本是可执行的，你可以运行它：</p>
<div class="highlight"><pre><span></span><code>./print_words.d
</code></pre></div>

<p>这将在你的命令行中打印以下内容：</p>
<div class="highlight"><pre><span></span><code>open
source
is
cool
</code></pre></div>

<p>恭喜你，你写了第一个 D 语言脚本。你可以看到 D 是如何让你按顺序链式调用函数，这让阅读代码的感觉很自然，类似于你在头脑中思考问题的方式。这个<a href="https://opensource.com/article/20/7/d-programming">功能让 D 成为我最喜欢的编程语言</a>。</p>
<p>试着再写一个脚本：一个非营利组织的管理员有一个捐款的文本文件，每笔金额都是单独的一行。管理员想把前 10 笔捐款相加，然后打印出金额：</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env rdmd</span>
<span class="o">//</span> <span class="n">file</span> <span class="n">sum_donations</span><span class="o">.</span><span class="n">d</span>

<span class="kn">import</span> <span class="nn">std</span><span class="p">;</span>

<span class="n">void</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">double</span> <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="o">//</span> <span class="nb">open</span> <span class="n">the</span> <span class="n">file</span>
    <span class="n">File</span><span class="p">(</span><span class="s2">&quot;monies.txt&quot;</span><span class="p">)</span>

         <span class="o">//</span> <span class="n">iterate</span> <span class="n">by</span> <span class="n">line</span>
        <span class="o">.</span><span class="n">byLine</span>

         <span class="o">//</span> <span class="n">pick</span> <span class="n">first</span> <span class="mi">10</span> <span class="n">lines</span>
        <span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

        <span class="o">//</span> <span class="n">remove</span> <span class="n">new</span> <span class="n">line</span> <span class="n">characters</span> <span class="p">(</span>\<span class="n">n</span><span class="p">)</span>
        <span class="o">.</span><span class="n">map</span><span class="err">!</span><span class="p">(</span><span class="n">strip</span><span class="p">)</span>

         <span class="o">//</span> <span class="n">convert</span> <span class="n">each</span> <span class="n">to</span> <span class="n">double</span>
        <span class="o">.</span><span class="n">map</span><span class="err">!</span><span class="p">(</span><span class="n">to</span><span class="err">!</span><span class="n">double</span><span class="p">)</span>

        <span class="o">//</span> <span class="n">add</span> <span class="n">element</span> <span class="n">to</span> <span class="n">total</span>
        <span class="o">.</span><span class="n">tee</span><span class="err">!</span><span class="p">((</span><span class="n">x</span><span class="p">)</span> <span class="p">{</span> <span class="n">total</span> <span class="o">+=</span> <span class="n">x</span><span class="p">;</span> <span class="p">})</span>

        <span class="o">//</span> <span class="nb">print</span> <span class="n">each</span> <span class="n">number</span>
        <span class="o">.</span><span class="n">each</span><span class="err">!</span><span class="n">writeln</span><span class="p">;</span>

    <span class="o">//</span> <span class="nb">print</span> <span class="n">total</span>
    <span class="n">writeln</span><span class="p">(</span><span class="s2">&quot;total: &quot;</span><span class="p">,</span> <span class="n">total</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p>与 <code>each</code> 一起使用的 <code>!</code> 操作符是<a href="http://ddili.org/ders/d.en/templates.html">模板参数</a>的语法。</p>
<h3>2、D 是快速原型设计的好帮手</h3>
<p>D 是灵活的，它可以快速地将代码敲打在一起，并使其发挥作用。它的标准库中包含了丰富的实用函数，用于执行常见的任务，如操作数据（JSON、CSV、文本等）。它还带有一套丰富的通用算法，用于迭代、搜索、比较和 mutate 数据。这些巧妙的算法通过定义通用的 <a href="http://ddili.org/ders/d.en/ranges.html">基于范围的接口</a> 而按照序列进行处理。</p>
<p>上面的脚本显示了 D 中的链式调用函数如何提供顺序处理和操作数据的要领。D 的另一个吸引人的地方是它不断增长的用于执行普通任务的第三方包的生态系统。一个例子是，使用 <a href="https://vibed.org">Vibe.d</a> web 框架构建一个简单的 web 服务器很容易。下面是一个例子：</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env dub</span>
<span class="o">/+</span> <span class="n">dub</span><span class="o">.</span><span class="n">sdl</span><span class="p">:</span>
<span class="n">dependency</span> <span class="s2">&quot;vibe-d&quot;</span> <span class="n">version</span><span class="o">=</span><span class="s2">&quot;~&gt;0.8.0&quot;</span>
<span class="o">+/</span>
<span class="n">void</span> <span class="n">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kn">import</span> <span class="nn">vibe.d</span><span class="p">;</span>
    <span class="n">listenHTTP</span><span class="p">(</span><span class="s2">&quot;:8080&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">res</span><span class="o">.</span><span class="n">writeBody</span><span class="p">(</span><span class="s2">&quot;Hello, World: &quot;</span> <span class="o">~</span> <span class="n">req</span><span class="o">.</span><span class="n">path</span><span class="p">);</span>
    <span class="p">});</span>
    <span class="n">runApplication</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>

<p>它使用官方的 D 软件包管理器 <a href="https://dub.pm/getting_started">Dub</a>，从 <a href="https://code.dlang.org">D 软件包仓库</a>中获取 vibe.d Web 框架。Dub 负责下载 Vibe.d 包，然后在本地主机 8080 端口上编译并启动一个 web 服务器。</p>
<h3>尝试一下 D 语言</h3>
<p>这些只是你可能想用 D 来写脚本的几个原因。</p>
<p>D 是一种非常适合开发的语言。你可以很容易从 D 下载页面安装，因此下载编译器，看看例子，并亲自体验 D 语言。</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>