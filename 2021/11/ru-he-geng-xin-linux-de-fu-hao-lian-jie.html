<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>如何更新 Linux 的符号链接</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: Alan Formy-duval 链接一直是 UNIX 文件系统的一个独特的高级功能。 UNIX 和 Linux 用户发现链接有很多用途，特别是符号链接。我喜欢使用符 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li class="active"><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2021/11/ru-he-geng-xin-linux-de-fu-hao-lian-jie.html" rel="bookmark"
           title="Permalink to 如何更新 Linux 的符号链接">如何更新 Linux 的符号链接</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2021-11-13T18:56:33+01:00">
                Published: Sat 13 November 2021
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/ji-zhu">技术</a>.</p>

</footer><!-- /.post-info -->      <p>Author: Alan Formy-duval</p>
<blockquote>
<p>链接一直是 UNIX 文件系统的一个独特的高级功能。</p>
</blockquote>
<p><img alt="" src="/data/attachment/album/202111/13/185626ubb832pphjhlpmly.jpg" title="Links"></p>
<p>UNIX 和 Linux 用户发现链接有很多用途，特别是符号链接。我喜欢使用符号链接的一种方式是管理各种 IT 设备的配置备份。</p>
<p>我有一个目录结构，用来存放我的文档、更新及网络上其他和计算机和设备有关的文件。设备可以包括路由器、接入点、NAS 服务器和笔记本电脑，通常有不同的品牌和版本。配置备份本身可能在目录树的深处，例如 <code>/home/alan/Documents/network/device/NetgearRL5000/config</code>。</p>
<p>为了简化备份过程，我在主目录中有一个名为 <code>Configuration</code> 的目录。我使用这个目录的符号链接来指向特定的设备目录：</p>
<div class="highlight"><pre><span></span><code>:~/Configuration/ $ ls -F1
Router@
Accesspoint@
NAS@
</code></pre></div>

<p><strong>注意</strong>：<code>ls</code> 命令的 <code>-F</code> 选项在每个文件名上附加特殊字符以表示其类型。如上所示，<code>@</code> 符号表示这些是链接。</p>
<h3>创建一个链接</h3>
<p>符号链接 <code>Router</code> 指向我的 Netgear RL5000 的 <code>config</code> 目录。创建它的命令是 <code>ln -s</code>：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ln<span class="w"> </span>-s<span class="w"> </span>/home/alan/Documents/network/device/NetgearRL5000/config<span class="w"> </span>Router
</code></pre></div>

<p>然后，用 <code>ls -l</code> 看一下并确认：</p>
<div class="highlight"><pre><span></span><code><span class="o">:~/</span><span class="n">Configuration</span><span class="o">/</span><span class="w"> </span><span class="err">$</span><span class="w"> </span><span class="n">ls</span><span class="w"> </span><span class="o">-</span><span class="n">l</span>
<span class="n">Router</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">alan</span><span class="o">/</span><span class="n">Documents</span><span class="o">/</span><span class="n">network</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">NetgearRL5000</span><span class="o">/</span><span class="n">config</span>
<span class="n">NAS</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">alan</span><span class="o">/</span><span class="n">Documents</span><span class="o">/</span><span class="n">network</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">NFSBox</span><span class="o">/</span><span class="n">config</span>
<span class="p">...</span>
</code></pre></div>

<p>这样做的好处是，当对这个设备进行维护时，我只需进入 <code>~/Configuration/Router</code>。</p>
<p>如果我决定用一个新的型号替换这个路由器，使用符号链接的第二个好处就很明显了。我可能会把旧的路由器改成一个接入点。因此，它的目录并没有被删除。相反，我有一个新的目录，对应于新的路由器，也许是华硕 DF-3760。我创建这个目录并确认它的存在：</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>mkdir<span class="w"> </span>-p<span class="w"> </span>~/Documents/network/device/ASUSDF-3760/config
</code></pre></div>

<div class="highlight"><pre><span></span><code>:~/Documents/network/device/ $ ls
NetgearRL5000
ASUSDF-3760
NFSBox
...
</code></pre></div>

<p>另一个例子是，如果你的办公室里有几个接入点。你可以使用符号链接在逻辑上代表每一个，用一个通用的名字，如 <code>ap1</code>，<code>ap2</code>，等等，或者你可以使用描述性的词语，如 <code>ap_floor2</code>，<code>ap_floor3</code>，等等。这样，当物理设备随时间变化时，你不必持续更新任何可能管理它们的进程，因为它们是在处理链接而不是实际的设备目录。</p>
<h3>更新一个链接</h3>
<p>由于我的主路由器已经改变，我想让路由器的符号链接指向它的目录。我可以使用 <code>rm</code> 和 <code>ln</code> 命令来删除和创建一个新的符号链接，但是有一种方法可以只用 <code>ln</code> 命令和几个选项就可以一步完成：</p>
<div class="highlight"><pre><span></span><code><span class="o">:~/</span><span class="n">Configuration</span><span class="o">/</span><span class="w"> </span><span class="err">$</span><span class="w"> </span><span class="nf">ln</span><span class="w"> </span><span class="o">-</span><span class="n">vfns</span><span class="w"> </span><span class="o">~/</span><span class="n">Documents</span><span class="o">/</span><span class="n">network</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">ASUSDF</span><span class="o">-</span><span class="mi">3760</span><span class="o">/</span><span class="n">config</span><span class="o">/</span><span class="w"> </span><span class="n">Router</span>
<span class="s">&#39;Router&#39;</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">&#39;/home/alan/Documents/network/device/ASUSDF-3760/config/&#39;</span>
<span class="o">:~/</span><span class="n">Configuration</span><span class="o">/</span><span class="w"> </span><span class="err">$</span><span class="w"> </span><span class="n">ls</span><span class="w"> </span><span class="o">-</span><span class="n">l</span>
<span class="n">Router</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">alan</span><span class="o">/</span><span class="n">Documents</span><span class="o">/</span><span class="n">network</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">ASUSDF</span><span class="o">-</span><span class="mi">3760</span><span class="o">/</span><span class="n">config</span>
<span class="n">NAS</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">alan</span><span class="o">/</span><span class="n">Documents</span><span class="o">/</span><span class="n">network</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">NFSBox</span><span class="o">/</span><span class="n">config</span>
</code></pre></div>

<p>根据手册页，这些选项如下：</p>
<ul>
<li><code>-v</code>、<code>--verbose</code>：打印每个链接文件的名称</li>
<li><code>-f</code>、<code>--force</code>：删除目标文件（有必要，因为已经存在一个链接）</li>
<li><code>-n</code>、<code>--no-dereference</code>：如果链接名是一个目录的符号链接，就把它当作一个正常的文件</li>
<li><code>-s</code>、<code>--symbolic</code>：制作符号链接而不是硬链接</li>
</ul>
<h3>总结</h3>
<p>链接是 UNIX 和 Linux 文件系统中最强大的功能之一。其他操作系统也曾试图模仿这种能力，但由于他们的文件系统缺乏基本的链接设计，这些系统从来没有工作得那么好，也没有那么可用。</p>
<p>上面的演示只是利用链接在生活生产环境中无缝浏览不断变化的目录结构的众多可能性中的一种。链接提供了一个永远不会长期静态的组织所需的灵活性。</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>