<!DOCTYPE html>
<html lang="zh">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>在 FreeDOS 中使用批处理文件</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="Author: Kevin O'brien 编写你自己的简单程序来自动执行通常需要大量输入的任务的批处理文件，是一种极好的方法。 在 Linux 上，创建 shell 脚 …" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">linux_cn</a></h1>
                <nav><ul>
                    <li><a href="/category/chuan-shan-jia-zhuan-fang">穿山甲专访</a></li>
                    <li><a href="/category/dai-ma-ying-xiong">代码英雄</a></li>
                    <li><a href="/category/fen-xiang">分享</a></li>
                    <li><a href="/category/guan-dian">观点</a></li>
                    <li><a href="/category/huo-dong">活动</a></li>
                    <li><a href="/category/ji-ke-man-hua">极客漫画</a></li>
                    <li class="active"><a href="/category/ji-zhu">技术</a></li>
                    <li><a href="/category/kai-yuan-zhi-hui">开源智慧</a></li>
                    <li><a href="/category/linux-fa-xing-ban">Linux 发行版</a></li>
                    <li><a href="/category/mei-ri-an-quan-zi-xun">每日安全资讯</a></li>
                    <li><a href="/category/misc">Misc</a></li>
                    <li><a href="/category/qu-kuai-lian">区块链</a></li>
                    <li><a href="/category/rong-qi-yu-yun">容器与云</a></li>
                    <li><a href="/category/ruan-jian-kai-fa">软件开发</a></li>
                    <li><a href="/category/shu-mei-pai">树莓派</a></li>
                    <li><a href="/category/xi-tong-yun-wei">系统运维</a></li>
                    <li><a href="/category/xin-wen">新闻</a></li>
                    <li><a href="/category/ying-he-guan-cha">硬核观察</a></li>
                    <li><a href="/category/zhi-ye-sheng-ya">职业生涯</a></li>
                    <li><a href="/category/zhong-jiang-ming-dan">中奖名单</a></li>
                    <li><a href="/category/zhuo-mian-ying-yong">桌面应用</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2021/12/zai-freedos-zhong-shi-yong-pi-chu-li-wen-jian.html" rel="bookmark"
           title="Permalink to 在 FreeDOS 中使用批处理文件">在 FreeDOS 中使用批处理文件</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2021-12-24T10:28:01+01:00">
                Published: Fri 24 December 2021
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/linux-fans-from-china.html">linux fans from china</a>
        </address>
<p>In <a href="/category/ji-zhu">技术</a>.</p>

</footer><!-- /.post-info -->      <p>Author: Kevin O'brien</p>
<blockquote>
<p>编写你自己的简单程序来自动执行通常需要大量输入的任务的批处理文件，是一种极好的方法。</p>
</blockquote>
<p><img alt="" src="/data/attachment/album/202112/24/102751sldikuebf7z4u64l.jpg" title="Computer screen with files or windows open"></p>
<p>在 Linux 上，创建 <em>shell 脚本</em> 来自动执行重复的任务是很常见的。类似地，在开源版的旧式 DOS 操作系统 <a href="https://www.freedos.org/">FreeDOS</a> 上，你可以创建一个包含数个 FreeDOS 命令的 <em>批处理文件</em> 。然后，你就可以运行你的批处理文件来按顺序执行每个命令。</p>
<p>你可以使用一个 ASCII 文本编辑器来创建批处理文件，诸如 FeeDOS 的 Edit 应用程序。在你创建一个批处理文件后，你可以使用一个文件名称加上扩展名 <code>.bat</code> 来保存它。文件名称应该是唯一的。如果你使用 FreeDOS 的一个命令的名称作为你自己的文件名称，那么可能将会执行 FreeDOS 的命令，而不会是你的批处理文件。</p>
<p>实际上，所有的内部的和外部的 FreeDOS 命令都可以在一个批处理文件中使用。在你创建一个批处理文件时，你其实就是在编写一个程序。FreeDOS 批处理文件可能没有结构化编程语言的功能，但是对于耗时短暂却重复乏味的任务来说，它是非常方便的。</p>
<h3>注释你的代码</h3>
<p>对于任何程序员来说，学习的第一个好习惯都应该是：在一个程序中放置注释来解释该代码正在做什么。这是一件非常容易完成的事情，但是你需要仔细，不要傻傻地让操作系统来执行你的注释。避免出现这种情况的方法是在一个注释行的开头处放置 <code>REM</code>（“remark” 的缩写） 。</p>
<p>FreeDOS 忽略以 <code>REM</code> 开头的代码行。但是任何查看源文件代码（即你在你的批处理文件中所编写的文本）的人都可以读取你的注释并理解它在做什么。这也是一种临时性禁用一个命令而不需要删除它的一种方法。只需要打开你的批处理文件来进行编辑，在你想要禁用行的开头处放置 <code>REM</code> ，并保存它。在你想要重新启用这个命令时，只需要打开文件来进行编辑和移除 <code>REM</code> 。这种技巧有时被称为 “注释掉” 一个命令。</p>
<h3>开始设置</h3>
<p>在你开始编写你自己的批处理文件前，我建议在 FreeDOS 中创建一个临时目录。这将会为你提供一个处理批处理文件的安全空间，不会意外地删除、移动，或重命名重要的系统文件或目录。在 FreeDOS 上，你可以使用 <code>MD</code> 命令来 <a href="https://opensource.com/article/21/2/freedos-commands-you-need-know">创建一个目录</a> ：</p>
<div class="highlight"><pre><span></span><code>C:\&gt;MD TEMP
C:\&gt;CD TEMP
C:\TEMP&gt;
</code></pre></div>

<p>FreeDOS 的 <code>ECHO</code> 命令会控制当你运行一个批处理文件时在屏幕上显示的东西。例如，这里是一个简单是单行批处理文件：</p>
<div class="highlight"><pre><span></span><code>ECHO Hello world
</code></pre></div>

<p>如果你创建这个文件并运行它，你将看到在屏幕上显示的句子。从命令行中完成这项操作的最快的方法是：使用 <code>COPY</code> 命令来从你的键盘中（<code>CON</code>）获取输入，并将其放置到文件 <code>TEST1.BAT</code> 之中。接下来，按下组合键 <code>Ctrl+Z</code> 来停止复制过程，按下你键盘上的 <code>Return</code> 或 <code>Enter</code> 按键来返回一个提示。</p>
<p>在你的临时目录中尝试创建这个文件为 <code>TEST1.BAT</code> ，接下来运行它：</p>
<div class="highlight"><pre><span></span><code>C:\TEMP&gt;COPY CON TEST1.BAT
CON =&gt; TEST1.BAT
ECHO Hello world
^Z

C:\TEMP&gt;TEST1
Hello world
</code></pre></div>

<p>当你想要显示一段文本时，这可能很有用。例如，在一个程序完成它的任务时，你可能会在你的屏幕上看到一条告诉你需要等待的消息，或者在一个网络环境中时，你可能会看到一条登录消息。</p>
<p>如果你想要显示一个空行怎么办？你可能会认为 <code>ECHO</code> 命令本身就可以达到目的，但是单独一个 <code>ECHO</code> 命令只会询问 FreeDOS 来响应 <code>ECHO</code> 是打开还是关闭：</p>
<div class="highlight"><pre><span></span><code>C:\TEMP&gt;ECHO
ECHO is on
</code></pre></div>

<p>获取一个空白行的方法是在 <code>ECHO</code>后紧接着使用一个 <code>+</code>符号：</p>
<div class="highlight"><pre><span></span><code>C:\TEMP&gt;ECHO+

C:\TEMP&gt;
</code></pre></div>

<h3>批处理文件变量</h3>
<p>变量是一个存储你需要你的批处理文件临时记住的信息的位置。这是编程的一个重要的功能，因为你不能总是知道你的批处理文件需要使用什么样的数据。这里有一个用于演示的简单示例。</p>
<p>创建 <code>TEST3.BAT</code> ：</p>
<div class="highlight"><pre><span></span><code><span class="nv">@MD</span><span class="w"> </span><span class="n">BACKUPS</span>
<span class="n">COPY</span><span class="w"> </span><span class="o">%</span><span class="mi">1</span><span class="w"> </span><span class="n">BACKUPS</span><span class="err">\</span><span class="o">%</span><span class="mi">1</span>
</code></pre></div>

<p>变量是使用百分比符号和随后的数字表示的，因此，这个批处理文件将在你的当前目录中创建一个 <code>BACKUPS</code> 子目录，然后将复制变量 <code>%1</code> 到 <code>BACKUPS</code> 文件夹之中。这个变量是什么？当你运行批处理文件时，变量由你决定：</p>
<div class="highlight"><pre><span></span><code>C:\TEMP&gt;TEST3 TEMP1.BAT
TEST1.BAT =&gt; BACKUPS\TEST1.BAT
</code></pre></div>

<p>你的批处理文件已经复制 <code>TEST1.BAT</code> 到一个名称为 <code>BACKUPS</code> 的子目录，因为在你运行批处理文件时，你标识这个文件为一个参数。你的批处理文件将把 <code>%1</code> 替换为 <code>TEST1.BAT</code> 。</p>
<p>变量是按位置的。变量 <code>%1</code> 是你提供给命令的第一个参数，变量 <code>%2</code> 是第二个参数，以此类推。假设你创建一个批处理文件来列出一个目录的内容：</p>
<div class="highlight"><pre><span></span><code>DIR %1
</code></pre></div>

<p>尝试运行它：</p>
<div class="highlight"><pre><span></span><code>C:\TEMP&gt;TEST4.BAT C:\HOME
ARTICLES
BIN
CHEATSHEETS
GAMES
DND
</code></pre></div>

<p>这像预期一样的工作。但是下面这个却失败了：</p>
<div class="highlight"><pre><span></span><code>C:\TEMP&gt;TEST4.BAT C:\HOME C:\DOCS
ARTICLES
BIN
CHEATSHEETS
GAMES
DND
</code></pre></div>

<p>如果你尝试它，你将得到第一个参数（<code>C:\HOME</code>）的列表，而得不到第二个参数（<code>C:\DOCS</code>）的列表。这是因为你的批处理文件仅查找一个变量（<code>%1</code>），此外，<code>DIR</code> 命令也仅能获取一个目录。</p>
<p>此外，当你运行一个批处理文件时，你也不需要为其具体指定扩展名 —— 除非你运气相当不好地为批处理文件选取了一个与 FreeDOS 外部命令或类似命令相同的名称。当 FreeDOS 执行命令时，它按下面的顺序执行：</p>
<ol>
<li>内部命令</li>
<li>带有 *.COM 扩展名的外部命令</li>
<li>带有 *.EXE 扩展名的外部命令</li>
<li>批处理文件</li>
</ol>
<h3>多个参数</h3>
<p>好的，选择重新编写 <code>TEST4.BAT</code> 文件来使一个命令可以获取两个参数，以便你可以看到这是如何工作的。首先，使用 <code>EDIT</code> 应用程序来创建一个简单的名称为 <code>FILE1.TXT</code> 的文本文件。在其中放置一段某种类型（例如，“Hello world”）的语句，并在你的 <code>TEMP</code> 工作目录中保存文件。</p>
<p>接下来，使用 <code>EDIT</code> 来更改你的 <code>TEST4.BAT</code> 文件：</p>
<div class="highlight"><pre><span></span><code>COPY %1 %2
DIR
</code></pre></div>

<p>保存它，然后执行命令：</p>
<div class="highlight"><pre><span></span><code>C:\TEMP\&gt;TEST4 FILE1.TXT FILE2.TXT
</code></pre></div>

<p>在运行你的批处理文件时，你会看一个你的 <code>TEMP</code> 目录的目录列表。在列出的文件之中，你有 <code>FILE1.TXT</code> 和 <code>FILE2.TXT</code> ，它们是由你的批处理文件所创建的。</p>
<h3>嵌套批处理文件</h3>
<p>批处理文件的另一个功能是能够 “嵌套” ，这意味着一个批处理文件可以在另外一个批处理文件中被调用和运行。为查看这是如何工作的，从一对简单的批处理文件开始：</p>
<p>第一个文件被称为 <code>NBATCH1.BAT</code> ：</p>
<div class="highlight"><pre><span></span><code><span class="nv">@ECHO</span><span class="w"> </span><span class="k">OFF</span>
<span class="n">ECHO</span><span class="w"> </span><span class="n">Hello</span>
<span class="k">CALL</span><span class="w"> </span><span class="n">NBATCH2</span><span class="p">.</span><span class="n">BAT</span><span class="w"> </span>
<span class="n">ECHO</span><span class="w"> </span><span class="n">world</span>
</code></pre></div>

<p>第一行 （<code>@ECHO OFF</code>） 轻轻地告诉批处理文件在你运行它时仅显示命令 （而不是命令本身） 的输出。你可能会在前面的示例中注意到这里有很多关于批处理文件正在做什么的反馈；在这种情况下，你正在允许你的批处理文件仅显示结果。</p>
<p>第二个批处理被称为 NBATCH2.BAT ：</p>
<div class="highlight"><pre><span></span><code>echo from FreeDOS
</code></pre></div>

<p>使用 <code>EDIT</code> 来创建这两个文件，并在你的 TEMP 子目录中保存它们。运行 <code>NBATCH1.BAT</code> 来查看会发生什么：</p>
<div class="highlight"><pre><span></span><code>C:\TEMP\&gt;NBATCH1.BAT 
Hello
from FreeDOS
world
</code></pre></div>

<p>你的第二个批处理文件将在第一个批处理文件之中通过 <code>CALL</code> 命令来执行，它将提供在你 “Hello world” 信息中间的字符串 “from FreeDOS” 。</p>
<h3>FreeDOS 脚本</h3>
<p>编写你自己的简单程序来自动执行通常需要大量输入的任务的批处理文件，是一种极好的方法。你使用的 FreeDOS 越多, 你将越熟悉它的命令，在你熟知命令后，在一个批处理文件中列出它们仅是一件使你的 FreeDOS 系统让你生活轻松的事情。尝试一下！</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://getpelican.com/">Pelican</a></li>
                            <li><a href="https://www.python.org/">Python.org</a></li>
                            <li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>